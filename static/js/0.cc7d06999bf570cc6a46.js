webpackJsonp([0],{"/JqY":function(t,e,n){var i=n("1Ldu").coordEach;t.exports=function(t){return t=JSON.parse(JSON.stringify(t)),i(t,function(t){t.reverse()}),t}},"0/Kn":function(t,e,n){var i=n("WSCq").featureCollection,r=n("HedJ"),o=n("fJ48"),s=n("OiNl"),a=n("Rsiq");function h(t,e,n,i,r,o){if(Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)))return!0}t.exports=function(t){"FeatureCollection"!==t.type&&("Feature"!==t.type&&(t={type:"Feature",geometry:t,properties:{}}),t=i([t]));for(var e=r(t),n=!1,u=0;!n&&u<t.features.length;){var l,c=t.features[u].geometry,f=!1;if("Point"===c.type)e.geometry.coordinates[0]===c.coordinates[0]&&e.geometry.coordinates[1]===c.coordinates[1]&&(n=!0);else if("MultiPoint"===c.type){var p=!1;for(l=0;!p&&l<c.coordinates.length;)e.geometry.coordinates[0]===c.coordinates[l][0]&&e.geometry.coordinates[1]===c.coordinates[l][1]&&(n=!0,p=!0),l++}else if("LineString"===c.type)for(l=0;!f&&l<c.coordinates.length-1;)h(e.geometry.coordinates[0],e.geometry.coordinates[1],c.coordinates[l][0],c.coordinates[l][1],c.coordinates[l+1][0],c.coordinates[l+1][1])&&(f=!0,n=!0),l++;else if("MultiLineString"===c.type)for(var d=0;d<c.coordinates.length;){f=!1,l=0;for(var g=c.coordinates[d];!f&&l<g.length-1;)h(e.geometry.coordinates[0],e.geometry.coordinates[1],g[l][0],g[l][1],g[l+1][0],g[l+1][1])&&(f=!0,n=!0),l++;d++}else"Polygon"!==c.type&&"MultiPolygon"!==c.type||s(e,{type:"Feature",geometry:c,properties:{}})&&(n=!0);u++}if(n)return e;var y,m=i([]);for(u=0;u<t.features.length;u++)m.features=m.features.concat(a(t.features[u]).features);var v=1/0;for(u=0;u<m.features.length;u++){var _=o(e,m.features[u],"miles");_<v&&(v=_,y=m.features[u])}return y}},"1Ldu":function(t,e){function n(t,e,n){var i,r,o,s,a,h,u,l,c,f,p=0,d="FeatureCollection"===t.type,g="Feature"===t.type,y=d?t.features.length:1;for(i=0;i<y;i++)for(u=(f="GeometryCollection"===(c=d?t.features[i].geometry:g?t.geometry:t).type)?c.geometries.length:1,s=0;s<u;s++)if(l=(h=f?c.geometries[s]:c).coordinates,p=!n||"Polygon"!==h.type&&"MultiPolygon"!==h.type?0:1,"Point"===h.type)e(l);else if("LineString"===h.type||"MultiPoint"===h.type)for(r=0;r<l.length;r++)e(l[r]);else if("Polygon"===h.type||"MultiLineString"===h.type)for(r=0;r<l.length;r++)for(o=0;o<l[r].length-p;o++)e(l[r][o]);else{if("MultiPolygon"!==h.type)throw new Error("Unknown Geometry Type");for(r=0;r<l.length;r++)for(o=0;o<l[r].length;o++)for(a=0;a<l[r][o].length-p;a++)e(l[r][o][a])}}function i(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}t.exports.coordEach=n,t.exports.coordReduce=function(t,e,i,r){return n(t,function(t){i=e(i,t)},r),i},t.exports.propEach=i,t.exports.propReduce=function(t,e,n){return i(t,function(t){n=e(n,t)}),n},t.exports.featureEach=function(t,e){if("Feature"===t.type)e(t);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n])},t.exports.coordAll=function(t){var e=[];return n(t,function(t){e.push(t)}),e}},"1sH3":function(t,e,n){var i=n("OiNl");t.exports=function(t,e,n,r){return t=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(e)),t.features.forEach(function(t){t.properties||(t.properties={}),e.features.forEach(function(e){void 0===t.properties[r]&&(i(t,e)&&(t.properties[r]=e.properties[n]))})}),t}},"5gC3":function(t,e,n){"use strict";var i=n("v+Tb"),r=n("U4kr");t.exports=function(t,e){var n=t.length;if(1===n){var o=i(t[0],e);return o[0]?o:[o[1]]}var s=new Array(2*n),a=[.1,.1],h=[.1,.1],u=0;i(t[0],e,a),a[0]&&(s[u++]=a[0]);for(var l=1;l<n;++l){i(t[l],e,h);var c=a[1];r(c,h[0],a),a[0]&&(s[u++]=a[0]);var f=h[1],p=a[1],d=f+p,g=d-f,y=p-g;a[1]=d,y&&(s[u++]=y)}a[1]&&(s[u++]=a[1]);0===u&&(s[u++]=0);return s.length=u,s}},"71UE":function(t,e,n){var i=n("QLfZ"),r=["LineString","MultiLineString","Polygon","MultiPolygon"];function o(t,e,n){return"LineString"===t.geometry.type?{type:"LineString",coordinates:h(t.geometry.coordinates,e,n)}:"MultiLineString"===t.geometry.type?{type:"MultiLineString",coordinates:t.geometry.coordinates.map(function(t){return h(t,e,n)})}:"Polygon"===t.geometry.type?{type:"Polygon",coordinates:u(t.geometry.coordinates,e,n)}:"MultiPolygon"===t.geometry.type?{type:"MultiPolygon",coordinates:t.geometry.coordinates.map(function(t){return u(t,e,n)})}:t}function s(t){return!(t.length<3)&&(3!==t.length||t[2][0]!==t[0][0]||t[2][1]!==t[0][1])}function a(t,e){return{type:"Feature",geometry:t,properties:e}}function h(t,e,n){return i(t.map(function(t){return{x:t[0],y:t[1]}}),e,n).map(function(t){return[t.x,t.y]})}function u(t,e,n){return t.map(function(t){var r=t.map(function(t){return{x:t[0],y:t[1]}});if(r.length<4)throw new Error("Invalid polygon");for(var o=i(r,e,n).map(function(t){return[t.x,t.y]});!s(o);)o=i(r,e-=.01*e,n).map(function(t){return[t.x,t.y]});return o[o.length-1][0]===o[0][0]&&o[o.length-1][1]===o[0][1]||o.push(o[0]),o})}t.exports=function(t,e,n){return"Feature"===t.type?a(o(t,e,n),t.properties):"FeatureCollection"===t.type?{type:"FeatureCollection",features:t.features.map(function(t){var i=o(t,e,n);return r.indexOf(i.type)>-1?a(i,t.properties):i})}:"GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(function(t){return r.indexOf(t.type)>-1?o({type:"Feature",geometry:t},e,n):t})}:t}},AgVf:function(t,e,n){var r=n("UqTI");function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(s(t[n]))}return e}function s(t){var e,n,o,s,h,u=0,l=t.length;if(l>2){for(i=0;i<l;i++)i===l-2?(o=l-2,s=l-1,h=0):i===l-1?(o=l-1,s=0,h=1):(o=i,s=i+1,h=i+2),e=t[o],n=t[s],u+=(a(t[h][0])-a(e[0]))*Math.sin(a(n[1]));u=u*r.RADIUS*r.RADIUS/2}return u}function a(t){return t*Math.PI/180}t.exports.geometry=function t(e){var n,i=0;switch(e.type){case"Polygon":return o(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=o(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}},t.exports.ring=s},Ckg5:function(t,e){t.exports.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},t.exports.collectionOf=function(t,e,n){if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}},t.exports.featureOf=function(t,e,n){if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},t.exports.getCoord=function(t){if(Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1])return t;if(t){if("Feature"===t.type&&t.geometry&&"Point"===t.geometry.type&&Array.isArray(t.geometry.coordinates))return t.geometry.coordinates;if("Point"===t.type&&Array.isArray(t.coordinates))return t.coordinates}throw new Error("A coordinate, feature, or point geometry is required")}},Cxdp:function(t,e,n){"use strict";"use restrict";var i=n("eWjs"),r=n("ng5e");function o(t,e){var n=t.length,i=t.length-e.length,r=Math.min;if(i)return i;switch(n){case 0:return 0;case 1:return t[0]-e[0];case 2:return(a=t[0]+t[1]-e[0]-e[1])||r(t[0],t[1])-r(e[0],e[1]);case 3:var o=t[0]+t[1],s=e[0]+e[1];if(a=o+t[2]-(s+e[2]))return a;var a,h=r(t[0],t[1]),u=r(e[0],e[1]);return(a=r(h,t[2])-r(u,e[2]))||r(h+t[2],o)-r(u+e[2],s);default:var l=t.slice(0);l.sort();var c=e.slice(0);c.sort();for(var f=0;f<n;++f)if(i=l[f]-c[f])return i;return 0}}function s(t,e){return o(t[0],e[0])}function a(t,e){if(e){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=[t[r],e[r]];i.sort(s);for(r=0;r<n;++r)t[r]=i[r][0],e[r]=i[r][1];return t}return t.sort(o),t}function h(t){if(0===t.length)return[];for(var e=1,n=t.length,i=1;i<n;++i){var r=t[i];if(o(r,t[i-1])){if(i===e){e++;continue}t[e++]=r}}return t.length=e,t}function u(t,e){for(var n=0,i=t.length-1,r=-1;n<=i;){var s=n+i>>1,a=o(t[s],e);a<=0?(0===a&&(r=s),n=s+1):a>0&&(i=s-1)}return r}function l(t,e){for(var n=new Array(t.length),r=0,s=n.length;r<s;++r)n[r]=[];for(var a=[],h=(r=0,e.length);r<h;++r)for(var l=e[r],c=l.length,f=1,p=1<<c;f<p;++f){a.length=i.popCount(f);for(var d=0,g=0;g<c;++g)f&1<<g&&(a[d++]=l[g]);var y=u(t,a);if(!(y<0))for(;n[y++].push(r),!(y>=t.length||0!==o(t[y],a)););}return n}function c(t,e){if(e<0)return[];for(var n=[],r=(1<<e+1)-1,o=0;o<t.length;++o)for(var s=t[o],h=r;h<1<<s.length;h=i.nextCombination(h)){for(var u=new Array(e+1),l=0,c=0;c<s.length;++c)h&1<<c&&(u[l++]=s[c]);n.push(u)}return a(n)}e.dimension=function(t){for(var e=0,n=Math.max,i=0,r=t.length;i<r;++i)e=n(e,t[i].length);return e-1},e.countVertices=function(t){for(var e=-1,n=Math.max,i=0,r=t.length;i<r;++i)for(var o=t[i],s=0,a=o.length;s<a;++s)e=n(e,o[s]);return e+1},e.cloneCells=function(t){for(var e=new Array(t.length),n=0,i=t.length;n<i;++n)e[n]=t[n].slice(0);return e},e.compareCells=o,e.normalize=a,e.unique=h,e.findCell=u,e.incidence=l,e.dual=function(t,e){if(!e)return l(h(c(t,0)),t);for(var n=new Array(e),i=0;i<e;++i)n[i]=[];i=0;for(var r=t.length;i<r;++i)for(var o=t[i],s=0,a=o.length;s<a;++s)n[o[s]].push(i);return n},e.explode=function(t){for(var e=[],n=0,i=t.length;n<i;++n)for(var r=t[n],o=0|r.length,s=1,h=1<<o;s<h;++s){for(var u=[],l=0;l<o;++l)s>>>l&1&&u.push(r[l]);e.push(u)}return a(e)},e.skeleton=c,e.boundary=function(t){for(var e=[],n=0,i=t.length;n<i;++n)for(var r=t[n],o=0,s=r.length;o<s;++o){for(var h=new Array(r.length-1),u=0,l=0;u<s;++u)u!==o&&(h[l++]=r[u]);e.push(h)}return a(e)},e.connectedComponents=function(t,e){return e?function(t,e){for(var n=new r(e),i=0;i<t.length;++i)for(var o=t[i],s=0;s<o.length;++s)for(var a=s+1;a<o.length;++a)n.link(o[s],o[a]);var h=[],u=n.ranks;for(i=0;i<u.length;++i)u[i]=-1;for(i=0;i<t.length;++i){var l=n.find(t[i][0]);u[l]<0?(u[l]=h.length,h.push([t[i].slice(0)])):h[u[l]].push(t[i].slice(0))}return h}(t,e):function(t){for(var e=h(a(c(t,0))),n=new r(e.length),i=0;i<t.length;++i)for(var o=t[i],s=0;s<o.length;++s)for(var l=u(e,[o[s]]),f=s+1;f<o.length;++f)n.link(l,u(e,[o[f]]));var p=[],d=n.ranks;for(i=0;i<d.length;++i)d[i]=-1;for(i=0;i<t.length;++i){var g=n.find(u(e,[t[i][0]]));d[g]<0?(d[g]=p.length,p.push([t[i].slice(0)])):p[d[g]].push(t[i].slice(0))}return p}(t)}},D84y:function(t,e,n){var i=n("WSCq").lineString,r=n("HlEs");t.exports=function(t,e,n){var o=i([]);o.properties=t.properties;for(var s=new r({points:t.geometry.coordinates.map(function(t){return{x:t[0],y:t[1]}}),duration:e,sharpness:n}),a=0;a<s.duration;a+=10){var h=s.pos(a);Math.floor(a/100)%2==0&&o.geometry.coordinates.push([h.x,h.y])}return o}},EP79:function(t,e,n){var i=n("QVS1");t.exports=function(t,e,n){switch(n=n||{},e=e||1,t){case"point":case"points":case void 0:return i.point(e,n.bbox);case"polygon":case"polygons":return i.polygon(e,n.num_vertices,n.max_radial_length,n.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}}},FA6F:function(t,e){t.exports=s;var n=1e-10;function i(t,e){var i=t.x-e.x,r=t.y-e.y;return i*i+r*r<n}function r(t){for(var e=t.head;e;){var n=e.next;e.next=e.prev,e.prev=n,e=n}n=t.head;t.head=t.tail,t.tail=n}function o(t){this.level=t,this.s=null,this.count=0}function s(t){if(t)this.drawContour=t;else{var e=this;e.contours={},this.drawContour=function(t,n,i,r,s,a){var h=e.contours[a];h||(h=e.contours[a]=new o(s)),h.addSegment({x:t,y:n},{x:i,y:r})},this.contourList=function(){var t=[],n=e.contours;for(var i in n)for(var r=n[i].s,o=n[i].level;r;){var s=r.head,a=[];for(a.level=o,a.k=i;s&&s.p;)a.push(s.p),s=s.next;t.push(a),r=r.next}return t.sort(function(t,e){return t.k-e.k}),t}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)}o.prototype.remove_seq=function(t){t.prev?t.prev.next=t.next:this.s=t.next,t.next&&(t.next.prev=t.prev),--this.count},o.prototype.addSegment=function(t,e){for(var n=this.s,o=null,s=null,a=!1,h=!1;n&&(null==o&&(i(t,n.head.p)?(o=n,a=!0):i(t,n.tail.p)&&(o=n)),null==s&&(i(e,n.head.p)?(s=n,h=!0):i(e,n.tail.p)&&(s=n)),null==s||null==o);)n=n.next;switch((null!=o?1:0)|(null!=s?2:0)){case 0:var u={p:t,prev:null},l={p:e,next:null};u.next=l,l.prev=u,o={head:u,tail:l,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=o),this.s=o,++this.count;break;case 1:var c={p:e};a?(c.next=o.head,c.prev=null,o.head.prev=c,o.head=c):(c.next=null,c.prev=o.tail,o.tail.next=c,o.tail=c);break;case 2:c={p:t};h?(c.next=s.head,c.prev=null,s.head.prev=c,s.head=c):(c.next=null,c.prev=s.tail,s.tail.next=c,s.tail=c);break;case 3:if(o===s){c={p:o.tail.p,next:o.head,prev:null};o.head.prev=c,o.head=c,o.closed=!0;break}switch((a?1:0)|(h?2:0)){case 0:r(o);case 1:s.tail.next=o.head,o.head.prev=s.tail,s.tail=o.tail,this.remove_seq(o);break;case 3:r(o);case 2:o.tail.next=s.head,s.head.prev=o.tail,o.tail=s.tail,this.remove_seq(s)}}},s.prototype.contour=function(t,e,i,r,o,s,a,h,u){var l=this.h,c=this.sh,f=this.xh,p=this.yh,d=this.drawContour;this.contours={};for(var g,y,m,v,_,x,w=function(t,e){return(l[e]*f[t]-l[t]*f[e])/(l[e]-l[t])},C=function(t,e){return(l[e]*p[t]-l[t]*p[e])/(l[e]-l[t])},E=0,S=0,I=0,b=0,P=[0,1,1,0],M=[0,0,1,1],T=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],L=o-1;L>=r;L--)for(var N=e;N<=i-1;N++){var R,O;if(R=Math.min(t[N][L],t[N][L+1]),O=Math.min(t[N+1][L],t[N+1][L+1]),_=Math.min(R,O),R=Math.max(t[N][L],t[N][L+1]),O=Math.max(t[N+1][L],t[N+1][L+1]),(x=Math.max(R,O))>=u[0]&&_<=u[h-1])for(var A=0;A<h;A++)if(u[A]>=_&&u[A]<=x){for(var D=4;D>=0;D--)D>0?(l[D]=t[N+P[D-1]][L+M[D-1]]-u[A],f[D]=s[N+P[D-1]],p[D]=a[L+M[D-1]]):(l[0]=.25*(l[1]+l[2]+l[3]+l[4]),f[0]=.5*(s[N]+s[N+1]),p[0]=.5*(a[L]+a[L+1])),l[D]>n?c[D]=1:l[D]<-n?c[D]=-1:c[D]=0;for(D=1;D<=4;D++)if(g=D,y=0,m=4!=D?D+1:1,0!=(v=T[c[g]+1][c[y]+1][c[m]+1])){switch(v){case 1:E=f[g],I=p[g],S=f[y],b=p[y];break;case 2:E=f[y],I=p[y],S=f[m],b=p[m];break;case 3:E=f[m],I=p[m],S=f[g],b=p[g];break;case 4:E=f[g],I=p[g],S=w(y,m),b=C(y,m);break;case 5:E=f[y],I=p[y],S=w(m,g),b=C(m,g);break;case 6:E=f[m],I=p[m],S=w(g,y),b=C(g,y);break;case 7:E=w(g,y),I=C(g,y),S=w(y,m),b=C(y,m);break;case 8:E=w(y,m),I=C(y,m),S=w(m,g),b=C(m,g);break;case 9:E=w(m,g),I=C(m,g),S=w(g,y),b=C(g,y)}d(E,I,S,b,u[A],A)}}}}},FAD7:function(t,e,n){var i=n("Ckg5").getCoord;t.exports=function(t,e){var n=Math.PI/180,r=180/Math.PI,o=i(t),s=i(e),a=n*o[0],h=n*s[0],u=n*o[1],l=n*s[1],c=Math.sin(h-a)*Math.cos(l),f=Math.cos(u)*Math.sin(l)-Math.sin(u)*Math.cos(l)*Math.cos(h-a);return r*Math.atan2(c,f)}},FG9u:function(t,e,n){"use strict";t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var n=t[0].length,i=[t[0]],o=[0],s=1;s<e;++s)if(i.push(t[s]),r(i,n)){if(o.push(s),o.length===n+1)return o}else i.pop();return o};var i=n("OXcx");function r(t,e){for(var n=new Array(e+1),r=0;r<t.length;++r)n[r]=t[r];for(r=0;r<=t.length;++r){for(var o=t.length;o<=e;++o){for(var s=new Array(e),a=0;a<e;++a)s[a]=Math.pow(o+1-r,a);n[o]=s}if(i.apply(void 0,n))return!0}return!1}},HedJ:function(t,e,n){var i=n("TbfW"),r=n("WSCq").point;t.exports=function(t){var e=i(t),n=(e[0]+e[2])/2,o=(e[1]+e[3])/2;return r([n,o])}},HlEs:function(t,e){var n=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};n.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},n.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},n.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n);return function(t,e,n,i,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+i.x*o[1]+n.x*o[2]+e.x*o[3],y:r.y*o[0]+i.y*o[1]+n.y*o[2]+e.y*o[3],z:r.z*o[0]+i.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])},t.exports=n},It3W:function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,a,h,u,l,p,g,y=e&&e.length,m=y?e[0]*n:t.length,v=r(t,0,m,n,!0),_=[];if(!v)return _;if(y&&(v=function(t,e,n,i){var s,a,h,u,l,p=[];for(s=0,a=e.length;s<a;s++)h=e[s]*i,u=s<a-1?e[s+1]*i:t.length,(l=r(t,h,u,i,!1))===l.next&&(l.steiner=!0),p.push(d(l));for(p.sort(c),s=0;s<p.length;s++)f(p[s],n),n=o(n,n.next);return n}(t,e,v,n)),t.length>80*n){i=h=t[0],a=u=t[1];for(var x=n;x<m;x+=n)l=t[x],p=t[x+1],l<i&&(i=l),p<a&&(a=p),l>h&&(h=l),p>u&&(u=p);g=0!==(g=Math.max(h-i,u-a))?1/g:0}return s(v,_,n,i,a,g),_}function r(t,e,n,i,r){var o,s;if(r===I(t,e,n,i)>0)for(o=e;o<n;o+=i)s=C(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=C(o,t[o],t[o+1],s);return s&&v(s,s.next)&&(E(s),s=s.next),s}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(E(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function s(t,e,n,i,r,c,f){if(t){!f&&c&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=p(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,h,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,i,r,c);for(var d,g,y=t;t.prev!==t.next;)if(d=t.prev,g=t.next,c?h(t,i,r,c):a(t))e.push(d.i/n),e.push(t.i/n),e.push(g.i/n),E(t),t=g.next,y=g.next;else if((t=g)===y){f?1===f?s(t=u(t,e,n),e,n,i,r,c,2):2===f&&l(t,e,n,i,r,c):s(o(t),e,n,i,r,c,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&m(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function h(t,e,n,i){var r=t.prev,o=t,s=t.next;if(m(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,h=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,l=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=p(a,h,e,n,i),f=p(u,l,e,n,i),d=t.prevZ,y=t.nextZ;d&&d.z>=c&&y&&y.z<=f;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,y!==t.prev&&y!==t.next&&g(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,o.x,o.y,s.x,s.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;y&&y.z<=f;){if(y!==t.prev&&y!==t.next&&g(r.x,r.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function u(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!v(r,o)&&_(r,i,i.next,o)&&x(r,o)&&x(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),E(i),E(i.next),i=t=o),i=i.next}while(i!==t);return i}function l(t,e,n,i,r,a){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&y(h,u)){var l=w(h,u);return h=o(h,h.next),l=o(l,l.next),s(h,e,n,i,r,a),void s(l,e,n,i,r,a)}u=u.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var h,u=n,l=n.x,c=n.y,f=1/0;i=n.next;for(;i!==u;)r>=i.x&&i.x>=l&&r!==i.x&&g(o<c?r:s,o,l,c,o<c?s:r,o,i.x,i.y)&&((h=Math.abs(o-i.y)/(r-i.x))<f||h===f&&i.x>n.x)&&x(i,t)&&(n=i,f=h),i=i.next;return n}(t,e)){var n=w(e,t);o(n,n.next)}}function p(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,r,o,s,a){return(r-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,i){return!!(v(t,e)&&v(n,i)||v(t,i)&&v(n,e))||m(t,e,n)>0!=m(t,e,i)>0&&m(n,i,t)>0!=m(n,i,e)>0}function x(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function w(t,e){var n=new S(t.i,t.x,t.y),i=new S(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function C(t,e,n,i){var r=new S(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function E(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(I(t,0,o,n));if(r)for(var a=0,h=e.length;a<h;a++){var u=e[a]*n,l=a<h-1?e[a+1]*n:t.length;s-=Math.abs(I(t,u,l,n))}var c=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,p=i[a+1]*n,d=i[a+2]*n;c+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},"J+uX":function(t,e,n){var i=n("sijn");t.exports=function(t,e){var n=new i.io.GeoJSONReader,r=n.read(JSON.stringify(t.geometry)),o=n.read(JSON.stringify(e.geometry)),s=r.union(o);return{type:"Feature",geometry:s=(new i.io.GeoJSONWriter).write(s),properties:t.properties}}},JfdC:function(t,e,n){var i=n("fJ48"),r=n("WSCq").point,o=n("FAD7"),s=n("nun3");t.exports=function(t,e,n){var a;if("Feature"===t.type)a=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");a=t.coordinates}for(var h=0,u=0;u<a.length&&!(e>=h&&u===a.length-1);u++){if(h>=e){var l=e-h;if(l){var c=o(a[u],a[u-1])-180;return s(a[u],l,c,n)}return r(a[u])}h+=i(a[u],a[u+1],n)}return r(a[a.length-1])}},MAmB:function(t,e,n){"use strict";t.exports=function(t,e){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var r=t[0].length;if(n<=r)throw new Error("Must input at least d+1 points");var s=t.slice(0,r+1),a=i.apply(void 0,s);if(0===a)throw new Error("Input not in general position");for(var h=new Array(r+1),l=0;l<=r;++l)h[l]=l;a<0&&(h[0]=1,h[1]=0);for(var c=new o(h,new Array(r+1),!1),f=c.adjacent,p=new Array(r+2),l=0;l<=r;++l){for(var d=h.slice(),g=0;g<=r;++g)g===l&&(d[g]=-1);var y=d[0];d[0]=d[1],d[1]=y;var m=new o(d,new Array(r+1),!0);f[l]=m,p[l]=m}p[r+1]=c;for(var l=0;l<=r;++l)for(var d=f[l].vertices,v=f[l].adjacent,g=0;g<=r;++g){var _=d[g];if(_<0)v[g]=c;else for(var x=0;x<=r;++x)f[x].vertices.indexOf(_)<0&&(v[g]=f[x])}for(var w=new u(r,s,p),C=!!e,l=r+1;l<n;++l)w.insert(t[l],C);return w.boundary()};var i=n("OXcx"),r=n("Cxdp").compareCells;function o(t,e,n){this.vertices=t,this.adjacent=e,this.boundary=n,this.lastVisited=-1}function s(t,e,n){this.vertices=t,this.cell=e,this.index=n}function a(t,e){return r(t.vertices,e.vertices)}o.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var h=[];function u(t,e,n){this.dimension=t,this.vertices=e,this.simplices=n,this.interior=n.filter(function(t){return!t.boundary}),this.tuple=new Array(t+1);for(var r=0;r<=t;++r)this.tuple[r]=this.vertices[r];var o=h[t];o||(o=h[t]=function(t){for(var e=["function orient(){var tuple=this.tuple;return test("],n=0;n<=t;++n)n>0&&e.push(","),e.push("tuple[",n,"]");e.push(")}return orient");var r=new Function("test",e.join("")),o=i[t+1];return o||(o=i),r(o)}(t)),this.orient=o}var l=u.prototype;l.handleBoundaryDegeneracy=function(t,e){var n=this.dimension,i=this.vertices.length-1,r=this.tuple,o=this.vertices,s=[t];for(t.lastVisited=-i;s.length>0;){(t=s.pop()).vertices;for(var a=t.adjacent,h=0;h<=n;++h){var u=a[h];if(u.boundary&&!(u.lastVisited<=-i)){for(var l=u.vertices,c=0;c<=n;++c){var f=l[c];r[c]=f<0?e:o[f]}var p=this.orient();if(p>0)return u;u.lastVisited=-i,0===p&&s.push(u)}}}return null},l.walk=function(t,e){var n=this.vertices.length-1,i=this.dimension,r=this.vertices,o=this.tuple,s=e?this.interior.length*Math.random()|0:this.interior.length-1,a=this.interior[s];t:for(;!a.boundary;){for(var h=a.vertices,u=a.adjacent,l=0;l<=i;++l)o[l]=r[h[l]];a.lastVisited=n;for(l=0;l<=i;++l){var c=u[l];if(!(c.lastVisited>=n)){var f=o[l];o[l]=t;var p=this.orient();if(o[l]=f,p<0){a=c;continue t}c.boundary?c.lastVisited=-n:c.lastVisited=n}}return}return a},l.addPeaks=function(t,e){var n=this.vertices.length-1,i=this.dimension,r=this.vertices,h=this.tuple,u=this.interior,l=this.simplices,c=[e];e.lastVisited=n,e.vertices[e.vertices.indexOf(-1)]=n,e.boundary=!1,u.push(e);for(var f=[];c.length>0;){var p=(e=c.pop()).vertices,d=e.adjacent,g=p.indexOf(n);if(!(g<0))for(var y=0;y<=i;++y)if(y!==g){var m=d[y];if(m.boundary&&!(m.lastVisited>=n)){var v=m.vertices;if(m.lastVisited!==-n){for(var _=0,x=0;x<=i;++x)v[x]<0?(_=x,h[x]=t):h[x]=r[v[x]];if(this.orient()>0){v[_]=n,m.boundary=!1,u.push(m),c.push(m),m.lastVisited=n;continue}m.lastVisited=-n}var w=m.adjacent,C=p.slice(),E=d.slice(),S=new o(C,E,!0);l.push(S);var I=w.indexOf(e);if(!(I<0)){w[I]=S,E[g]=m,C[y]=-1,E[y]=e,d[y]=S,S.flip();for(x=0;x<=i;++x){var b=C[x];if(!(b<0||b===n)){for(var P=new Array(i-1),M=0,T=0;T<=i;++T){var L=C[T];L<0||T===x||(P[M++]=L)}f.push(new s(P,S,x))}}}}}}f.sort(a);for(y=0;y+1<f.length;y+=2){var N=f[y],R=f[y+1],O=N.index,A=R.index;O<0||A<0||(N.cell.adjacent[N.index]=R.cell,R.cell.adjacent[R.index]=N.cell)}},l.insert=function(t,e){var n=this.vertices;n.push(t);var i=this.walk(t,e);if(i){for(var r=this.dimension,o=this.tuple,s=0;s<=r;++s){var a=i.vertices[s];o[s]=a<0?t:n[a]}var h=this.orient(o);h<0||(0!==h||(i=this.handleBoundaryDegeneracy(i,t)))&&this.addPeaks(t,i)}},l.boundary=function(){for(var t=this.dimension,e=[],n=this.simplices,i=n.length,r=0;r<i;++r){var o=n[r];if(o.boundary){for(var s=new Array(t),a=o.vertices,h=0,u=0,l=0;l<=t;++l)a[l]>=0?s[h++]=a[l]:u=1&l;if(u===(1&t)){var c=s[0];s[0]=s[1],s[1]=c}e.push(s)}}return e}},MMEr:function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],e[0]);var r,o,s=new Array(n+i),a=0,h=0,u=0,l=Math.abs,c=t[h],f=l(c),p=e[u],d=l(p);f<d?(o=c,(h+=1)<n&&(c=t[h],f=l(c))):(o=p,(u+=1)<i&&(p=e[u],d=l(p)));h<n&&f<d||u>=i?(r=c,(h+=1)<n&&(c=t[h],f=l(c))):(r=p,(u+=1)<i&&(p=e[u],d=l(p)));var g,y,m=r+o,v=m-r,_=o-v,x=_,w=m;for(;h<n&&u<i;)f<d?(r=c,(h+=1)<n&&(c=t[h],f=l(c))):(r=p,(u+=1)<i&&(p=e[u],d=l(p))),(_=(o=x)-(v=(m=r+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g;for(;h<n;)(_=(o=x)-(v=(m=(r=c)+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g,(h+=1)<n&&(c=t[h]);for(;u<i;)(_=(o=x)-(v=(m=(r=p)+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g,(u+=1)<i&&(p=e[u]);x&&(s[a++]=x);w&&(s[a++]=w);a||(s[a++]=0);return s.length=a,s}},OChC:function(t,e,n){var i=n("WSCq").featureCollection,r=n("WSCq").polygon,o=n("fJ48");t.exports=function(t,e,n){for(var s=i([]),a=e/o([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),h=e/o([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),u=0,l=t[0];l<=t[2];){for(var c=0,f=t[1];f<=t[3];)u%2==0&&c%2==0?s.features.push(r([[[l,f],[l,f+h],[l+a,f],[l,f]]]),r([[[l,f+h],[l+a,f+h],[l+a,f],[l,f+h]]])):u%2==0&&c%2==1?s.features.push(r([[[l,f],[l+a,f+h],[l+a,f],[l,f]]]),r([[[l,f],[l,f+h],[l+a,f+h],[l,f]]])):c%2==0&&u%2==1?s.features.push(r([[[l,f],[l,f+h],[l+a,f+h],[l,f]]]),r([[[l,f],[l+a,f+h],[l+a,f],[l,f]]])):c%2==1&&u%2==1&&s.features.push(r([[[l,f],[l,f+h],[l+a,f],[l,f]]]),r([[[l,f+h],[l+a,f+h],[l+a,f],[l,f+h]]])),f+=h,c++;u++,l+=a}return s}},OXcx:function(t,e,n){"use strict";var i=n("v+Tb"),r=n("MMEr"),o=n("5gC3"),s=n("iZiq"),a=5;function h(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[i][o]);return n}function u(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",u(t.slice(0,e)),",",u(t.slice(e)),")"].join("")}function l(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",u(l(h(t,n))),",",(i=n,1&i?"-":""),t[0][n],")"].join(""));return e;var i}function c(t){for(var e=[],n=[],a=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}(t),c=[],f=0;f<t;++f)0==(1&f)?e.push.apply(e,l(h(a,f))):n.push.apply(n,l(h(a,f))),c.push("m"+f);var p=u(e),d=u(n),g="orientation"+t+"Exact",y=["function ",g,"(",c.join(),"){var p=",p,",n=",d,",d=sub(p,n);return d[d.length-1];};return ",g].join("");return new Function("sum","prod","scale","sub",y)(r,i,o,s)}var f=c(3),p=c(4),d=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),s=r-o;if(r>0){if(o<=0)return s;i=r+o}else{if(!(r<0))return s;if(o>=0)return s;i=-(r+o)}var a=3.3306690738754716e-16*i;return s>=a||s<=-a?s:f(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],s=n[0]-i[0],a=t[1]-i[1],h=e[1]-i[1],u=n[1]-i[1],l=t[2]-i[2],c=e[2]-i[2],f=n[2]-i[2],d=o*u,g=s*h,y=s*a,m=r*u,v=r*h,_=o*a,x=l*(d-g)+c*(y-m)+f*(v-_),w=7.771561172376103e-16*((Math.abs(d)+Math.abs(g))*Math.abs(l)+(Math.abs(y)+Math.abs(m))*Math.abs(c)+(Math.abs(v)+Math.abs(_))*Math.abs(f));return x>w||-x>w?x:p(t,e,n,i)}];!function(){for(;d.length<=a;)d.push(c(d.length));for(var e=[],n=["slow"],i=0;i<=a;++i)e.push("a"+i),n.push("o"+i);var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(i=2;i<=a;++i)r.push("case ",i,":return o",i,"(",e.slice(0,i).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(r.join(""));var o=Function.apply(void 0,n);for(t.exports=o.apply(void 0,[function(t){var e=d[t.length];return e||(e=d[t.length]=c(t.length)),e.apply(void 0,t)}].concat(d)),i=0;i<=a;++i)t.exports[i]=d[i]}()},OiNl:function(t,e,n){var i=n("Ckg5");function r(t,e){for(var n=!1,i=0,r=e.length-1;i<e.length;r=i++){var o=e[i][0],s=e[i][1],a=e[r][0],h=e[r][1];s>t[1]!=h>t[1]&&t[0]<(a-o)*(t[1]-s)/(h-s)+o&&(n=!n)}return n}t.exports=function(t,e){var n=i.getCoord(t),o=e.geometry.coordinates;"Polygon"===e.geometry.type&&(o=[o]);for(var s=0,a=!1;s<o.length&&!a;s++)if(r(n,o[s][0])){for(var h=!1,u=1;u<o[s].length&&!h;)r(n,o[s][u])&&(h=!0),u++;h||(a=!0)}return a}},Otc2:function(t,e,n){var i=n("1Ldu").coordEach,r=n("tYv0"),o=n("WSCq").polygon;t.exports=function(t){var e=[];i(t,function(t){e.push(t)});var n=r(e);if(n.length>0){for(var s=[],a=0;a<n.length;a++)s.push(e[n[a][0]]);return s.push(e[n[n.length-1][1]]),o([s])}}},QLfZ:function(t,e,n){var i;!function(){"use strict";function r(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);a>1?(i=n.x,r=n.y):a>0&&(i+=o*a,r+=s*a)}return(o=t.x-i)*o+(s=t.y-r)*s}function o(t,e){var n=t.length-1,i=[t[0]];return function t(e,n,i,o,s){for(var a,h=o,u=n+1;u<i;u++){var l=r(e[u],e[n],e[i]);l>h&&(a=u,h=l)}h>o&&(a-n>1&&t(e,n,a,o,s),s.push(e[a]),i-a>1&&t(e,a,i,o,s))}(t,0,n,e,i),i.push(t[n]),i}function s(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=o(t=n?t:function(t,e){for(var n,i,r,o,s,a=t[0],h=[a],u=1,l=t.length;u<l;u++)n=t[u],r=a,o=(i=n).x-r.x,s=i.y-r.y,o*o+s*s>e&&(h.push(n),a=n);return a!==n&&h.push(n),h}(t,i),i)}void 0===(i=function(){return s}.call(e,n,e,t))||(t.exports=i)}()},QVS1:function(t,e){function n(t){return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[s(),a()]}function r(t){return function(e,n){return[e[0]+t[0],e[1]+t[1]]}}function o(){return Math.random()-.5}function s(){return 360*o()}function a(){return 180*o()}function h(t){return{type:"Point",coordinates:t||[s(),a()]}}function u(t){return{type:"Feature",geometry:t,properties:{}}}function l(t){return{type:"FeatureCollection",features:t}}t.exports=function(){throw new Error("call .point() or .polygon() instead")},t.exports.position=n,t.exports.point=function(t,e){var r=[];for(i=0;i<t;i++)r.push(u(e?h(n(e)):h()));return l(r)},t.exports.polygon=function(t,e,o,s){"number"!=typeof e&&(e=10),"number"!=typeof o&&(o=10);var a=[];for(i=0;i<t;i++){var h=[],c=Array.apply(null,new Array(e+1)).map(Math.random);c.forEach(f),c.forEach(p),h[h.length-1]=h[0],h=h.map(r(n(s))),a.push(u({type:"Polygon",coordinates:[h]}))}function f(t,e,n){n[e]=e>0?t+n[e-1]:t}function p(t,e){t=2*t*Math.PI/c[c.length-1];var n=Math.random();h.push([n*o*Math.sin(t),n*o*Math.cos(t)])}return l(a)}},RmXG:function(t,e,n){var i=n("fJ48"),r=n("WSCq").point;function o(t,e){for(var n,o=0,s=r(t[0]),a=r(t[0]),h=1;h<t.length;h++)a.geometry.coordinates=t[h],o+=i(s,a,e),n=s,s=a,a=n;return o}t.exports=function t(e,n){if("FeatureCollection"===e.type)return e.features.reduce(function(e,i){return e+t(i,n)},0);var i,r,s="Feature"===e.type?e.geometry:e;if("LineString"===s.type)return o(s.coordinates,n);if("Polygon"===s.type||"MultiLineString"===s.type){for(i=0,r=0;r<s.coordinates.length;r++)i+=o(s.coordinates[r],n);return i}if("MultiPolygon"===e.type){for(i=0,r=0;r<s.coordinates.length;r++)for(var a=0;a<s.coordinates[r].length;a++)i+=o(s.coordinates[r][a],n);return i}throw new Error("input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry (or a FeatureCollection containing only those types)")}},Rsiq:function(t,e,n){var i=n("WSCq").featureCollection,r=n("1Ldu").coordEach,o=n("WSCq").point;t.exports=function(t){var e=[];return r(t,function(t){e.push(o(t))}),i(e)}},SRqW:function(t,e,n){var i=n("fJ48"),r=n("WSCq").point,o=n("FAD7"),s=n("nun3");function a(t,e,n,i,r,o,s,a){var h,u,l,c,f={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(h=(a-o)*(n-t)-(s-r)*(i-e))?null!==f.x&&null!==f.y&&f:(c=(n-t)*(u=e-o)-(i-e)*(l=t-r),u=((s-r)*u-(a-o)*l)/h,l=c/h,f.x=t+u*(n-t),f.y=e+u*(i-e),u>0&&u<1&&(f.onLine1=!0),l>0&&l<1&&(f.onLine2=!0),!(!f.onLine1||!f.onLine2)&&[f.x,f.y])}t.exports=function(t,e){var n;if("Feature"===t.type)n=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");n=t.coordinates}return function(t,e){for(var n=r([1/0,1/0],{dist:1/0}),h=0;h<e.length-1;h++){var u=r(e[h]),l=r(e[h+1]);u.properties.dist=i(t,u,"miles"),l.properties.dist=i(t,l,"miles");var c,f=Math.max(u.properties.dist,l.properties.dist),p=o(u,l),d=s(t,f,p+90,"miles"),g=s(t,f,p-90,"miles"),y=a(d.geometry.coordinates[0],d.geometry.coordinates[1],g.geometry.coordinates[0],g.geometry.coordinates[1],u.geometry.coordinates[0],u.geometry.coordinates[1],l.geometry.coordinates[0],l.geometry.coordinates[1]);y&&((c=r(y)).properties.dist=i(t,c,"miles")),u.properties.dist<n.properties.dist&&((n=u).properties.index=h),l.properties.dist<n.properties.dist&&((n=l).properties.index=h),c&&c.properties.dist<n.properties.dist&&((n=c).properties.index=h)}return n}(e,n)}},SaEv:function(t,e,n){var i=n("WSCq").polygon,r=n("WSCq").featureCollection;function o(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o,s,a=e.x-t.x,h=e.y-t.y,u=n.x-t.x,l=n.y-t.y,c=a*(t.x+e.x)+h*(t.y+e.y),f=u*(t.x+n.x)+l*(t.y+n.y),p=2*(a*(n.y-e.y)-h*(n.x-e.x));Math.abs(p)<1e-6?(i=Math.min(t.x,e.x,n.x),r=Math.min(t.y,e.y,n.y),o=.5*(Math.max(t.x,e.x,n.x)-i),s=.5*(Math.max(t.y,e.y,n.y)-r),this.x=i+o,this.y=r+s,this.r=o*o+s*s):(this.x=(l*c-h*f)/p,this.y=(a*f-u*c)/p,o=this.x-t.x,s=this.y-t.y,this.r=o*o+s*s)}function s(t,e){return e.x-t.x}function a(t){var e,n,i,r,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],i=s;i;)if(o=t[--i],e===(r=t[--i])&&n===o||e===o&&n===r){t.splice(s,2),t.splice(i,2),s-=2;continue t}}t.exports=function(t,e){return r(function(t){if(t.length<3)return[];t.sort(s);var e=t.length-1,n=t[e].x,i=t[0].x,r=t[e].y,h=r;for(;e--;)t[e].y<r&&(r=t[e].y),t[e].y>h&&(h=t[e].y);var u,l,c,f=i-n,p=h-r,d=f>p?f:p,g=.5*(i+n),y=.5*(h+r),m=[new o({x:g-20*d,y:y-d,__sentinel:!0},{x:g,y:y+20*d,__sentinel:!0},{x:g+20*d,y:y-d,__sentinel:!0})],v=[],_=[];e=t.length;for(;e--;){for(_.length=0,u=m.length;u--;)(f=t[e].x-m[u].x)>0&&f*f>m[u].r?(v.push(m[u]),m.splice(u,1)):(p=t[e].y-m[u].y,f*f+p*p>m[u].r||(_.push(m[u].a,m[u].b,m[u].b,m[u].c,m[u].c,m[u].a),m.splice(u,1)));for(a(_),u=_.length;u;)c=_[--u],l=_[--u],m.push(new o(l,c,t[e]))}Array.prototype.push.apply(v,m),e=v.length;for(;e--;)(v[e].a.__sentinel||v[e].b.__sentinel||v[e].c.__sentinel)&&v.splice(e,1);return v}(t.features.map(function(t){var n={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e&&(n.z=t.properties[e]),n})).map(function(t){return i([[[t.a.x,t.a.y],[t.b.x,t.b.y],[t.c.x,t.c.y],[t.a.x,t.a.y]]],{a:t.a.z,b:t.b.z,c:t.c.z})}))}},TbfW:function(t,e,n){var i=n("1Ldu").coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return i(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},U4kr:function(t,e,n){"use strict";t.exports=function(t,e,n){var i=t+e,r=i-t,o=e-r,s=t-(i-r);if(n)return n[0]=s+o,n[1]=i,n;return[s+o,i]}},UNfW:function(t,e,n){var i=n("TbfW"),r=n("ln1B");t.exports=function(t){return r(i(t))}},UqTI:function(t,e){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},VCWz:function(t,e,n){var i=n("FAD7"),r=n("nun3"),o=n("fJ48");t.exports=function(t,e){var n=o(t,e,"miles"),s=i(t,e);return r(t,n/2,s,"miles")}},VVWw:function(t,e,n){var i=n("sijn");t.exports=function(t,e){var n=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));"Feature"!==n.type&&(n={type:"Feature",properties:{},geometry:n}),"Feature"!==r.type&&(r={type:"Feature",properties:{},geometry:r});var o=new i.io.GeoJSONReader,s=o.read(JSON.stringify(n.geometry)),a=o.read(JSON.stringify(r.geometry)),h=s.difference(a);if(!h.isEmpty()){var u=(new i.io.GeoJSONWriter).write(h);return n.geometry=h,{type:"Feature",properties:n.properties,geometry:u}}}},WEwc:function(t,e,n){var i=n("SaEv"),r=n("OiNl"),o=n("yQZG"),s=n("TbfW"),a=n("mmLd"),h=n("WSCq").featureCollection,u=n("WSCq").lineString,l=n("q/PK"),c=n("FA6F");t.exports=function(t,e,n,f){for(var p=i(t,e),d=s(t),g=l(d),y=o(g,n),m=[],v=0;v<y.features.length;v++)for(var _=y.features[v],x=0;x<p.features.length;x++){var w=p.features[x];r(_,w)&&(_.properties={},_.properties[e]=a(_,w))}for(var C=Math.sqrt(y.features.length),E=0;E<C;E++){for(var S=y.features.slice(E*C,(E+1)*C),I=[],b=0;b<S.length;b++)S[b].properties?I.push(S[b].properties[e]):I.push(0);m.push(I)}for(var P=(g[2]-g[0])/C,M=[],T=[],L=0;L<C;L++)M.push(L*P+g[0]),T.push(L*P+g[1]);var N=new c;N.contour(m,0,n,0,n,M,T,f.length,f);var R=N.contourList(),O=h([]);return R.forEach(function(t){if(t.length>2){var n=[];t.forEach(function(t){n.push([t.x,t.y])});var i=u(n);i.properties={},i.properties[e]=t.level,O.features.push(i)}}),O}},WSCq:function(t,e){function n(t,e){return{type:"Feature",properties:e||{},geometry:t}}t.exports.feature=n,t.exports.point=function(t,e){if(!Array.isArray(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return n({type:"Point",coordinates:t.slice()},e)},t.exports.polygon=function(t,e){if(!t)throw new Error("No coordinates passed");for(var i=0;i<t.length;i++){var r=t[i];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++)if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e)},t.exports.lineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"LineString",coordinates:t},e)},t.exports.featureCollection=function(t){return{type:"FeatureCollection",features:t}},t.exports.multiLineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e)},t.exports.multiPoint=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e)},t.exports.multiPolygon=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e)},t.exports.geometryCollection=function(t,e){return n({type:"GeometryCollection",geometries:t},e)};var i={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373};t.exports.radiansToDistance=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t*n},t.exports.distanceToRadians=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n},t.exports.distanceToDegrees=function(t,e){var n=i[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n*57.2958}},XBa1:function(t,e,n){var i=n("OiNl");t.exports=function(t,e,n,r){return t.features.forEach(function(t){var o=e.features.filter(function(e){return i(e,t)}).map(function(t){return t.properties[n]});t.properties||(t.properties={}),t.properties[r]=o}),t}},XHIT:function(t,e,n){t.exports={isolines:n("WEwc"),convex:n("Otc2"),within:n("t0xs"),concave:n("g0/l"),difference:n("VVWw"),collect:n("XBa1"),flip:n("/JqY"),simplify:n("71UE"),bezier:n("D84y"),tag:n("1sH3"),sample:n("hPRx"),envelope:n("UNfW"),square:n("q/PK"),midpoint:n("VCWz"),buffer:n("aqwe"),center:n("HedJ"),centroid:n("ZU5/"),combine:n("mnuZ"),distance:n("fJ48"),explode:n("Rsiq"),bbox:n("TbfW"),tesselate:n("uJ4D"),bboxPolygon:n("ln1B"),inside:n("OiNl"),intersect:n("zXiN"),nearest:n("fU9D"),planepoint:n("mmLd"),random:n("EP79"),tin:n("SaEv"),union:n("J+uX"),bearing:n("FAD7"),destination:n("nun3"),kinks:n("ewP/"),pointOnSurface:n("0/Kn"),area:n("c9uS"),along:n("JfdC"),lineDistance:n("RmXG"),lineSlice:n("Y2kK"),pointOnLine:n("SRqW"),pointGrid:n("pRlo"),squareGrid:n("d4gs"),triangleGrid:n("OChC"),hexGrid:n("zjTK")};var i=n("WSCq");t.exports.point=i.point,t.exports.polygon=i.polygon,t.exports.lineString=i.lineString,t.exports.multiPoint=i.multiPoint,t.exports.multiPolygon=i.multiPolygon,t.exports.multiLineString=i.multiLineString,t.exports.feature=i.feature,t.exports.featureCollection=i.featureCollection,t.exports.geometryCollection=i.geometryCollection},Y2kK:function(t,e,n){var i=n("WSCq").lineString,r=n("SRqW");t.exports=function(t,e,n){var o;if("Feature"===n.type)o=n.geometry.coordinates;else{if("LineString"!==n.type)throw new Error("input must be a LineString Feature or Geometry");o=n.coordinates}var s,a=r(n,t),h=r(n,e);s=a.properties.index<=h.properties.index?[a,h]:[h,a];for(var u=i([s[0].geometry.coordinates],{}),l=s[0].properties.index+1;l<s[1].properties.index+1;l++)u.geometry.coordinates.push(o[l]);return u.geometry.coordinates.push(s[1].geometry.coordinates),u}},Y41E:function(t,e,n){"use strict";t.exports=function(t){var e=i(t),n=e.length;if(n<=2)return[];for(var r=new Array(n),o=e[n-1],s=0;s<n;++s){var a=e[s];r[s]=[o,a],o=a}return r};var i=n("a3bA")},"ZU5/":function(t,e,n){var i=n("1Ldu").coordEach,r=n("WSCq").point;t.exports=function(t){var e=0,n=0,o=0;return i(t,function(t){e+=t[0],n+=t[1],o++},!0),r([e/o,n/o])}},a3bA:function(t,e,n){"use strict";t.exports=function(t){var e=t.length;if(e<3){for(var n=new Array(e),r=0;r<e;++r)n[r]=r;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}for(var o=new Array(e),r=0;r<e;++r)o[r]=r;o.sort(function(e,n){var i=t[e][0]-t[n][0];return i||t[e][1]-t[n][1]});for(var s=[o[0],o[1]],a=[o[0],o[1]],r=2;r<e;++r){for(var h=o[r],u=t[h],l=s.length;l>1&&i(t[s[l-2]],t[s[l-1]],u)<=0;)l-=1,s.pop();for(s.push(h),l=a.length;l>1&&i(t[a[l-2]],t[a[l-1]],u)>=0;)l-=1,a.pop();a.push(h)}for(var n=new Array(a.length+s.length-2),c=0,r=0,f=s.length;r<f;++r)n[c++]=s[r];for(var p=a.length-2;p>0;--p)n[c++]=a[p];return n};var i=n("OXcx")[3]},aqwe:function(t,e,n){var i=n("WSCq"),r=i.featureCollection,o=n("sijn"),s=n("hzuH");t.exports=function(t,e,n){var a=i.distanceToDegrees(e,n),h=s(t),u=s(r(h.features.map(function(t){return e=t,n=a,i=(new o.io.GeoJSONReader).read(e.geometry).buffer(n),r=new o.io.GeoJSONWriter,{type:"Feature",geometry:i=r.write(i),properties:{}};var e,n,i,r})));return u.features.length>1?u:1===u.features.length?u.features[0]:void 0}},c9uS:function(t,e,n){var i=n("AgVf").geometry;t.exports=function(t){if("FeatureCollection"===t.type){for(var e=0,n=0;e<t.features.length;e++)t.features[e].geometry&&(n+=i(t.features[e].geometry));return n}return"Feature"===t.type?i(t.geometry):i(t)}},d4gs:function(t,e,n){var i=n("WSCq").featureCollection,r=n("WSCq").point,o=n("WSCq").polygon,s=n("fJ48");t.exports=function(t,e,n){for(var a=i([]),h=e/s(r([t[0],t[1]]),r([t[2],t[1]]),n)*(t[2]-t[0]),u=e/s(r([t[0],t[1]]),r([t[0],t[3]]),n)*(t[3]-t[1]),l=t[0];l<=t[2];){for(var c=t[1];c<=t[3];){var f=o([[[l,c],[l,c+u],[l+h,c+u],[l+h,c],[l,c]]]);a.features.push(f),c+=u}l+=h}return a}},eWjs:function(t,e,n){"use strict";"use restrict";function i(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=i,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var r=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(r),e.reverse=function(t){return r[255&t]<<24|r[t>>>8&255]<<16|r[t>>>16&255]<<8|r[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>i(t)+1}},"ewP/":function(t,e,n){var i=n("WSCq").point;function r(t,e,n,i,r,o,s,a){var h,u,l,c,f={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(h=(a-o)*(n-t)-(s-r)*(i-e))?null!==f.x&&null!==f.y&&f:(c=(n-t)*(u=e-o)-(i-e)*(l=t-r),u=((s-r)*u-(a-o)*l)/h,l=c/h,f.x=t+u*(n-t),f.y=e+u*(i-e),u>=0&&u<=1&&(f.onLine1=!0),l>=0&&l<=1&&(f.onLine2=!0),!(!f.onLine1||!f.onLine2)&&[f.x,f.y])}t.exports=function(t){var e,n={type:"FeatureCollection",features:[]};return(e="Feature"===t.type?t.geometry:t).coordinates.forEach(function(t){e.coordinates.forEach(function(e){for(var o=0;o<t.length-1;o++)for(var s=0;s<e.length-1;s++)if(t!==e||1!==Math.abs(o-s)&&Math.abs(o-s)!==t.length-2){var a=r(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e[s][0],e[s][1],e[s+1][0],e[s+1][1]);a&&n.features.push(i([a[0],a[1]]))}})}),n}},fJ48:function(t,e,n){var i=n("Ckg5").getCoord,r=n("WSCq").radiansToDistance;t.exports=function(t,e,n){var o=Math.PI/180,s=i(t),a=i(e),h=o*(a[1]-s[1]),u=o*(a[0]-s[0]),l=o*s[1],c=o*a[1],f=Math.pow(Math.sin(h/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(l)*Math.cos(c);return r(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),n)}},fU9D:function(t,e,n){var i=n("fJ48");t.exports=function(t,e){for(var n,r=1/0,o=0;o<e.features.length;o++){var s=i(t,e.features[o],"miles");s<r&&(n=e.features[o],r=s)}return n}},"g0/l":function(t,e,n){var i=n("SaEv"),r=n("J+uX"),o=n("fJ48");t.exports=function(t,e,n){if("number"!=typeof e)throw new Error("maxEdge parameter is required");if("string"!=typeof n)throw new Error("units parameter is required");var s=i(t),a=s.features.filter(function(t){var i=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],s=t.geometry.coordinates[0][2],a=o(i,r,n),h=o(r,s,n),u=o(i,s,n);return a<=e&&h<=e&&u<=e});return s.features=a,function(t){for(var e=JSON.parse(JSON.stringify(t.features[0])),n=t.features,i=0,o=n.length;i<o;i++){var s=n[i];s.geometry&&(e=r(e,s))}return e}(s)}},hPRx:function(t,e,n){var i=n("WSCq").featureCollection;t.exports=function(t,e){return i(function(t,e){var n,i,r=t.slice(0),o=t.length,s=o-e;for(;o-- >s;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(s)}(t.features,e))}},hzuH:function(t,e){t.exports=function(t){if(!t||!t.type)return null;var e=n[t.type];if(!e)return null;if("geometry"===e)return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]};if("feature"===e)return{type:"FeatureCollection",features:[t]};if("featurecollection"===e)return t};var n={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},iZiq:function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],-e[0]);var r,o,s=new Array(n+i),a=0,h=0,u=0,l=Math.abs,c=t[h],f=l(c),p=-e[u],d=l(p);f<d?(o=c,(h+=1)<n&&(c=t[h],f=l(c))):(o=p,(u+=1)<i&&(p=-e[u],d=l(p)));h<n&&f<d||u>=i?(r=c,(h+=1)<n&&(c=t[h],f=l(c))):(r=p,(u+=1)<i&&(p=-e[u],d=l(p)));var g,y,m=r+o,v=m-r,_=o-v,x=_,w=m;for(;h<n&&u<i;)f<d?(r=c,(h+=1)<n&&(c=t[h],f=l(c))):(r=p,(u+=1)<i&&(p=-e[u],d=l(p))),(_=(o=x)-(v=(m=r+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g;for(;h<n;)(_=(o=x)-(v=(m=(r=c)+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g,(h+=1)<n&&(c=t[h]);for(;u<i;)(_=(o=x)-(v=(m=(r=p)+o)-r))&&(s[a++]=_),x=w-((g=w+m)-(y=g-w))+(m-y),w=g,(u+=1)<i&&(p=-e[u]);x&&(s[a++]=x);w&&(s[a++]=w);a||(s[a++]=0);return s.length=a,s}},j0UB:function(t,e){var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t,e){if(!n(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:e||{}}}},lQk9:function(t,e,n){"use strict";t.exports=function(t){for(var e=0,n=0,i=1;i<t.length;++i)t[i][0]<t[e][0]&&(e=i),t[i][0]>t[n][0]&&(n=i);return e<n?[[e],[n]]:e>n?[[n],[e]]:[[e]]}},ln1B:function(t,e,n){var i=n("WSCq").polygon;t.exports=function(t){var e=[t[0],t[1]],n=[t[0],t[3]],r=[t[2],t[3]],o=[t[2],t[1]];return i([[e,o,r,n,e]])}},mEuU:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,i){n.d(e,"Util",function(){return zt}),n.d(e,"DomUtil",function(){return nn}),n.d(e,"StringUtil",function(){return Pe}),n.d(e,"MapboxUtil",function(){return Tt}),n.d(e,"ui",function(){return mo}),n.d(e,"control",function(){return Po}),n.d(e,"renderer",function(){return xs}),n.d(e,"symbolizer",function(){return bi}),n.d(e,"animation",function(){return ji}),n.d(e,"Browser",function(){return he}),n.d(e,"Ajax",function(){return rn}),n.d(e,"Canvas",function(){return sn}),n.d(e,"Class",function(){return dn}),n.d(e,"Eventable",function(){return cn}),n.d(e,"JSONAble",function(){return yn}),n.d(e,"Handlerable",function(){return mn}),n.d(e,"Handler",function(){return pn}),n.d(e,"DragHandler",function(){return xn}),n.d(e,"MapTool",function(){return Sr}),n.d(e,"DrawTool",function(){return br}),n.d(e,"AreaTool",function(){return io}),n.d(e,"DistanceTool",function(){return no}),n.d(e,"SpatialReference",function(){return ni}),n.d(e,"INTERNAL_LAYER_PREFIX",function(){return r}),n.d(e,"GEOMETRY_COLLECTION_TYPES",function(){return o}),n.d(e,"GEOJSON_TYPES",function(){return s}),n.d(e,"RESOURCE_PROPERTIES",function(){return a}),n.d(e,"RESOURCE_SIZE_PROPERTIES",function(){return h}),n.d(e,"NUMERICAL_PROPERTIES",function(){return u}),n.d(e,"COLOR_PROPERTIES",function(){return l}),n.d(e,"projection",function(){return Wn}),n.d(e,"measurer",function(){return Gn}),n.d(e,"Coordinate",function(){return wn}),n.d(e,"CRS",function(){return Cn}),n.d(e,"Extent",function(){return Sn}),n.d(e,"Point",function(){return le}),n.d(e,"PointExtent",function(){return In}),n.d(e,"Size",function(){return ce}),n.d(e,"Transformation",function(){return bn}),n.d(e,"Map",function(){return ri}),n.d(e,"Layer",function(){return $n}),n.d(e,"TileLayer",function(){return Oo}),n.d(e,"GroupTileLayer",function(){return Ao}),n.d(e,"WMSTileLayer",function(){return ko}),n.d(e,"CanvasTileLayer",function(){return Fo}),n.d(e,"ImageLayer",function(){return Zo}),n.d(e,"OverlayLayer",function(){return xr}),n.d(e,"VectorLayer",function(){return Cr}),n.d(e,"CanvasLayer",function(){return Qo}),n.d(e,"ParticleLayer",function(){return $o}),n.d(e,"TileSystem",function(){return Mo}),n.d(e,"TileConfig",function(){return Lo}),n.d(e,"ArcCurve",function(){return hr}),n.d(e,"Circle",function(){return ir}),n.d(e,"ConnectorLine",function(){return vr}),n.d(e,"ArcConnectorLine",function(){return _r}),n.d(e,"CubicBezierCurve",function(){return ur}),n.d(e,"Curve",function(){return ar}),n.d(e,"Ellipse",function(){return rr}),n.d(e,"GeoJSON",function(){return nr}),n.d(e,"Geometry",function(){return Ni}),n.d(e,"GeometryCollection",function(){return Yi}),n.d(e,"Label",function(){return gr}),n.d(e,"LineString",function(){return Ui}),n.d(e,"Marker",function(){return Wi}),n.d(e,"MultiLineString",function(){return $i}),n.d(e,"MultiPoint",function(){return Ki}),n.d(e,"MultiPolygon",function(){return tr}),n.d(e,"Polygon",function(){return Vi}),n.d(e,"QuadBezierCurve",function(){return lr}),n.d(e,"Rectangle",function(){return or}),n.d(e,"Sector",function(){return sr}),n.d(e,"TextBox",function(){return dr}),n.d(e,"TextMarker",function(){return pr});
/*!
 * maptalks v0.40.5
 * LICENSE : BSD-3-Clause
 * (c) 2016-2018 maptalks.org
 */
var r="_maptalks__internal_layer_",o=["MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"],s=["FeatureCollection","Feature","Point","LineString","Polygon"].concat(o),a=["markerFile","polygonPatternFile","linePatternFile","markerFillPatternFile","markerLinePatternFile"],h=[["markerWidth","markerHeight"],[],[null,"lineWidth"],[],[null,"markerLineWidth"]],u={lineWidth:1,lineOpacity:1,lineDx:1,lineDy:1,polygonOpacity:1,markerWidth:1,markerHeight:1,markerDx:1,markerDy:1,markerOpacity:1,markerFillOpacity:1,markerLineWidth:1,markerLineOpacity:1,textSize:1,textOpacity:1,textHaloRadius:1,textWrapWidth:1,textLineSpacing:1,textDx:1,textDy:1},l=["lineColor","polygonFill","markerFill","markerLineColor","textFill"];var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},p=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):function(t,e){for(var n=Object.getOwnPropertyNames(e),i=0;i<n.length;i++){var r=n[i],o=Object.getOwnPropertyDescriptor(e,r);o&&o.configurable&&void 0===t[r]&&Object.defineProperty(t,r,o)}}(t,e))},d=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e};function g(){return Date.now()}function y(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}function m(t){return null==t}function v(t){return"number"==typeof t&&!isNaN(t)}function _(t){return(0|t)===t}function x(t){return"object"===(void 0===t?"undefined":c(t))&&!!t}function w(t){return!m(t)&&("string"==typeof t||null!==t.constructor&&t.constructor===String)}function C(t){return!m(t)&&("function"==typeof t||null!==t.constructor&&t.constructor===Function)}var E=Object.prototype.hasOwnProperty;function S(t,e){return E.call(t,e)}var I=Math.PI/180;function b(t){return t*I}function P(t){return t/I}var M="[object process]"===Object.prototype.toString.call(void 0!==t?t:0)&&!t.versions.electron&&!t.versions.nw&&!t.versions["node-webkit"],T=void 0,L=void 0;function N(t){return t.length>4&&".svg"===t.slice(-4)?1:"data:image/svg+xml"===t.slice(0,"data:image/svg+xml".length)?2:0}function R(t,e){M&&R.node?R.node(t,e):t.src=e[0]}!function(){if(M)return T=function(t){return setTimeout(t,16)},void(L=clearTimeout);var t=void 0,e=void 0,n=1e3/30;function i(t){return setTimeout(t,n)}function r(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}"undefined"!=typeof window?(t=window.requestAnimationFrame||r("RequestAnimationFrame")||i,e=window.cancelAnimationFrame||r("CancelAnimationFrame")||r("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)}):(t=i,e=clearTimeout),T=function(e){return t(e)},L=function(t){t&&e(t)}}();var O=0;function A(){return O++}var D=A;function k(t){return t&&w(t)?JSON.parse(t):t}function F(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var i=0,r=n.length;i<r;i++)t.push(n[i])}return t.length}function G(t,e){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function z(t,e,n){if(!Array.isArray(t))return n?e.call(n,t):e(t);for(var i=[],r=void 0,o=void 0,s=0,a=t.length;s<a;s++)m(r=t[s])?i.push(null):Array.isArray(r)?i.push(z(r,e,n)):(o=n?e.call(n,r):e(r),i.push(o));return i}function j(t,e){return void 0===t?e:t}function B(t){return Math.sign?Math.sign(t):0===(t=+t)||isNaN(t)?Number(t):t>0?1:-1}function H(t){if(Math.log2)return Math.log2(t);var e=Math.log(t)*Math.LOG2E,n=Math.round(e);return Math.abs(n-e)<1e-14?n:e}function V(t,e,n){return t*(1-n)+e*n}function q(t,e,n){if(t===n||t===e)return t;var i=n-e;return((t-e)%i+i)%i+e}function W(t,e,n){return Math.min(n,Math.max(e,t))}function Z(t){return Array.isArray(t)&&t.length>0}function U(t){if(!t)return!1;var e=t.slice(0,6);return"http:/"===e||"https:"===e||"file:/"===e}var Y=/^url\((['"])(.+)\1\)$/i,X=/^url\(([^'"].*[^'"])\)$/i;function J(t){if(!w(t))return 0;var e=t.slice(0,6);return"http:/"===e||"https:"===e?3:X.test(t)?1:Y.test(t)?2:0}function K(t){var e=J(t);return 3===e?t:1===e?X.exec(t)[1]:2===e?Y.exec(t)[2]:t}var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $(t){if("undefined"!=typeof window&&window.btoa)return window.btoa(t);for(var e,n,i=String(t),r="",o=0,s=Q;i.charAt(0|o)||(s="=",o%1);r+=s.charAt(63&e>>8-o%1*8)){if((n=i.charCodeAt(o+=.75))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");e=e<<8|n}return r}function tt(t,e){for(var n=atob(t),i=new ArrayBuffer(n.length),r=new Uint8Array(i),o=0;o<n.length;o++)r[o]=255&n.charCodeAt(o);return new Blob([i],{type:e})}function et(t,e,n,i){var r=n-t,o=i-e;return Math.atan2(o,r)}var nt="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function it(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;for(var n in t)if("center"===n){if(!e[n]||!rt(t[n][0],e[n][0])||!rt(t[n][1],e[n][1]))return!1}else if(t[n]!==e[n])return!1;return!0}function rt(t,e,n){return null==n&&(n=1e-6),t>=e-n&&t<=e+n}function ot(t,e,n,i){t||(t=100),e||(e=4);var r=this;return e*=2,this._flashTimeout&&clearTimeout(this._flashTimeout),this._flashTimeout=setTimeout(function o(){if(0===e)return r.show(),void(n&&(i?n.call(i):n()));e%2==0?r.hide():r.show(),e--,r._flashTimeout=setTimeout(o,t)},t),this}var st=["Unknown","Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"];function at(t){return new Function("f","var p = (f && f.properties || {}); return "+ht(t))}function ht(t){if(!t)return"true";var e=t[0];return t.length<=1?"any"===e?"false":"true":"("+("=="===e?lt(t[1],t[2],"===",!1):"!="===e?lt(t[1],t[2],"!==",!1):"<"===e||">"===e||"<="===e||">="===e?lt(t[1],t[2],e,!0):"any"===e?ct(t.slice(1),"||"):"all"===e?ct(t.slice(1),"&&"):"none"===e?dt(ct(t.slice(1),"||")):"in"===e?ft(t[1],t.slice(2)):"!in"===e?dt(ft(t[1],t.slice(2))):"has"===e?pt(t[1]):"!has"===e?dt(pt(t[1])):"true")+")"}function ut(t){return"$"===t[0]?"f."+t.substring(1):"p["+JSON.stringify(t)+"]"}function lt(t,e,n,i){var r=ut(t),o="$type"===t?st.indexOf(e):JSON.stringify(e);return(i?"typeof "+r+"=== typeof "+o+"&&":"")+r+n+o}function ct(t,e){return t.map(ht).join(e)}function ft(t,e){"$type"===t&&(e=e.map(function(t){return st.indexOf(t)}));var n=JSON.stringify(e.sort(gt)),i=ut(t);return e.length<=200?n+".indexOf("+i+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+i+", "+n+",0,"+(e.length-1)+")"}function pt(t){return"$id"===t?'"id" in f':JSON.stringify(t)+" in p"}function dt(t){return"!("+t+")"}function gt(t,e){return t<e?-1:t>e?1:0}function yt(t){var e=t._toJSON(),n=e.feature;return n.type=st.indexOf(n.geometry.type),n.subType=e.subType,n}function mt(t){if(!Array.isArray(t))return mt([t]);for(var e=[],n=0;n<t.length;n++){var i=void 0;i=!0===t[n].filter?function(){return!0}:at(t[n].filter),e.push(y({},t[n],{filter:i}))}return e}function vt(t,e){var n;if(St(t)){var i,r=t.stops&&"object"===c(t.stops[0][0]),o=r||void 0!==t.property,s=r||!o,a=t.type||e||"exponential";if("exponential"===a)i=wt;else if("interval"===a)i=xt;else if("categorical"===a)i=_t;else{if("identity"!==a)throw new Error('Unknown function type "'+a+'"');i=Ct}if(r){for(var h={},u=[],l=0;l<t.stops.length;l++){var f=t.stops[l];void 0===h[f[0].zoom]&&(h[f[0].zoom]={zoom:f[0].zoom,type:t.type,property:t.property,stops:[]}),h[f[0].zoom].stops.push([f[0].value,f[1]])}for(var p in h)u.push([h[p].zoom,vt(h[p])]);(n=function(e,n){return wt({stops:u,base:t.base},e)(e,n)}).isFeatureConstant=!1,n.isZoomConstant=!1}else s?((n=function(e){return i(t,e)}).isFeatureConstant=!0,n.isZoomConstant=!1):((n=function(e,n){return i(t,n[t.property])}).isFeatureConstant=!1,n.isZoomConstant=!0)}else(n=function(){return t}).isFeatureConstant=!0,n.isZoomConstant=!0;return n}function _t(t,e){for(var n=0;n<t.stops.length;n++)if(e===t.stops[n][0])return t.stops[n][1];return t.stops[0][1]}function xt(t,e){for(var n=0;n<t.stops.length&&!(e<t.stops[n][0]);n++);return t.stops[Math.max(n-1,0)][1]}function wt(t,e){for(var n=void 0!==t.base?t.base:1,i=0;!(i>=t.stops.length||e<=t.stops[i][0]);)i++;return 0===i?t.stops[i][1]:i===t.stops.length?t.stops[i-1][1]:function t(e,n,i,r,o,s){return"function"==typeof o?function(){var a=o.apply(void 0,arguments),h=s.apply(void 0,arguments);return t(e,n,i,r,a,h)}:o.length?function(t,e,n,i,r,o){for(var s=[],a=0;a<r.length;a++)s[a]=Et(t,e,n,i,r[a],o[a]);return s}(e,n,i,r,o,s):Et(e,n,i,r,o,s)}(e,n,t.stops[i-1][0],t.stops[i][0],t.stops[i-1][1],t.stops[i][1])}function Ct(t,e){return e}function Et(t,e,n,i,r,o){var s,a=i-n,h=t-n;return r*(1-(s=1===e?h/a:(Math.pow(e,h)-1)/(Math.pow(e,a)-1)))+o*s}function St(t){return t&&"object"===(void 0===t?"undefined":c(t))&&(t.stops||t.property&&"identity"===t.type)}function It(t){for(var e in t)if(St(t[e]))return!0;return!1}function bt(t){return vt(t,"exponential")}function Pt(t,e){if(!t)return null;var n=!1;if(Array.isArray(t)){for(var i,r=[],o=0;o<t.length;o++)(i=Pt(t[o],e))?(r.push(i),n=!0):r.push(t[o]);return n?r:t}var s,a={__fn_types_loaded:!0},h=[];for(s in t)t.hasOwnProperty(s)&&h.push(s);for(var u=0,l=h.length;u<l;u++)St(t[s=h[u]])?(n=!0,a["_"+s]=t[s],function(t){Object.defineProperty(a,t,{get:function(){return this["__fn_"+t]||(this["__fn_"+t]=bt(this["_"+t])),this["__fn_"+t].apply(this,e())},set:function(e){this["_"+t]=e},configurable:!0,enumerable:!0})}(s)):a[s]=t[s];return n?a:t}function Mt(t){if(!t||!t.stops)return[];for(var e=[],n=0,i=t.stops.length;n<i;n++)e.push(t.stops[n][1]);return e}var Tt=Object.freeze({createFilter:at,getFilterFeature:yt,compileStyle:mt,isFunctionDefinition:St,hasFunctionDefinition:It,interpolated:bt,piecewiseConstant:function(t){return vt(t,"interval")},loadFunctionTypes:Pt,getFunctionTypeResources:Mt});function Lt(t){var e={stroke:{stroke:t.markerLineColor,"stroke-width":t.markerLineWidth,"stroke-opacity":t.markerLineOpacity,"stroke-dasharray":null,"stroke-linecap":"butt","stroke-linejoin":"round"},fill:{fill:t.markerFill,"fill-opacity":t.markerFillOpacity}};return"butt"===e.stroke["stroke-linecap"]&&he.vml&&(e.stroke["stroke-linecap"]="flat"),0===e.stroke["stroke-width"]&&(e.stroke["stroke-opacity"]=0),e}function Nt(t,e,n){if(!t.markerPath)return null;var i=1,r=Lt(t);v(t.markerOpacity)&&(i=t.markerOpacity),v(t.opacity)&&(i*=t.opacity);var o={};if(r){for(var s in r.stroke)r.stroke.hasOwnProperty(s)&&(m(r.stroke[s])||(o[s]=r.stroke[s]));for(var a in r.fill)r.fill.hasOwnProperty(a)&&(m(r.fill[a])||(o[a]=r.fill[a]))}for(var h=Array.isArray(t.markerPath)?t.markerPath:[t.markerPath],u=void 0,l=[],c=0;c<h.length;c++)(u=y({},u=w(h[c])?{path:h[c]}:h[c],o)).d=u.path,delete u.path,l.push(u);var f=['<svg version="1.1"','xmlns="http://www.w3.org/2000/svg"'];i<1&&f.push('opacity="'+i+'"'),t.markerPathWidth&&t.markerPathHeight&&f.push('viewBox="0 0 '+t.markerPathWidth+" "+t.markerPathHeight+'"'),f.push('preserveAspectRatio="none"'),e&&f.push('width="'+e+'"'),n&&f.push('height="'+n+'"'),f.push("><defs></defs>");for(var p=0;p<l.length;p++){var d="<path ";for(var g in l[p])l[p].hasOwnProperty(g)&&(d+=" "+g+'="'+l[p][g]+'"');d+="></path>",f.push(d)}return f.push("</svg>"),"data:image/svg+xml;base64,"+$(f.join(" "))}function Rt(t,e){if(!t)return[];var n=t;Array.isArray(t)||(n=[t]);for(var i=[],r=a,o=void 0,s=void 0,u=void 0,l=void 0,c=n.length-1;c>=0;c--)if(t=n[c]){e&&(t=Ot(t));for(var f=0;f<r.length;f++)if(St(o=t[r[f]])&&(o=Mt(o)),o){Array.isArray(o)||(o=[o]);for(var p=0;p<o.length;p++)"url("===o[p].slice(0,4)&&(o[p]=K(o[p])),s=h[f],i.push([o[p],t[s[0]],t[s[1]]])}if("path"===t.markerType&&t.markerPath)if(u=St(t.markerWidth)?200:t.markerWidth,l=St(t.markerHeight)?200:t.markerHeight,St(t.markerPath)){o=Mt(t.markerPath);for(var d=t.markerPath,g=0;g<o.length;g++)t.markerPath=o[g],i.push([Nt(t),u,l]);t.markerPath=d}else i.push([Nt(t),u,l])}return i}function Ot(t){if(!t)return null;var e=t;if(M)return e;for(var n=a,i=void 0,r=0,o=n.length;r<o;r++)(i=e[n[r]])&&(e[n[r]]=At(i));return e}function At(t){if(St(t)){for(var e=t.stops,n=0;n<e.length;n++)e[n][1]=At(e[n][1]);return t}return"url("===t.slice(0,4)&&(t=K(t)),!U(t)&&(t.length<="data:".length||"data:"!==t.substring(0,"data:".length))&&(t=function(t,e){var n=t.split("/"),i=e.split("/");if(0===e.slice(0,1))return n.slice(0,3).join("/")+e;n.pop();for(var r=0;r<i.length;r++)"."!==i[r]&&(".."===i[r]?n.pop():n.push(i[r]));return n.join("/")}(location.href,t)),t}function Dt(t){return t&&t.colorStops}function kt(t){var e=[t.type];if(t.places&&e.push(t.places.join()),t.colorStops){for(var n=[],i=t.colorStops.length-1;i>=0;i--)n.push(t.colorStops[i].join());e.push(n.join(","))}return e.join("_")}function Ft(t,e){function n(t,e){m(t.opacity)?t.opacity=e:t.opacity*=e}var i=void 0;if(Array.isArray(t)){i=[];for(var r=0;r<t.length;r++){var o=y({},t[r]);n(o,e),i.push(o)}}else n(i=y({},t),e);return i}function Gt(t){var e=Array.prototype.slice.call(arguments,1);if(e&&e.length||(e=[{}]),Array.isArray(t)){for(var n=void 0,i=void 0,r=[],o=0,s=t.length;o<s;o++){n=t[o],i={};for(var a=0,h=e.length;a<h;a++)Array.isArray(e[a])?m(e[a][o])?y(i,n||{}):y(i,n,e[a][o]):y(i,n,e[a]?e[a]:{});r.push(i)}return r}var u=[{},t];return u.push.apply(u,e),y.apply(this,u)}var zt=Object.freeze({now:g,extend:y,isNil:m,isNumber:v,isInteger:_,isObject:x,isString:w,isFunction:C,hasOwn:S,join:function(t,e){return t.join?t.join(e||","):Array.prototype.join.call(t,e||",")},toRadian:b,toDegree:P,IS_NODE:M,get requestAnimFrame(){return T},get cancelAnimFrame(){return L},isSVG:N,loadImage:R,UID:A,GUID:D,parseJSON:k,pushIn:F,removeFromArray:G,forEachCoord:z,getValueOrDefault:j,sign:B,log2:H,interpolate:V,wrap:q,clamp:W,isArrayHasData:Z,isURL:U,isCssUrl:J,extractCssUrl:K,btoa:$,b64toBlob:tt,computeDegree:et,emptyImageUrl:nt,equalMapView:it,flash:ot,translateToSVGStyles:Lt,getMarkerPathBase64:Nt,getExternalResources:Rt,convertResourceUrl:Ot,isGradient:Dt,getGradientStamp:kt,getSymbolStamp:function t(e){var n=[];if(Array.isArray(e)){for(var i=0;i<e.length;i++)n.push(t(e[i]));return"[ "+n.join(" , ")+" ]"}for(var r in e)S(e,r)&&(C(e[r])||(Dt(e[r])?n.push(r+"="+kt(e[r])):n.push(r+"="+e[r])));return n.join(";")},lowerSymbolOpacity:Ft,extendSymbol:Gt}),jt={};if(!M){var Bt=navigator.userAgent.toLowerCase(),Ht=document.documentElement,Vt="ActiveXObject"in window,qt=-1!==Bt.indexOf("webkit"),Wt=-1!==Bt.indexOf("phantom"),Zt=-1!==Bt.search("android [23]"),Ut=-1!==Bt.indexOf("chrome"),Yt=-1!==Bt.indexOf("gecko")&&!qt&&!window.opera&&!Vt,Xt="undefined"!=typeof orientation||-1!==Bt.indexOf("mobile"),Jt=!window.PointerEvent&&window.MSPointerEvent,Kt=window.PointerEvent&&navigator.pointerEnabled||Jt,Qt=Vt&&"transition"in Ht.style,$t="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Zt,te="MozPerspective"in Ht.style,ee="OTransition"in Ht.style,ne=(Qt||$t||te)&&!ee&&!Wt,ie=0;Ut&&(ie=Bt.match(/chrome\/([\d.]+)/)[1]);var re=!Wt&&(Kt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),oe=void 0;try{var se=document.createElement("canvas"),ae=se.getContext("webgl")||se.getContext("experimental-webgl");oe=ae&&ae instanceof WebGLRenderingContext}catch(t){oe=!1}jt={ie:Vt,ielt9:Vt&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:qt,gecko:Yt,android:-1!==Bt.indexOf("android"),android23:Zt,chrome:Ut,chromeVersion:ie,safari:!Ut&&-1!==Bt.indexOf("safari"),phantomjs:Wt,ie3d:Qt,webkit3d:$t,gecko3d:te,opera12:ee,any3d:ne,mobile:Xt,mobileWebkit:Xt&&qt,mobileWebkit3d:Xt&&$t,mobileOpera:Xt&&window.opera,mobileGecko:Xt&&Yt,touch:!!re,msPointer:!!Jt,pointer:!!Kt,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:Vt&&9===document.documentMode,ie10:Vt&&10===document.documentMode,webgl:oe}}var he=jt,ue=function(){function t(e,n){if(f(this,t),m(e)||m(n)?m(e.x)||m(e.y)?Array.isArray(e)&&(this.x=+e[0],this.y=+e[1]):(this.x=+e.x,this.y=+e.y):(this.x=+e,this.y=+n),this._isNaN())throw new Error("Position is NaN")}return t.prototype.abs=function(){return new this.constructor(Math.abs(this.x),Math.abs(this.y))},t.prototype._abs=function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},t.prototype._round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.round=function(){return new this.constructor(Math.round(this.x),Math.round(this.y))},t.prototype._ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.prototype.ceil=function(){return new this.constructor(Math.ceil(this.x),Math.ceil(this.y))},t.prototype._floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.prototype.floor=function(){return new this.constructor(Math.floor(this.x),Math.floor(this.y))},t.prototype.copy=function(){return new this.constructor(this.x,this.y)},t.prototype._add=function(t,e){return m(t.x)?m(t[0])?(this.x+=t,this.y+=e):(this.x+=t[0],this.y+=t[1]):(this.x+=t.x,this.y+=t.y),this},t.prototype.add=function(t,e){var n=void 0,i=void 0;return m(t.x)?m(t[0])?(n=this.x+t,i=this.y+e):(n=this.x+t[0],i=this.y+t[1]):(n=this.x+t.x,i=this.y+t.y),new this.constructor(n,i)},t.prototype._sub=function(t,e){return m(t.x)?m(t[0])?(this.x-=t,this.y-=e):(this.x-=t[0],this.y-=t[1]):(this.x-=t.x,this.y-=t.y),this},t.prototype._substract=function(){return this._sub.apply(this,arguments)},t.prototype.sub=function(t,e){var n=void 0,i=void 0;return m(t.x)?m(t[0])?(n=this.x-t,i=this.y-e):(n=this.x-t[0],i=this.y-t[1]):(n=this.x-t.x,i=this.y-t.y),new this.constructor(n,i)},t.prototype.substract=function(){return this.sub.apply(this,arguments)},t.prototype.multi=function(t){return new this.constructor(this.x*t,this.y*t)},t.prototype._multi=function(t){return this.x*=t,this.y*=t,this},t.prototype.div=function(t){return this.multi(1/t)},t.prototype._div=function(t){return this._multi(1/t)},t.prototype.equals=function(t){return t instanceof this.constructor&&(this.x===t.x&&this.y===t.y)},t.prototype._isNaN=function(){return isNaN(this.x)||isNaN(this.y)},t.prototype.isZero=function(){return 0===this.x&&0===this.y},t.prototype.toArray=function(){return[this.x,this.y]},t.prototype.toFixed=function(t){return new this.constructor(this.x.toFixed(t),this.y.toFixed(t))},t.prototype.toJSON=function(){return{x:this.x,y:this.y}},t}(),le=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.closeTo=function(t,e){return e||(e=0),this.x>=t.x-e&&this.x<=t.x+e&&this.y>=t.y-e&&this.y<=t.y+e},e.prototype.distanceTo=function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},e.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.unit=function(){return this.copy()._unit()},e.prototype._unit=function(){return this._div(this.mag()),this},e.prototype.perp=function(){return this.copy()._perp()},e.prototype._perp=function(){var t=this.y;return this.y=this.x,this.x=-t,this},e.prototype.angleWith=function(t){return this.angleWithSep(t.x,t.y)},e.prototype.angleWithSep=function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},e.prototype._rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,r=n*this.x+e*this.y;return this.x=i,this.y=r,this},e.prototype.rotate=function(t){return this.copy()._rotate(t)},e}(ue),ce=function(){function t(e,n){f(this,t),v(e)&&v(n)?(this.width=e,this.height=n):v(e.width)?(this.width=e.width,this.height=e.height):Array.isArray(e)&&(this.width=e[0],this.height=e[1])}return t.prototype.copy=function(){return new t(this.width,this.height)},t.prototype.add=function(e,n){var i=void 0,r=void 0;return e instanceof t?(i=this.width+e.width,r=this.height+e.height):(i=this.width+e,r=this.height+n),new t(i,r)},t.prototype.equals=function(t){return this.width===t.width&&this.height===t.height},t.prototype.multi=function(e){return new t(this.width*e,this.height*e)},t.prototype._multi=function(t){return this.width*=t,this.height*=t,this},t.prototype._round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.prototype.toPoint=function(){return new le(this.width,this.height)},t.prototype.toArray=function(){return[this.width,this.height]},t.prototype.toJSON=function(){return{width:this.width,height:this.height}},t}();function fe(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}var pe=/[\b\t\r\v\f]/gim;function de(t){return w(t)?t.replace(pe,""):t}function ge(t){return fe(t).split(/\s+/)}var ye="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):null;function me(t,e){return me.node?me.node(t,e):(ye.font=e,ye.measureText(t).width)}var ve={};function _e(t,e){if(_e.node)return _e.node(t,e);var n=me(t,e);return e||(e="_default_"),ve[e]||(ve[e]=xe(e)),new ce(n,ve[e])}function xe(t){var e=$e();"_default_"!==t&&(e.style.font=t),e.innerHTML="秦";var n=e.clientHeight;return De(e),n}function we(t,e,n,i){if(!t||0===t.length)return[{text:"",width:0}];var r=m(i)?me(t,e):i,o=r/t.length,s=Math.floor(n/o/2);if(o>=n||s<=0)return[{text:"",width:n}];if(r<=n)return[{text:t,width:r}];for(var a=[],h=t.substring(0,s),u=o*s,l=s,c=t.length;l<c;l++){var f=t[l],p=me(h+f);p>=n?(a.push({text:h,width:u}),h=t.substring(l,s+l),l+=s-1,u=o*s):(h+=f,u=p),l>=c-1&&(u=me(h),a.push({text:h,width:u}))}return a}var Ce=/\{([\w_]+)\}/g;function Ee(t,e){return w(t)?t.replace(Ce,function(t,n){if(!e)return"";var i=e[n];return m(i)?"":Array.isArray(i)?i.join():i}):t}function Se(t,e,n){var i=t.width,r=t.height;return new le("left"===e?-i:"right"===e?0:-i/2,"top"===n?-r:"bottom"===n?0:-r/2)}function Ie(t){return t.textFont?t.textFont:(t.textStyle&&"normal"!==t.textStyle?t.textStyle+" ":"")+(t.textWeight&&"normal"!==t.textWeight?t.textWeight+" ":"")+t.textSize+"px "+('"'===t.textFaceName[0]?t.textFaceName:'"'+t.textFaceName+'"')}function be(t,e){var n=Ie(e),i=e.textLineSpacing||0,r=_e(t,n),o=r.width,s=r.height,a=e.textWrapCharacter,h=[],u=e.textWrapWidth;(!u||u>o)&&(u=o),w(t)||(t+="");var l=0;if(a&&t.indexOf(a)>=0)for(var c=t.split(a),f=0,p=c.length;f<p;f++){var d=c[f],g=me(d,n);if(g>u)for(var y=we(d,n,u,g),m=0,v=y.length;m<v;m++){var _=y[m].width;_>l&&(l=_),h.push({text:y[m].text,size:new ce(_,s)})}else g>l&&(l=g),h.push({text:d,size:new ce(g,s)})}else if(o>u)for(var x=we(t,n,u,o),C=0;C<x.length;C++){var E=x[C].width;E>l&&(l=E),h.push({text:x[C].text,size:new ce(E,s)})}else o>l&&(l=o),h.push({text:t,size:r});var S=h.length;return{total:S,size:new ce(l,s*S+i*(S-1)),rows:h,rawSize:r}}var Pe=Object.freeze({trim:fe,escapeSpecialChars:de,splitWords:ge,stringWidth:me,stringLength:_e,getFontHeight:xe,splitContent:we,replaceVariable:Ee,getAlignPoint:Se,getFont:Ie,splitTextToRow:be}),Me=M?function(t){return t[0]}:function(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},Te=Me(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),Le=Me(["transformOrigin","WebkitTransformOrigin","OTransformOrigin","MozTransformOrigin","msTransformOrigin"]),Ne=Me(["transition","WebkitTransition","OTransition","MozTransition","msTransition"]),Re=Me(["filter","WebkitFilter","OFilter","MozFilter","msFilter"]);function Oe(t,e){var n=document.createElement(t);return e&&Ye(n,e),n}function Ae(t,e,n){var i=Oe(t);return e&&We(i,e),n&&n.appendChild(i),i}function De(t){if(!t)return this;if(he.ielt9||he.ie9){var e=Oe("div");e.appendChild(t),e.innerHTML="",e=null}else t.parentNode&&t.parentNode.removeChild(t);return this}function ke(t,e,n,i){if(!(t&&t.addEventListener&&e&&n))return this;for(var r=function(e){e||(e=window.event),n.call(i||t,e)},o=e.split(" "),s=o.length-1;s>=0;s--){var a=o[s];if(a)t["Z__"+a]||(t["Z__"+a]=[]),Ge(t,a,n)>=0&&Fe(t,a,n),t["Z__"+a].push({callback:r,src:n}),"mousewheel"===a&&he.gecko&&(a="DOMMouseScroll"),t.addEventListener(a,r,!1)}return this}function Fe(t,e,n){function i(e,n){"mousewheel"===e&&he.gecko&&(e="DOMMouseScroll"),t.removeEventListener(e,n,!1)}if(!t||!t.removeEventListener||!e)return this;for(var r=e.split(" "),o=r.length-1;o>=0;o--){var s=r[o];if(s){if(!n&&t["Z__"+s]){for(var a=t["Z__"+s],h=0,u=a.length;h<u;h++)i(a[h].callback);return delete t["Z__"+s],this}var l=Ge(t,s,n);if(l<0)return this;i(s,t["Z__"+s][l].callback),t["Z__"+s].splice(l,1)}}return this}function Ge(t,e,n){if(!t||!t["Z__"+e]||!n)return-1;for(var i=t["Z__"+e],r=0,o=i.length;r<o;r++)if(i[r].src===n)return r;return-1}function ze(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function je(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this}function Be(t){return t.onselectstart=function(){return!1},t.ondragstart=function(){return!1},t.setAttribute("unselectable","on"),this}function He(t,e){return t?(he.any3d?Je(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px"),e):null}function Ve(t){var e=window.getComputedStyle(t),n=[parseInt(e["padding-left"]),parseInt(e["padding-top"])],i=t.getBoundingClientRect(),r=t.offsetWidth,o=t.offsetHeight,s=r?i.width/r:1,a=o?i.height/o:1;return t.__position=[i.left+n[0],i.top+n[1],s,a],t.__position}function qe(t,e){t||(t=window.event);var n=e.__position;return n||(n=Ve(e)),new le(t.clientX/n[2]-n[0]-e.clientLeft,t.clientY/n[3]-n[1]-e.clientTop)}function We(t,e){var n,i,r,o=t.style.cssText;return i=";",(r=(n=o).length-i.length)>=0&&n.indexOf(i,r)===r||(o+=";"),t.style.cssText=o+e,this}function Ze(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Xe(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function Ue(t,e){if(void 0===t.classList||Ze(t,e)){var n=Xe(t);Ye(t,(n?n+" ":"")+e)}else for(var i=ge(e),r=0,o=i.length;r<o;r++)t.classList.add(i[r]);return this}function Ye(t,e){return m(t.className.baseVal)?t.className=e:t.className.baseVal=e,this}function Xe(t){return m(t.className.baseVal)?t.className:t.className.baseVal}function Je(t,e){var n=e||new le(0,0);return t.style[Te]=he.any3d?"translate3d("+n.x+"px,"+n.y+"px,0px)":"translate("+n.x+"px,"+n.y+"px)",this}function Ke(t){return/<[a-z\][\s\S]*>/i.test(t)}function Qe(t,e){var n=$e(t);w(e)?n.innerHTML=e:n.appendChild(e);var i=new ce(n.clientWidth,n.clientHeight);return De(n),i}function $e(t){var e=document.createElement(t);return e.style.cssText="position:absolute;left:-10000px;top:-10000px;",document.body.appendChild(e),e}var tn=ke,en=Fe,nn=Object.freeze({TRANSFORM:Te,TRANSFORMORIGIN:Le,TRANSITION:Ne,CSSFILTER:Re,createEl:Oe,createElOn:Ae,removeDomNode:De,addDomEvent:ke,removeDomEvent:Fe,listensDomEvent:Ge,preventDefault:ze,stopPropagation:je,preventSelection:Be,offsetDom:He,computeDomPosition:Ve,getEventContainerPoint:qe,setStyle:We,hasClass:Ze,addClass:Ue,setClass:Ye,getClass:Xe,setOpacity:function(t,e){return t.style.opacity=e,this},setTransform:Je,setTransformMatrix:function(t,e){var n="matrix("+(w(e)?e:e.join())+")";return t.style[Te]!==n&&(t.style[Te]=n),this},removeTransform:function(t){return t.style[Te]&&(t.style[Te]=""),this},isHTML:Ke,measureDom:Qe,getDomRuler:$e,on:tn,off:en}),rn={jsonp:function(t,e){var n="_maptalks_jsonp_"+A();t.match(/\?/)?t+="&callback="+n:t+="?callback="+n;var i=document.createElement("script");return i.type="text/javascript",i.src=t,window[n]=function(t){e(null,t),document.getElementsByTagName("head")[0].removeChild(i),i=null,delete window[n]},document.getElementsByTagName("head")[0].appendChild(i),this},get:function(t,e,n){if(C(e)){var i=n;n=e,e=i}if(M&&rn.get.node)return rn.get.node(t,n,e);var r=rn._getClient(n);if(r.open("GET",t,!0),e){for(var o in e.headers)r.setRequestHeader(o,e.headers[o]);r.withCredentials="include"===e.credentials,e.responseType&&(r.responseType=e.responseType)}return r.send(null),r},post:function(t,e,n){var i=void 0;if(w(t)){if(C(e)){var r=n;n=e,e=r}i=(e=e||{}).postData}else{var o=n;i=e,t=(e=t).url,n=o}if(M&&rn.post.node)return e.url=t,rn.post.node(e,i,n);var s=rn._getClient(n);if(s.open("POST",e.url,!0),e.headers||(e.headers={}),e.headers["Content-Type"]||(e.headers["Content-Type"]="application/x-www-form-urlencoded"),"setRequestHeader"in s)for(var a in e.headers)e.headers.hasOwnProperty(a)&&s.setRequestHeader(a,e.headers[a]);return w(i)||(i=JSON.stringify(i)),s.send(i),s},_wrapCallback:function(t,e){return function(){4===t.readyState&&(200===t.status?"arraybuffer"===t.responseType?0===t.response.byteLength?e(new Error("http status 200 returned without content.")):e(null,{data:t.response,cacheControl:t.getResponseHeader("Cache-Control"),expires:t.getResponseHeader("Expires"),contentType:t.getResponseHeader("Content-Type")}):e(null,t.responseText):e(new Error(t.statusText+","+t.status)))}},_getClient:function(t){var e=void 0;try{e=new XMLHttpRequest}catch(t){try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}}return e.onreadystatechange=rn._wrapCallback(e,t),e},getArrayBuffer:function(t,e,n){if(C(e)){var i=n;n=e,e=i}return e||(e={}),e.responseType="arraybuffer",rn.get(t,e,n)},getImage:function(t,e,n){return rn.getArrayBuffer(e,n,function(e,n){if(e)t.onerror&&t.onerror(e);else if(n){var i=window.URL||window.webkitURL,r=t.onload;t.onload=function(){r&&r(),i.revokeObjectURL(t.src)};var o=new Blob([new Uint8Array(n.data)],{type:n.contentType});t.cacheControl=n.cacheControl,t.expires=n.expires,t.src=n.data.byteLength?i.createObjectURL(o):nt}})},getJSON:function(t,e,n){if(C(e)){var i=n;n=e,e=i}var r=function(t,e){var i=e?k(e):null;n(t,i)};return e&&e.jsonp?rn.jsonp(t,r):rn.get(t,e,r)}},on=!1,sn={setHitTesting:function(t){on=t},createCanvas:function(t,e,n){var i=void 0;return M?i=new n(t,e):((i=Oe("canvas")).width=t,i.height=e),i},prepareCanvasFont:function(t,e){t.textBaseline="top",t.font=Ie(e);var n=e.textFill;n||(n="#000"),t.fillStyle=sn.getRgba(n,e.textOpacity)},prepareCanvas:function(t,e,n,i){if(e){var r=e.lineWidth;m(r)||t.lineWidth===r||(t.lineWidth=r);var o=e.linePatternFile||e.lineColor||"#000";if(i)t.strokeStyle="#000";else if(un(o)&&n){var s=void 0;(e.linePatternDx||e.linePatternDy)&&(s=[e.linePatternDx,e.linePatternDy]),sn._setStrokePattern(t,o,r,s,n),e.lineDasharray=[]}else Dt(o)?e.lineGradientExtent?t.strokeStyle=sn._createGradient(t,o,e.lineGradientExtent):t.strokeStyle="#000":t.strokeStyle=o;e.lineJoin&&(t.lineJoin=e.lineJoin),e.lineCap&&(t.lineCap=e.lineCap),t.setLineDash&&Z(e.lineDasharray)&&t.setLineDash(e.lineDasharray);var a=e.polygonPatternFile||e.polygonFill||"rgba(255,255,255,0)";if(i)t.fillStyle="#000";else if(un(a)&&n){var h=ln(a),u=n.getImage([h,null,null]);if(u||(u=n.getImage([h+"-texture",null,r])),N(h)&&u instanceof Image&&(he.edge||he.ie)){var l=u.width||20,c=u.height||20,f=sn.createCanvas(l,c);sn.image(f.getContext("2d"),u,0,0,l,c),u=f}u?(t.fillStyle=t.createPattern(u,"repeat"),(e.polygonPatternDx||e.polygonPatternDy)&&(t.fillStyle.polygonPatternOffset=[e.polygonPatternDx,e.polygonPatternDy])):"undefined"!=typeof console&&console.warn("img not found for",h)}else Dt(a)?e.polygonGradientExtent?t.fillStyle=sn._createGradient(t,a,e.polygonGradientExtent):t.fillStyle="rgba(255,255,255,0)":t.fillStyle=a}},_createGradient:function(t,e,n){var i=null,r=e.places,o=n.getMin(),s=n.getMax(),a=n.getWidth(),h=n.getHeight();if(e.type&&"linear"!==e.type){if("radial"===e.type){if(r){if(6!==r.length)throw new Error("A radial gradient's places should have 6 numbers.");r=[o.x+r[0]*a,o.y+r[1]*h,a*r[2],o.x+r[3]*a,o.y+r[4]*h,a*r[5]]}else{var u=n.getCenter()._round();r=[u.x,u.y,Math.abs(u.x-o.x),u.x,u.y,0]}i=t.createRadialGradient.apply(t,r)}}else{if(r){if(4!==r.length)throw new Error("A linear gradient's places should have 4 numbers.");r=[o.x+r[0]*a,o.y+r[1]*h,o.x+r[2]*a,o.y+r[3]*h]}else r=[o.x,o.y,s.x,o.y];i=t.createLinearGradient.apply(t,r)}return e.colorStops.forEach(function(t){i.addColorStop.apply(i,t)}),i},_setStrokePattern:function(t,e,n,i,r){var o=ln(e),s=void 0;if(M)s=r.getImage([o,null,n]);else{var a=o+"-texture-"+n;if(!(s=r.getImage(a))){var h=r.getImage([o,null,null]);if(h){var u=void 0;u=h.width&&h.height?Math.round(h.width*n/h.height):n;var l=sn.createCanvas(u,n,t.canvas.constructor);sn.image(l.getContext("2d"),h,0,0,u,n),r.addResource([a,null,n],l),s=l}}}s?(t.strokeStyle=t.createPattern(s,"repeat"),t.strokeStyle.linePatternOffset=i):"undefined"!=typeof console&&console.warn("img not found for",o)},clearRect:function(t,e,n,i,r){t.canvas._drawn=!1,t.clearRect(e,n,i,r)},fillCanvas:function(t,e,n,i){if(on&&(e=1),t.canvas._drawn=!0,0!==e){var r=sn._isPattern(t.fillStyle),o=t.fillStyle&&t.fillStyle.polygonPatternOffset,s=o?o[0]:0,a=o?o[1]:0;m(e)&&(e=1);var h=void 0;e<1&&(h=t.globalAlpha,t.globalAlpha*=e),r&&(n=n||0,i=i||0,t.translate(n+s,i+a)),t.fill(),r&&t.translate(-n-s,-i-a),e<1&&(t.globalAlpha=h)}},getRgba:function(t,e){if(m(e)&&(e=1),"#"!==t[0])return t;var n=void 0,i=void 0,r=void 0;return 7===t.length?(n=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16)):(n=17*parseInt(t.substring(1,2),16),i=17*parseInt(t.substring(2,3),16),r=17*parseInt(t.substring(3,4),16)),"rgba("+n+","+i+","+r+","+e+")"},image:function(t,e,n,i,r,o){t.canvas._drawn=!0;try{v(r)&&v(o)?t.drawImage(e,n,i,r,o):t.drawImage(e,n,i)}catch(t){console&&(console.warn("error when drawing image on canvas:",t),console.warn(e))}},text:function(t,e,n,i,r){sn._textOnMultiRow(t,r.rows,i,n,r.size,r.rawSize)},_textOnMultiRow:function(t,e,n,i,r,o){for(var s=Se(r,n.textHorizontalAlignment,n.textVerticalAlignment),a=o.height+n.textLineSpacing,h=i.add(0,s.y),u=n.textMaxHeight,l=void 0,c=void 0,f=0,p=0,d=e.length;p<d&&(l=e[p].text,c=Se(e[p].size,n.textHorizontalAlignment,n.textVerticalAlignment),sn._textOnLine(t,l,h.add(c.x,p*a),n.textHaloRadius,n.textHaloFill,n.textHaloOpacity),!(u>0&&(f+=a)+o.height>=u));p++);},_textOnLine:function(t,e,n,i,r,o){on&&(o=1);var s=0!==o&&0!==i;t.textBaseline="top";var a=void 0,h=void 0,u=t.shadowBlur,l=t.shadowOffsetX,c=t.shadowOffsetY;if(s){var f=t.globalAlpha;t.globalAlpha*=o,t.miterLimit=2,t.lineJoin="round",t.lineCap="round",t.lineWidth=2*i,t.strokeStyle=r,t.strokeText(e,Math.round(n.x),Math.round(n.y)),t.miterLimit=10,t.globalAlpha=f,a=t.globalCompositeOperation,t.globalCompositeOperation="destination-out",h=t.fillStyle,t.fillStyle="#000"}u&&s&&(t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0),sn.fillText(t,e,n),a&&(t.globalCompositeOperation=a,sn.fillText(t,e,n,h),u&&(t.shadowBlur=u,t.shadowOffsetX=l,t.shadowOffsetY=c))},fillText:function(t,e,n,i){t.canvas._drawn=!0,i&&(t.fillStyle=i),t.fillText(e,Math.round(n.x),Math.round(n.y))},_stroke:function(t,e,n,i){if(on&&(e=1),t.canvas._drawn=!0,0!==e){var r=t.strokeStyle&&t.strokeStyle.linePatternOffset,o=r?r[0]:0,s=r?r[1]:0,a=sn._isPattern(t.strokeStyle)&&(!m(n)&&!m(i)||!m(o)&&!m(s));m(e)&&(e=1);var h=void 0;e<1&&(h=t.globalAlpha,t.globalAlpha*=e),a&&(n=n||0,i=i||0,t.translate(n+o,i+s)),t.stroke(),a&&t.translate(-n-o,-i-s),e<1&&(t.globalAlpha=h)}},_path:function(t,e,n,i,r){if(Z(e))for(var o,s,a,h=Z(n),u=!0!==r&&sn._isPattern(t.strokeStyle),l=void 0,c=void 0,f=void 0,p=0,d=e.length;p<d;p++)if(l=e[p],!h||t.setLineDash)t.lineTo(l.x,l.y),u&&p>0&&(c=e[p-1],s=l,void 0,a=et((o=c).x,o.y,s.x,s.y),t.save(),t.translate(o.x,o.y-t.lineWidth/2/Math.cos(a)),t.rotate(a),sn._stroke(t,i),t.restore(),t.beginPath(),t.moveTo(l.x,l.y));else if(h){if(p===d-1)break;f=e[p+1],an(t,l,f,n)}},path:function(t,e,n,i,r){Z(e)&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),sn._path(t,e,r,n),sn._stroke(t,n))},polygon:function(t,e,n,i,r,o){if(Z(e)){var s=sn._isPattern(t.strokeStyle),a=Z(r)&&!t.setLineDash||s&&!o;Z(e[0])||(e=[e]);var h=void 0,u=void 0,l=void 0;if(a){for(t.save(),u=0,l=e.length;u<l;u++)Z(e[u])&&(sn._ring(t,e[u],null,0,!0),h=i,u>0&&(t.globalCompositeOperation="destination-out",h=1),c(e,u,h),u>0?t.globalCompositeOperation="source-over":l>1&&(t.fillStyle="#fff"),sn._stroke(t,0));t.restore()}for(u=0,l=e.length;u<l;u++)Z(e[u])&&(o?(sn.paintSmoothLine(t,e[u],n,o,!0),t.closePath()):sn._ring(t,e[u],r,n),a||(h=i,u>0&&(t.globalCompositeOperation="destination-out",h=1),c(e,u,h),u>0?t.globalCompositeOperation="source-over":l>1&&(t.fillStyle="#fff")),sn._stroke(t,n))}function c(e,n,i){sn.fillCanvas(t,i,e[n][0].x,e[n][0].y)}},_ring:function(t,e,n,i,r){var o=sn._isPattern(t.strokeStyle);r||!o||e[0].equals(e[e.length-1])||(e=e.concat([e[0]])),t.beginPath(),t.moveTo(e[0].x,e[0].y),sn._path(t,e,n,i,r),o||t.closePath()},paintSmoothLine:function(t,e,n,i,r,o,s){if(e)if(e.length<=2||!i)sn.path(t,e,n);else{var a=e.length,h=r?a:a-1;t.beginPath(),t.moveTo(e[0].x,e[0].y),void 0!==s&&(h-=Math.max(h-o-1,0));for(var u=void 0,l=0;l<h;l++){var c=e[l].x,f=e[l].y,p=void 0,d=void 0,g=void 0,y=void 0,m=void 0,v=void 0;l-1<0?r?(p=e[h-1].x,d=e[h-1].y):(p=e[l+1].x,d=e[l+1].y):(p=e[l-1].x,d=e[l-1].y),l+1<a?(g=e[l+1].x,y=e[l+1].y):(g=e[l+1-a].x,y=e[l+1-a].y),l+2<a?(m=e[l+2].x,v=e[l+2].y):r?(m=e[l+2-a].x,v=e[l+2-a].y):(m=e[l].x,v=e[l].y);var _=w(p,d,c,f,g,y,m,v,i,l===h-1?s:1);if(l===h-1&&s>=0&&s<1){t.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]),e.splice(h-1,a-(h-1)-1);var x=new le(_[4],_[5]);x.prevCtrlPoint=new le(_[2],_[3]),e.push(x),a=e.length}else t.bezierCurveTo(_[0],_[1],_[2],_[3],g,y);e[l].nextCtrlPoint=_.slice(0,2),e[l].prevCtrlPoint=u?u.slice(2):null,u=_}!r&&e[1].prevCtrlPoint&&(e[0].nextCtrlPoint=e[1].prevCtrlPoint,delete e[0].prevCtrlPoint),e[a-1].prevCtrlPoint||(e[a-1].prevCtrlPoint=e[a-2].nextCtrlPoint),sn._stroke(t,n)}function w(t,e,n,i,r,o,s,a,h,u){var l=(t+n)/2,c=(e+i)/2,f=(n+r)/2,p=(i+o)/2,d=(r+s)/2,g=(o+a)/2,y=Math.sqrt((n-t)*(n-t)+(i-e)*(i-e)),m=Math.sqrt((r-n)*(r-n)+(o-i)*(o-i)),v=y/(y+m),_=m/(m+Math.sqrt((s-r)*(s-r)+(a-o)*(a-o))),x=l+(f-l)*v,w=c+(p-c)*v,C=f+(d-f)*_,E=p+(g-p)*_,S=x+(f-x)*h+n-x,I=w+(p-w)*h+i-w,b=C+(f-C)*h+r-C,P=E+(p-E)*h+o-E,M=[S,I,b,P];return u<1?function(t,e,n,i,r,o,s,a,h,u){var l=1-t,c=1-e,f=n*c*c+2*r*e*c+s*e*e,p=r*c*c+2*s*e*c+h*e*e,d=i*c*c+2*o*e*c+a*e*e,g=o*c*c+2*a*e*c+u*e*e;return[(n*l*l+2*r*t*l+s*t*t)*c+(r*l*l+2*s*t*l+h*t*t)*e,(i*l*l+2*o*t*l+a*t*t)*c+(o*l*l+2*a*t*l+u*t*t)*e,f*l+p*t,d*l+g*t,f*c+p*e,d*c+g*e]}(0,u,n,i,S,I,b,P,r,o):M}},_arcBetween:function(t,e,n,i){var r=i,o=e.distanceTo(n),s=o/2/Math.sin(r/2),a=Math.asin((n.y-e.y)/o);e.x>n.x&&(a=Math.PI-a);var h=a-(90*Math.PI/180-r/2),u=Math.cos(h)*s,l=Math.sin(h)*s,c=e.x+u,f=e.y+l,p=Math.asin((n.y-f)/s);c>n.x&&(p=Math.PI-p);var d=p+r;return t.beginPath(),t.arc(c,f,s,p,d),[c,f]},_lineTo:function(t,e){t.lineTo(e.x,e.y)},bezierCurveAndFill:function(t,e,n,i){t.beginPath();var r=e[0];t.moveTo(r.x,r.y);var o=[t];o.push.apply(o,e.splice(1)),sn._bezierCurveTo.apply(sn,o),sn.fillCanvas(t,i),sn._stroke(t,n)},_bezierCurveTo:function(t,e,n,i){t.bezierCurveTo(e.x,e.y,n.x,n.y,i.x,i.y)},ellipse:function(t,e,n,i,r,o){var s,a,h,u,l,c,f;t.beginPath(),n===i?t.arc(e.x,e.y,n,0,2*Math.PI):t.ellipse?t.ellipse(e.x,e.y,n,i,0,0,Math.PI/180*360):(s=e.x,a=e.y,c=(h=n)*(l=.5522848),f=(u=i)*l,t.moveTo(s-h,a),t.bezierCurveTo(s-h,a-f,s-c,a-u,s,a-u),t.bezierCurveTo(s+c,a-u,s+h,a-f,s+h,a),t.bezierCurveTo(s+h,a+f,s+c,a+u,s,a+u),t.bezierCurveTo(s-c,a+u,s-h,a+f,s-h,a),t.closePath()),sn.fillCanvas(t,o,e.x-n,e.y-i),sn._stroke(t,r,e.x-n,e.y-i)},rectangle:function(t,e,n,i,r){t.beginPath(),t.rect(e.x,e.y,n.width,n.height),sn.fillCanvas(t,r,e.x,e.y),sn._stroke(t,i,e.x,e.y)},sector:function(t,e,n,i,r,o){var s=Math.PI/180,a=i[0],h=i[1];function u(t,e,n,i,a,h){var u=s*-h,l=s*-a;t.beginPath(),t.moveTo(e,n),t.arc(e,n,i,u,l),t.lineTo(e,n),sn.fillCanvas(t,o,e-i,n-i),sn._stroke(t,r,e-i,n-i)}u(t,e.x,e.y,n,a,h)},_isPattern:function(t){return!(w(t)||"addColorStop"in t)},drawCross:function(t,e,n,i){t.canvas._drawn=!0,t.strokeStyle=i,t.lineWidth=n,t.beginPath(),t.moveTo(e.x-5,e.y),t.lineTo(e.x+5,e.y),t.moveTo(e.x,e.y-5),t.lineTo(e.x,e.y+5),t.stroke()},copy:function(t,e){var n=e||Oe("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),n}};function an(t,e,n,i){var r=e.x,o=e.y,s=n.x,a=n.y,h=i,u=function(t,e){return t<=e},l=function(t,e){return t>=e},c=function(t,e){return Math.min(t,e)},f=function(t,e){return Math.max(t,e)},p={thereYet:l,cap:c},d={thereYet:l,cap:c};o-a>0&&(d.thereYet=u,d.cap=f),r-s>0&&(p.thereYet=u,p.cap=f),t.moveTo(r,o);for(var g=r,y=o,m=0,v=!0,_=void 0,x=void 0;!p.thereYet(g,s)||!d.thereYet(y,a);)_=Math.atan2(a-o,s-r),x=h[m],g=p.cap(s,g+Math.cos(_)*x),y=d.cap(a,y+Math.sin(_)*x),v?t.lineTo(g,y):t.moveTo(g,y),m=(m+1)%h.length,v=!v}var hn="data:image/";function un(t){return t.length>hn.length&&t.substring(0,hn.length)===hn||J(t)}function ln(t){return t.substring(0,hn.length)===hn?t:K(t)}var cn=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.on=function(t,e,n){if(!t)return this;if(!w(t))return this._switch("on",t,e);if(!e)return this;this._eventMap||(this._eventMap={});var i=t.toLowerCase().split(" "),r=void 0;n||(n=this);for(var o=void 0,s=0,a=i.length;s<a;s++){r=i[s],(o=this._eventMap[r])||(o=[],this._eventMap[r]=o);var h=o.length;if(h>0)for(var u=0;u<h;u++)if(e===o[u].handler&&o[u].context===n)return this;o.push({handler:e,context:n})}return this},e.prototype.addEventListener=function(){return this.on.apply(this,arguments)},e.prototype.once=function(t,e,n){if(!w(t)){var i={};for(var r in t)t.hasOwnProperty(r)&&(i[r]=this._wrapOnceHandler(r,t[r],n));return this._switch("on",i)}for(var o=t.split(" "),s=0,a=o.length;s<a;s++)this.on(o[s],this._wrapOnceHandler(o[s],e,n));return this},e.prototype.off=function(t,e,n){if(!this._eventMap||!t)return this;if(!w(t))return this._switch("off",t,e);if(!e)return this;var i=t.split(" "),r=void 0,o=void 0,s=void 0;n||(n=this);for(var a=0,h=i.length;a<h;a++){if(s="Z__"+(r=i[a].toLowerCase()),!(o=this._eventMap[r]))return this;for(var u=o.length-1;u>=0;u--){var l=o[u];e!==l.handler&&e!==l.handler[s]||l.context!==n||(delete l.handler[s],o.splice(u,1))}}return this},e.prototype.removeEventListener=function(){return this.off.apply(this,arguments)},e.prototype.listens=function(t,e,n){if(!this._eventMap||!w(t))return 0;var i=this._eventMap[t.toLowerCase()];if(!i||!i.length)return 0;for(var r=0,o=0,s=i.length;o<s;o++)if(e){if(e===i[o].handler&&(m(n)||i[o].context===n))return 1}else r++;return r},e.prototype.copyEventListeners=function(t){var e=t._eventMap;if(!e)return this;var n=void 0;for(var i in e)for(var r=0,o=(n=e[i]).length;r<o;r++)this.on(i,n[r].handler,n[r].context);return this},e.prototype.fire=function(){return this._eventParent?this._eventParent.fire.apply(this._eventParent,arguments):this._fire.apply(this,arguments)},e.prototype._wrapOnceHandler=function(t,e,n){var i=this,r="Z__"+t,o=!1,s=function a(){o||(delete s[r],o=!0,n?e.apply(n,arguments):e.apply(this,arguments),i.off(t,a,this))};return s[r]=e,s},e.prototype._switch=function(t,e,n){for(var i in e)e.hasOwnProperty(i)&&this[t](i,e[i],n);return this},e.prototype._clearListeners=function(t){this._eventMap&&w(t)&&(this._eventMap[t.toLowerCase()]&&(this._eventMap[t]=null))},e.prototype._clearAllListeners=function(){this._eventMap=null},e.prototype._setEventParent=function(t){return this._eventParent=t,this},e.prototype._fire=function(t,e){if(!this._eventMap)return this;var n=this._eventMap[t.toLowerCase()];if(!n)return this;e||(e={}),e.type=t,e.target=this;for(var i=n.slice(0),r=void 0,o=void 0,s=0,a=i.length;s<a;s++)i[s]&&(r=i[s].context,!0,o=y({},e),!1===(r?i[s].handler.call(r,o):i[s].handler(o))&&e.domEvent&&je(e.domEvent));return this},e}(t)},fn=function(){function t(e){f(this,t),this.target=e}return t.prototype.enable=function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},t.prototype.disable=function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},t.prototype.enabled=function(){return!!this._enabled},t.prototype.remove=function(){this.disable(),delete this.target,delete this.dom},t}(),pn=cn(fn),dn=function(){function t(e){if(f(this,t),!this||!this.setOptions)throw new Error('Class instance is being created without "new" operator.');this.setOptions(e),this.callInitHooks()}return t.prototype.callInitHooks=function(){var t=Object.getPrototypeOf(this);return this._visitInitHooks(t),this},t.prototype.setOptions=function(t){if(this.hasOwnProperty("options")||(this.options=this.options?Object.create(this.options):{}),!t)return this;for(var e in t)this.options[e]=t[e];return this},t.prototype.config=function(t){if(!t){var e={};for(var n in this.options)this.options.hasOwnProperty(n)&&(e[n]=this.options[n]);return e}if(2===arguments.length){var i={};i[t]=arguments[1],t=i}for(var r in t)this.options[r]=t[r],this[r]&&this[r]instanceof pn&&(t[r]?this[r].enable():this[r].disable());return this.onConfig(t),this},t.prototype.onConfig=function(){},t.prototype._visitInitHooks=function(t){if(!this._initHooksCalled){var e=Object.getPrototypeOf(t);e._visitInitHooks&&e._visitInitHooks.call(this,e),this._initHooksCalled=!0;var n=t._initHooks;if(n&&n!==e._initHooks)for(var i=0;i<n.length;i++)n[i].call(this)}},t.addInitHook=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r="function"==typeof t?t:function(){this[t].apply(this,n)},o=this.prototype,s=Object.getPrototypeOf(o);return o._initHooks&&o._initHooks!==s._initHooks||(o._initHooks=[]),o._initHooks.push(r),this},t.include=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0;i<e.length;i++)y(this.prototype,e[i]);return this},t.mergeOptions=function(t){var e=this.prototype,n=Object.getPrototypeOf(e);return e.options&&e.options!==n.options||(e.options=e.options?Object.create(e.options):{}),y(e.options,t),this},t}(),gn={},yn=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.registerJSONType=function(t){return t?(gn[t]=this,this):this},e.getJSONClass=function(t){return t?gn[t]:null},e.prototype.getJSONType=function(){if(void 0===this._jsonType){var t=Object.getPrototypeOf(this).constructor;for(var e in gn)if(gn[e]===t){this._jsonType=e;break}}if(!this._jsonType)throw new Error("Found an unregistered geometry class!");return this._jsonType},e}(t)},mn=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHandler=function(t,e){if(!e)return this;if(this._handlers||(this._handlers=[]),this[t])return this[t].enable(),this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},e.prototype.removeHandler=function(t){if(!t)return this;var e=this[t];if(e){var n=this._handlers.indexOf(e);n>=0&&this._handlers.splice(n,1),this[t].remove(),delete this[t]}return this},e.prototype._clearHandlers=function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].remove();this._handlers=[]},e}(t)},vn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},_n={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},xn=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,e);var r=d(this,t.call(this,null));return r.dom=n,r.options=i,r}return p(e,t),e.prototype.enable=function(){return this.dom?(this._onMouseDown=function(t){return this.onMouseDown(t)},tn(this.dom,"touchstart mousedown",this._onMouseDown,this),this):this},e.prototype.disable=function(){return this.dom?(this._offEvents(),en(this.dom,"touchstart mousedown",this._onMouseDown),delete this._onMouseDown,this):this},e.prototype.onMouseDown=function(t){if((this.options.rightclick||2!==t.button)&&!(t.touches&&t.touches.length>1||this.options.cancelOn&&!0===this.options.cancelOn(t))){var e=this.dom;e.setCapture?e.setCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP),e.ondragstart=function(){return!1},delete this.moved;var n=t.touches?t.touches[0]:t;this.startPos=new le(n.clientX,n.clientY),tn(document,vn[t.type],this.onMouseMove,this),tn(document,_n[t.type],this.onMouseUp,this),this.options.ignoreMouseleave||tn(this.dom,"mouseleave",this.onMouseUp,this),this.fire("mousedown",{domEvent:t,mousePos:new le(n.clientX,n.clientY)})}},e.prototype.onMouseMove=function(t){if(t.touches&&t.touches.length>1)this.moved&&(this.interupted=!0,this.onMouseUp(t));else{var e=t.touches?t.touches[0]:t,n=new le(e.clientX,e.clientY).sub(this.startPos);(n.x||n.y)&&(this.moved?this.fire("dragging",{domEvent:t,mousePos:new le(e.clientX,e.clientY)}):(this.fire("dragstart",{domEvent:t,mousePos:this.startPos.copy()}),this.moved=!0))}},e.prototype.onMouseUp=function(t){var e=t.changedTouches?t.changedTouches[0]:t;this._offEvents();var n={domEvent:t};v(e.clientX)&&(n.mousePos=new le(parseInt(e.clientX,0),parseInt(e.clientY,0))),this.moved&&(n.interupted=this.interupted,this.fire("dragend",n),delete this.interupted,delete this.moved),this.fire("mouseup",n)},e.prototype._offEvents=function(){var t=this.dom;if(en(t,"mouseleave",this.onMouseUp,this),"undefined"!=typeof document&&"undefined"!=typeof window){for(var e in vn)en(document,vn[e],this.onMouseMove,this),en(document,_n[e],this.onMouseUp,this);t.releaseCapture?t.releaseCapture():window.captureEvents&&window.captureEvents(window.Event.MOUSEMOVE|window.Event.MOUSEUP)}},e}(pn),wn=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.toNumberArrays=function(t){return Array.isArray(t)?z(t,function(t){return[t.x,t.y]}):[t.x,t.y]},e.toCoordinates=function(t){if(v(t[0])&&v(t[1]))return new e(t);for(var n=[],i=0,r=t.length;i<r;i++){var o=t[i];Array.isArray(o)?v(o[0])?n.push(new e(o)):n.push(e.toCoordinates(o)):n.push(new e(o))}return n},e}(ue),Cn=function(){function t(e,n){f(this,t),this.type=e,this.properties=n}return t.createProj4=function(e){return new t("proj4",{proj:e})},t.fromProjectionCode=function(e){return e&&t[e=e.toUpperCase().replace(":","")]||null},t}();Cn.WGS84=Cn.createProj4("+proj=longlat +datum=WGS84 +no_defs"),Cn.EPSG4326=Cn.WGS84,Cn.EPSG3857=Cn.createProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"),Cn.IDENTITY=Cn.createProj4("+proj=identity +no_defs"),Cn.CGCS2000=Cn.createProj4("+proj=longlat +datum=CGCS2000"),Cn.EPSG4490=Cn.CGCS2000,Cn.BD09LL=Cn.createProj4("+proj=longlat +datum=BD09"),Cn.GCJ02=Cn.createProj4("+proj=longlat +datum=GCJ02");var En,Sn=function(){function t(e,n,i,r){f(this,t),this._clazz=wn;var o=arguments.length,s=o>0?arguments[o-1]:null;s&&s.unproject&&(this.projection=arguments[o-1]),this._dirty=!0,this._initialize(e,n,i,r)}return t.prototype._initialize=function(t,e,n,i){if(this.xmin=null,this.xmax=null,this.ymin=null,this.ymax=null,!m(t)){var r=this.projection;v(t)&&v(e)&&v(n)&&v(i)?r?(this.xmin=t,this.ymin=e,this.xmax=n,this.ymax=i):(this.xmin=Math.min(t,n),this.ymin=Math.min(e,i),this.xmax=Math.max(t,n),this.ymax=Math.max(e,i)):Array.isArray(t)?r?(this.xmin=t[0],this.ymin=t[1],this.xmax=t[2],this.ymax=t[3]):(this.xmin=Math.min(t[0],t[2]),this.ymin=Math.min(t[1],t[3]),this.xmax=Math.max(t[0],t[2]),this.ymax=Math.max(t[1],t[3])):v(t.x)&&v(e.x)&&v(t.y)&&v(e.y)?r?(this.xmin=t.x,this.ymin=t.y,this.xmax=e.x,this.ymax=e.y):(t.x>e.x?(this.xmin=e.x,this.xmax=t.x):(this.xmin=t.x,this.xmax=e.x),t.y>e.y?(this.ymin=e.y,this.ymax=t.y):(this.ymin=t.y,this.ymax=e.y)):v(t.xmin)&&v(t.xmax)&&v(t.ymin)&&v(t.ymax)&&(this.xmin=t.xmin,this.ymin=t.ymin,this.xmax=t.xmax,this.ymax=t.ymax)}},t.prototype._add=function(t){return this._dirty=!0,m(t.x)?m(t.xmin)?m(t[0])||(this.xmin+=t[0],this.ymin+=t[1],this.xmax+=t[0],this.ymax+=t[1]):(this.xmin+=t.xmin,this.ymin+=t.ymin,this.xmax+=t.xmax,this.ymax+=t.ymax):(this.xmin+=t.x,this.ymin+=t.y,this.xmax+=t.x,this.ymax+=t.y),this},t.prototype.add=function(){var t=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return t._add.apply(t,arguments)},t.prototype._sub=function(t){return this._dirty=!0,m(t.x)?m(t.xmin)?m(t[0])||(this.xmin-=t[0],this.ymin-=t[1],this.xmax-=t[0],this.ymax-=t[1]):(this.xmin-=t.xmin,this.ymin-=t.ymin,this.xmax-=t.xmax,this.ymax-=t.ymax):(this.xmin-=t.x,this.ymin-=t.y,this.xmax-=t.x,this.ymax-=t.y),this},t.prototype._substract=function(){return this._sub.apply(this,arguments)},t.prototype.sub=function(){var t=new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection);return t._sub.apply(t,arguments)},t.prototype.substract=function(){return this.sub.apply(this,arguments)},t.prototype.round=function(){return new this.constructor(Math.round(this.xmin),Math.round(this.ymin),Math.round(this.xmax),Math.round(this.ymax),this.projection)},t.prototype._round=function(){return this._dirty=!0,this.xmin=Math.round(this.xmin),this.ymin=Math.round(this.ymin),this.xmax=Math.round(this.xmax),this.ymax=Math.round(this.ymax),this},t.prototype.getMin=function(){return new this._clazz(this.xmin,this.ymin)},t.prototype.getMax=function(){return new this._clazz(this.xmax,this.ymax)},t.prototype.getCenter=function(){return new this._clazz((this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)},t.prototype.isValid=function(){return v(this.xmin)&&v(this.ymin)&&v(this.xmax)&&v(this.ymax)},t.prototype.equals=function(t){return this.xmin===t.xmin&&this.xmax===t.xmax&&this.ymin===t.ymin&&this.ymax===t.ymax},t.prototype.intersects=function(t){this._project(this),this._project(t);var e=Math.max(this.pxmin,t.pxmin),n=Math.max(this.pymin,t.pymin),i=Math.min(this.pxmax,t.pxmax),r=Math.min(this.pymax,t.pymax),o=!(e>i||n>r);return o},t.prototype.within=function(t){return this._project(this),this._project(t),this.pxmin>=t.pxmin&&this.pxmax<=t.pxmax&&this.pymin>=t.pymin&&this.pymax<=t.pymax},t.prototype.contains=function(t){if(!t)return!1;this._project(this);var e=this.projection;return Array.isArray(t)&&(t=new this._clazz(t)),e&&(t=e.project(t)),t.x>=this.pxmin&&t.x<=this.pxmax&&t.y>=this.pymin&&t.y<=this.pymax},t.prototype.getWidth=function(){return Math.abs(this.xmax-this.xmin)},t.prototype.getHeight=function(){return Math.abs(this.ymax-this.ymin)},t.prototype.getSize=function(){return new ce(this.getWidth(),this.getHeight())},t.prototype.__combine=function(t){t instanceof this.constructor||(t=new this.constructor(t,t)),this._project(t),this._project(this);var e=this.pxmin;v(e)?v(t.pxmin)&&e>t.pxmin&&(e=t.pxmin):e=t.pxmin;var n=this.pxmax;v(n)?v(t.pxmax)&&n<t.pxmax&&(n=t.pxmax):n=t.pxmax;var i=this.pymin;v(i)?v(t.pymin)&&i>t.pymin&&(i=t.pymin):i=t.pymin;var r=this.pymax;v(r)?v(t.pymax)&&r<t.pymax&&(r=t.pymax):r=t.pymax;var o=this.projection;if(o){var s=o.unproject(new this._clazz(e,i)),a=o.unproject(new this._clazz(n,r));e=s.x,i=s.y,n=a.x,r=a.y}return[e,i,n,r]},t.prototype._combine=function(t){if(!t)return this;var e=this.__combine(t);return this.xmin=e[0],this.ymin=e[1],this.xmax=e[2],this.ymax=e[3],this._dirty=!0,this},t.prototype.combine=function(t){if(!t)return this;var e=this.__combine(t);return new this.constructor(e[0],e[1],e[2],e[3],this.projection)},t.prototype.intersection=function(t){if(!this.intersects(t))return null;var e=new this._clazz(Math.max(this.pxmin,t.pxmin),Math.max(this.pymin,t.pymin)),n=new this._clazz(Math.min(this.pxmax,t.pxmax),Math.min(this.pymax,t.pymax)),i=this.projection;return i&&(e=i.unproject(e),n=i.unproject(n)),new this.constructor(e,n,i)},t.prototype.expand=function(t){var e=void 0,n=void 0;return v(t)?e=n=t:(e=t.width||t.x||t[0]||0,n=t.height||t.y||t[1]||0),new this.constructor(this.xmin-e,this.ymin-n,this.xmax+e,this.ymax+n,this.projection)},t.prototype._expand=function(t){var e=void 0,n=void 0;return v(t)?e=n=t:(e=t.width||t.x||t[0]||0,n=t.height||t.y||t[1]||0),this.xmin-=e,this.ymin-=n,this.xmax+=e,this.ymax+=n,this._dirty=!0,this},t.prototype.toJSON=function(){return{xmin:this.xmin,ymin:this.ymin,xmax:this.xmax,ymax:this.ymax}},t.prototype.toArray=function(){var t=this.xmin,e=this.ymin,n=this.xmax,i=this.ymax;return[new this._clazz([t,i]),new this._clazz([n,i]),new this._clazz([n,e]),new this._clazz([t,e]),new this._clazz([t,i])]},t.prototype.toString=function(){return this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},t.prototype.copy=function(){return new this.constructor(this.xmin,this.ymin,this.xmax,this.ymax,this.projection)},t.prototype.convertTo=function(t){if(!this.isValid())return null;var e=new this.constructor,n=new this._clazz(this.xmin,this.ymax);return e._combine(t(n)),n.x=this.xmax,e._combine(t(n)),n.y=this.ymin,e._combine(t(n)),n.x=this.xmin,e._combine(t(n)),e},t.prototype._project=function(t){if(t&&t.isValid()){var e=this.projection;if(e){if(t._dirty){var n=[t.getMin(),t.getMax()],i=(n=e.projectCoords(n))[0],r=n[1];t.pxmin=Math.min(i.x,r.x),t.pymin=Math.min(i.y,r.y),t.pxmax=Math.max(i.x,r.x),t.pymax=Math.max(i.y,r.y)}delete t._dirty}else t.pxmin=t.xmin,t.pxmax=t.xmax,t.pymin=t.ymin,t.pymax=t.ymax}},t}(),In=function(t){function e(n,i,r,o){f(this,e);var s=d(this,t.call(this,n,i,r,o));return s._clazz=le,s}return p(e,t),e}(Sn),bn=function(){function t(e){f(this,t),this.matrix=e}return t.prototype.transform=function(t,e){return new le(this.matrix[0]*(t.x-this.matrix[2])/e,this.matrix[1]*(t.y-this.matrix[3])/e)},t.prototype.untransform=function(t,e){return new wn(t.x*e/this.matrix[0]+this.matrix[2],t.y*e/this.matrix[1]+this.matrix[3])},t}(),Pn={project:function(){},unproject:function(){},projectCoords:function(t){var e=this;if(!t)return[];if(!Array.isArray(t))return this.project(t);if(0===t.length)return[];if(!this.isSphere())return z(t,this.project,this);if(Array.isArray(t[0]))return t.map(function(t){return e.projectCoords(t)});for(var n=this.getCircum(),i=this.getSphereExtent(),r=i.sx,o=i.sy,s=void 0,a=void 0,h=t[0],u=void 0,l=void 0,c=void 0,f=void 0,p=[this.project(h)],d=1,g=t.length;d<g;d++)l=(u=t[d]).x-h.x,c=u.y-h.y,f=this.project(u),Math.abs(l)>180&&(void 0===s&&(s=u.x<h.x),s&&(f._add(-n.x*B(l)*r,0),u._add(-360*B(l),0))),Math.abs(c)>90&&(void 0===a&&(a=u.y<h.y),a&&(f._add(0,-n.y*B(c)*o),u._add(0,-180*B(c)))),h=u,p.push(f);return p},unprojectCoords:function(t){return t?Array.isArray(t)?z(t,this.unproject,this):this.unproject(t):[]},isSphere:function(){return!!this.sphere},isOutSphere:function(t){return!!this.isSphere()&&!this.getSphereExtent().contains(t)},wrapCoord:function(t){if(!this.isSphere())return t;var e=this.getSphereExtent(),n=new wn(t);return e.contains(n)||(n.x=q(t.x,e.xmin,e.xmax),n.y=q(t.y,e.ymin,e.ymax)),n},getCircum:function(){if(!this.circum&&this.isSphere()){var t=this.getSphereExtent();this.circum={x:t.getWidth(),y:t.getHeight()}}return this.circum},getSphereExtent:function(){if(!this.extent&&this.isSphere()){var t=this.project(new wn(180,90)),e=this.project(new wn(-180,-90));this.extent=new Sn(e,t,this),this.extent.sx=t.x>e.x?1:-1,this.extent.sy=t.y>e.y?1:-1}return this.extent}},Mn={measureLength:function(t,e){if(!Array.isArray(t))return this.measureLenBetween(t,e);for(var n=0,i=0,r=t.length;i<r-1;i++)n+=this.measureLenBetween(t[i],t[i+1]);return n}},Tn=y({measure:"IDENTITY",measureLenBetween:function(t,e){if(!t||!e)return 0;try{return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}catch(t){return 0}},measureArea:function(t){if(!Array.isArray(t))return 0;for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n],o=null;o=n===i-1?t[0]:t[n+1],e+=r.x*o.y-r.y*o.x}return Math.abs(e/2)},locate:function(t,e,n){return t=new wn(t.x,t.y),this._locate(t,e,n)},_locate:function(t,e,n){return t?(e||(e=0),n||(n=0),e||n?(t.x=t.x+e,t.y=t.y+n,t):t):null},rotate:function(t,e,n){return t=new wn(t.x,t.y),this._rotate(t,e,n)},_rotate:(En=new le(0,0),function(t,e,n){return En.x=t.x-e.x,En.y=t.y-e.y,En._rotate(n*Math.PI/180),t._add(En.x,En.y)})},Mn),Ln=function(){function t(e){f(this,t),this.radius=e}return t.prototype.measureLenBetween=function(t,e){if(!t||!e)return 0;var n=b(t.y),i=b(e.y),r=n-i,o=b(t.x)-b(e.x);return n=2*Math.asin(Math.sqrt(Math.pow(Math.sin(r/2),2)+Math.cos(n)*Math.cos(i)*Math.pow(Math.sin(o/2),2))),n*=this.radius,Math.round(1e5*n)/1e5},t.prototype.measureArea=function(t){var e=b(this.radius),n=0,i=t,r=i.length;if(r<3)return 0;var o=void 0;for(o=0;o<r-1;o++){var s=i[o],a=i[o+1];n+=s.x*e*Math.cos(b(s.y))*a.y*e-a.x*e*Math.cos(b(a.y))*s.y*e}return r=i[o],i=i[0],n+=r.x*e*Math.cos(b(r.y))*i.y*e-i.x*e*Math.cos(b(i.y))*r.y*e,.5*Math.abs(n)},t.prototype.locate=function(t,e,n){return t=new wn(t.x,t.y),this._locate(t,e,n)},t.prototype._locate=function(t,e,n){if(!t)return null;if(e||(e=0),n||(n=0),!e&&!n)return t;var i=void 0,r=void 0,o=b(t.y);if(0!==n){var s=Math.abs(n);r=q(180*(o+=2*Math.sin(s/(2*this.radius))*(n>0?1:-1))/Math.PI,-90,90)}else r=t.y;if(0!==e){var a=Math.abs(e),h=b(t.x);i=q(180*(h+=2*Math.sqrt(Math.pow(Math.sin(a/(2*this.radius)),2)/Math.pow(Math.cos(o),2))*(e>0?1:-1))/Math.PI,-180,180)}else i=t.x;return t.x=i,t.y=r,t},t.prototype.rotate=function(t,e,n){return t=new wn(t),this._rotate(t,e,n)},t.prototype._rotate=function(t,e,n){var i=function(t,e){var n=void 0;n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).final?Nn(e,t):Nn(t,e);return n>180?-(360-n):n}(e,t)-n,r=this.measureLenBetween(e,t);return t.x=e.x,t.y=e.y,function(t,e,n,i){var r=e/i,o=t.x*Math.PI/180,s=b(t.y),a=b(n),h=r*Math.cos(a),u=s+h;Math.abs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u);var l=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),c=Math.abs(l)>1e-11?h/l:Math.cos(s),f=r*Math.sin(a)/c,p=o+f;return t.x=(180*p/Math.PI+540)%360-180,t.y=180*u/Math.PI,t}(t,r,i,this.radius)},t}();function Nn(t,e){var n=b(t.y),i=b(e.y),r=b(e.x-t.x);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(P(Math.atan2(r,o))+360)%360}var Rn=y({measure:"EPSG:4326",sphere:new Ln(6378137),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},Mn),On=y({measure:"BAIDU",sphere:new Ln(6370996.81),measureLenBetween:function(){return this.sphere.measureLenBetween.apply(this.sphere,arguments)},measureArea:function(){return this.sphere.measureArea.apply(this.sphere,arguments)},_locate:function(){return this.sphere._locate.apply(this.sphere,arguments)},locate:function(){return this.sphere.locate.apply(this.sphere,arguments)},_rotate:function(){return this.sphere._rotate.apply(this.sphere,arguments)},rotate:function(){return this.sphere.rotate.apply(this.sphere,arguments)}},Mn),An=Rn,Dn={};function kn(t){Dn[t.measure]=t}kn(Tn),kn(Rn),kn(On);var Fn={getInstance:function(t){if(!t)return An;for(var e in Dn)if(S(Dn,e)){var n=Dn[e].measure;if(!n)continue;if(t.toLowerCase()===n.toLowerCase())return Dn[e]}return null}},Gn=Object.freeze({Identity:Tn,DEFAULT:An,Measurer:Fn,WGS84Sphere:Rn,BaiduSphere:On}),zn=y({},Pn,{code:"EPSG:3857",rad:Math.PI/180,metersPerDegree:6378137*Math.PI/180,maxLatitude:85.0511287798,project:function(t){var e=this.rad,n=this.metersPerDegree,i=this.maxLatitude,r=t.x,o=Math.max(Math.min(i,t.y),-i),s=void 0;return s=0===o?0:Math.log(Math.tan((90+o)*e/2))/e,new wn(r*n,s*n)},unproject:function(t){var e=t.x,n=t.y,i=this.rad,r=this.metersPerDegree,o=void 0;return 0===n?o=0:(o=n/r,o=(2*Math.atan(Math.exp(o*i))-Math.PI/2)/i),new wn(q(e/r,-180,180),q(o,-this.maxLatitude,this.maxLatitude))}},Rn),jn=y({},Pn,{code:"EPSG:4326",project:function(t){return new wn(t)},unproject:function(t){return new wn(t)}},Rn),Bn=y({},jn,{code:"EPSG:4490"}),Hn=y({},Pn,{code:"BAIDU",project:function(t){return this.convertLL2MC(t)},unproject:function(t){return this.convertMC2LL(t)}},On,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],convertMC2LL:function(t){Math.abs(t.x);for(var e=Math.abs(t.y),n=void 0,i=0,r=this.MCBAND.length;i<r;i++)if(e>=this.MCBAND[i]){n=this.MC2LL[i];break}var o=this.convertor(t,n);return new wn(o.x,o.y)},convertLL2MC:function(t){var e,n=void 0,i=void 0;t.x=this.getLoop(t.x,-180,180),t.y=this.getRange(t.y,-74,74);var r=new wn(t.x,t.y);for(i=0,e=this.LLBAND.length;i<e;i++)if(r.y>=this.LLBAND[i]){n=this.LL2MC[i];break}if(!n)for(i=this.LLBAND.length-1;i>=0;i--)if(r.y<=-this.LLBAND[i]){n=this.LL2MC[i];break}var o=this.convertor(t,n);return new wn(o.x,o.y)},convertor:function(t,e){if(!t||!e)return null;var n=e[0]+e[1]*Math.abs(t.x),i=Math.abs(t.y)/e[9],r=e[2]+e[3]*i+e[4]*i*i+e[5]*i*i*i+e[6]*i*i*i*i+e[7]*i*i*i*i*i+e[8]*i*i*i*i*i*i;return n*=t.x<0?-1:1,r*=t.y<0?-1:1,new wn(n,r)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,e,n){return null!=e&&(t=Math.max(t,e)),null!=n&&(t=Math.min(t,n)),t},getLoop:function(t,e,n){for(;t>n;)t-=n-e;for(;t<e;)t+=n-e;return t}}),Vn=y({},Pn,{code:"IDENTITY",project:function(t){return t.copy()},unproject:function(t){return t.copy()}},Tn),qn=zn,Wn=Object.freeze({EPSG3857:zn,DEFAULT:qn,EPSG4326:jn,EPSG4490:Bn,BAIDU:Hn,IDENTITY:Vn,Common:Pn}),Zn=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.registerRenderer=function(t,e){var n=this.prototype,i=Object.getPrototypeOf(n);return n._rendererClasses&&n._rendererClasses!==i._rendererClasses||(n._rendererClasses=n._rendererClasses?Object.create(n._rendererClasses):{}),n._rendererClasses[t.toLowerCase()]=e,this},e.getRendererClass=function(t){var e=this.prototype;return e._rendererClasses?e._rendererClasses[t.toLowerCase()]:null},e}(t)},Un="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:{};function Yn(t,e){return t(e={exports:{}},e.exports),e.exports}var Xn=Yn(function(t){!function(e){function n(t){if(t){var e=this;t(function(t){e.resolve(t)},function(t){e.reject(t)})}}function i(t,e){if("function"==typeof t.y)try{var n=t.y.call(s,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.resolve(e)}function r(t,e){if("function"==typeof t.n)try{var n=t.n.call(s,e);t.p.resolve(n)}catch(e){t.p.reject(e)}else t.p.reject(e)}var o,s,a="fulfilled",h="undefined",u=function(){function t(){for(;n.length-i;){try{n[i]()}catch(t){e.console&&e.console.error(t)}n[i++]=s,i==r&&(n.splice(0,r),i=0)}}var n=[],i=0,r=1024,o=function(){if(("undefined"==typeof MutationObserver?"undefined":c(MutationObserver))!==h){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.setAttribute("a",0)}}return("undefined"==typeof setImmediate?"undefined":c(setImmediate))!==h?function(){setImmediate(t)}:function(){setTimeout(t,0)}}();return function(t){n.push(t),n.length-i==1&&o()}}();n.prototype={resolve:function(t){if(this.state===o){if(t===this)return this.reject(new TypeError("Attempt to resolve promise with self"));var e=this;if(t&&("function"==typeof t||"object"==(void 0===t?"undefined":c(t))))try{var n=!0,r=t.then;if("function"==typeof r)return void r.call(t,function(t){n&&(n=!1,e.resolve(t))},function(t){n&&(n=!1,e.reject(t))})}catch(t){return void(n&&this.reject(t))}this.state=a,this.v=t,e.c&&u(function(){for(var n=0,r=e.c.length;r>n;n++)i(e.c[n],t)})}},reject:function(t){if(this.state===o){this.state="rejected",this.v=t;var i=this.c;i?u(function(){for(var e=0,n=i.length;n>e;e++)r(i[e],t)}):!n.suppressUncaughtRejectionError&&e.console&&e.console.log("You upset Zousan. Please catch rejections: ",t,t?t.stack:null)}},then:function(t,e){var s=new n,h={y:t,n:e,p:s};if(this.state===o)this.c?this.c.push(h):this.c=[h];else{var l=this.state,c=this.v;u(function(){l===a?i(h,c):r(h,c)})}return s},catch:function(t){return this.then(null,t)},finally:function(t){return this.then(t,t)},timeout:function(t,e){e=e||"Timeout";var i=this;return new n(function(n,r){setTimeout(function(){r(Error(e))},t),i.then(function(t){n(t)},function(t){r(t)})})}},n.resolve=function(t){var e=new n;return e.resolve(t),e},n.reject=function(t){var e=new n;return e.reject(t),e},n.all=function(t){function e(e,s){e&&"function"==typeof e.then||(e=n.resolve(e)),e.then(function(e){i[s]=e,++r==t.length&&o.resolve(i)},function(t){o.reject(t)})}for(var i=[],r=0,o=new n,s=0;s<t.length;s++)e(t[s],s);return t.length||o.resolve(i),o},t.exports&&(t.exports=n),e.define&&e.define.amd&&e.define([],function(){return n}),e.Zousan=n,n.soon=u}(Un)}),Jn="undefined"!=typeof Promise?Promise:Xn,Kn=function(t){function e(n){f(this,e);var i=d(this,t.call(this));return i.layer=n,i._painted=!1,i._drawTime=0,i.setToRedraw(),i}return p(e,t),e.prototype.render=function(t){var e=this;if(this.prepareRender(),this.getMap()&&this.layer.isVisible())if(this.resources||(this.resources=new Qn),this.checkResources){var n=this.checkResources();n.length>0?(this._loadingResource=!0,this.loadResources(n).then(function(){e._loadingResource=!1,e.layer&&(e.layer.fire("resourceload"),e.setToRedraw())})):this._tryToDraw(t)}else this._tryToDraw(t)},e.prototype.testIfNeedRedraw=function(){var t=this.getMap();return!this._loadingResource&&(!!this._toRedraw||!(t.isInteracting()&&!this.drawOnInteracting)&&!!this.needToRedraw())},e.prototype.needToRedraw=function(){var t=this.getMap();return!!t.isInteracting()&&!(!t.getPitch()&&t.isMoving()&&!t.isZooming()&&!t.isRotating()&&!this.layer.options.forceRenderOnMoving)},e.prototype.onSkipDrawOnInteracting=function(){},e.prototype.isRenderComplete=function(){return!!this._renderComplete},e.prototype.mustRenderOnInteracting=function(){return!this._painted||this.checkResources&&this.checkResources().length>0},e.prototype.setToRedraw=function(){return this._toRedraw=!0,this},e.prototype.setCanvasUpdated=function(){return this._canvasUpdated=!0,this},e.prototype.isCanvasUpdated=function(){return!!this._canvasUpdated},e.prototype.remove=function(){this.onRemove(),delete this._loadingResource,delete this.southWest,delete this.canvas,delete this.context,delete this.canvasExtent2D,delete this._extent2D,delete this.resources,delete this.layer},e.prototype.onRemove=function(){},e.prototype.onAdd=function(){},e.prototype.getMap=function(){return this.layer?this.layer.getMap():null},e.prototype.getCanvasImage=function(){var t=this.getMap();if(this._canvasUpdated=!1,this._renderZoom!==t.getZoom()||!this.canvas||!this._extent2D)return null;if(this.isBlank())return null;if(this.layer.isEmpty&&this.layer.isEmpty())return null;var e=t._pointToContainerPoint(this.southWest)._add(0,-t.height);return{image:this.canvas,layer:this.layer,point:e}},e.prototype.clear=function(){this.clearCanvas()},e.prototype.isBlank=function(){return!this._painted},e.prototype.show=function(){this.setToRedraw()},e.prototype.hide=function(){this.clear(),this.setToRedraw()},e.prototype.setZIndex=function(){this.setToRedraw()},e.prototype.hitDetect=function(t){if(!this.context||this.layer.isEmpty&&this.layer.isEmpty()||this.isBlank()||this._errorThrown)return!1;var e=this.getMap(),n=he.retina?2:1,i=e.getSize();if(t.x<0||t.x>i.width*n||t.y<0||t.y>i.height*n)return!1;try{if(this.context.getImageData(n*t.x,n*t.y,1,1).data[3]>0)return!0}catch(t){return this._errorThrown||(console&&console.warn("hit detect failed with tainted canvas, some geometries have external resources in another domain:\n",t),this._errorThrown=!0),!1}return!1},e.prototype.loadResources=function(t){this.resources||(this.resources=new Qn);var e=this.resources,n=[];if(Z(t))for(var i={},r=t.length-1;r>=0;r--){var o=t[r];o&&o.length&&!i[o.join("-")]&&(i[o.join("-")]=1,e.isResourceLoaded(o,!0)||n.push(new Jn(this._promiseResource(o))))}return Jn.all(n)},e.prototype.prepareRender=function(){delete this._renderComplete;var t=this.getMap();this._renderZoom=t.getZoom(),this.canvasExtent2D=this._extent2D=t._get2DExtent(),this.southWest=t._containerPointToPoint(new le(0,t.height))},e.prototype.createCanvas=function(){if(!this.canvas){var t=this.getMap(),e=t.getSize(),n=he.retina?2:1,i=n*e.width,r=n*e.height;if(this.layer._canvas){var o=this.layer._canvas;o.width=i,o.height=r,o.style&&(o.style.width=e.width+"px",o.style.height=e.height+"px"),this.canvas=this.layer._canvas}else this.canvas=sn.createCanvas(i,r,t.CanvasClass);this.onCanvasCreate()}},e.prototype.onCanvasCreate=function(){},e.prototype.createContext=function(){if(!(this.gl&&this.gl.canvas===this.canvas||this.context)&&(this.context=this.canvas.getContext("2d"),this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation),he.retina)){this.context.scale(2,2)}},e.prototype.resetCanvasTransform=function(){if(this.context){var t=he.retina?2:1;this.context.setTransform(t,0,0,t,0,0)}},e.prototype.resizeCanvas=function(t){var e=this.canvas;if(e){var n=t||this.getMap().getSize(),i=he.retina?2:1;e.width===i*n.width&&e.height===i*n.height||(e.height=i*n.height,e.width=i*n.width,he.retina&&this.context&&this.context.scale(i,i),this.layer._canvas&&e.style&&(e.style.width=n.width+"px",e.style.height=n.height+"px"))}},e.prototype.clearCanvas=function(){this.context&&sn.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},e.prototype.prepareCanvas=function(){this.canvas?(this.clearCanvas(),this.resizeCanvas(),this.resetCanvasTransform()):(this.createCanvas(),this.createContext(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})),delete this._maskExtent;var t=this.layer.getMask();if(!t)return this.layer.fire("renderstart",{context:this.context,gl:this.gl}),null;var e=this._maskExtent=t._getPainter().get2DExtent();return e.intersects(this._extent2D),this.layer.fire("renderstart",{context:this.context,gl:this.gl}),e},e.prototype.clipCanvas=function(t){var e=this.layer.getMask();if(!e)return!1;var n=this.southWest,i=this.getMap();return this.southWest=i._containerPointToPoint(new le(0,i.height)),t.save(),he.retina&&(t.save(),t.scale(2,2)),e._getPainter().paint(null,t),he.retina&&t.restore(),t.clip(),this.southWest=n,!0},e.prototype.getViewExtent=function(){return{extent:this._extent2D,maskExtent:this._maskExtent,zoom:this._renderZoom,southWest:this.southWest}},e.prototype.completeRender=function(){this.getMap()&&(this._renderComplete=!0,this.layer.fire("renderend",{context:this.context,gl:this.gl}),this.setCanvasUpdated())},e.prototype.getEvents=function(){return{_zoomstart:this.onZoomStart,_zooming:this.onZooming,_zoomend:this.onZoomEnd,_resize:this.onResize,_movestart:this.onMoveStart,_moving:this.onMoving,_moveend:this.onMoveEnd,_dragrotatestart:this.onDragRotateStart,_dragrotating:this.onDragRotating,_dragrotateend:this.onDragRotateEnd,_spatialreferencechange:this.onSpatialReferenceChange}},e.prototype.onZoomStart=function(){},e.prototype.onZoomEnd=function(){this.setToRedraw()},e.prototype.onZooming=function(){},e.prototype.onMoveStart=function(){},e.prototype.onMoving=function(){},e.prototype.onMoveEnd=function(){this.setToRedraw()},e.prototype.onResize=function(){delete this._extent2D,this.resizeCanvas(),this.setToRedraw()},e.prototype.onDragRotateStart=function(){},e.prototype.onDragRotating=function(){},e.prototype.onDragRotateEnd=function(){this.setToRedraw()},e.prototype.onSpatialReferenceChange=function(){},e.prototype.getDrawTime=function(){return this._drawTime},e.prototype._tryToDraw=function(t){this._toRedraw=!1,!this.canvas&&this.layer.isEmpty&&this.layer.isEmpty()?this._renderComplete=!0:this._drawAndRecord(t)},e.prototype._drawAndRecord=function(t){if(this.getMap()){var e=this._painted;this._painted=!0;var n=g();this.draw(t),n=g()-n,this._drawTime=e?n:n/2,e&&this.layer.options.logDrawTime&&console.log(this.layer.getId(),"frameTimeStamp:",t,"drawTime:",this._drawTime)}},e.prototype._promiseResource=function(t){var e=this,n=this.resources,i=this.layer.options.crossOrigin;return function(r){if(n.isResourceLoaded(t,!0))r(t);else{var o=new Image;m(i)||(o.crossOrigin=i),N(t[0])&&!M&&(t[1]&&(t[1]*=2),t[2]&&(t[2]*=2)),o.onload=function(){e._cacheResource(t,o),r(t)},o.onabort=function(e){console&&console.warn("image loading aborted: "+t[0]),e&&console&&console.warn(e),r(t)},o.onerror=function(e){e&&"undefined"!=typeof console&&console.warn(e),n.markErrorResource(t),r(t)},R(o,t)}}},e.prototype._cacheResource=function(t,e){if(this.layer&&this.resources){var n=t[1],i=t[2];if(this.layer.options.cacheSvgOnCanvas&&1===N(t[0])&&(he.edge||he.ie)){m(n)&&(n=e.width||this.layer.options.defaultIconSize[0]),m(i)&&(i=e.height||this.layer.options.defaultIconSize[1]);var r=sn.createCanvas(n,i);sn.image(r.getContext("2d"),e,0,0,n,i),e=r}this.resources.addResource(t,e)}},e}(dn),Qn=function(){function t(){f(this,t),this.resources={},this._errors={}}return t.prototype.addResource=function(t,e){this.resources[t[0]]={image:e,width:+t[1],height:+t[2]}},t.prototype.isResourceLoaded=function(t,e){if(!t)return!1;var n=this._getImgUrl(t);if(this._errors[n])return!0;var i=this.resources[n];return!!i&&!(e&&N(t[0])&&(+t[1]>i.width||+t[2]>i.height))},t.prototype.getImage=function(t){var e=this._getImgUrl(t);return!this.isResourceLoaded(t)||this._errors[e]?null:this.resources[e].image},t.prototype.markErrorResource=function(t){this._errors[this._getImgUrl(t)]=1},t.prototype.merge=function(t){if(!t)return this;for(var e in t.resources){var n=t.resources[e];this.addResource([e,n.width,n.height],n.image)}return this},t.prototype.forEach=function(t){if(!this.resources)return this;for(var e in this.resources)S(this.resources,e)&&t(e,this.resources[e]);return this},t.prototype._getImgUrl=function(t){return Array.isArray(t)?t[0]:t},t}(),$n=function(t){function e(n,i){f(this,e);var r=void 0;i&&(r=i.canvas,delete i.canvas);var o=d(this,t.call(this,i));return r&&(o._canvas=r),o.setId(n),i&&o.setZIndex(i.zIndex),o}return p(e,t),e.prototype.load=function(){if(!this.getMap())return this;if(this.onLoad()){this._initRenderer();var t=this.getZIndex();m(t)||(this._renderer.setZIndex(t),this.isCanvasRender()||this._renderer.render()),this.onLoadEnd()}return this},e.prototype.getId=function(){return this._id},e.prototype.setId=function(t){var e=this._id;return m(t)||(t+=""),this._id=t,this.fire("idchange",{old:e,new:t}),this},e.prototype.addTo=function(t){return t.addLayer(this),this},e.prototype.setZIndex=function(t){return this._zIndex=t,this.map&&this.map._sortLayersByZIndex(),this._renderer&&this._renderer.setZIndex(t),this},e.prototype.getZIndex=function(){return this._zIndex||0},e.prototype.getMinZoom=function(){var t=this.getMap(),e=this.options.minZoom;return t?Math.max(t.getMinZoom(),e||0):e},e.prototype.getMaxZoom=function(){var t=this.getMap(),e=this.options.maxZoom;return t?Math.min(t.getMaxZoom(),m(e)?1/0:e):e},e.prototype.getOpacity=function(){return this.options.opacity},e.prototype.setOpacity=function(t){return this.config("opacity",t),this},e.prototype.isCanvasRender=function(){var t=this._getRenderer();return t&&t instanceof Kn},e.prototype.getMap=function(){return this.map?this.map:null},e.prototype.getProjection=function(){var t=this.getMap();return t?t.getProjection():null},e.prototype.bringToFront=function(){var t=this._getLayerList();if(!t.length)return this;var e=t[t.length-1];if(1===t.length||e===this)return this;var n=e.getZIndex();return this.setZIndex(n+1),this},e.prototype.bringToBack=function(){var t=this._getLayerList();if(!t.length)return this;var e=t[0];if(1===t.length||e===this)return this;var n=e.getZIndex();return this.setZIndex(n-1),this},e.prototype.show=function(){var t=this;if(!this.options.visible){this.options.visible=!0;var e=this.getRenderer();e&&e.show();var n=this.getMap();e&&n?n.once("renderend",function(){t.fire("show")}):this.fire("show")}return this},e.prototype.hide=function(){var t=this;if(this.options.visible){this.options.visible=!1;var e=this.getRenderer();e&&e.hide();var n=this.getMap();e&&n?n.once("renderend",function(){t.fire("hide")}):this.fire("hide")}return this},e.prototype.isVisible=function(){if(v(this.options.opacity)&&this.options.opacity<=0)return!1;var t=this.getMap();if(t){var e=t.getZoom();if(!m(this.options.maxZoom)&&this.options.maxZoom<e||!m(this.options.minZoom)&&this.options.minZoom>e)return!1}return m(this.options.visible)&&(this.options.visible=!0),this.options.visible},e.prototype.remove=function(){return this.map&&this.map.removeLayer(this),this},e.prototype.getMask=function(){return this._mask},e.prototype.setMask=function(t){if(!("Point"===t.type&&t._isVectorMarker()||"Polygon"===t.type))throw new Error("Mask for a layer must be a marker with vector marker symbol or a Polygon.");if("Point"===t.type?t.updateSymbol({markerLineColor:"rgba(0, 0, 0, 0)",markerFillOpacity:0}):t.setSymbol({lineColor:"rgba(0, 0, 0, 0)",polygonOpacity:0}),t._bindLayer(this),this._mask=t,!this.getMap()||this.getMap().isZooming())return this;var e=this._getRenderer();return e&&e.setToRedraw&&this._getRenderer().setToRedraw(),this},e.prototype.removeMask=function(){if(delete this._mask,!this.getMap()||this.getMap().isZooming())return this;var t=this._getRenderer();return t&&t.setToRedraw&&this._getRenderer().setToRedraw(),this},e.prototype.onLoad=function(){return!0},e.prototype.onLoadEnd=function(){},e.prototype.isLoaded=function(){return!!this._loaded},e.prototype.getRenderer=function(){return this._getRenderer()},e.prototype.onConfig=function(t){if(v(t.opacity)||t.cssFilter){var e=this.getRenderer();e&&e.setToRedraw()}},e.prototype.onAdd=function(){},e.prototype.onRemove=function(){},e.prototype._bindMap=function(t,e){t&&(this.map=t,m(e)||this.setZIndex(e),this._switchEvents("on",this),this.onAdd(),this.fire("add"))},e.prototype._initRenderer=function(){var t=this.options.renderer;if(this.constructor.getRendererClass){var e=this.constructor.getRendererClass(t);if(!e)throw new Error("Invalid renderer for Layer("+this.getId()+"):"+t);this._renderer=new e(this),this._renderer.layer=this,this._renderer.setZIndex(this.getZIndex()),this._switchEvents("on",this._renderer),this._renderer.onAdd&&this._renderer.onAdd(),this.fire("renderercreate",{renderer:this._renderer})}},e.prototype._doRemove=function(){this._loaded=!1,this.onRemove(),this._switchEvents("off",this),this._renderer&&(this._switchEvents("off",this._renderer),this._renderer.remove(),delete this._renderer),delete this._mask,delete this.map},e.prototype._switchEvents=function(t,e){e&&e.getEvents&&this.getMap()[t](e.getEvents(),e)},e.prototype._getRenderer=function(){return this._renderer},e.prototype._getLayerList=function(){return this.map?this.map._layers:[]},e.prototype._getMask2DExtent=function(){if(!this._mask||!this.getMap())return null;var t=this._mask._getPainter();return t?t.get2DExtent():null},e}(yn(cn(Zn(dn))));$n.mergeOptions({attribution:null,minZoom:null,maxZoom:null,visible:!0,opacity:1,globalCompositeOperation:null,renderer:"canvas",debugOutline:"#0f0",cssFilter:null,forceRenderOnMoving:!1,forceRenderOnZooming:!1,forceRenderOnRotating:!1});var ti=$n.prototype.fire;$n.prototype.fire=function(t,e){return"layerload"===t&&(this._loaded=!0),this.map&&(e||(e={}),e.type=t,e.target=this,this.map._onLayerEvent(e)),ti.apply(this,arguments)};var ei={"EPSG:3857":{resolutions:function(){for(var t=[],e=12756274*Math.PI,n=0;n<21;n++)t[n]=e/(256*Math.pow(2,n));return t}(),fullExtent:{top:6378137*Math.PI,left:-6378137*Math.PI,bottom:-6378137*Math.PI,right:6378137*Math.PI}},"EPSG:4326":{fullExtent:{top:90,left:-180,bottom:-90,right:180},resolutions:function(){for(var t=[],e=0;e<20;e++)t[e]=180/(128*Math.pow(2,e));return t}()},BAIDU:{resolutions:function(){for(var t=Math.pow(2,18),e=[],n=0;n<20;n++)e[n]=t,t*=.5;return e[0]=null,e[1]=null,e[2]=null,e}(),fullExtent:{top:33554432,left:-33554432,bottom:-33554432,right:33554432}},IDENTITY:{resolutions:function(){for(var t=Math.pow(2,8),e=[],n=0;n<18;n++)e[n]=t,t*=.5;return e}(),fullExtent:{top:2e5,left:-2e5,bottom:-2e5,right:2e5}}};ei["EPSG:4490"]=ei["EPSG:4326"];var ni=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,t),this.options=e,this._initSpatialRef()}return t.getProjectionInstance=function(t){if(!t)return null;if(x(t))return t;for(var e in t=(t+"").toLowerCase(),Wn)if(S(Wn,e)){var n=Wn[e].code;if(n&&n.toLowerCase()===t)return Wn[e]}return null},t.equals=function(t,e){if(!t&&!e)return!0;if(!t||!e)return!1;if(t.projection!==e.projection)return!1;var n=t.fullExtent,i=e.fullExtent;if(n&&i&&(n.top!==i.top||n.bottom!==i.bottom||n.left!==i.left||n.right!==i.right))return!1;var r=t.resolutions,o=e.resolutions;if(r&&o){if(r.length!==o.length)return!1;for(var s=0;s<r.length;s++)if(r[s]!==o[s])return!1}return!0},t.prototype._initSpatialRef=function(){var e=this.options.projection;if(!(e=e?t.getProjectionInstance(e):qn))throw new Error("must provide a valid projection in map's spatial reference.");(e=y({},Pn,e)).measureLength||y(e,Fn.DEFAULT),this._projection=e;var n=void 0,i=this.options.resolutions;if(!i&&(e.code&&(n=ei[e.code])&&(i=n.resolutions),!i))throw new Error("must provide valid resolutions in map's spatial reference.");this._resolutions=i;var r=this.options.fullExtent;if(!r&&(e.code&&(n=ei[e.code])&&(r=n.fullExtent),!r))throw new Error("must provide a valid fullExtent in map's spatial reference.");if(m(r.left)?(this._fullExtent=new Sn(r),r.left=r.xmin,r.right=r.xmax,r.top=r.ymax,r.bottom=r.ymin):this._fullExtent=new Sn(new wn(r.left,r.top),new wn(r.right,r.bottom)),m(r.top)||m(r.bottom)||m(r.left)||m(r.right))throw new Error("must provide valid top/bottom/left/right in fullExtent.");y(this._fullExtent,r),this._projection.fullExtent=r;var o=r.right>=r.left?1:-1,s=r.top>=r.bottom?-1:1;this._transformation=new bn([o,s,0,0])},t.prototype.getResolutions=function(){return this._resolutions||[]},t.prototype.getResolution=function(t){var e=0|t;e<0?e=0:e>this._resolutions.length-1&&(e=this._resolutions.length-1);var n=this._resolutions[e];return _(t)||e===this._resolutions.length-1?n:n+(this._resolutions[e+1]-n)*(t-e)},t.prototype.getProjection=function(){return this._projection},t.prototype.getFullExtent=function(){return this._fullExtent},t.prototype.getTransformation=function(){return this._transformation},t.prototype.getMinZoom=function(){for(var t=0;t<this._resolutions.length;t++)if(!m(this._resolutions[t]))return t;return 0},t.prototype.getMaxZoom=function(){for(var t=this._resolutions.length-1;t>=0;t--)if(!m(this._resolutions[t]))return t;return this._resolutions.length-1},t.prototype.getZoomDirection=function(){return B(this._resolutions[this.getMinZoom()]-this._resolutions[this.getMaxZoom()])},t.prototype.toJSON=function(){return this.json||(this.json={resolutions:this._resolutions,fullExtent:{top:this._fullExtent.top,left:this._fullExtent.left,bottom:this._fullExtent.bottom,right:this._fullExtent.right},projection:this._projection.code}),this.json},t}(),ii={maxVisualPitch:60,maxPitch:80,centerCross:!1,zoomInCenter:!1,zoomAnimation:!M,zoomAnimationDuration:330,panAnimation:!M,panAnimationDuration:600,zoomable:!0,enableInfoWindow:!0,hitDetect:!he.mobile,hitDetectLimit:5,fpsOnInteracting:25,layerCanvasLimitOnInteracting:-1,maxZoom:null,minZoom:null,maxExtent:null,checkSize:!0,renderer:"canvas"},ri=function(t){function e(n,i){if(f(this,e),!i)throw new Error("Invalid options when creating map.");if(!i.center)throw new Error("Invalid center when creating map.");var r=y({},i),o=r.zoom;delete r.zoom;var s=new wn(r.center);delete r.center;var a=r.baseLayer;delete r.baseLayer;var h=r.layers;delete r.layers;var u=d(this,t.call(this,r));return Object.defineProperty(u,"id",{value:A(),writable:!1}),u._loaded=!1,u._initContainer(n),u._panels={},u._baseLayer=null,u._layers=[],u._zoomLevel=o,u._center=s,u.setSpatialReference(r.spatialReference||r.view),u._mapViewPoint=new le(0,0),u._initRenderer(),u._updateMapSize(u._getContainerDomSize()),a&&u.setBaseLayer(a),h&&u.addLayer(h),u._Load(),u}return p(e,t),e.addOnLoadHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._onLoadHooks=this.prototype._onLoadHooks||[],this.prototype._onLoadHooks.push(n),this},e.prototype.isLoaded=function(){return!!this._loaded},e.prototype.getContainer=function(){return this._containerDOM},e.prototype.getSpatialReference=function(){return this._spatialReference},e.prototype.setSpatialReference=function(t){var e=this.options.spatialReference;if(this._loaded&&ni.equals(e,t))return this;if(t=y({},t),this._center=this.getCenter(),this.options.spatialReference=t,this._spatialReference=new ni(t),this.options.spatialReference&&C(this.options.spatialReference.projection)){var n=this._spatialReference.getProjection();this.options.spatialReference.projection=n.code}return this._resetMapStatus(),this._fireEvent("spatialreferencechange",{old:e,new:y({},this.options.spatialReference)}),this},e.prototype.onConfig=function(t){var e=t.spatialReference||t.view;return m(e)||this.setSpatialReference(e),this},e.prototype.getProjection=function(){return this._spatialReference?this._spatialReference.getProjection():null},e.prototype.getFullExtent=function(){return this._spatialReference?this._spatialReference.getFullExtent():null},e.prototype.setCursor=function(t){return delete this._cursor,this._trySetCursor(t),this._cursor=t,this},e.prototype.resetCursor=function(){return this.setCursor(null)},e.prototype.getCenter=function(){return this._loaded&&this._prjCenter?this.getProjection().unproject(this._prjCenter):this._center},e.prototype.setCenter=function(t){if(!t)return this;if(t=new wn(t),!this._verifyExtent(t))return this;if(!this._loaded)return this._center=t,this;this.onMoveStart();var e=this.getProjection().project(t);return this._setPrjCenter(e),this.onMoveEnd(this._parseEventFromCoord(this.getCenter())),this},e.prototype.getSize=function(){return m(this.width)||m(this.height)?this._getContainerDomSize():new ce(this.width,this.height)},e.prototype.getContainerExtent=function(){var t=this.height,e=this.getPitch(),n=this.options.maxVisualPitch;return n&&e>n&&(t=this._getVisualHeight(n)),new In(0,this.height-t,this.width,this.height)},e.prototype._getVisualHeight=function(t){var e=this.getPitch(),n=this.height/2*Math.tan(t*Math.PI/180);return this.height/2+n*Math.tan((90-e)*Math.PI/180)},e.prototype.getExtent=function(){return this._pointToExtent(this._get2DExtent())},e.prototype.getProjExtent=function(){var t=this._get2DExtent();return new Sn(this._pointToPrj(t.getMin()),this._pointToPrj(t.getMax()))},e.prototype.getPrjExtent=function(){return this.getProjExtent()},e.prototype.getMaxExtent=function(){return this.options.maxExtent?new Sn(this.options.maxExtent,this.getProjection()):null},e.prototype.setMaxExtent=function(t){if(t){var e=new Sn(t,this.getProjection());this.options.maxExtent=e;var n=this.getCenter();this._verifyExtent(n)||this.panTo(e.getCenter())}else delete this.options.maxExtent;return this},e.prototype.getZoom=function(){return this._zoomLevel},e.prototype.getZoomForScale=function(t,e,n){var i=this.getZoom();if(m(e)&&(e=i),1===t&&e===i)return i;var r=this._getResolution(e)/t,o=this.getZoomFromRes(r);if(n)return o;return this.getSpatialReference().getZoomDirection()<0?Math.ceil(o-1e-6):Math.floor(o+1e-6)},e.prototype.getZoomFromRes=function(t){var e=this._getResolutions(),n=this._getResolution(this.getMinZoom()),i=this._getResolution(this.getMaxZoom());if(n<=i){if(t<=n)return this.getMinZoom();if(t>=i)return this.getMaxZoom()}else{if(t>=n)return this.getMinZoom();if(t<=i)return this.getMaxZoom()}for(var r=e.length,o=0;o<r-1;o++)if(e[o]){var s=e[o+1]-e[o],a=t-e[o];if(B(s)===B(a)&&Math.abs(s)>=Math.abs(a))return o+a/s}return r-1},e.prototype.setZoom=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{animation:!0};return isNaN(t)||m(t)?this:(this._loaded&&this.options.zoomAnimation&&e.animation?this._zoomAnimation(t):this._zoom(t),this)},e.prototype.getMaxZoom=function(){return m(this.options.maxZoom)?this.getMaxNativeZoom():this.options.maxZoom},e.prototype.setMaxZoom=function(t){var e=this.getMaxNativeZoom();return t>e&&(t=e),null!==t&&t<this._zoomLevel&&this.setZoom(t),this.options.maxZoom=t,this},e.prototype.getMinZoom=function(){return m(this.options.minZoom)?this._spatialReference.getMinZoom():this.options.minZoom},e.prototype.setMinZoom=function(t){if(null!==t){var e=this._spatialReference.getMinZoom();t<e&&(t=e),t>this._zoomLevel&&this.setZoom(t)}return this.options.minZoom=t,this},e.prototype.getMaxNativeZoom=function(){var t=this.getSpatialReference();return t?t.getMaxZoom():null},e.prototype.getGLZoom=function(){return this.getMaxNativeZoom()/2},e.prototype.getGLScale=function(t){return m(t)&&(t=this.getZoom()),this.getScale(t)/this.getScale(this.getGLZoom())},e.prototype.zoomIn=function(){return this.setZoom(this.getZoom()+1)},e.prototype.zoomOut=function(){return this.setZoom(this.getZoom()-1)},e.prototype.isZooming=function(){return!!this._zooming},e.prototype.isInteracting=function(){return this.isZooming()||this.isMoving()||this.isRotating()},e.prototype.setCenterAndZoom=function(t,e){return m(e)||this._zoomLevel===e?this.setCenter(t):(this.setCenter(t),this.setZoom(e,{animation:!1})),this},e.prototype.getFitZoom=function(t){var e=this;if(!(t&&t instanceof Sn))return this._zoomLevel;if(t.xmin===t.xmax&&t.ymin===t.ymax)return this.getMaxZoom();var n=this.getSize(),i=t.convertTo(function(t){return e.coordToContainerPoint(t)}),r=i.getWidth(),o=i.getHeight(),s=n.width/r,a=n.height/o,h=this.getSpatialReference().getZoomDirection()<0?Math.max(s,a):Math.min(s,a);return this.getZoomForScale(h)},e.prototype.getView=function(){return{center:this.getCenter().toArray(),zoom:this.getZoom(),pitch:this.getPitch(),bearing:this.getBearing()}},e.prototype.setView=function(t){return t?(t.center&&this.setCenter(t.center),t.zoom&&this.setZoom(t.zoom,{animation:!1}),t.pitch&&this.setPitch(t.pitch),t.bearing&&this.setBearing(t.bearing),this):this},e.prototype.getResolution=function(t){return this._getResolution(t)},e.prototype.getScale=function(t){var e=m(t)?this.getZoom():t,n=this._getResolution(this.getMaxNativeZoom());return this._getResolution(e)/n},e.prototype.fitExtent=function(t,e){if(!t)return this;t=new Sn(t,this.getProjection());var n=this.getFitZoom(t)+(e||0),i=t.getCenter();return this.setCenterAndZoom(i,n)},e.prototype.getBaseLayer=function(){return this._baseLayer},e.prototype.setBaseLayer=function(t){var e=!1;if(this._baseLayer&&(e=!0,this._fireEvent("baselayerchangestart"),this._baseLayer.remove()),!t)return delete this._baseLayer,this._fireEvent("baselayerchangeend"),this._fireEvent("setbaselayer"),this;return this._baseLayer=t,t._bindMap(this,-1),this._baseLayer.on("layerload",function(){this._fireEvent("baselayerload"),e&&(e=!1,this._fireEvent("baselayerchangeend"))},this),this._loaded&&this._baseLayer.load(),this._fireEvent("setbaselayer"),this},e.prototype.removeBaseLayer=function(){return this._baseLayer&&(this._baseLayer.remove(),delete this._baseLayer,this._fireEvent("baselayerremove")),this},e.prototype.getLayers=function(t){return this._getLayers(function(e){return!(e===this._baseLayer||e.getId().indexOf(r)>=0)&&(!t||t(e))})},e.prototype.getLayer=function(t){if(!t)return null;var e=this._layerCache?this._layerCache[t]:null;if(e)return e;var n=this.getBaseLayer();return n&&n.getId()===t?n:null},e.prototype.addLayer=function(t){if(!t)return this;if(!Array.isArray(t))return t=Array.prototype.slice.call(arguments,0),this.addLayer(t);this._layerCache||(this._layerCache={});for(var e=this._layers,n=0,i=t.length;n<i;n++){var r=t[n],o=r.getId();if(m(o))throw new Error("Invalid id for the layer: "+o);if(r.getMap()!==this){if(this._layerCache[o])throw new Error("Duplicate layer id in the map: "+o);this._layerCache[o]=r,r._bindMap(this),e.push(r),this._loaded&&r.load()}}return this._sortLayersByZIndex(),this._fireEvent("addlayer",{layers:t}),this},e.prototype.removeLayer=function(t){if(!t)return this;if(!Array.isArray(t))return this.removeLayer([t]);for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(r instanceof $n||(r=this.getLayer(r)),r){var o=r.getMap();if(o&&o===this){e.push(r),this._removeLayer(r,this._layers),this._loaded&&r._doRemove();var s=r.getId();this._layerCache&&delete this._layerCache[s]}}}return e.length>0&&this.once("frameend",function(){e.forEach(function(t){t.fire("remove")})}),this._fireEvent("removelayer",{layers:t}),this},e.prototype.sortLayers=function(t){if(!t||!Array.isArray(t))return this;for(var e=[],n=Number.MAX_VALUE,i=0,r=t.length;i<r;i++){var o=t[i];if(w(t[i])&&(o=this.getLayer(o)),!(o instanceof $n&&o.getMap()&&o.getMap()===this))throw new Error("It must be a layer added to this map to order.");o.getZIndex()<n&&(n=o.getZIndex()),e.push(o)}for(var s=0,a=e.length;s<a;s++)e[s].setZIndex(n+s);return this},e.prototype.toDataURL=function(t){t||(t={});var e=t.mimeType;e||(e="image/png");var n=t.save,i=this._getRenderer();if(i&&i.toDataURL){var r=t.fileName;r||(r="export");var o=i.toDataURL(e);if(n&&o){var s=void 0;if("undefined"!=typeof Blob&&"undefined"!=typeof atob){var a=tt(o.replace(/^data:image\/(png|jpeg|jpg);base64,/,""),e);s=URL.createObjectURL(a)}else s=o;var h=document.createElement("a");h.download=r,h.href=s,document.body.appendChild(h),h.click(),document.body.removeChild(h)}return o}return null},e.prototype.coordinateToPoint=function(t,e){var n=this.getProjection().project(t);return this._prjToPoint(n,e)},e.prototype.coordToPoint=function(t,e){return this.coordinateToPoint(t,e)},e.prototype.pointToCoordinate=function(t,e){var n=this._pointToPrj(t,e);return this.getProjection().unproject(n)},e.prototype.pointToCoord=function(t,e){return this.pointToCoordinate(t,e)},e.prototype.coordinateToViewPoint=function(t){return this._prjToViewPoint(this.getProjection().project(t))},e.prototype.coordToViewPoint=function(t){return this.coordinateToViewPoint(t)},e.prototype.viewPointToCoordinate=function(t){return this.getProjection().unproject(this._viewPointToPrj(t))},e.prototype.viewPointToCoord=function(t){return this.viewPointToCoordinate(t)},e.prototype.coordinateToContainerPoint=function(t,e){var n=this.getProjection().project(t);return this._prjToContainerPoint(n,e)},e.prototype.coordToContainerPoint=function(t,e){return this.coordinateToContainerPoint(t,e)},e.prototype.containerPointToCoordinate=function(t){var e=this._containerPointToPrj(t);return this.getProjection().unproject(e)},e.prototype.containerPointToCoord=function(t){return this.containerPointToCoordinate(t)},e.prototype.containerPointToViewPoint=function(t){return t.sub(this.getViewPoint())},e.prototype.viewPointToContainerPoint=function(t){return t.add(this.getViewPoint())},e.prototype.containerToExtent=function(t){var e=new In(this._containerPointToPoint(t.getMin()),this._containerPointToPoint(t.getMax()));return this._pointToExtent(e)},e.prototype.checkSize=function(){var t=g()-this._initTime<1500&&0===this.width||0===this.height,e=this._getContainerDomSize(),n=this.height,i=this.width;if(e.width===i&&e.height===n)return this;var r=this.getCenter();this._updateMapSize(e);var o=new le((i-e.width)/2,(n-e.height)/2);this._offsetCenterByPixel(o),this._mapViewCoord=this._getPrjCenter();var s=0===e.width||0===e.height||0===i||0===n;return(t||s)&&(this._noEvent=!0,this.setCenter(r),delete this._noEvent),this._fireEvent("resize"),this},e.prototype.distanceToPixel=function(t,e,n){var i=this.getProjection();if(!i)return null;var r=this.getScale()/this.getScale(n),o=this.getCenter(),s=i.locate(o,t,e),a=this.coordToContainerPoint(o),h=this.coordToContainerPoint(s);return h._sub(a)._multi(r)._abs(),new ce(h.x,h.y)},e.prototype.distanceToPoint=function(t,e,n){var i=this.getProjection();if(!i)return null;var r=this.getCenter(),o=i.locate(r,t,e),s=this.coordToPoint(r,n),a=this.coordToPoint(o,n);return a._sub(s)._abs(),a},e.prototype.pixelToDistance=function(t,e){var n=this.getProjection();if(!n)return null;var i=this.getFullExtent(),r=i.top>i.bottom?-1:1,o=new le(this.width/2+t,this.height/2+r*e),s=this.containerPointToCoord(o);return n.measureLength(this.getCenter(),s)},e.prototype.pointToDistance=function(t,e,n){var i=this.getProjection();if(!i)return null;var r=this._prjToPoint(this._getPrjCenter(),n);r._add(t,e);var o=this.pointToCoord(r,n);return i.measureLength(this.getCenter(),o)},e.prototype.locate=function(t,e,n){return this.getProjection()._locate(new wn(t),e,n)},e.prototype.locateByPoint=function(t,e,n){var i=this.coordToContainerPoint(t);return this.containerPointToCoord(i._add(e,n))},e.prototype.getMainPanel=function(){return this._getRenderer().getMainPanel()},e.prototype.getPanels=function(){return this._panels},e.prototype.remove=function(){if(this.isRemoved())return this;this._fireEvent("removestart"),this._removeDomEvents(),this._clearHandlers(),this.removeBaseLayer();for(var t=this.getLayers(),e=0;e<t.length;e++)t[e].remove();return this._getRenderer()&&this._getRenderer().remove(),this._containerDOM.innerHTML&&(this._containerDOM.innerHTML=""),delete this._panels,delete this._containerDOM,delete this.renderer,this._fireEvent("removeend"),this._clearAllListeners(),this},e.prototype.isRemoved=function(){return!this._containerDOM},e.prototype.isMoving=function(){return!!this._moving},e.prototype.onMoveStart=function(t){this._originCenter=this.getCenter(),this._moving=!0,this._trySetCursor("move"),this._fireEvent("movestart",this._parseEvent(t?t.domEvent:null,"movestart"))},e.prototype.onMoving=function(t){this._fireEvent("moving",this._parseEvent(t?t.domEvent:null,"moving"))},e.prototype.onMoveEnd=function(t){if(this._moving=!1,this._trySetCursor("default"),this._fireEvent("moveend",t&&t.domEvent?this._parseEvent(t.domEvent,"moveend"):t),!this._verifyExtent(this.getCenter())){var e=this._originCenter;this._verifyExtent(e)||(e=this.getMaxExtent().getCenter()),this.panTo(e)}},e.prototype.onDragRotateStart=function(t){this._dragRotating=!0,this._fireEvent("dragrotatestart",this._parseEvent(t?t.domEvent:null,"dragrotatestart"))},e.prototype.onDragRotating=function(t){this._fireEvent("dragrotating",this._parseEvent(t?t.domEvent:null,"dragrotating"))},e.prototype.onDragRotateEnd=function(t){this._dragRotating=!1,this._fireEvent("dragrotateend",this._parseEvent(t?t.domEvent:null,"dragrotateend"))},e.prototype.isDragRotating=function(){return!!this._dragRotating},e.prototype.getRenderer=function(){return this._getRenderer()},e.prototype._initContainer=function(t){if(w(t)){if(this._containerDOM=document.getElementById(t),!this._containerDOM)throw new Error("Invalid container when creating map: '"+t+"'")}else this._containerDOM=t,M&&(this.CanvasClass=this._containerDOM.constructor);if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&"maptalks-wrapper"===this._containerDOM.childNodes[0].className)throw new Error("Container is already loaded with another map instance, use map.remove() to clear it.")},e.prototype._trySetCursor=function(t){return this._cursor||this._priorityCursor||(t||(t="default"),this._setCursorToPanel(t)),this},e.prototype._setPriorityCursor=function(t){if(t)this._priorityCursor=t,this._setCursorToPanel(t);else{var e=!1;this._priorityCursor&&(e=!0),delete this._priorityCursor,e&&this.setCursor(this._cursor)}return this},e.prototype._setCursorToPanel=function(t){var e=this.getMainPanel();e&&e.style&&e.style.cursor!==t&&(e.style.cursor=t)},e.prototype._get2DExtent=function(t){var e=this;return this.getContainerExtent().convertTo(function(n){return e._containerPointToPoint(n,t)})},e.prototype._pointToExtent=function(t){var e=t.getMin(),n=t.getMax(),i=this.getFullExtent(),r=!i||i.left<=i.right?[e.x,n.x]:[n.x,e.x],o=r[0],s=r[1],a=!i||i.top>i.bottom?[n.y,e.y]:[e.y,n.y],h=a[1],u=new wn(o,a[0]),l=new wn(s,h);return new Sn(this.pointToCoord(u),this.pointToCoord(l),this.getProjection())},e.prototype._removeLayer=function(t,e){if(t&&e){var n=e.indexOf(t);n>-1&&e.splice(n,1)}},e.prototype._sortLayersByZIndex=function(){if(this._layers){for(var t=0,e=this._layers.length;t<e;t++)this._layers[t]._order=t;this._layers.sort(function(t,e){var n=t.getZIndex()-e.getZIndex();return 0===n?t._order-e._order:n})}},e.prototype._fireEvent=function(t,e){this._noEvent||(this.fire("_"+t,e),this.fire(t,e))},e.prototype._Load=function(){this._resetMapStatus(),this.options.pitch&&(this.setPitch(this.options.pitch),delete this.options.pitch),this.options.bearing&&(this.setBearing(this.options.bearing),delete this.options.bearing),this._loadAllLayers(),this._getRenderer().onLoad(),this._loaded=!0,this._callOnLoadHooks(),this._initTime=g()},e.prototype._initRenderer=function(){var t=this.options.renderer,n=e.getRendererClass(t);this._renderer=new n(this),this._renderer.load()},e.prototype._getRenderer=function(){return this._renderer},e.prototype._loadAllLayers=function(){this._baseLayer&&this._baseLayer.load(),this._eachLayer(function(t){t&&t.load()},this.getLayers())},e.prototype._getLayers=function(t){for(var e=this._baseLayer?[this._baseLayer].concat(this._layers):this._layers,n=[],i=0;i<e.length;i++)t&&!t.call(this,e[i])||n.push(e[i]);return n},e.prototype._eachLayer=function(t){if(!(arguments.length<2)){var e=Array.prototype.slice.call(arguments,1);e&&!Array.isArray(e)&&(e=[e]);for(var n=[],i=0,r=e.length;i<r;i++)n=n.concat(e[i]);for(var o=0,s=n.length;o<s;o++)t.call(t,n[o])}},e.prototype._onLayerEvent=function(t){t&&"idchange"===t.type&&(delete this._layerCache[t.old],this._layerCache[t.new]=t.target)},e.prototype._resetMapStatus=function(){var t=this.getMaxZoom(),e=this.getMinZoom(),n=this._spatialReference.getMaxZoom(),i=this._spatialReference.getMinZoom();(m(t)||-1===t||t>n)&&this.setMaxZoom(n),(m(e)||-1===e||e<i)&&this.setMinZoom(i),(t=this.getMaxZoom())<(e=this.getMinZoom())&&this.setMaxZoom(e),(m(this._zoomLevel)||this._zoomLevel>t)&&(this._zoomLevel=t),this._zoomLevel<e&&(this._zoomLevel=e),delete this._prjCenter;var r=this.getProjection();this._prjCenter=r.project(this._center),this._calcMatrices();var o=this._getRenderer();o&&o.resetContainer()},e.prototype._getContainerDomSize=function(){if(!this._containerDOM)return null;var t=this._containerDOM,e=void 0,n=void 0;if(m(t.width)||m(t.height)){if(m(t.clientWidth)||m(t.clientHeight))throw new Error("can not get size of container");e=parseInt(t.clientWidth,0),n=parseInt(t.clientHeight,0)}else e=t.width,n=t.height,he.retina&&t.layer&&(e/=2,n/=2);return new ce(e,n)},e.prototype._updateMapSize=function(t){return this.width=t.width,this.height=t.height,this._getRenderer().updateMapSize(t),this._calcMatrices(),this},e.prototype._getPrjCenter=function(){return this._prjCenter},e.prototype._setPrjCenter=function(t){this._prjCenter=t,this.isInteracting()&&!this.isMoving()&&(this._mapViewCoord=t),this._calcMatrices()},e.prototype._setPrjCoordAtContainerPoint=function(t,e){if(e.x===this.width/2&&e.y===this.height/2)return this;var n=this._containerPointToPoint(e)._sub(this._prjToPoint(this._getPrjCenter())),i=this._pointToPrj(this._prjToPoint(t).sub(n));return this._setPrjCenter(i),this},e.prototype._verifyExtent=function(t){if(!t)return!1;var e=this.getMaxExtent();return!e||e.contains(t)},e.prototype._offsetCenterByPixel=function(t){var e=new le(this.width/2-t.x,this.height/2-t.y),n=this._containerPointToPrj(e);return this._setPrjCenter(n),n},e.prototype.offsetPlatform=function(t){return t?(this._getRenderer().offsetPlatform(t),this._mapViewCoord=this._getPrjCenter(),this._mapViewPoint=this._mapViewPoint.add(t),this):this._mapViewPoint},e.prototype.getViewPoint=function(){var t=this._getViewPointFrameOffset(),e=this.offsetPlatform();return t&&(e=e.add(t)),e},e.prototype._getViewPointFrameOffset=function(){if(this.isZooming())return null;var t=this._getPrjCenter();return this._mapViewCoord&&!this._mapViewCoord.equals(t)?this._prjToContainerPoint(this._mapViewCoord).sub(this._prjToContainerPoint(t)):null},e.prototype._resetMapViewPoint=function(){this._mapViewPoint=new le(0,0),this._mapViewCoord=this._getPrjCenter()},e.prototype._getResolution=function(t){return m(t)&&(t=this.getZoom()),this._spatialReference.getResolution(t)},e.prototype._getResolutions=function(){return this._spatialReference.getResolutions()},e.prototype._prjToPoint=function(t,e){return e=m(e)?this.getZoom():e,this._spatialReference.getTransformation().transform(t,this._getResolution(e))},e.prototype._pointToPrj=function(t,e){return e=m(e)?this.getZoom():e,this._spatialReference.getTransformation().untransform(t,this._getResolution(e))},e.prototype._pointToPoint=function(t,e){return m(e)?t.copy():t.multi(this._getResolution(e)/this._getResolution())},e.prototype._pointToPointAtZoom=function(t,e){return m(e)?t.copy():t.multi(this._getResolution()/this._getResolution(e))},e.prototype._containerPointToPrj=function(t){return this._pointToPrj(this._containerPointToPoint(t))},e.prototype._viewPointToPrj=function(t){return this._containerPointToPrj(this.viewPointToContainerPoint(t))},e.prototype._prjToContainerPoint=function(t,e){return this._pointToContainerPoint(this._prjToPoint(t,e),e)},e.prototype._prjToViewPoint=function(t){var e=this._prjToContainerPoint(t);return this._containerPointToViewPoint(e)},e.prototype._containerPointToViewPoint=function(t){return t?t._sub(this.getViewPoint()):null},e.prototype._viewPointToPoint=function(t,e){return this._containerPointToPoint(this.viewPointToContainerPoint(t),e)},e.prototype._pointToViewPoint=function(t,e){return this._prjToViewPoint(this._pointToPrj(t,e))},e.prototype._callOnLoadHooks=function(){var t=e.prototype;if(t._onLoadHooks)for(var n=0,i=t._onLoadHooks.length;n<i;n++)t._onLoadHooks[n].call(this)},e}(mn(cn(Zn(dn))));ri.mergeOptions(ii);var oi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHooks=function(){this.target&&this.target.on("_dblclick",this._onDoubleClick,this)},e.prototype.removeHooks=function(){this.target&&this.target.off("_dblclick",this._onDoubleClick,this)},e.prototype._onDoubleClick=function(t){var e=this.target;if(e.options.doubleClickZoom){var n=e.getZoom(),i=t.domEvent.shiftKey?Math.ceil(n)-1:Math.floor(n)+1;e._zoomAnimation(i,t.containerPoint)}},e}(pn);ri.mergeOptions({doubleClickZoom:!0}),ri.addOnLoadHook("addHandler","doubleClickZoom",oi);var si=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHooks=function(){var t=this.target;if(t){var e=t._panels.mapWrapper||t._containerDOM;this._dragHandler=new xn(e,{cancelOn:this._cancelOn.bind(this),rightclick:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this).on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this).enable()}},e.prototype.removeHooks=function(){this._dragHandler.off("mousedown",this._onMouseDown,this).off("dragstart",this._onDragStart,this).off("dragging",this._onDragging,this).off("dragend",this._onDragEnd,this),this._dragHandler.remove(),delete this._dragHandler},e.prototype._cancelOn=function(t){return!(!this.target.isZooming()&&!this._ignore(t))},e.prototype._ignore=function(t){return!!t&&(t.domEvent&&(t=t.domEvent),this.target._ignoreEvent(t))},e.prototype._onMouseDown=function(t){delete this.startDragTime,delete this._mode,2===t.domEvent.button||t.domEvent.ctrlKey?(this.target.options.dragRotate||this.target.options.dragPitch)&&(this._mode="rotatePitch"):this.target.options.dragPan&&(this._mode="move"),this.target._stopAnim(this.target._animPlayer),ze(t.domEvent)},e.prototype._onDragStart=function(t){this.startDragTime=g(),"move"===this._mode?this._moveStart(t):"rotatePitch"===this._mode&&this._rotateStart(t)},e.prototype._onDragging=function(t){this.target._isEventOutMap(t.domEvent)||("move"===this._mode?this._moving(t):"rotatePitch"===this._mode&&this._rotating(t))},e.prototype._onDragEnd=function(t){"move"===this._mode?this._moveEnd(t):"rotatePitch"===this._mode&&this._rotateEnd(t),delete this.startDragTime,delete this.startBearing},e.prototype._start=function(t){this.preX=t.mousePos.x,this.preY=t.mousePos.y,this.startX=this.preX,this.startY=this.preY},e.prototype._moveStart=function(t){this._start(t);var e=this.target;e.onMoveStart(t);var n=qe(e._getActualEvent(t.domEvent),e.getContainer());this.startPrjCoord=e._containerPointToPrj(n)},e.prototype._moving=function(t){if(this.startDragTime){var e=this.target,n=qe(e._getActualEvent(t.domEvent),e.getContainer());e._setPrjCoordAtContainerPoint(this.startPrjCoord,n),e.onMoving(t)}},e.prototype._moveEnd=function(t){if(this.startDragTime){var e=this.target,n=g()-this.startDragTime,i=t.mousePos.x,r=t.mousePos.y,o=i-this.startX,s=r-this.startY;this._clear(),e.options.panAnimation&&!t.interupted&&e._verifyExtent(e.getCenter())&&n<280&&Math.abs(s)+Math.abs(o)>5?(n=5*n*(Math.abs(o)+Math.abs(s))/500,e.panBy(new le(o,s),{duration:n})):e.onMoveEnd(t)}},e.prototype._rotateStart=function(t){this._start(t),delete this._rotateMode,this.startBearing=this.target.getBearing(),this.target.onDragRotateStart(t),this._db=0},e.prototype._rotating=function(t){var e=this.target,n=t.mousePos.x,i=t.mousePos.y,r=e.getPitch(),o=e.getBearing(),s=Math.abs(n-this.preX),a=Math.abs(i-this.preY);if(this._rotateMode||(e.options.dragRotatePitch?this._rotateMode="rotate_pitch":this._rotateMode=s>a?"rotate":s<a?"pitch":"rotate"),!("pitch"===this._rotateMode&&0===r&&a<10)){if(this._rotateMode.indexOf("rotate")>=0&&e.options.dragRotate){var h=0;h=e.options.dragPitch||s>a?-.6*(this.preX-n):n>e.width/2?.6*(this.preY-i):-.6*(this.preY-i);var u=e.getBearing()+h;this._db=this._db||0,this._db+=h,e.setBearing(u)}this._rotateMode.indexOf("pitch")>=0&&e.options.dragPitch&&e.setPitch(e.getPitch()+.4*(this.preY-i)),this.preX=n,this.preY=i,e.getBearing()===o&&e.getPitch()===r||e.onDragRotating(t)}},e.prototype._rotateEnd=function(t){var e=this.target,n=e.getBearing();this._clear();var i=g()-this.startDragTime;if(e.onDragRotateEnd(t),Math.abs(n-this.startBearing)>20&&("rotate"===this._rotateMode||"rotate_pitch"===this._rotateMode)&&!t.interupted&&i<400){var r=e.getBearing();e.animateTo({bearing:r+this._db/2},{easing:"out",duration:800})}},e.prototype._clear=function(){delete this.startPrjCoord,delete this.preX,delete this.preY,delete this.startX,delete this.startY},e}(pn);function ai(t,e,n,i){for(var r=[],o=0,s=void 0,a=0,h=t.length;a<h-1;a++)(s=ui(t[a],t[a+1],e,a,n,i))&&(r[o]=r[o]||[],r[o].push({point:s[0],index:a}),s[1]===t[a+1]&&a!==h-2||(r[o].push({point:s[1],index:a+1}),o++));return r}ri.mergeOptions({draggable:!0,dragPan:!0,dragRotatePitch:!0,dragRotate:!0,dragPitch:!0}),ri.addOnLoadHook("addHandler","draggable",si);var hi=void 0;function ui(t,e,n,i,r,o){var s=i?hi:fi(t,n),a=fi(e,n),h=void 0,u=void 0,l=void 0;for(hi=a;;){if(!(s|a))return[t,e];if(s&a)return!1;if(o)return[t,e];l=fi(u=ci(t,e,h=s||a,n,r),n),h===s?(t=u,s=l):(e=u,a=l)}}function li(t,e,n){var i=[1,4,2,8],r=void 0,o=void 0,s=void 0,a=void 0,h=void 0,u=void 0,l=void 0,c=void 0,f=void 0;for(o=0,l=t.length;o<l;o++)t[o]._code=fi(t[o],e);for(a=0;a<4;a++){for(c=i[a],r=[],o=0,s=(l=t.length)-1;o<l;s=o++)h=t[o],u=t[s],h._code&c?u._code&c||((f=ci(u,h,c,e,n))._code=fi(f,e),r.push(f)):(u._code&c&&((f=ci(u,h,c,e,n))._code=fi(f,e),r.push(f)),r.push(h));t=r}return t}function ci(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=i.getMin(),h=i.getMax(),u=void 0,l=void 0;8&n?(u=t.x+o*(h.y-t.y)/s,l=h.y):4&n?(u=t.x+o*(a.y-t.y)/s,l=a.y):2&n?(u=h.x,l=t.y+s*(h.x-t.x)/o):1&n&&(u=a.x,l=t.y+s*(a.x-t.x)/o);var c=new le(u,l);return r&&c._round(),c}function fi(t,e){var n=0;return t.x<e.getMin().x?n|=1:t.x>e.getMax().x&&(n|=2),t.y<e.getMin().y?n|=4:t.y>e.getMax().y&&(n|=8),n}function pi(t,e,n,i){t=new le(t);var r=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),s=Math.sqrt(Math.abs(r*r-o*o)),a=void 0,h=void 0,u=void 0;return r>=o?(a=new le(e.x-s,e.y),h=new le(e.x+s,e.y),u=2*r):(a=new le(e.x,e.y-s),h=new le(e.x,e.y+s),u=2*o),t.distanceTo(a)+t.distanceTo(h)<=u+2*i}var di=function(){function t(){f(this,t)}return t.prototype.getMap=function(){return this.geometry.getMap()},t.prototype.getPainter=function(){return this.painter},t.testColor=function(t){return!(!t||!w(t))&&l.indexOf(t)>=0},t}(),gi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype._prepareContext=function(t){v(this.symbol.opacity)?t.globalAlpha!==this.symbol.opacity&&(t.globalAlpha=this.symbol.opacity):1!==t.globalAlpha&&(t.globalAlpha=1)},e.prototype.prepareCanvas=function(t,e,n){sn.prepareCanvas(t,e,n,this.getPainter().isHitTesting())},e.prototype.remove=function(){},e.prototype.setZIndex=function(){},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype._defineStyle=function(t){return function(){var e=this,n=[],i={};return Pt(t,function(){var t=e.getMap();return function(t,e,n){return t[0]=e,t[1]=n,t}(n,t.getZoom(),y({},e.geometry.getProperties(),function(t,e,n,i){return t["{bearing}"]=e,t["{pitch}"]=n,t["{zoom}"]=i,t}(i,t.getBearing(),t.getPitch(),t.getZoom())))})}.bind(this)()},e}(di);var yi=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this));return o.symbol=n,o.geometry=i,o.painter=r,o}return p(e,t),e.prototype.get2DExtent=function(){for(var t=this.getMap(),e=t.getGLZoom(),n=new In,i=this._getRenderPoints()[0],r=i.length-1;r>=0;r--)i[r]&&n._combine(t._pointToPoint(i[r],e));return n},e.prototype._rotateExtent=function(t,e){return t.convertTo(function(t){return t._rotate(e)})},e.prototype._getRenderPoints=function(){return this.getPainter().getRenderPoints(this.getPlacement())},e.prototype._getRenderContainerPoints=function(t){var e=this.getPainter(),n=this._getRenderPoints()[0];if(e.isSpriting())return n;var i=this.getDxDy(),r=this.painter._pointContainerPoints(n,i.x,i.y,t,!0,this.getPlacement());if(!r||!Array.isArray(r[0]))return r;for(var o=[],s=0,a=r.length;s<a;s++)for(var h=0,u=r[s].length;h<u;h++)o.push(r[s][h]);return o},e.prototype._getRotationAt=function(t){var e=this.getRotation();e||(e=0);var n=this._getRenderPoints()[1];if(!n||!n[t])return e;var i=this.getMap(),r=n[t][0],o=n[t][1];if(i.isTransforming()){var s=i.getGLZoom();r=i._pointToContainerPoint(n[t][0],s),o=i._pointToContainerPoint(n[t][1],s)}return e+et(r.x,r.y,o.x,o.y)},e.prototype._rotate=function(t,e,n){if(n){var i=this.getDxDy(),r=e.sub(i);return t.save(),t.translate(r.x,r.y),t.rotate(n),this.getDxDy()}return null},e}(gi),mi=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r));o._dynamic=It(n),o.style=o._defineStyle(o.translate()),o.strokeAndFill=o._defineStyle(e.translateLineAndFill(o.style));var s=o.strokeAndFill.lineWidth;return o.padding=s%2==0?2:1.5,o}return p(e,t),e.test=function(t){return!!t&&!(!m(t.markerFile)||m(t.markerType)||"path"===t.markerType)},e.prototype.symbolize=function(t,e){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&(0!==n.polygonOpacity||0!==n.lineOpacity)){var i=this._getRenderContainerPoints();Z(i)&&(this._prepareContext(t),this.getPainter().isSpriting()||this.geometry.getLayer().getMask()===this.geometry||this._dynamic||!1===this.geometry.getLayer().options.cacheVectorOnCanvas?this._drawMarkers(t,i,e):this._drawMarkersWithCache(t,i,e))}},e.prototype.getDxDy=function(){var t=this.style,e=t.markerDx,n=t.markerDy;return new le(e,n)},e.prototype._drawMarkers=function(t,e,n){var i=this.strokeAndFill;Dt(i.lineColor)||Dt(i.polygonFill)||this.prepareCanvas(t,i,n);for(var r=e.length-1;r>=0;r--){var o=e[r],s=this._rotate(t,o,this._getRotationAt(r));s&&(o=s),this._drawVectorMarker(t,o,n),s&&t.restore()}},e.prototype._drawMarkersWithCache=function(t,e,n){var i=this._stampSymbol(),r=n.getImage(i);r||(r=this._createMarkerImage(t,n),n.addResource([i,r.width,r.height],r));for(var o=this._getAnchor(r.width,r.height),s=e.length-1;s>=0;s--){var a=e[s],h=this._rotate(t,a,this._getRotationAt(s));h&&(a=h),sn.image(t,r,a.x+o.x,a.y+o.y),h&&t.restore()}},e.prototype._calMarkerSize=function(){if(!this._size){var t=this.strokeAndFill.lineWidth,e=2*(this.symbol.shadowBlur||0),n=Math.round(this.style.markerWidth+t+2*e+2*this.padding),i=Math.round(this.style.markerHeight+t+2*e+2*this.padding);this._size=[n,i]}return this._size},e.prototype._createMarkerImage=function(t,e){var n=t.canvas.constructor,i=this._calMarkerSize(),r=sn.createCanvas(i[0],i[1],n),o=this._getCacheImageAnchor(i[0],i[1]),s=r.getContext("2d");return Dt(this.strokeAndFill.lineColor)||Dt(this.strokeAndFill.polygonFill)||this.prepareCanvas(s,this.strokeAndFill,e),this._drawVectorMarker(s,o,e),r},e.prototype._stampSymbol=function(){return this._stamp||(this._stamp=[this.style.markerType,Dt(this.style.markerFill)?kt(this.style.markerFill):this.style.markerFill,this.style.markerFillOpacity,this.style.markerFillPatternFile,Dt(this.style.markerLineColor)?kt(this.style.markerLineColor):this.style.markerLineColor,this.style.markerLineWidth,this.style.markerLineOpacity,this.style.markerLineDasharray?this.style.markerLineDasharray.join(","):"",this.style.markerLinePatternFile,this.style.markerWidth,this.style.markerHeight,this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment].join("_")),this._stamp},e.prototype._getAnchor=function(t,e){var n=2*(this.symbol.shadowBlur||0)+this.padding,i=Se(new ce(t,e),this.style.markerHorizontalAlignment,this.style.markerVerticalAlignment);return i.x!==-t/2&&(i.x-=B(i.x+t/2)*n),i.y!==-e/2&&(i.y-=B(i.y+e/2)*n),i},e.prototype._getCacheImageAnchor=function(t,e){var n=2*(this.symbol.shadowBlur||0)+this.padding,i=this.style.markerType;return"bar"===i||"pie"===i||"pin"===i?new le(t/2,e-n):"rectangle"===i?new le(n,n):new le(t/2,e/2)},e.prototype._getGraidentExtent=function(t){var e=new In,n=this.getDxDy(),i=this.getFixedExtent();if(Array.isArray(t))for(var r=t.length-1;r>=0;r--)e._combine(t[r]);else e._combine(t);return e.xmin+=i.xmin-n.x,e.ymin+=i.ymin-n.y,e.xmax+=i.xmax-n.x,e.ymax+=i.ymax-n.y,e},e.prototype._drawVectorMarker=function(t,n,i){var r=this.style,o=this.strokeAndFill,s=r.markerType.toLowerCase(),a=e._getVectorPoints(s,r.markerWidth,r.markerHeight),h=o.lineOpacity,u=o.polygonOpacity;if(Dt(o.lineColor)||Dt(o.polygonFill)){var l=void 0;Dt(o.lineColor)&&(l=this._getGraidentExtent(n),o.lineGradientExtent=l.expand(o.lineWidth)),Dt(o.polygonFill)&&(l||(l=this._getGraidentExtent(n)),o.polygonGradientExtent=l),this.prepareCanvas(t,o,i)}var c=r.markerWidth,f=r.markerHeight,p=r.markerLineWidth/2;if("ellipse"===s)sn.ellipse(t,n,c/2,f/2,h,u);else if("cross"===s||"x"===s){for(var d=a.length-1;d>=0;d--)a[d]._add(n);sn.path(t,a.slice(0,2),h),sn.path(t,a.slice(2,4),h)}else if("diamond"===s||"bar"===s||"square"===s||"rectangle"===s||"triangle"===s){"bar"===s?n=n.add(0,-p):"rectangle"===s&&(n=n.add(p,p));for(var g=a.length-1;g>=0;g--)a[g]._add(n);sn.polygon(t,a,h,u)}else if("pin"===s){n=n.add(0,-p);for(var y=a.length-1;y>=0;y--)a[y]._add(n);var m=t.lineCap;t.lineCap="round",sn.bezierCurveAndFill(t,a,h,u),t.lineCap=m}else{if("pie"!==s)throw new Error("unsupported markerType: "+s);n=n.add(0,-p);var v=180*Math.atan(c/2/f)/Math.PI,_=t.lineCap;t.lineCap="round",sn.sector(t,n,f,[90-v,90+v],h,u),t.lineCap=_}},e.prototype.getPlacement=function(){return this.symbol.markerPlacement},e.prototype.getRotation=function(){var t=this.style.markerRotation;return v(t)?-t*Math.PI/180:null},e.prototype.getFixedExtent=function(){var t=this.getDxDy(),e=2*this.padding,n=this._calMarkerSize().map(function(t){return t-e}),i=this._getAnchor(n[0],n[1]),r=new In(t.add(0,0),t.add(n[0],n[1]));r._add(i);var o=this.getRotation();return o&&(r=this._rotateExtent(r,o)),r},e.prototype.translate=function(){var t=this.symbol,e={markerType:j(t.markerType,"ellipse"),markerFill:j(t.markerFill,"#00f"),markerFillOpacity:j(t.markerFillOpacity,1),markerFillPatternFile:j(t.markerFillPatternFile,null),markerLineColor:j(t.markerLineColor,"#000"),markerLineWidth:j(t.markerLineWidth,1),markerLineOpacity:j(t.markerLineOpacity,1),markerLineDasharray:j(t.markerLineDasharray,[]),markerLinePatternFile:j(t.markerLinePatternFile,null),markerDx:j(t.markerDx,0),markerDy:j(t.markerDy,0),markerWidth:j(t.markerWidth,10),markerHeight:j(t.markerHeight,10),markerRotation:j(t.markerRotation,0)},n=e.markerType,i=void 0,r=void 0;return"bar"===n||"pie"===n||"pin"===n?(i="middle",r="top"):"rectangle"===n?(i="right",r="bottom"):(i="middle",r="middle"),e.markerHorizontalAlignment=j(t.markerHorizontalAlignment,i),e.markerVerticalAlignment=j(t.markerVerticalAlignment,r),v(t.markerOpacity)&&(v(t.markerFillOpacity)&&(e.markerFillOpacity*=t.markerOpacity),v(t.markerLineOpacity)&&(e.markerLineOpacity*=t.markerOpacity)),e},e.translateLineAndFill=function(t){var e={lineColor:t.markerLineColor,linePatternFile:t.markerLinePatternFile,lineWidth:t.markerLineWidth,lineOpacity:t.markerLineOpacity,lineDasharray:t.markerLineDasharray,lineCap:"butt",lineJoin:"round",polygonFill:t.markerFill,polygonPatternFile:t.markerFillPatternFile,polygonOpacity:t.markerFillOpacity};return 0===e.lineWidth&&(e.lineOpacity=0),e},e._getVectorPoints=function(t,e,n){var i=n/2,r=e/2,o=void 0;if("triangle"===t)return[o=new le(0,0-i),new le(0-r,0+i),new le(0+r,0+i)];if("cross"===t)return[o=new le(0-r,0),new le(0+r,0),new le(0,0-i),new le(0,0+i)];if("diamond"===t)return[o=new le(0-r,0),new le(0,0-i),new le(0+r,0),new le(0,0+i)];if("square"===t)return[o=new le(0-r,0+i),new le(0+r,0+i),new le(0+r,0-i),new le(0-r,0-i)];if("rectangle"===t)return[o=new le(0,0),o.add(e,0),o.add(e,n),o.add(0,n)];if("x"===t)return[o=new le(0-r,0+i),new le(0+r,0-i),new le(0+r,0+i),new le(0-r,0-i)];if("bar"===t)return[o=new le(0-r,0-n),new le(0+r,0-n),new le(0+r,0),new le(0-r,0)];if("pin"===t){var s=n*Math.atan(r/i);return[o=new le(0,0),new le(0-s,0-n),new le(0+s,0-n),new le(0,0)]}return[]},e}(yi),vi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getPlacement=function(){return"point"},e.prototype.getDxDy=function(){return new le(0,0)},e.prototype.symbolize=function(t){var e=this.geometry,n=e.getLayer();if(e.options.debug||!n||n.options.debug){var i=this.getMap();if(i&&!i.isZooming()){var r=n.options.debugOutline;t.strokeStyle=r,t.fillStyle=r;var o=this.getPainter().getContainerExtent().toArray();sn.polygon(t,[o],1,0);for(var s=this._getRenderContainerPoints(),a=this.geometry.getId(),h=mi._getVectorPoints("cross",10,10),u=0;u<s.length;u++){var l=s[u];m(a)||sn.fillText(t,a,l.add(8,-4),r);for(var c=[],f=0;f<h.length;f++)c.push(h[f].add(l));sn.path(t,c.slice(0,2),1),sn.path(t,c.slice(2,4),1)}}}},e}(yi),_i=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r));return o.style=o._defineStyle(o.translate()),o}return p(e,t),e.test=function(t){return!!t&&!m(t.markerFile)},e.prototype.symbolize=function(t,e){var n=this.style;if(this.painter.isHitTesting()||0!==n.markerWidth&&0!==n.markerHeight&&0!==n.markerOpacity){var i=this._getRenderContainerPoints();if(Z(i)){var r=this._getImage(e);if(r){this._prepareContext(t);var o=n.markerWidth,s=n.markerHeight;if(!v(o)||!v(s)){o=r.width,s=r.height,n.markerWidth=o,n.markerHeight=s;var a=[n.markerFile,n.markerWidth,n.markerHeight];e.isResourceLoaded(a)||e.addResource(a,r);var h=this.getPainter();h.isSpriting()||h.removeCache()}var u=void 0;"path"!==this.symbol.markerType&&v(n.markerOpacity)&&n.markerOpacity<1&&(u=t.globalAlpha,t.globalAlpha*=n.markerOpacity);for(var l=Se(new ce(o,s),n.markerHorizontalAlignment,n.markerVerticalAlignment),c=0,f=i.length;c<f;c++){var p=i[c],d=this._rotate(t,p,this._getRotationAt(c));d&&(p=d),sn.image(t,r,p.x+l.x,p.y+l.y,o,s),d&&t.restore()}void 0!==u&&(t.globalAlpha=u)}else"undefined"!=typeof console&&console.warn("no img found for "+(this.style.markerFile||this._url[0]))}}},e.prototype._getImage=function(t){return t?t.getImage([this.style.markerFile,this.style.markerWidth,this.style.markerHeight]):null},e.prototype.getPlacement=function(){return this.symbol.markerPlacement},e.prototype.getRotation=function(){var t=this.style.markerRotation;return v(t)?-t*Math.PI/180:null},e.prototype.getDxDy=function(){var t=this.style,e=t.markerDx,n=t.markerDy;return new le(e,n)},e.prototype.getFixedExtent=function(t){var e=this.style,n=e.markerFile,i=t?t.getImage(n):null,r=e.markerWidth||(i?i.width:0),o=e.markerHeight||(i?i.height:0),s=this.getDxDy(),a=Se(new ce(r,o),e.markerHorizontalAlignment,e.markerVerticalAlignment),h=new In(s.add(0,0),s.add(r,o));h._add(a);var u=this.getRotation();return u&&(h=this._rotateExtent(h,u)),h},e.prototype.translate=function(){var t=this.symbol;return{markerFile:t.markerFile,markerOpacity:j(t.markerOpacity,1),markerWidth:j(t.markerWidth,null),markerHeight:j(t.markerHeight,null),markerRotation:j(t.markerRotation,0),markerDx:j(t.markerDx,0),markerDy:j(t.markerDy,0),markerHorizontalAlignment:j(t.markerHorizontalAlignment,"middle"),markerVerticalAlignment:j(t.markerVerticalAlignment,"top")}},e}(yi),xi=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this));return o.symbol=n,o.geometry=i,o.painter=r,"Point"===i.type?d(o):(o.style=o._defineStyle(o.translate()),o)}return p(e,t),e.test=function(t,e){if(!t)return!1;if(e&&"Point"===e.type)return!1;for(var n in t){var i=n.slice(0,4);if("line"===i||"poly"===i)return!0}return!1},e.prototype.symbolize=function(t,e){var n=this.style;if(0!==n.polygonOpacity||0!==n.lineOpacity||this.painter.isHitTesting()){var i=this._getPaintParams();if(i){this._prepareContext(t);var r=Dt(n.lineColor),o="Polygon"===this.geometry.getJSONType()||"LineString"===this.geometry.type;!r||!n.lineColor.places&&o||(n.lineGradientExtent=this.getPainter().getContainerExtent()._expand(n.lineWidth)),Dt(n.polygonFill)&&(n.polygonGradientExtent=this.getPainter().getContainerExtent());var s=i[0];if("Polygon"===this.geometry.getJSONType()&&s.length>0&&Array.isArray(s[0][0])||"LineString"===this.geometry.type&&s.length>0&&Array.isArray(s[0]))for(var a=0;a<s.length;a++){this.prepareCanvas(t,n,e),r&&o&&!n.lineColor.places&&this._createGradient(t,s[a],n.lineColor);var h=[t,s[a]];i.length>1&&h.push.apply(h,i.slice(1)),h.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray),this.geometry._paintOn.apply(this.geometry,h)}else{this.prepareCanvas(t,n,e),r&&o&&!n.lineColor.places&&this._createGradient(t,s,n.lineColor);var u=[t];u.push.apply(u,i),u.push(n.lineOpacity,n.polygonOpacity,n.lineDasharray),this.geometry._paintOn.apply(this.geometry,u)}t.setLineDash&&Array.isArray(n.lineDasharray)&&t.setLineDash([])}}},e.prototype.get2DExtent=function(){var t=this.getMap(),e=this.geometry._getPrjExtent();if(!e)return null;this._extMin&&this._extMax||(this._extMin=new wn(0,0),this._extMax=new wn(0,0)),this._extMin.x=e.xmin,this._extMin.y=e.ymin,this._extMax.x=e.xmax,this._extMax.y=e.ymax;var n=t._prjToPoint(this._extMin),i=t._prjToPoint(this._extMax);return this._pxExtent?(this._pxExtent.xmin=Math.min(n.x,i.x),this._pxExtent.xmax=Math.max(n.x,i.x),this._pxExtent.ymin=Math.min(n.y,i.y),this._pxExtent.ymax=Math.max(n.y,i.y)):this._pxExtent=new In(n,i),this._pxExtent},e.prototype.getFixedExtent=function(){var t=this.style.lineWidth/2;return new In(-t,-t,t,t)},e.prototype._getPaintParams=function(){return this.getPainter().getPaintParams(this.style.lineDx,this.style.lineDy)},e.prototype.translate=function(){var t=this.symbol,e={lineColor:j(t.lineColor,"#000"),lineWidth:j(t.lineWidth,2),lineOpacity:j(t.lineOpacity,1),lineDasharray:j(t.lineDasharray,[]),lineCap:j(t.lineCap,"butt"),lineJoin:j(t.lineJoin,"miter"),linePatternFile:j(t.linePatternFile,null),lineDx:j(t.lineDx,0),lineDy:j(t.lineDy,0),polygonFill:j(t.polygonFill,null),polygonOpacity:j(t.polygonOpacity,1),polygonPatternFile:j(t.polygonPatternFile,null),polygonPatternDx:j(t.polygonPatternDx,0),polygonPatternDy:j(t.polygonPatternDy,0),linePatternDx:j(t.linePatternDx,0),linePatternDy:j(t.linePatternDy,0)};return 0===e.lineWidth&&(e.lineOpacity=0),"LineString"!==this.geometry.type||e.polygonFill||(e.polygonFill=e.lineColor),e},e.prototype._createGradient=function(t,e,n){if(Array.isArray(e)){var i=e.length,r=t.createLinearGradient(e[0].x,e[0].y,e[i-1].x,e[i-1].y);n.colorStops.forEach(function(t){r.addColorStop.apply(r,t)}),t.strokeStyle=r}},e}(gi),wi="___text_symbol_cache",Ci=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r));if(o._dynamic=It(n),o.style=o._defineStyle(o.translate()),0===o.style.textWrapWidth)return d(o);o.strokeAndFill=o._defineStyle(o.translateLineAndFill(o.style));var s=Ee(o.style.textName,o.geometry.getProperties());return o._dynamic||(o._cacheKey=function(t,e){var n=[t];for(var i in e)e.hasOwnProperty(i)&&i.length>4&&"text"===i.substring(0,4)&&n.push(i+"="+e[i]);return n.join("-")}(s,o.style)),o._descText(s),o}return p(e,t),e.test=function(t){return!!t&&!m(t.textName)},e.prototype.symbolize=function(t,e){if(this.painter.isHitTesting()||0!==this.style.textSize&&(this.style.textOpacity||this.style.textHaloRadius&&this.style.textHaloOpacity)&&0!==this.style.textWrapWidth){var n=this._getRenderContainerPoints();if(Z(n)){var i=this.style,r=this.strokeAndFill,o=Ee(this.style.textName,this.geometry.getProperties());this._descText(o),this._prepareContext(t),this.prepareCanvas(t,r,e),sn.prepareCanvasFont(t,i);for(var s=0,a=n.length;s<a;s++){var h=n[s],u=this._rotate(t,h,this._getRotationAt(s));u&&(h=u),sn.text(t,o,h,i,this.textDesc),u&&t.restore()}}}},e.prototype.getPlacement=function(){return this.symbol.textPlacement},e.prototype.getRotation=function(){var t=this.style.textRotation;return v(t)?-t*Math.PI/180:null},e.prototype.getDxDy=function(){var t=this.style;return new le(t.textDx,t.textDy)},e.prototype.getFixedExtent=function(){var t=this.getDxDy(),e=this.style,n=this.textDesc.size,i=Se(n,e.textHorizontalAlignment,e.textVerticalAlignment),r=i.x,o=i.y;if(e.textHaloRadius){var s=e.textHaloRadius;n=n.add(2*s,2*s)}var a=new In(t.add(r,o),t.add(r+n.width,o+n.height)),h=this.getRotation();return h&&(a=this._rotateExtent(a,h)),a},e.prototype.translate=function(){var t=this.symbol,e={textName:t.textName,textFaceName:j(t.textFaceName,"monospace"),textWeight:j(t.textWeight,"normal"),textStyle:j(t.textStyle,"normal"),textSize:j(t.textSize,10),textFont:j(t.textFont,null),textFill:j(t.textFill,"#000"),textOpacity:j(t.textOpacity,1),textHaloFill:j(t.textHaloFill,"#ffffff"),textHaloRadius:j(t.textHaloRadius,0),textHaloOpacity:j(t.textHaloOpacity,1),textWrapWidth:j(t.textWrapWidth,null),textWrapCharacter:j(t.textWrapCharacter,"\n"),textLineSpacing:j(t.textLineSpacing,0),textDx:j(t.textDx,0),textDy:j(t.textDy,0),textHorizontalAlignment:j(t.textHorizontalAlignment,"middle"),textVerticalAlignment:j(t.textVerticalAlignment,"middle"),textAlign:j(t.textAlign,"center"),textRotation:j(t.textRotation,0),textMaxWidth:j(t.textMaxWidth,0),textMaxHeight:j(t.textMaxHeight,0)};return e.textMaxWidth>0&&(!e.textWrapWidth||e.textWrapWidth>e.textMaxWidth)&&(e.textWrapWidth||(e.textMaxHeight=1),e.textWrapWidth=e.textMaxWidth),e},e.prototype.translateLineAndFill=function(t){return{lineColor:t.textHaloRadius?t.textHaloFill:t.textFill,lineWidth:t.textHaloRadius,lineOpacity:t.textOpacity,lineDasharray:null,lineCap:"butt",lineJoin:"round",polygonFill:t.textFill,polygonOpacity:t.textOpacity}},e.prototype._descText=function(t){this._dynamic?this.textDesc=this._measureText(t):(this.textDesc=this._loadFromCache(),this.textDesc||(this.textDesc=this._measureText(t),this._storeToCache(this.textDesc)))},e.prototype._measureText=function(t){var e=this.style.textMaxHeight,n=be(t,this.style);return e&&e<n.size.height&&(n.size.height=e),n},e.prototype._storeToCache=function(t){M||(this.geometry[wi]||(this.geometry[wi]={}),this.geometry[wi][this._cacheKey]={desc:t,active:!0})},e.prototype._loadFromCache=function(){if(!this.geometry[wi])return null;var t=this.geometry[wi][this._cacheKey];return t?(t.active=!0,t.desc):null},e}(yi);Ci.CACHE_KEY=wi;var Ei=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r));return o.style=o._defineStyle(o.translate()),m(o.style.markerWidth)&&(o.style.markerWidth=80),m(o.style.markerHeight)&&(o.style.markerHeight=80),he.gecko?o._url=[Nt(n,o.style.markerWidth,o.style.markerHeight),o.style.markerWidth,o.style.markerHeight]:o._url=[Nt(n),n.markerWidth,n.markerHeight],o}return p(e,t),e.test=function(t){return!!t&&!(!m(t.markerFile)||"path"!==t.markerType)},e.prototype._prepareContext=function(){},e.prototype._getImage=function(t){if(t&&t.isResourceLoaded(this._url))return t.getImage(this._url);var e=new Image;return e.src=this._url[0],t&&t.addResource(this._url,e),e},e}(_i),Si={lineWidth:1,polygonFill:"#fff",polygonOpacity:.5},Ii=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r));return o.style=i.getLayer().options.drawAltitude,o.style&&x(o.style)||(o.style={lineWidth:2}),o.style.lineWidth||(o.style.lineWidth=0),o.dxdy=o._defineStyle({dx:n.textDx||n.markerDx,dy:n.textDy||n.markerDy}),o}return p(e,t),e.test=function(t,e){if(!e.getLayer())return!1;var n=e.getJSONType();return"Marker"===n||"LineString"===n},e.prototype.symbolize=function(t){var e=this.geometry.getLayer();if(e.options.drawAltitude){var n=this.geometry.getProperties();if(n&&n[e.options.altitudeProperty]){var i=this._getStyle();if(this._prepareContext(t),"LineString"===this.geometry.type){var r=this._getPaintParams(i.lineDx,i.lineDy);if(!r)return;var o=this.getPainter().getPaintParams(i.lineDx,i.lineDy,!0)[0];this._drawLineAltitude(t,r[0],o)}else{var s=this._getRenderContainerPoints(),a=this._getRenderContainerPoints(!0);if(!s||0===s.length)return;this._drawMarkerAltitude(t,s[0],a[0])}}}},e.prototype.getDxDy=function(){var t=this.dxdy;return new le(t.dx||0,t.dy||0)},e.prototype.get2DExtent=function(){return"LineString"===this.geometry.type?xi.prototype.get2DExtent.apply(this):t.prototype.get2DExtent.call(this)},e.prototype.getPlacement=function(){return"point"},e.prototype._getPaintParams=function(t,e){return this.getPainter().getPaintParams(t||0,e||0)},e.prototype._drawMarkerAltitude=function(t,e,n){var i=this._getStyle();this.prepareCanvas(t,i),sn.path(t,[e,n],i.lineOpacity,null,i.lineDasharray)},e.prototype._drawLineAltitude=function(t,e,n){var i=this._getStyle();if(e.length>0&&Array.isArray(e[0]))for(var r=0;r<e.length;r++)this._drawLine(t,e[r],n[r]);else this._drawLine(t,e,n);t.setLineDash&&Array.isArray(i.lineDasharray)&&t.setLineDash([])},e.prototype._drawLine=function(t,e,n){var i=this._getStyle();this.prepareCanvas(t,i);for(var r=0,o=e.length-1;r<o;r++)sn.polygon(t,[e[r],e[r+1],n[r+1],n[r]],i.lineOpacity,i.polygonOpacity,i.lineDasharray)},e.prototype._getStyle=function(){var t=this.geometry.getLayer().options.drawAltitude;return x(t)||(t=Si),t.lineWidth||(t.lineWidth=0,t.lineOpacity=0),t},e}(yi),bi=Object.freeze({Symbolizer:di,CanvasSymbolizer:gi,DebugSymbolizer:vi,ImageMarkerSymbolizer:_i,PointSymbolizer:yi,StrokeAndFillSymbolizer:xi,TextMarkerSymbolizer:Ci,VectorMarkerSymbolizer:mi,VectorPathMarkerSymbolizer:Ei,DrawAltitudeSymbolizer:Ii}),Pi=[Ii,xi,_i,Ei,mi,Ci],Mi=void 0,Ti=function(t){function e(n){f(this,e);var i=d(this,t.call(this));return i.geometry=n,i.symbolizers=i._createSymbolizers(),i._altAtGLZoom=i._getGeometryAltitude(),i}return p(e,t),e.prototype.getMap=function(){return this.geometry.getMap()},e.prototype.getLayer=function(){return this.geometry.getLayer()},e.prototype._createSymbolizers=function(){var t=this.getSymbol(),e=[],n=Pi,i=t;Array.isArray(t)||(i=[t]);for(var r=i.length-1;r>=0;r--)for(var o=i[r],s=n.length-1;s>=0;s--)if(n[s].test(o,this.geometry)){var a=new n[s](o,this.geometry,this);e.push(a),a instanceof yi&&(this._hasPoint=!0)}if(!e.length&&console){var h=this.geometry.getId();console.warn("invalid symbol for geometry("+(this.geometry?this.geometry.getType()+(h?":"+h:""):"")+") to draw : "+JSON.stringify(t))}return this._debugSymbolizer=new vi(t,this.geometry,this),e},e.prototype.hasPoint=function(){return!!this._hasPoint},e.prototype.getRenderPoints=function(t){return this._renderPoints||(this._renderPoints={}),t||(t="center"),this._renderPoints[t]||(this._renderPoints[t]=this.geometry._getRenderPoints(t)),this._renderPoints[t]},e.prototype.getPaintParams=function(t,e,n){var i=this.getMap(),r=this.geometry,o=i.getResolution(),s=0!==i.getPitch(),a=0!==i.getBearing(),h=this._cachedParams,u=r._paintAsPath&&r._paintAsPath();if(u&&this._unsimpledParams&&o<=this._unsimpledParams._res)h=this._unsimpledParams;else if(!h||h._res!==i.getResolution()||this._pitched!==s&&r._redrawWhenPitch()||this._rotated!==a&&r._redrawWhenRotate()){if(!(h=r._getPaintParams()))return null;h._res=o,!r._simplified&&u&&(this._unsimpledParams||(this._unsimpledParams=h),o>this._unsimpledParams._res&&(this._unsimpledParams._res=o)),this._cachedParams=h}if(!h)return null;this._pitched=s,this._rotated=a;var l=i.getGLScale(),c=[],f=h[0],p=i.getContainerExtent(),d=this._pointContainerPoints(f,t,e,n,!p.contains(this._hitPoint));if(!d)return null;c.push(d);for(var g=1,y=h.length;g<y;g++)v(h[g])||h[g]instanceof ce?v(h[g])?c.push(h[g]/l):c.push(h[g].multi(1/l)):c.push(h[g]);return c},e.prototype._pointContainerPoints=function(t,e,n,i,r,o){if(!this.getContainerExtent())return null;var s=this.getMap(),a=s.getGLZoom(),h=this.containerOffset,u=void 0;function l(t,i){var r=s._pointToContainerPoint(t,a,i)._sub(h);return(e||n)&&r._add(e||0,n||0),r}var c=this.getAltitude();if(Array.isArray(t)){var f=this.geometry,p=void 0,d=(p=!r&&f.options.enableClip?this._clip(t,c):{points:t,altitude:c}).points;c=p.altitude,i&&(c=0);var g=c;u=[];for(var y=0,m=d.length;y<m;y++){var v=d[y];if(Array.isArray(v)){for(var _=[],x=0,w=v.length;x<w;x++){var C=v[x];Array.isArray(c)&&(g=c[y]?c[y][x]:0),_.push(l(C,g))}u.push(_)}else Array.isArray(c)&&(g="vertex-last"===o?c[c.length-1-y]:"line"===o?(c[y]+c[y+1])/2:c[y]),u.push(l(v,g))}}else t instanceof le&&(i&&(c=0),u=s._pointToContainerPoint(t,a,c)._sub(h),(e||n)&&u._add(e,n));return u},e.prototype._clip=function(t,e){var n=this.getMap(),i=this.geometry,r=n.getGLZoom(),o=this.getSymbol().lineWidth;v(o)||(o=4);var s=n.getContainerExtent().expand(o).convertTo(function(t){return n._containerPointToPoint(t,r)});if(n.getPitch()>0&&e){var a=n.cameraLookAt,h=n.cameraPosition;s=s.combine(new le(h)._add(B(a[0]-h[0]),B(a[1]-h[1])))}var u=t;if(this.get2DExtent().within(s))return{points:u,altitude:e};var l=i.options.smoothness;if(i.getShell&&this.geometry.getHoles&&!l)if(Array.isArray(t[0])){u=[];for(var c=0;c<t.length;c++){var f=li(t[c],s);f.length&&u.push(f)}}else u=li(t,s);else if("LineString"===i.getJSONType()){if(Array.isArray(t[0])){u=[];for(var p=0;p<t.length;p++)F(u,ai(t[p],s,!1,!!l))}else u=ai(t,s,!1,!!l);return this._interpolateSegAlt(u,t,e)}return{points:u,altitude:e}},e.prototype._interpolateSegAlt=function(t,e,n){if(!Array.isArray(n)){var i=function(t){return t.point};return{points:t.map(function(t){return Array.isArray(t)?t.map(i):t.point}),altitude:n}}var r=function t(e,n,i){if(!Array.isArray(i))return e;var r=[];for(var o=0,s=e.length;o<s;o++)if(Array.isArray(e[o]))r.push(t(e[o],n,i));else{var a=e[o];if(a.point.equals(n[a.index]))a.altitude=i[a.index],r.push(a);else{var h=void 0,u=void 0;0===a.index?(h=a.index,u=a.index+1):(h=a.index-1,u=a.index);var l=a.point.distanceTo(n[u]),c=l/(l+n[h].distanceTo(a.point)),f=V(i[h],i[u],1-c);a.altitude=f,r.push(a)}}return r}(t,e,n);return n=[],{points:r.map(function(t){if(Array.isArray(t)){var e=[],i=t.map(function(t){return e.push(t.altitude),t.point});return n.push(e),i}return n.push(t.altitude),t.point}),altitude:n}},e.prototype.getSymbol=function(){return this.geometry._getInternalSymbol()},e.prototype.paint=function(t,e,n){if(this.symbolizers){var i=this.getLayer()._getRenderer();if(i&&i.context&&(!t||t.intersects(this.get2DExtent(i.resources)))){var r=this.getMap(),o=this.getMinAltitude(),s=r.getFrustumAltitude();if(!(o&&s&&s<o)){this.containerOffset=n||r._pointToContainerPoint(i.southWest)._add(0,-r.height),this._beforePaint();for(var a=e||i.context,h=[a,i.resources],u=this.symbolizers.length-1;u>=0;u--)this._prepareShadow(a,this.symbolizers[u].symbol),this.symbolizers[u].symbolize.apply(this.symbolizers[u],h);this._afterPaint(),this._painted=!0,this._debugSymbolizer.symbolize.apply(this._debugSymbolizer,h)}}}},e.prototype.getSprite=function(t,e){if("Point"!==this.geometry.type)return null;if(this._spriting=!0,!this._sprite&&this.symbolizers.length>0){var n=new In;this.symbolizers.forEach(function(e){var i=e.getFixedExtent(t);n._combine(i)});var i=n.getMin().multi(-1),r=e||(this.getMap()?this.getMap().CanvasClass:null),o=sn.createCanvas(n.getWidth(),n.getHeight(),r),s=void 0;this._renderPoints&&(s=this._renderPoints);for(var a=o.getContext("2d"),h=[a,t],u=this.symbolizers.length-1;u>=0;u--){var l=this.symbolizers[u].getDxDy();this._renderPoints={center:[[i.add(l)]]},this._prepareShadow(a,this.symbolizers[u].symbol),this.symbolizers[u].symbolize.apply(this.symbolizers[u],h)}s&&(this._renderPoints=s),this._sprite={canvas:o,offset:n.getCenter()}}return this._spriting=!1,this._sprite},e.prototype.isSpriting=function(){return!!this._spriting},e.prototype.hitTest=function(t,e){(!e||e<.5)&&(e=.5),Mi||(Mi=sn.createCanvas(1,1)),sn.setHitTesting(!0),Mi.width=Mi.height=2*e;var n=Mi.getContext("2d");this._hitPoint=t.sub(e,e);try{this.paint(null,n,this._hitPoint)}catch(t){throw t}finally{sn.setHitTesting(!1)}delete this._hitPoint;for(var i=n.getImageData(0,0,Mi.width,Mi.height).data,r=3,o=i.length;r<o;r+=4)if(i[r]>0)return!0;return!1},e.prototype.isHitTesting=function(){return!!this._hitPoint},e.prototype._prepareShadow=function(t,e){e.shadowBlur?(t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor||"#000",t.shadowOffsetX=e.shadowOffsetX||0,t.shadowOffsetY=e.shadowOffsetY||0):t.shadowBlur&&(t.shadowBlur=null,t.shadowColor=null,t.shadowOffsetX=null,t.shadowOffsetY=null)},e.prototype._eachSymbolizer=function(t,e){if(this.symbolizers){e||(e=this);for(var n=this.symbolizers.length-1;n>=0;n--)t.apply(e,[this.symbolizers[n]])}},e.prototype.get2DExtent=function(t){this._verifyProjection();var e=this.getMap();t=t||this.getLayer()._getRenderer().resources;var n=e.getZoom();if((!this._extent2D||this._extent2D._zoom!==n)&&(delete this._extent2D,delete this._fixedExtent,this.symbolizers)){for(var i=this._extent2D=new In,r=this._fixedExtent=new In,o=this.symbolizers.length-1;o>=0;o--){var s=this.symbolizers[o];i._combine(s.get2DExtent()),s.getFixedExtent&&r._combine(s.getFixedExtent(t))}i._zoom=n}return this._extent2D.add(this._fixedExtent)},e.prototype.getContainerExtent=function(){this._verifyProjection();var t=this.getMap(),e=t.getZoom(),n=t.getGLScale();this._extent2D&&this._extent2D._zoom===e||this.get2DExtent();var i=this.getMinAltitude(),r=t.getFrustumAltitude();if(i&&r&&r<i)return null;var o=this._extent2D.convertTo(function(r){return t._pointToContainerPoint(r,e,i/n)}),s=this.getMaxAltitude();if(s!==i){var a=this._extent2D.convertTo(function(i){return t._pointToContainerPoint(i,e,s/n)});o._combine(a)}return o&&o._add(this._fixedExtent),this.geometry.options.smoothness&&o._expand(.15*o.getWidth()),o},e.prototype.getFixedExtent=function(){var t=this.getMap().getZoom();return this._extent2D&&this._extent2D._zoom===t||this.get2DExtent(),this._fixedExtent},e.prototype.setZIndex=function(t){this._eachSymbolizer(function(e){e.setZIndex(t)})},e.prototype.show=function(){this._painted?(this.removeCache(),this._eachSymbolizer(function(t){t.show()})):this.getLayer().isCanvasRender()||this.paint()},e.prototype.hide=function(){this._eachSymbolizer(function(t){t.hide()})},e.prototype.repaint=function(){this._altAtGLZoom=this._getGeometryAltitude(),this.removeCache();var t=this.getLayer();if(t){var e=t.getRenderer();e&&e.setToRedraw()&&e.setToRedraw()}},e.prototype.refreshSymbol=function(){this.removeCache(),this._removeSymbolizers(),this.symbolizers=this._createSymbolizers()},e.prototype.remove=function(){this.removeCache(),this._removeSymbolizers()},e.prototype._removeSymbolizers=function(){this._eachSymbolizer(function(t){delete t.painter,t.remove()}),delete this.symbolizers},e.prototype.removeCache=function(){delete this._renderPoints,delete this._paintParams,delete this._sprite,delete this._extent2D,delete this._fixedExtent,delete this._cachedParams,delete this._unsimpledParams,this.geometry&&delete this.geometry[Ci.CACHE_KEY]},e.prototype.getAltitude=function(){return this._getAltitudeProperty()!==this._propAlt&&(this._altAtGLZoom=this._getGeometryAltitude()),this._altAtGLZoom?this._altAtGLZoom:0},e.prototype.getMinAltitude=function(){return this.minAltitude?this.minAltitude:0},e.prototype.getMaxAltitude=function(){return this.maxAltitude?this.maxAltitude:0},e.prototype._getGeometryAltitude=function(){var t=this;if(!this.getMap())return 0;var e=this._getAltitudeProperty();if(this._propAlt=e,!e)return this.minAltitude=this.maxAltitude=0,0;var n=this.geometry.getCenter();return Array.isArray(e)?(this.minAltitude=Number.MAX_VALUE,this.maxAltitude=Number.MIN_VALUE,e.map(function(e){var i=t._meterToPoint(n,e);return i<t.minAltitude&&(t.minAltitude=i),i>t.maxAltitude&&(t.maxAltitude=i),i})):(this.minAltitude=this.maxAltitude=this._meterToPoint(n,e),this.minAltitude)},e.prototype._meterToPoint=function(t,e){var n=this.getMap(),i=n.getGLZoom(),r=n.locate(t,e,0),o=n.coordToPoint(t,i),s=n.coordToPoint(r,i);return Math.abs(s.x-o.x)*B(e)},e.prototype._getAltitudeProperty=function(){var t=this.geometry,e=t.getLayer().options,n=t.getProperties();return e.enableAltitude&&n?n[e.altitudeProperty]:0},e.prototype._verifyProjection=function(){var t=this.geometry._getProjection();this._projCode&&this._projCode!==t.code&&this.removeCache(),this._projCode=t.code},e.prototype._beforePaint=function(){var t=this.geometry[Ci.CACHE_KEY];if(t)for(var e in t)S(t,e)&&(t[e].active=!1)},e.prototype._afterPaint=function(){var t=this.geometry[Ci.CACHE_KEY];if(t)for(var e in t)S(t,e)&&(t[e].active||delete t[e])},e}(dn);var Li=function(t){function e(n){f(this,e);var i=d(this,t.call(this));return i.geometry=n,i}return p(e,t),e.prototype._eachPainter=function(t){for(var e=this.geometry.getGeometries(),n=void 0,i=0,r=e.length;i<r&&(!(n=e[i]._getPainter())||!n||!1!==t.call(this,n));i++);},e.prototype.paint=function(t){this.geometry&&this._eachPainter(function(e){e.paint(t)})},e.prototype.get2DExtent=function(t){var e=new In;return this._eachPainter(function(n){e=e.combine(n.get2DExtent(t))}),e},e.prototype.getContainerExtent=function(){var t=new In;return this._eachPainter(function(e){t=t.combine(e.getContainerExtent())}),t},e.prototype.remove=function(){var t=arguments;this._eachPainter(function(e){e.remove.apply(e,t)})},e.prototype.setZIndex=function(){var t=arguments;this._eachPainter(function(e){e.setZIndex.apply(e,t)})},e.prototype.show=function(){var t=arguments;this._eachPainter(function(e){e.show.apply(e,t)})},e.prototype.hide=function(){var t=arguments;this._eachPainter(function(e){e.hide.apply(e,t)})},e.prototype.repaint=function(){var t=arguments;this._eachPainter(function(e){e.repaint.apply(e,t)})},e.prototype.refreshSymbol=function(){var t=arguments;this._eachPainter(function(e){e.refreshSymbol.apply(e,t)})},e.prototype.hasPoint=function(){var t=!1;return this._eachPainter(function(e){return!e.hasPoint()||(t=!0,!1)}),t},e.prototype.getMinAltitude=function(){var t=!0,e=0;return this._eachPainter(function(n){var i=n.getMinAltitude();(t||i<e)&&(t=!1,e=i)}),e},e.prototype.getMaxAltitude=function(){var t=0;return this._eachPainter(function(e){var n=e.getMaxAltitude();n>t&&(t=n)}),t},e}(dn),Ni=function(t){function e(n){f(this,e);var i=y({},n),r=i.symbol,o=i.properties,s=i.id;delete i.symbol,delete i.id,delete i.properties;var a=d(this,t.call(this,i));return r&&a.setSymbol(r),o&&a.setProperties(o),m(s)||a.setId(s),a}return p(e,t),e.prototype.getFirstCoordinate=function(){if("GeometryCollection"===this.type){var t=this.getGeometries();return t.length?t[0].getFirstCoordinate():null}var e=this.getCoordinates();if(!Array.isArray(e))return e;do{e=e[0]}while(Array.isArray(e)&&e.length>0);return e},e.prototype.getLastCoordinate=function(){if("GeometryCollection"===this.type){var t=this.getGeometries();return t.length?t[t.length-1].getLastCoordinate():null}var e=this.getCoordinates();if(!Array.isArray(e))return e;do{e=e[e.length-1]}while(Array.isArray(e)&&e.length>0);return e},e.prototype.addTo=function(t,e){return t.addGeometry(this,e),this},e.prototype.getLayer=function(){return this._layer?this._layer:null},e.prototype.getMap=function(){return this._layer?this._layer.getMap():null},e.prototype.getId=function(){return this._id},e.prototype.setId=function(t){var e=this.getId();return this._id=t,this._fireEvent("idchange",{old:e,new:t}),this},e.prototype.getProperties=function(){return this.properties?this.properties:this._getParent()?this._getParent().getProperties():null},e.prototype.setProperties=function(t){var e=this.properties;return this.properties=x(t)?y({},t):t,this._repaint(),this._fireEvent("propertieschange",{old:e,new:t}),this},e.prototype.getType=function(){return this.type},e.prototype.getSymbol=function(){var t=this._symbol;return t?Array.isArray(t)?Gt(t):y({},t):null},e.prototype.setSymbol=function(t){return this._symbol=this._prepareSymbol(t),this.onSymbolChanged(),this},e.prototype.updateSymbol=function(t){if(!t)return this;var e=this._getSymbol();return e=Gt(e||this._getInternalSymbol(),t),this.setSymbol(e)},e.prototype.getCenter=function(){return this._computeCenter(this._getMeasurer())},e.prototype.getExtent=function(){var t=this._getPrjExtent();if(t){var e=this._getProjection(),n=e.unproject(new wn(t.xmin,t.ymin)),i=e.unproject(new wn(t.xmax,t.ymax));return new Sn(n,i,this._getProjection())}return this._computeExtent(this._getMeasurer())},e.prototype.getContainerExtent=function(){var t=this._getPainter();return t?t.getContainerExtent():null},e.prototype.getSize=function(){var t=this.getContainerExtent();return t?t.getSize():null},e.prototype.containsPoint=function(t,e){if(!this.getMap())throw new Error('The geometry is required to be added on a map to perform "containsPoint".');return t instanceof wn&&(t=this.getMap().coordToContainerPoint(t)),this._containsPoint(t,e)},e.prototype._containsPoint=function(t,e){var n=this._getPainter();return!!n&&(m(e)&&this._hitTestTolerance&&(e=this._hitTestTolerance()),n.hitTest(t,e))},e.prototype.show=function(){if(this.options.visible=!0,this.getMap()){var t=this._getPainter();t&&t.show(),this._fireEvent("show")}return this},e.prototype.hide=function(){if(this.options.visible=!1,this.getMap()){this.onHide();var t=this._getPainter();t&&t.hide(),this._fireEvent("hide")}return this},e.prototype.isVisible=function(){if(!this.options.visible)return!1;var t=this._getInternalSymbol();if(!t)return!0;if(Array.isArray(t)){if(!t.length)return!0;for(var e=0,n=t.length;e<n;e++)if(m(t[e].opacity)||t[e].opacity>0)return!0;return!1}return m(t.opacity)||v(t.opacity)&&t.opacity>0},e.prototype.getZIndex=function(){return this.options.zIndex||0},e.prototype.setZIndex=function(t){var e=this.options.zIndex;return this.options.zIndex=t,this._fireEvent("zindexchange",{old:e,new:t}),this},e.prototype.setZIndexSilently=function(t){return this.options.zIndex=t,this},e.prototype.bringToFront=function(){var t=this.getLayer();if(!t||!t.getGeoMaxZIndex)return this;var e=t.getGeoMaxZIndex();return this.setZIndex(e+1),this},e.prototype.bringToBack=function(){var t=this.getLayer();if(!t||!t.getGeoMinZIndex)return this;var e=t.getGeoMinZIndex();return this.setZIndex(e-1),this},e.prototype.translate=function(t,e){if(m(t))return this;var n=new wn(t,e);if(0===n.x&&0===n.y)return this;var i=this.getCoordinates();if(i)if(Array.isArray(i)){var r=z(i,function(t){return t.add(n)});this.setCoordinates(r)}else this.setCoordinates(i.add(n));return this},e.prototype.flash=function(t,e,n,i){return ot.call(this,t,e,n,i)},e.prototype.copy=function(){var t=this.toJSON(),n=e.fromJSON(t);return n.options.visible=!0,n},e.prototype.remove=function(){return this.getLayer()?(this._fireEvent("removestart"),this._unbind(),this._fireEvent("removeend"),this._fireEvent("remove"),this):this},e.prototype.toGeoJSONGeometry=function(){return this._exportGeoJSONGeometry()},e.prototype.toGeoJSON=function(t){t||(t={});var e={type:"Feature",geometry:null};if(m(t.geometry)||t.geometry){var n=this._exportGeoJSONGeometry();e.geometry=n}var i=this.getId();m(i)||(e.id=i);var r=void 0;return(m(t.properties)||t.properties)&&(r=this._exportProperties()),e.properties=r,e},e.prototype.toJSON=function(t){t||(t={});var e=this._toJSON(t);return y(e,this._exportGraphicOptions(t)),e},e.prototype.getLength=function(){return this._computeGeodesicLength(this._getMeasurer())},e.prototype.getArea=function(){return this._computeGeodesicArea(this._getMeasurer())},e.prototype.rotate=function(t,e){if("GeometryCollection"===this.type)return this.getGeometries().forEach(function(n){return n.rotate(t,e)}),this;e=e?new wn(e):this.getCenter();var n=this._getMeasurer(),i=this.getCoordinates();if(!Array.isArray(i)){if(e.x!==i.x||e.y!==i.y){var r=n._rotate(i,e,t);this.setCoordinates(r)}return this}return z(i,function(i){return n._rotate(i,e,t)}),this.setCoordinates(i),this},e.prototype._getConnectPoints=function(){return[this.getCenter()]},e.prototype._initOptions=function(t){var e=y({},t),n=e.symbol,i=e.properties,r=e.id;delete e.symbol,delete e.id,delete e.properties,this.setOptions(e),n&&this.setSymbol(n),i&&this.setProperties(i),m(r)||this.setId(r)},e.prototype._bindLayer=function(t){if(this.getLayer())throw new Error("Geometry cannot be added to two or more layers at the same time.");this._layer=t,this._clearCache(),this._clearProjection()},e.prototype._prepareSymbol=function(t){if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(Ot(this._checkAndCopySymbol(t[n])));return e}return t?Ot(t=this._checkAndCopySymbol(t)):null},e.prototype._checkAndCopySymbol=function(t){var e={};for(var n in t)u[n]&&w(t[n])?e[n]=+t[n]:e[n]=t[n];return e},e.prototype._getSymbol=function(){return this._symbol},e.prototype._setExternSymbol=function(t){return this._externSymbol=this._prepareSymbol(t),this.onSymbolChanged(),this},e.prototype._getInternalSymbol=function(){return this._symbol?this._symbol:this._externSymbol?this._externSymbol:this.options.symbol?this.options.symbol:null},e.prototype._getPrjExtent=function(){var t=this._getProjection();return this._verifyProjection(),!this._extent&&t&&(this._extent=this._computePrjExtent(t)),this._extent},e.prototype._unbind=function(){var t=this.getLayer();t&&(this._animPlayer&&this._animPlayer.finish(),this._clearHandlers(),this._unbindMenu(),this._unbindInfoWindow(),this.isEditing()&&this.endEdit(),this._removePainter(),this.onRemove&&this.onRemove(),t.onRemoveGeometry&&t.onRemoveGeometry(this),delete this._layer,delete this._internalId,delete this._extent)},e.prototype._getInternalId=function(){return this._internalId},e.prototype._setInternalId=function(t){this._internalId=t},e.prototype._getMeasurer=function(){return this._getProjection()?this._getProjection():ni.getProjectionInstance(this.options.defaultProjection)},e.prototype._getProjection=function(){var t=this.getMap();return t?t.getProjection():null},e.prototype._verifyProjection=function(){var t=this._getProjection();!this._projCode||t&&this._projCode===t.code||this._clearProjection(),this._projCode=t?t.code:null},e.prototype._getExternalResources=function(){return Rt(this._getInternalSymbol())},e.prototype._getPainter=function(){return!this._painter&&this.getMap()&&(-1!==o.indexOf(this.type)?this._painter=new Li(this):this._painter=new Ti(this)),this._painter},e.prototype._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter},e.prototype._paint=function(t){this._painter&&this._painter.paint(t)},e.prototype._clearCache=function(){delete this._extent},e.prototype._clearProjection=function(){delete this._extent},e.prototype._repaint=function(){this._painter&&this._painter.repaint()},e.prototype.onHide=function(){this.closeMenu(),this.closeInfoWindow()},e.prototype.onShapeChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("shapechange")},e.prototype.onPositionChanged=function(){this._clearCache(),this._repaint(),this._fireEvent("positionchange")},e.prototype.onSymbolChanged=function(){this._painter&&this._painter.refreshSymbol(),this._fireEvent("symbolchange")},e.prototype.onConfig=function(t){var e=void 0;t.properties&&(e=t.properties,delete t.properties);var n=!1;for(var i in t)if(t.hasOwnProperty(i)){var r=i.slice(0,5);if("arrow"===r||"smoot"===r){n=!0;break}}e?(this.setProperties(e),this._repaint()):n&&this._repaint()},e.prototype._setParent=function(t){t&&(this._parent=t)},e.prototype._getParent=function(){return this._parent},e.prototype._fireEvent=function(t,e){this.getLayer()&&this.getLayer()._onGeometryEvent&&(e||(e={}),e.type=t,e.target=this,this.getLayer()._onGeometryEvent(e)),this.fire(t,e)},e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t)}},e.prototype._exportGraphicOptions=function(t){var e={};return(m(t.options)||t.options)&&(e.options=this.config()),(m(t.symbol)||t.symbol)&&(e.symbol=this.getSymbol()),(m(t.infoWindow)||t.infoWindow)&&this._infoWinOptions&&(e.infoWindow=this._infoWinOptions),e},e.prototype._exportGeoJSONGeometry=function(){var t=this.getCoordinates(),e=wn.toNumberArrays(t);return{type:this.getType(),coordinates:e}},e.prototype._exportProperties=function(){var t=null,e=this.getProperties();return m(e)||(t=x(e)?y({},e):e),t},e}(yn(cn(mn(dn))));Ni.mergeOptions({id:null,visible:!0,editable:!0,cursor:null,defaultProjection:"EPSG:4326"});var Ri="mousedown mouseup mousemove click dblclick contextmenu touchstart touchmove touchend",Oi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHooks=function(){var t=this.target,e=t._panels.allLayers||t._containerDOM;tn(e,Ri,this._identifyGeometryEvents,this)},e.prototype.removeHooks=function(){var t=this.target,e=t._panels.allLayers||t._containerDOM;en(e,Ri,this._identifyGeometryEvents,this)},e.prototype._identifyGeometryEvents=function(t,e){var n=this.target;if(!n.isInteracting()&&!n._ignoreEvent(t)){var i=n._getLayers(function(t){return!(!t.identify||!t.options.geometryEvents)});if(i.length){var r=null,o=e||t.type;if("mousedown"===o||"touchstart"===o&&1===t.touches.length)this._mouseDownTime=g();else if(("click"===o||"touchend"===o)&&this._mouseDownTime){var s=this._mouseDownTime;if(delete this._mouseDownTime,g()-s>300){if("click"===o)return}else"touchend"===o&&(r="click")}var a=t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t;if(a){var h=qe(a,n._containerDOM),u=n.containerPointToCoordinate(h);"touchstart"===o&&ze(t);var l=null,c={includeInternals:!0,filter:function(e){if(!(e instanceof Ni))return!1;var n=e._getEventTypeToFire(t);if("mousemove"===o){if(!l&&e.options.cursor&&(l=e.options.cursor),!e.listens("mousemove")&&!e.listens("mouseover")&&!e.listens("mouseenter"))return!1}else if(!e.listens(n)&&!e.listens(r))return!1;return!0},count:1,coordinate:u,onlyVisible:n.options.onlyVisibleGeometryEvents,layers:i},f=function(e){var i=!0;if("mousemove"===o){var s={};if(e.length>0)for(var a=e.length-1;a>=0;a--){var h=e[a];if(h instanceof Ni){var u=h._getInternalId();s[u]=h,h._onEvent(t),this._prevOverGeos&&this._prevOverGeos.geomap[u]||h._onEvent(t,"mouseenter"),i=h._onEvent(t,"mouseover")}}n._setPriorityCursor(l);var c=this._prevOverGeos&&this._prevOverGeos.geos;if(this._prevOverGeos={geos:e,geomap:s},c&&c.length>0)for(var f=c.length-1;f>=0;f--){var p=c[f];if(p instanceof Ni){var d=c[f]._getInternalId();s[d]||(i=p._onEvent(t,"mouseout"))}}}else{if(!e||!e.length)return;for(var g=e.length-1;g>=0;g--)if(e[g]instanceof Ni){i=e[g]._onEvent(t),r&&e[g]._onEvent(t,r);break}}!1===i&&je(t)}.bind(this);this._queryIdentifyTimeout&&L(this._queryIdentifyTimeout),"mousemove"===o||"touchmove"===o?this._queryIdentifyTimeout=T(function(){n.isInteracting()||n.identify(c,f)}):n.identify(c,f)}}}},e}(pn);ri.mergeOptions({geometryEvents:!0,onlyVisibleGeometryEvents:!0}),ri.addOnLoadHook("addHandler","geometryEvents",Oi);var Ai=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHooks=function(){ke(this.target._containerDOM,"mousewheel",this._onWheelScroll,this)},e.prototype.removeHooks=function(){Fe(this.target._containerDOM,"mousewheel",this._onWheelScroll)},e.prototype._onWheelScroll=function(t){var e=this,n=this.target;if(n._ignoreEvent(t)||!n.options.zoomable)return!1;if(ze(t),je(t),this._zooming)return this._requesting++,!1;this._requesting=0;var i=n._containerDOM,r=(t.wheelDelta?t.wheelDelta:t.detail)>0?1:-1;t.detail&&(r*=-1);var o=n.getZoom(),s=o+r;if((s=n._checkZoom(r>0?Math.ceil(s):Math.floor(s)))===o)return!1;this._zooming=!0;var a=n._checkZoomOrigin(qe(t,i));this._delta||(n.onZoomStart(null,a),this._origin=a,this._delta=r,this._startZoom=n.getZoom());return n.animateTo({zoom:s-1*this._delta/2,around:this._origin},{continueOnViewChanged:!0,easing:"linear",duration:90,wheelZoom:!0},function(i){"finished"===i.state.playState&&(e._requesting<1||Math.abs(s-e._startZoom)>2||s===n.getMaxZoom()||s===n.getMinZoom()?(n.animateTo({zoom:s,around:e._origin},{continueOnViewChanged:!0,duration:100},function(t){"finished"===t.state.playState&&setTimeout(function(){delete e._zooming,delete e._requesting},200)}),delete e._startZoom,delete e._origin,delete e._delta,e._requesting=0):m(e._requesting)||(delete e._zooming,e._onWheelScroll(t)))}),!1},e}(pn);ri.mergeOptions({scrollWheelZoom:!0}),ri.addOnLoadHook("addHandler","scrollWheelZoom",Ai);var Di=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addHooks=function(){ke(this.target.getContainer(),"touchstart",this._onTouchStart,this)},e.prototype.removeHooks=function(){Fe(this.target.getContainer(),"touchstart",this._onTouchStart)},e.prototype._onTouchStart=function(t){var e=this.target;if(t.touches&&2===t.touches.length&&!e.isInteracting()){var n=e.getContainer(),i=qe(t.touches[0],n),r=qe(t.touches[1],n);this.preY=i.y,this._startP1=i,this._startP2=r,this._startDist=i.distanceTo(r),this._startVector=i.sub(r),this._startZoom=e.getZoom(),this._startBearing=e.getBearing(),ke(document,"touchmove",this._onTouchMove,this),ke(document,"touchend",this._onTouchEnd,this),ze(t),e._fireEvent("touchactstart")}},e.prototype._onTouchMove=function(t){var e=this.target;if(t.touches&&2===t.touches.length){var n=e.getContainer(),i=qe(t.touches[0],n),r=qe(t.touches[1],n),o=i.sub(this._startP1),s=r.sub(this._startP2),a=i.sub(r),h=i.distanceTo(r)/this._startDist,u=180*a.angleWith(this._startVector)/Math.PI,l=.4*((this.preY||i.y)-i.y);this.preY=i.y;var c={domEvent:t,mousePos:[i,r]};if(this.mode||(e.options.touchRotate&&Math.abs(u)>8?this.mode=e.options.touchZoomRotate?"rotate_zoom":"rotate":e.options.touchPitch&&o.y*s.y>0&&Math.abs(o.y)>10&&Math.abs(s.y)>10?this.mode="pitch":e.options.zoomable&&e.options.touchZoom&&Math.abs(1-h)>.15&&(this.mode=e.options.touchZoomRotate&&e.options.touchRotate?"rotate_zoom":"zoom"),this._startTouching(c)),"zoom"===this.mode||"rotate_zoom"===this.mode){this._scale=h;var f=e._getResolution(this._startZoom)/h,p=e.getZoomFromRes(f);e.onZooming(p,this._Origin)}"rotate"===this.mode||"rotate_zoom"===this.mode?(e.setBearing(this._startBearing+u),e.onDragRotating(c)):"pitch"===this.mode&&(e.setPitch(e.getPitch()+l),e.onDragRotating(c)),e._fireEvent("touchactinging")}},e.prototype._startTouching=function(t){var e=this.target;if("zoom"===this.mode||"rotate_zoom"===this.mode){var n=e.getSize();this._Origin=new le(n.width/2,n.height/2),e.onZoomStart(null,this._Origin)}"rotate"!==this.mode&&"pitch"!==this.mode&&"rotate_zoom"!==this.mode||e.onDragRotateStart(t)},e.prototype._onTouchEnd=function(t){delete this.preY;var e=this.target;if(en(document,"touchmove",this._onTouchMove,this),en(document,"touchend",this._onTouchEnd,this),"zoom"===this.mode||"rotate_zoom"===this.mode){var n=this._scale,i=e._getResolution(this._startZoom)/n,r=e.getZoomFromRes(i);e.onZoomEnd(r,this._Origin)}"pitch"!==this.mode&&"rotate"!==this.mode&&"rotate_zoom"!==this.mode||e.onDragRotateEnd({domEvent:t}),delete this.mode,e._fireEvent("touchactend")},e}(pn);ri.mergeOptions({touchGesture:!0,touchZoom:!0,touchPitch:!0,touchRotate:!0,touchZoomRotate:!1}),ri.addOnLoadHook("addHandler","touchGesture",Di);var ki={in:function(t){return Math.pow(t,2)},out:function(t){return 1-ki.in(1-t)},inAndOut:function(t){return 3*t*t-2*t*t*t},linear:function(t){return t},upAndDown:function(t){return t<.5?ki.inAndOut(2*t):1-ki.inAndOut(2*(t-.5))}},Fi=function t(e,n){f(this,t),this.state=e,this.styles=n},Gi=function t(e,n,i){f(this,t),this._animation=e,this.options=n,this._onFrame=i,this.playState="idle",this.ready=!0,this.finished=!1},zi={speed:{slow:2e3,normal:1e3,fast:500},_resolveStyles:function(t){if(!t)return null;function e(t){if(!Array.isArray(t))return zi._resolveStyles(t);for(var e=[],n=[],i=[],r=0;r<t.length;r++){var o=zi._resolveStyles(t[r]);o&&(e.push(o[0]),n.push(o[1]),i.push(o[2]))}return e.length?[e,n,i]:null}function n(t){var e=t,n=void 0;Array.isArray(t)||(e=v(t)?[0,t]:t instanceof le||t instanceof wn?[new(n=t.constructor)(0,0),t]:[t,t]);var i=e[0],r=e[1];return v(i)&&v(r)?i===r?null:[i,r-i,r]:Array.isArray(i)||i instanceof wn||i instanceof le?(Array.isArray(i)?(i=new wn(i),r=new wn(r)):(i=new(n=i.constructor)(i),r=new n(r)),i.equals(r)?null:[i,r.sub(i),r]):[i,0,r]}var i,r={},o={},s={};for(var a in t)if(t.hasOwnProperty(a)){var h=t[a];if(!h)continue;if(Array.isArray(h)&&(m(h[0])||m(h[1])))continue;var u=void 0;i=h,(u=!Array.isArray(i)&&i.constructor===Object||Array.isArray(i)&&i[0].constructor===Object?e(h):n(h))&&(o[a]=u[0],r[a]=u[1],s[a]=u[2])}return[o,r,s]},framing:function(t,e){e||(e={});var n=e.easing?ki[e.easing]:ki.linear;n||(n=ki.linear);var i=void 0,r=void 0,o=void 0;(t=zi._resolveStyles(t))&&(r=t[0],i=t[1],o=t[2]);return function(t,e){var s=void 0,a=void 0;if(t<0)s={playState:"idle",delta:0},a=r;else if(t<e){var h=n(t/e);s={playState:"running",delta:h},a=function t(e,n,i){if(!n||!i)return null;var r={};for(var s in i)if(i.hasOwnProperty(s)){if(n[s]===o[s]){r[s]=n[s];continue}var a=n[s],h=i[s];if(v(h))r[s]=a+e*h;else if(Array.isArray(h)){for(var u=[],l=0;l<h.length;l++)u.push(t(e,a[l],h[l]));r[s]=u}else h.constructor===Object?r[s]=t(e,a,h):(a instanceof le||a instanceof wn)&&(r[s]=a.add(h.multi(e)))}return r}(h,r,i)}else s={playState:"finished",delta:1},a=o;return s.startStyles=r,s.destStyles=o,s.progress=t,s.remainingMs=e-t,new Fi(s,a)}},_requestAnimFrame:function(t){this._frameQueue||(this._frameQueue=[]),this._frameQueue.push(t),this._a()},_a:function(){this._animationFrameId||(this._animationFrameId=T(zi._frameFn))},_run:function(){if(this._frameQueue.length){var t=this._frameQueue;this._frameQueue=[];for(var e=0,n=t.length;e<n;e++)t[e]();this._frameQueue.length?this._animationFrameId=T(zi._frameFn):delete this._animationFrameId}},animate:function(t,e,n){e||(e={});var i=zi.framing(t,e);return new Gi(i,e,n)}};zi._frameFn=zi._run.bind(zi),y(Gi.prototype,{_prepare:function(){var t=this.options,e=t.speed||t.duration;w(e)&&((e=zi.speed[e])||(e=+e)),e||(e=zi.speed.normal),this.duration=e,this._framer=t.framer||zi._requestAnimFrame.bind(zi)},play:function(){if("idle"!==this.playState&&"paused"!==this.playState)return this;"idle"===this.playState&&(this.currentTime=0,this._prepare());var t=g();if(!this.startTime){var e=this.options;this.startTime=e.startTime?e.startTime:t}return this._playStartTime=Math.max(t,this.startTime),"paused"===this.playState&&(this._playStartTime-=this.currentTime),this.playState="running",this._run(),this},pause:function(){return"paused"===this.playState?this:(this.playState="paused",this._run(),this)},cancel:function(){return"idle"===this.playState?this:(this.playState="idle",this.finished=!1,this._run(),this)},finish:function(){return"finished"===this.playState?this:(this.playState="finished",this.finished=!0,this._run(),this)},reverse:function(){},_run:function(){var t=this,e=this._onFrame,n=g(),i=n-this._playStartTime;if(this.options.repeat&&i>=this.duration&&(this._playStartTime=n,i=0),"running"===this.playState){var r=this._animation(i,this.duration);this.playState=r.state.playState,"idle"===this.playState?this.startTime>n&&setTimeout(this._run.bind(this),this.startTime-n):"running"===this.playState?this._framer(function(){"running"===t.playState&&(t.currentTime=i,e&&e(r),t._run())}):"finished"===this.playState&&(this.finished=!0,e&&e(r))}else if(e){"finished"===this.playState?i=this.duration:"idle"===this.playState&&(i=0);var o=this._animation(i,this.duration);o.state.playState=this.playState,e(o)}}});var ji=Object.freeze({Animation:zi,Easing:ki,Player:Gi,Frame:Fi}),Bi=Yn(function(t){!function(){function e(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);a>1?(i=n.x,r=n.y):a>0&&(i+=o*a,r+=s*a)}return(o=t.x-i)*o+(s=t.y-r)*s}function n(t,n){var i=t.length-1,r=[t[0]];return function t(n,i,r,o,s){for(var a,h=o,u=i+1;u<r;u++){var l=e(n[u],n[i],n[r]);l>h&&(a=u,h=l)}h>o&&(a-i>1&&t(n,i,a,o,s),s.push(n[a]),r-a>1&&t(n,a,r,o,s))}(t,0,i,n,r),r.push(t[i]),r}function i(t,e,i){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return t=n(t=i?t:function(t,e){for(var n,i,r,o,s,a=t[0],h=[a],u=1,l=t.length;u<l;u++)n=t[u],r=a,o=(i=n).x-r.x,s=i.y-r.y,o*o+s*s>e&&(h.push(n),a=n);return a!==n&&h.push(n),h}(t,r),r)}t.exports=i,t.exports.default=i}()}),Hi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getOutline=function(){var t=this._getPainter();if(!t)return null;var e=this.getMap(),n=t.getContainerExtent().convertTo(function(t){return e.containerPointToCoord(t)});return new Vi(n.toArray(),{symbol:{lineWidth:1,lineColor:"6b707b"}})},e.prototype.animateShow=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments[1];this._showPlayer&&this._showPlayer.finish(),C(e)&&(n=e={});var i=this.getCoordinates();if(0===i.length)return this;this._animIdx=0,this._animLenSoFar=0,this.show();var r=!!this.getShell?this.getShell().concat(this.getShell()[0]):this.getCoordinates(),o=this._getProjection();this._aniShowCenter=o.unproject(this._getPrjExtent().getCenter());var s=e.duration||1e3,a=this.getLength(),h=e.easing||"out";this.setCoordinates([]);var u=this._showPlayer=zi.animate({t:s},{duration:s,easing:h},function(e){if(t.getMap()){var o=t._drawAnimShowFrame(e.styles.t,s,a,r);"finished"===e.state.playState&&(delete t._showPlayer,delete t._aniShowCenter,delete t._animIdx,delete t._animLenSoFar,delete t._animTailRatio,t.setCoordinates(i)),n&&n(e,o)}else if("finished"!==u.playState&&(u.finish(),n)){var h=t.getCoordinates();n(e,h[h.length-1])}});return u.play(),u},e.prototype._drawAnimShowFrame=function(t,e,n,i){if(0===t)return i[0];var r,o=this.getMap(),s=t/e*n,a=0,h=void 0;for(h=this._animIdx,r=i.length;h<r-1&&(a=o.computeLength(i[h],i[h+1]),!(this._animLenSoFar+a>s));h++)this._animLenSoFar+=a;if(this._animIdx=h,this._animIdx>=r-1)return this.setCoordinates(i),i[i.length-1];var u=this._animIdx,l=i[u],c=i[u+1],f=(s-this._animLenSoFar)/a;this._animTailRatio=f;var p=l.x+(c.x-l.x)*f,d=l.y+(c.y-l.y)*f,g=new wn(p,d),y=!!this.getShell;if(!y&&this.options.smoothness>0){var m=i.slice(0,this._animIdx+3);this.setCoordinates(m)}else{var v=i.slice(0,this._animIdx+1);v.push(g),y?this.setCoordinates([this._aniShowCenter].concat(v)):this.setCoordinates(v)}return g},e.prototype._getCenterInExtent=function(t,e,n){var i=this.getExtent();if(!t.intersects(i))return null;var r=n(e,t);if(0===r.length)return null;var o=0,s=0,a=0;r.forEach(function(t){Array.isArray(t)?t.forEach(function(t){t.point&&(t=t.point),o+=t.x,s+=t.y,a++}):(t.point&&(t=t.point),o+=t.x,s+=t.y,a++)});var h=new wn(o,s)._multi(1/a);return h.count=a,h},e.prototype._getPath2DPoints=function(t,e,n){if(!Z(t))return[];var i=this.getMap(),r=!e&&this._shouldSimplify(),o=2*i._getResolution(),s=Array.isArray(t[0]);if(delete this._simplified,r&&!s){var a=t.length;t=Bi(t,o,!1),this._simplified=t.length<a}return m(n)&&(n=i.getZoom()),z(t,function(t){return i._prjToPoint(t,n)})},e.prototype._shouldSimplify=function(){var t=this.getLayer(),e=this.getProperties(),n=e&&t.options.enableAltitude&&!m(e[t.options.altitudeProperty]);return t&&t.options.enableSimplify&&!n&&this.options.enableSimplify},e.prototype._setPrjCoordinates=function(t){this._prjCoords=t,this.onShapeChanged()},e.prototype._getPrjCoordinates=function(){return this._getProjection()?(this._verifyProjection(),this._prjCoords||(this._prjCoords=this._projectCoords(this._coordinates)),this._prjCoords):null},e.prototype._updateCache=function(){this._clearCache(),this._getProjection()&&this._prjCoords&&(this._coordinates=this._unprojectCoords(this._getPrjCoordinates()))},e.prototype._clearProjection=function(){this._prjCoords=null,t.prototype._clearProjection.call(this)},e.prototype._projectCoords=function(t){var e=this._getProjection();return e?e.projectCoords(t):[]},e.prototype._unprojectCoords=function(t){var e=this._getProjection();return e?e.unprojectCoords(t):[]},e.prototype._computeCenter=function(){var t=this._coordinates;if(!Z(t))return null;for(var e=0,n=0,i=0,r=t.length,o=0;o<r;o++)t[o]&&v(t[o].x)&&v(t[o].y)&&(e+=t[o].x,n+=t[o].y,i++);return new wn(e/i,n/i)},e.prototype._computeExtent=function(){var t=this._coordinates;if(!Z(t))return null;var e=[t];return this.hasHoles&&this.hasHoles()&&e.push.apply(e,this.getHoles()),this._coords2Extent(e,this._getProjection())},e.prototype._computePrjExtent=function(){var t=[this._getPrjCoordinates()];return this.hasHoles&&this.hasHoles()&&t.push.apply(t,this._getPrjHoles()),this._coords2Extent(t)},e.prototype._get2DLength=function(){for(var t=this._getPath2DPoints(this._getPrjCoordinates(),!0),e=0,n=1,i=t.length;n<i;n++)e+=t[n].distanceTo(t[n-1]);return e},e.prototype._hitTestTolerance=function(){var t=this._getInternalSymbol(),e=void 0;if(Array.isArray(t)){e=0;for(var n=0;n<t.length;n++)v(t[n].lineWidth)&&t[n].lineWidth>e&&(e=t[n].lineWidth)}else e=t.lineWidth;return v(e)?e/2:1.5},e.prototype._coords2Extent=function(t,e){for(var n=new Sn(e),i=0,r=t.length;i<r;i++)for(var o=0,s=t[i].length;o<s;o++)n._combine(t[i][o]);return n},e}(Ni);Hi.mergeOptions({smoothness:0,enableClip:!0,enableSimplify:!0,symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:1,opacity:1}});var Vi=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r.type="Polygon",n&&r.setCoordinates(n),r}return p(e,t),e.prototype.setCoordinates=function(t){if(!t)return this._coordinates=null,this._holes=null,this._projectRings(),this;var e=wn.toCoordinates(t),n=e.length;if(Array.isArray(e[0])){if(this._coordinates=this._trimRing(e[0]),n>1){for(var i=[],r=1;r<n;r++)e[r]&&i.push(this._trimRing(e[r]));this._holes=i}}else this._coordinates=this._trimRing(e);return this._projectRings(),this},e.prototype.getCoordinates=function(){if(!this._coordinates)return[];for(var t=this.getHoles(),e=[this._copyAndCloseRing(this._coordinates)],n=0,i=t.length;n<i;n++)e.push(this._copyAndCloseRing(t[n]));return e},e.prototype.getCenterInExtent=function(t){return this._getCenterInExtent(t,this.getShell(),li)},e.prototype.getShell=function(){return this._coordinates||[]},e.prototype.getHoles=function(){return this._holes||[]},e.prototype.hasHoles=function(){return this.getHoles().length>0},e.prototype._projectRings=function(){this.getMap()?(this._prjCoords=this._projectCoords(this._coordinates),this._prjHoles=this._projectCoords(this._holes),this.onShapeChanged()):this.onShapeChanged()},e.prototype._cleanRing=function(t){for(var e=t.length-1;e>=0;e--)t[e]||t.splice(e,1)},e.prototype._checkRing=function(t){if(this._cleanRing(t),!t||!Z(t))return!1;var e=t[t.length-1],n=!0;return t[0].x===e.x&&t[0].y===e.y||(n=!1),n},e.prototype._trimRing=function(t){var e=this._checkRing(t);return Z(t)&&e&&t.splice(t.length-1,1),t},e.prototype._copyAndCloseRing=function(t){t=t.slice(0);var e=this._checkRing(t);return Z(t)&&!e?(t.push(t[0].copy()),t):t},e.prototype._getPrjShell=function(){return"Polygon"===this.getJSONType()?this._getPrjCoordinates():this._getProjection()?(this._verifyProjection(),this._prjShell||(this._prjShell=this._projectCoords(this.getShell())),this._prjShell):null},e.prototype._getPrjHoles=function(){return this._getProjection()?(this._verifyProjection(),this._prjHoles||(this._prjHoles=this._projectCoords(this.getHoles())),this._prjHoles):null},e.prototype._computeGeodesicLength=function(t){var e=this.getCoordinates();if(!Z(e))return 0;for(var n=0,i=0,r=e.length;i<r;i++)n+=t.measureLength(e[i]);return n},e.prototype._computeGeodesicArea=function(t){var e=this.getCoordinates();if(!Z(e))return 0;for(var n=t.measureArea(e[0]),i=1,r=e.length;i<r;i++)n-=t.measureArea(e[i]);return n},e.prototype._updateCache=function(){t.prototype._updateCache.call(this),this._prjHoles&&(this._holes=this._unprojectCoords(this._getPrjHoles()))},e.prototype._clearCache=function(){return delete this._prjShell,t.prototype._clearCache.call(this)},e.prototype._clearProjection=function(){this._prjHoles&&(this._prjHoles=null),this._prjShell&&(this._prjShell=null),t.prototype._clearProjection.call(this)},e}(Hi);Vi.registerJSONType("Polygon");var qi=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getCoordinates=function(){return this._coordinates},e.prototype.setCoordinates=function(t){var e=t instanceof wn?t:new wn(t);if(e.equals(this._coordinates))return this;if(this._coordinates=e,!this.getMap())return this.onPositionChanged(),this;var n=this._getProjection();return this._setPrjCoordinates(n.project(this._coordinates)),this},e.prototype._getCenter2DPoint=function(t){var e=this.getMap();if(!e)return null;var n=m(t)?e.getZoom():e.getGLZoom(),i=this._getPrjCoordinates();return i?e._prjToPoint(i,n):null},e.prototype._getPrjCoordinates=function(){var t=this._getProjection();return t?(this._verifyProjection(),this._pcenter||this._coordinates&&(this._pcenter=t.project(this._coordinates)),this._pcenter):null},e.prototype._setPrjCoordinates=function(t){this._pcenter=t,this.onPositionChanged()},e.prototype._updateCache=function(){this._clearCache();var t=this._getProjection();this._pcenter&&t&&(this._coordinates=t.unproject(this._pcenter))},e.prototype._clearProjection=function(){this._pcenter=null,t.prototype._clearProjection.call(this)},e.prototype._computeCenter=function(){return this._coordinates?this._coordinates.copy():null},e}(t)},Wi=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r.type="Point",n&&r.setCoordinates(n),r}return p(e,t),e.prototype.getOutline=function(){var t=this._getPainter();if(!t)return null;var n=this.getCoordinates(),i=t.getContainerExtent(),r=this.getMap().coordToContainerPoint(n);return new e(n,{symbol:{markerType:"square",markerWidth:i.getWidth(),markerHeight:i.getHeight(),markerLineWidth:1,markerLineColor:"6b707b",markerFill:"rgba(0, 0, 0, 0)",markerDx:i.xmin-(r.x-i.getWidth()/2),markerDy:i.ymin-(r.y-i.getHeight()/2)}})},e.prototype._isVectorMarker=function(){var t=this._getInternalSymbol();return!Array.isArray(t)&&mi.test(t)},e.prototype._canEdit=function(){var t=this._getInternalSymbol();return!Array.isArray(t)&&(mi.test(t)||Ei.test(t)||_i.test(t))},e.prototype._containsPoint=function(e,n){var i=this.getContainerExtent();return n&&(i=i.expand(n)),!!i.contains(e)&&(!this.options.hitTestForEvent||t.prototype._containsPoint.call(this,e,n))},e.prototype._computeExtent=function(){return Zi.call(this,"getCenter")},e.prototype._computePrjExtent=function(){return Zi.call(this,"_getPrjCoordinates")},e.prototype._computeGeodesicLength=function(){return 0},e.prototype._computeGeodesicArea=function(){return 0},e.prototype._getSprite=function(t,e){return this._getPainter()?this._getPainter().getSprite(t,e):new Ti(this).getSprite(t,e)},e}(qi(Ni));function Zi(t){var e=this[t]();return e?new Sn(e,e,this._getProjection()):null}Wi.mergeOptions({symbol:{markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},hitTestForEvent:!1}),Wi.registerJSONType("Marker");var Ui=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r.type="LineString",n&&r.setCoordinates(n),r}return p(e,t),e.prototype.setCoordinates=function(t){return t?(this._coordinates=wn.toCoordinates(t),this.getMap()?this._setPrjCoordinates(this._projectCoords(this._coordinates)):this.onShapeChanged(),this):(this._coordinates=null,this._setPrjCoordinates(null),this)},e.prototype.getCoordinates=function(){return this._coordinates||[]},e.prototype.getCenterInExtent=function(t){return this._getCenterInExtent(t,this.getCoordinates(),ai)},e.prototype._computeGeodesicLength=function(t){return t.measureLength(this.getCoordinates())},e.prototype._computeGeodesicArea=function(){return 0},e}(Hi);Ui.mergeOptions({arrowStyle:null,arrowPlacement:"vertex-last"}),Ui.registerJSONType("LineString");var Yi=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r.type="GeometryCollection",r.setGeometries(n),r}return p(e,t),e.prototype.setGeometries=function(t){for(var e=this._checkGeometries(t||[]),n=this._getSymbol(),i=this.config(),r=e.length-1;r>=0;r--)e[r]._initOptions(i),e[r]._setParent(this),e[r]._setEventParent(this),n&&e[r].setSymbol(n);return this._geometries=e,this.getLayer()&&(this._bindGeometriesToLayer(),this.onShapeChanged()),this},e.prototype.getGeometries=function(){return this._geometries||[]},e.prototype.forEach=function(t,e){for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)n[i]&&(e?t.call(e,n[i],i):t(n[i],i));return this},e.prototype.filter=function(t,n){if(!t)return new e;var i=[],r=C(t),o=r?t:at(t);return this.forEach(function(t){var e=r?t:yt(t);(n?o.call(n,e):o(e))&&i.push(t)},this),new e(i)},e.prototype.translate=function(t){if(!t)return this;if(this.isEmpty())return this;var e=arguments;return this.forEach(function(t){t&&t.translate&&t.translate.apply(t,e)}),this},e.prototype.isEmpty=function(){return!Z(this.getGeometries())},e.prototype.remove=function(){return this.forEach(function(t){t._unbind()}),Ni.prototype.remove.apply(this,arguments)},e.prototype.show=function(){return this.options.visible=!0,this.forEach(function(t){t.show()}),this},e.prototype.hide=function(){return this.options.visible=!1,this.forEach(function(t){t.hide()}),this},e.prototype.onConfig=function(t){this.forEach(function(e){e.config(t)})},e.prototype.getSymbol=function(){var e=t.prototype.getSymbol.call(this);if(!e){var n=[],i=!1;this.forEach(function(t){t.getSymbol()&&!i&&(i=!0),n.push(t.getSymbol())}),i&&(e={children:n})}return e},e.prototype.setSymbol=function(t){if(t&&t.children)this._symbol=null,this.forEach(function(e,n){e.setSymbol(t.children[n])});else{var e=this._prepareSymbol(t);this._symbol=e,this.forEach(function(t){t.setSymbol(e)})}return this.onSymbolChanged(),this},e.prototype._setExternSymbol=function(t){return t=this._prepareSymbol(t),this._externSymbol=t,this.forEach(function(e){e._setExternSymbol(t)}),this.onSymbolChanged(),this},e.prototype._bindLayer=function(){t.prototype._bindLayer.apply(this,arguments),this._bindGeometriesToLayer()},e.prototype._bindGeometriesToLayer=function(){var t=this.getLayer();this.forEach(function(e){e._bindLayer(t)})},e.prototype._checkGeometries=function(t){if(t&&!Array.isArray(t)){if(t instanceof Ni)return[t];throw new Error("The geometry added to collection is invalid.")}for(var e=0,n=t.length;e<n;e++)if(!this._checkGeo(t[e]))throw new Error("The geometry added to collection is invalid. Index: "+e);return t},e.prototype._checkGeo=function(t){return t instanceof Ni},e.prototype._updateCache=function(){this._clearCache(),this.isEmpty()||this.forEach(function(t){t&&t._updateCache&&t._updateCache()})},e.prototype._removePainter=function(){this._painter&&this._painter.remove(),delete this._painter,this.forEach(function(t){t._removePainter()})},e.prototype._computeCenter=function(t){if(!t||this.isEmpty())return null;for(var e=0,n=0,i=0,r=this.getGeometries(),o=0,s=r.length;o<s;o++)if(r[o]){var a=r[o]._computeCenter(t);a&&(e+=a.x,n+=a.y,i++)}return 0===i?null:new wn(e/i,n/i)},e.prototype._containsPoint=function(t,e){if(this.isEmpty())return!1;for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)if(n[i]._containsPoint(t,e))return!0;return!1},e.prototype._computeExtent=function(t){return Xi.call(this,t,"_computeExtent")},e.prototype._computePrjExtent=function(t){return Xi.call(this,t,"_computePrjExtent")},e.prototype._computeGeodesicLength=function(t){if(!t||this.isEmpty())return 0;for(var e=this.getGeometries(),n=0,i=0,r=e.length;i<r;i++)e[i]&&(n+=e[i]._computeGeodesicLength(t));return n},e.prototype._computeGeodesicArea=function(t){if(!t||this.isEmpty())return 0;for(var e=this.getGeometries(),n=0,i=0,r=e.length;i<r;i++)e[i]&&(n+=e[i]._computeGeodesicArea(t));return n},e.prototype._exportGeoJSONGeometry=function(){var t=[];if(!this.isEmpty())for(var e=this.getGeometries(),n=0,i=e.length;n<i;n++)e[n]&&t.push(e[n]._exportGeoJSONGeometry());return{type:"GeometryCollection",geometries:t}},e.prototype._clearProjection=function(){if(!this.isEmpty())for(var t=this.getGeometries(),e=0,n=t.length;e<n;e++)t[e]&&t[e]._clearProjection()},e.prototype._getConnectPoints=function(){var t=this.getExtent();return[new wn(t.xmin,t.ymax),new wn(t.xmax,t.ymin),new wn(t.xmin,t.ymin),new wn(t.xmax,t.ymax)]},e.prototype._getExternalResources=function(){if(this.isEmpty())return[];for(var t=this.getGeometries(),e=[],n={},i=void 0,r=void 0,o=0,s=t.length;o<s;o++)if(t[o])for(var a=0,h=(i=Rt(t[o]._getInternalSymbol())).length;a<h;a++)n[r=i[a].join()]||(e.push(i[a]),n[r]=1);return e},e.prototype.startEdit=function(t){var e=this;if(this.isEmpty())return this;t||(t={}),t.symbol&&(this._originalSymbol=this.getSymbol(),this.setSymbol(t.symbol)),this._draggbleBeforeEdit=this.options.draggable,this.config("draggable",!1);for(var n=this.getGeometries(),i=0,r=n.length;i<r;i++)n[i].startEdit(t);return this._editing=!0,this.hide(),setTimeout(function(){e.fire("editstart")},1),this},e.prototype.endEdit=function(){if(this.isEmpty())return this;for(var t=this.getGeometries(),e=0,n=t.length;e<n;e++)t[e].endEdit();return this._originalSymbol&&(this.setSymbol(this._originalSymbol),delete this._originalSymbol),this._editing=!1,this.show(),this.config("draggable",this._draggbleBeforeEdit),this.fire("editend"),this},e.prototype.isEditing=function(){return!!this._editing},e}(Ni);function Xi(t,e){if(this.isEmpty())return null;for(var n=this.getGeometries(),i=null,r=0,o=n.length;r<o;r++){var s=n[r];if(s){var a=s[e](t);a&&(i=a.combine(i))}}return i}Yi.registerJSONType("GeometryCollection");var Ji=function(t){function e(n,i,r,o){f(this,e);var s=d(this,t.call(this,null,o));return s.GeometryType=n,s.type=i,s._initData(r),s}return p(e,t),e.prototype.getCoordinates=function(){for(var t=[],e=this.getGeometries(),n=0,i=e.length;n<i;n++)t.push(e[n].getCoordinates());return t},e.prototype.setCoordinates=function(t){for(var e=[],n=0,i=(t=t||[]).length;n<i;n++){var r=new this.GeometryType(t[n],this.config());e.push(r)}return this.setGeometries(e),this},e.prototype._initData=function(t){(t=t||[]).length&&(t[0]instanceof this.GeometryType?this.setGeometries(t):this.setCoordinates(t))},e.prototype._checkGeo=function(t){return t instanceof this.GeometryType},e.prototype._exportGeoJSONGeometry=function(){var t=this.getCoordinates(),e=wn.toNumberArrays(t);return{type:this.getType(),coordinates:e}},e}(Yi),Ki=function(t){function e(n,i){return f(this,e),d(this,t.call(this,Wi,"MultiPoint",n,i))}return p(e,t),e}(Ji);Ki.registerJSONType("MultiPoint");var Qi=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getCenterInExtent=function(t){var e=0,n=0,i=0;return this.getGeometries().forEach(function(r){var o=r.getCenterInExtent(t);o&&(e+=o.x*o.count,n+=o.y*o.count,i+=o.count)}),0===i?null:new wn(e,n)._multi(1/i)},e}(Ji),$i=function(t){function e(n,i){return f(this,e),d(this,t.call(this,Ui,"MultiLineString",n,i))}return p(e,t),e}(Qi);$i.registerJSONType("MultiLineString");var tr=function(t){function e(n,i){return f(this,e),d(this,t.call(this,Vi,"MultiPolygon",n,i))}return p(e,t),e}(Qi);tr.registerJSONType("MultiPolygon");var er={Marker:Wi,LineString:Ui,Polygon:Vi,MultiPoint:Ki,MultiLineString:$i,MultiPolygon:tr},nr={toGeometry:function(t){if(w(t)&&(t=k(t)),Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var r=nr._convert(t[n]);Array.isArray(r)?F(e,r):e.push(r)}return e}return nr._convert(t)},_convert:function(t){if(!t||m(t.type))return null;var e=t.type;if("Feature"===e){var n=t.geometry,i=nr._convert(n);return i?(i.setId(t.id),i.setProperties(t.properties),i):null}if("FeatureCollection"===e){var r=t.features;return r?nr.toGeometry(r):null}if(["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(e)>=0)return new er["Point"===e?"Marker":e](t.coordinates);if("GeometryCollection"===e){var o=t.geometries;if(!Z(o))return new Yi;for(var s=[],a=o.length,h=0;h<a;h++)s.push(nr._convert(o[h]));return new Yi(s)}return null}},ir=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,null,r));return n&&o.setCoordinates(n),o._radius=i,o}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(t.coordinates,t.radius,t.options);return i.setProperties(n.properties),i},e.prototype.getRadius=function(){return this._radius},e.prototype.setRadius=function(t){return this._radius=t,this.onShapeChanged(),this},e.prototype.getShell=function(){for(var t=this._getMeasurer(),e=this.getCoordinates(),n=this.options.numberOfShellPoints,i=this.getRadius(),r=[],o=void 0,s=void 0,a=void 0,h=0,u=n-1;h<u;h++){o=360*h/u*Math.PI/180,s=i*Math.cos(o),a=i*Math.sin(o);var l=t.locate(e,s,a);r.push(l)}return r.push(r[0]),r},e.prototype.getHoles=function(){return[]},e.prototype.animateShow=function(){return this.show()},e.prototype._containsPoint=function(e,n){var i=this.getMap();if(i.getPitch())return t.prototype._containsPoint.call(this,e,n);var r=i._pointToContainerPoint(this._getCenter2DPoint()),o=this.getSize(),s=m(n)?this._hitTestTolerance():n;return pi(e,r,r.add(o.width/2,o.height/2),s)},e.prototype._computePrjExtent=function(t){var e=this._getMinMax(t);if(!e)return null;var n=this._getPrjCoordinates(),i=e.map(function(e){return t.project(e)}),r=Math.min(Math.abs(i[0].x-n.x),Math.abs(i[1].x-n.x)),o=Math.min(Math.abs(i[2].y-n.y),Math.abs(i[3].y-n.y));return new Sn(n.sub(r,o),n.add(r,o))},e.prototype._computeExtent=function(t){var e=this._getMinMax(t);return e?new Sn(e[0].x,e[2].y,e[1].x,e[3].y,this._getProjection()):null},e.prototype._getMinMax=function(t){if(!t||!this._coordinates||m(this._radius))return null;var e=this._radius;return[t.locate(this._coordinates,-e,0),t.locate(this._coordinates,e,0),t.locate(this._coordinates,0,e),t.locate(this._coordinates,0,-e)]},e.prototype._computeGeodesicLength=function(){return m(this._radius)?0:2*Math.PI*this._radius},e.prototype._computeGeodesicArea=function(){return m(this._radius)?0:Math.PI*Math.pow(this._radius,2)},e.prototype._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:wn.toNumberArrays([this.getShell()])}},e.prototype._toJSON=function(t){var e=this.getCenter(),n=y({},t);n.geometry=!1;var i=this.toGeoJSON(n);return i.geometry={type:"Polygon"},{feature:i,subType:"Circle",coordinates:[e.x,e.y],radius:this.getRadius()}},e}(qi(Vi));ir.mergeOptions({numberOfShellPoints:60}),ir.registerJSONType("Circle");var rr=function(t){function e(n,i,r,o){f(this,e);var s=d(this,t.call(this,null,o));return n&&s.setCoordinates(n),s.width=i,s.height=r,s}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(t.coordinates,t.width,t.height,t.options);return i.setProperties(n.properties),i},e.prototype.getWidth=function(){return this.width},e.prototype.setWidth=function(t){return this.width=t,this.onShapeChanged(),this},e.prototype.getHeight=function(){return this.height},e.prototype.setHeight=function(t){return this.height=t,this.onShapeChanged(),this},e.prototype.getShell=function(){for(var t=this._getMeasurer(),e=this.getCoordinates(),n=this.options.numberOfShellPoints,i=this.getWidth(),r=this.getHeight(),o=[],s=Math.pow(i/2,2)*Math.pow(r/2,2),a=Math.pow(i/2,2),h=Math.pow(r/2,2),u=void 0,l=void 0,c=void 0,f=void 0,p=0;p<n;p++){l=(u=360*p/n)*Math.PI/180,c=Math.sqrt(s/(a*Math.pow(Math.tan(l),2)+h)),f=Math.sqrt(s/(h*Math.pow(1/Math.tan(l),2)+a)),u>90&&u<270&&(c*=-1),u>180&&u<360&&(f*=-1);var d=t.locate(e,c,f);o.push(d)}return o},e.prototype.getHoles=function(){return[]},e.prototype.animateShow=function(){return this.show()},e.prototype._containsPoint=function(e,n){var i=this.getMap();if(i.isTransforming())return t.prototype._containsPoint.call(this,e,n);var r=i.getProjection(),o=m(n)?this._hitTestTolerance():n,s=r.projectCoords([this._coordinates,i.locate(this._coordinates,this.getWidth()/2,this.getHeight()/2)]);return pi(e,i._prjToContainerPoint(s[0]),i._prjToContainerPoint(s[1]),o)},e.prototype._computePrjExtent=function(){return ir.prototype._computePrjExtent.apply(this,arguments)},e.prototype._computeExtent=function(){return ir.prototype._computeExtent.apply(this,arguments)},e.prototype._getMinMax=function(t){if(!t||!this._coordinates||m(this.width)||m(this.height))return null;var e=this.getWidth(),n=this.getHeight();return[t.locate(this._coordinates,-e/2,0),t.locate(this._coordinates,e/2,0),t.locate(this._coordinates,0,-n/2),t.locate(this._coordinates,0,n/2)]},e.prototype._computeGeodesicLength=function(){if(m(this.width)||m(this.height))return 0;var t=this.width>this.height?this.width:this.height;return 2*Math.PI*t/2-4*Math.abs(this.width-this.height)},e.prototype._computeGeodesicArea=function(){return m(this.width)||m(this.height)?0:Math.PI*this.width*this.height/4},e.prototype._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:wn.toNumberArrays([this.getShell()])}},e.prototype._toJSON=function(t){var e=y({},t),n=this.getCenter();e.geometry=!1;var i=this.toGeoJSON(e);return i.geometry={type:"Polygon"},{feature:i,subType:"Ellipse",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},e}(qi(Vi));rr.mergeOptions({numberOfShellPoints:80}),rr.registerJSONType("Ellipse");var or=function(t){function e(n,i,r,o){f(this,e);var s=d(this,t.call(this,null,o));return n&&s.setCoordinates(n),s._width=i,s._height=r,s}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(t.coordinates,t.width,t.height,t.options);return i.setProperties(n.properties),i},e.prototype.getCoordinates=function(){return this._coordinates},e.prototype.setCoordinates=function(t){if(this._coordinates=t instanceof wn?t:new wn(t),!this._coordinates||!this.getMap())return this.onPositionChanged(),this;var e=this._getProjection();return this._setPrjCoordinates(e.project(this._coordinates)),this},e.prototype.getWidth=function(){return this._width},e.prototype.setWidth=function(t){return this._width=t,this.onShapeChanged(),this},e.prototype.getHeight=function(){return this._height},e.prototype.setHeight=function(t){return this._height=t,this.onShapeChanged(),this},e.prototype.getShell=function(){var t=this._getMeasurer(),e=this._coordinates,n=this.getMap(),i=1,r=-1;if(n){var o=n.getFullExtent();o.left>o.right&&(i=-1),o.bottom>o.top&&(r=1)}var s=[];return s.push(e),s.push(t.locate(e,i*this._width,0)),s.push(t.locate(e,i*this._width,r*this._height)),s.push(t.locate(e,0,r*this._height)),s.push(e),s},e.prototype.getHoles=function(){return[]},e.prototype.animateShow=function(){return this.show()},e.prototype._getPrjCoordinates=function(){var t=this._getProjection();return t?(this._verifyProjection(),this._pnw||this._coordinates&&(this._pnw=t.project(this._coordinates)),this._pnw):null},e.prototype._setPrjCoordinates=function(t){this._pnw=t,this.onPositionChanged()},e.prototype._getPrjShell=function(){var e=t.prototype._getPrjShell.call(this),n=this._getProjection();if(!n.isSphere())return e;for(var i=n.getSphereExtent(),r=i.sx,o=i.sy,s=this._getProjection().getCircum(),a=e[0],h=1,u=e.length;h<u;h++){var l=e[h],c=0,f=0;r*(a.x-l.x)>0&&(c=s.x*r),o*(a.y-l.y)<0&&(f=s.y*o),e[h]._add(c,f)}return e},e.prototype._updateCache=function(){this._clearCache();var t=this._getProjection();this._pnw&&t&&(this._coordinates=t.unproject(this._pnw))},e.prototype._clearProjection=function(){this._pnw=null,t.prototype._clearProjection.call(this)},e.prototype._computeCenter=function(t){return t.locate(this._coordinates,this._width/2,-this._height/2)},e.prototype._containsPoint=function(e,n){var i=this.getMap();if(i.isTransforming())return t.prototype._containsPoint.call(this,e,n);var r=m(n)?this._hitTestTolerance():n,o=i._getResolution()*r,s=this._getPrjExtent().expand(o),a=i._containerPointToPrj(e);return s.contains(a)},e.prototype._computePrjExtent=function(t){var e=this._getSouthEast(t);if(!e)return null;var n=t.projectCoords([new wn(this._coordinates.x,e.y),new wn(e.x,this._coordinates.y)]);return new Sn(n[0],n[1])},e.prototype._computeExtent=function(t){var e=this._getSouthEast(t);return e?new Sn(this._coordinates,e,this._getProjection()):null},e.prototype._getSouthEast=function(t){if(!t||!this._coordinates||m(this._width)||m(this._height))return null;var e=this.getWidth(),n=-this.getHeight();if(t.fullExtent){var i=t.fullExtent;e*=i.right>i.left?1:-1,n*=i.top>i.bottom?1:-1}return t.locate(this._coordinates,e,n)},e.prototype._computeGeodesicLength=function(){return m(this._width)||m(this._height)?0:2*(this._width+this._height)},e.prototype._computeGeodesicArea=function(){return m(this._width)||m(this._height)?0:this._width*this._height},e.prototype._exportGeoJSONGeometry=function(){return{type:"Polygon",coordinates:wn.toNumberArrays([this.getShell()])}},e.prototype._toJSON=function(t){var e=y({},t),n=this.getCoordinates();e.geometry=!1;var i=this.toGeoJSON(e);return i.geometry={type:"Polygon"},{feature:i,subType:"Rectangle",coordinates:[n.x,n.y],width:this.getWidth(),height:this.getHeight()}},e}(Vi);or.registerJSONType("Rectangle");var sr=function(t){function e(n,i,r,o,s){f(this,e);var a=d(this,t.call(this,n,i,s));return a.startAngle=r,a.endAngle=o,a}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(t.coordinates,t.radius,t.startAngle,t.endAngle,t.options);return i.setProperties(n.properties),i},e.prototype.getStartAngle=function(){return this.startAngle},e.prototype.setStartAngle=function(t){return this.startAngle=t,this.onShapeChanged(),this},e.prototype.getEndAngle=function(){return this.endAngle},e.prototype.setEndAngle=function(t){return this.endAngle=t,this.onShapeChanged(),this},e.prototype.getShell=function(){for(var t=this._getMeasurer(),e=this.getCoordinates(),n=this.options.numberOfShellPoints-2,i=this.getRadius(),r=[e.copy()],o=this.getStartAngle(),s=this.getEndAngle()-o,a=void 0,h=void 0,u=void 0,l=0;l<n;l++){a=(s*l/(n-1)+o)*Math.PI/180,h=i*Math.cos(a),u=i*Math.sin(a);var c=t.locate(e,h,u);r.push(c)}return r.push(e.copy()),r},e.prototype._containsPoint=function(e,n){var i=this.getMap();if(i.isTransforming())return t.prototype._containsPoint.call(this,e,n);var r=i._pointToContainerPoint(this._getCenter2DPoint()),o=m(n)?this._hitTestTolerance():n,s=this.getSize(),a=r,h=e,u=h.x-a.x,l=a.y-h.y,c=Math.atan2(l,u),f=c<0?360*(c+2*Math.PI)/(2*Math.PI):360*c/(2*Math.PI),p=this.startAngle%360,d=this.endAngle%360,g=!1;return g=p>d?!(f>d&&f<p):f>=p&&f<=d,h.distanceTo(a)<=s.width/2+o&&g},e.prototype._computeGeodesicLength=function(){return m(this._radius)?0:2*Math.PI*this._radius*Math.abs(this.startAngle-this.endAngle)/360+2*this._radius},e.prototype._computeGeodesicArea=function(){return m(this._radius)?0:Math.PI*Math.pow(this._radius,2)*Math.abs(this.startAngle-this.endAngle)/360},e.prototype._toJSON=function(t){var e=y({},t),n=this.getCenter();e.geometry=!1;var i=this.toGeoJSON(e);return i.geometry={type:"Polygon"},{feature:i,subType:"Sector",coordinates:[n.x,n.y],radius:this.getRadius(),startAngle:this.getStartAngle(),endAngle:this.getEndAngle()}},e}(ir);sr.mergeOptions({numberOfShellPoints:60}),sr.registerJSONType("Sector");var ar=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype._arc=function(t,e,n){for(var i=this.options.arcDegree*Math.PI/180,r=1,o=e.length;r<o;r++){var s=sn._arcBetween(t,e[r-1],e[r],i),a=[e[r-1].x+e[r].x-s[0],e[r-1].y+e[r].y-s[1]];e[r-1].nextCtrlPoint=a,e[r].prevCtrlPoint=a,sn._stroke(t,n)}},e.prototype._quadraticCurve=function(t,e){if(e.length<=2)sn._path(t,e);else{var n,i=void 0;for(i=2,n=e.length;i<n;i+=2)t.quadraticCurveTo(e[i-1].x,e[i-1].y,e[i].x,e[i].y);if((i-=1)<n)for(;i<n;i++)t.lineTo(e[i].x,e[i].y)}},e.prototype._bezierCurve=function(t,e){if(e.length<=3)sn._path(t,e);else{var n,i=void 0;for(i=1,n=e.length;i+2<n;i+=3)t.bezierCurveTo(e[i].x,e[i].y,e[i+1].x,e[i+1].y,e[i+2].x,e[i+2].y);if(i<n)for(;i<n;i++)t.lineTo(e[i].x,e[i].y)}},e.prototype._getCurveArrowPoints=function(t,e,n,i,r,o){var s=e.length,a=void 0;for(a=o;a<s;a+=o)t.push(this._getArrowShape(e[a-1],e[a],n,i,r));if((a-=o)<s-1)for(a+=1;a<s;a++)t.push(this._getArrowShape(e[a-1],e[a],n,i,r))},e}(Ui);ar.mergeOptions({enableSimplify:!1,enableClip:!1});var hr=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"ArcCurve"}},e.prototype._paintOn=function(t,e,n){t.beginPath(),this._arc(t,e,n),sn._stroke(t,n),this._paintArrow(t,e,n)},e.fromJSON=function(t){var n=t.feature,i=new e(n.geometry.coordinates,t.options);return i.setProperties(n.properties),i},e}(ar);hr.registerJSONType("ArcCurve"),hr.mergeOptions({arcDegree:90});var ur=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(n.geometry.coordinates,t.options);return i.setProperties(n.properties),i},e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"CubicBezierCurve"}},e.prototype._paintOn=function(t,e,n){t.beginPath(),t.moveTo(e[0].x,e[0].y),this._bezierCurve(t,e),sn._stroke(t,n),this._paintArrow(t,e,n)},e.prototype._getArrowPoints=function(t,e,n,i,r){return this._getCurveArrowPoints(t,e,n,i,r,3)},e}(ar);ur.registerJSONType("CubicBezierCurve");var lr=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.fromJSON=function(t){var n=t.feature,i=new e(n.geometry.coordinates,t.options);return i.setProperties(n.properties),i},e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"QuadBezierCurve"}},e.prototype._paintOn=function(t,e,n){t.beginPath(),t.moveTo(e[0].x,e[0].y),this._quadraticCurve(t,e,n),sn._stroke(t,n),this._paintArrow(t,e,n)},e.prototype._getArrowPoints=function(t,e,n,i,r){return this._getCurveArrowPoints(t,e,n,i,r,2)},e}(ar);lr.registerJSONType("QuadBezierCurve");var cr={textFaceName:"monospace",textSize:12,textLineSpacing:8,textWrapCharacter:"\n",textHorizontalAlignment:"middle",textVerticalAlignment:"middle"},fr={markerType:"square",markerLineColor:"#000",markerLineWidth:2,markerLineOpacity:1,markerFill:"#fff",markerOpacity:1},pr=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getContent=function(){return this._content},e.prototype.setContent=function(t){var e=this._content;return this._content=de(t),this._refresh(),this._fireEvent("contentchange",{old:e,new:t}),this},e.prototype.onAdd=function(){this._refresh()},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return delete e.symbol,e},e.prototype.setSymbol=function(e){if(this._refreshing||!e)return t.prototype.setSymbol.call(this,e);var n=this._parseSymbol(e);if(this.setTextStyle){var i=this.getTextStyle()||{};i.symbol=n[0],this.setTextStyle(i)}else this.setTextSymbol&&this.setTextSymbol(n[0]);if(this.setBoxStyle){var r=this.getBoxStyle()||{};r.symbol=n[1],this.setBoxStyle(r)}else this.setBoxSymbol&&this.setBoxSymbol(n[1]);return this},e.prototype._parseSymbol=function(t){var e={},n={};for(var i in t)S(t,i)&&(0===i.indexOf("text")?e[i]=t[i]:n[i]=t[i]);return[e,n]},e.prototype._getTextSize=function(t){return be(this._content,t).size},e.prototype._getInternalSymbol=function(){return this._symbol},e.prototype._getDefaultTextSymbol=function(){return y({},cr)},e.prototype._getDefaultBoxSymbol=function(){return y({},fr)},e.prototype._getDefaultPadding=function(){return[12,8]},e}(Wi),dr=function(t){function e(n,i,r,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};f(this,e);var a=d(this,t.call(this,i,s));return a._content=de(n),a._width=m(r)?100:r,a._height=m(o)?40:o,s.boxSymbol&&a.setBoxSymbol(s.boxSymbol),s.textStyle&&a.setTextStyle(s.textStyle),a._refresh(),a}return p(e,t),e.prototype.getWidth=function(){return this._width},e.prototype.setWidth=function(t){return this._width=t,this._refresh(),this},e.prototype.getHeight=function(){return this._height},e.prototype.setHeight=function(t){return this._height=t,this._refresh(),this},e.prototype.getBoxSymbol=function(){return y({},this.options.boxSymbol)},e.prototype.setBoxSymbol=function(t){return this.options.boxSymbol=t?y({},t):t,this.getSymbol()&&this._refresh(),this},e.prototype.getTextStyle=function(){return this.options.textStyle?y({},this.options.textStyle):null},e.prototype.setTextStyle=function(t){return this.options.textStyle=t?y({},t):t,this.getSymbol()&&this._refresh(),this},e.fromJSON=function(t){var n=t.feature,i=new e(t.content,n.geometry.coordinates,t.width,t.height,t.options);return i.setProperties(n.properties),i.setId(n.id),t.symbol&&i.setSymbol(t.symbol),i},e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t),width:this.getWidth(),height:this.getHeight(),subType:"TextBox",content:this._content}},e.prototype._refresh=function(){var t=this.getTextStyle()||{},e=t.padding||[12,8],n=this._width-2*e[0],i=this._height-2*e[1],r=y({},t.symbol||this._getDefaultTextSymbol(),this.options.boxSymbol||this._getDefaultBoxSymbol(),{textName:this._content,markerWidth:this._width,markerHeight:this._height,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textMaxWidth:n,textMaxHeight:i});t.wrap&&!r.textWrapWidth&&(r.textWrapWidth=n);var o=t.horizontalAlignment;r.textDx=r.markerDx||0;var s=r.markerWidth/2-e[0];"left"===o?(r.textHorizontalAlignment="right",r.textDx=r.textDx-s):"right"===o&&(r.textHorizontalAlignment="left",r.textDx=r.textDx+s);var a=t.verticalAlignment;r.textDy=r.markerDy||0;var h=r.markerHeight/2-e[1];"top"===a?(r.textVerticalAlignment="bottom",r.textDy-=h):"bottom"===a&&(r.textVerticalAlignment="top",r.textDy+=h),this._refreshing=!0,this.updateSymbol(r),delete this._refreshing},e}(pr);dr.mergeOptions({textStyle:{wrap:!0,padding:[12,8],verticalAlignment:"middle",horizontalAlignment:"middle"},boxSymbol:null}),dr.registerJSONType("TextBox");var gr=function(t){function e(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};f(this,e);var o=d(this,t.call(this,i,r));return r.textSymbol&&o.setTextSymbol(r.textSymbol),r.boxStyle&&o.setBoxStyle(r.boxStyle),o._content=de(n),o._refresh(),o}return p(e,t),e.prototype.getBoxStyle=function(){return this.options.boxStyle?y({},this.options.boxStyle):null},e.prototype.setBoxStyle=function(t){return this.options.boxStyle=t?y({},t):t,this._refresh(),this},e.prototype.getTextSymbol=function(){return y({},this._getDefaultTextSymbol(),this.options.textSymbol)},e.prototype.setTextSymbol=function(t){return this.options.textSymbol=t?y({},t):t,this._refresh(),this},e.fromJSON=function(t){var n=t.feature,i=new e(t.content,n.geometry.coordinates,t.options);return i.setProperties(n.properties),i.setId(n.id),t.symbol&&i.setSymbol(t.symbol),i},e.prototype._canEdit=function(){return!1},e.prototype._toJSON=function(t){return{feature:this.toGeoJSON(t),subType:"Label",content:this._content}},e.prototype._refresh=function(){var t=y({},this.getTextSymbol(),{textName:this._content}),e=this.getBoxStyle();if(e){y(t,e.symbol);var n=this._getBoxSize(t),i=n[1],r=e.padding||this._getDefaultPadding(),o=n[0];t.markerWidth=o.width,t.markerHeight=o.height;var s=t.textDx||0,a=t.textDy||0,h=Se(i,t.textHorizontalAlignment,t.textVerticalAlignment)._add(s,a),u=e.horizontalAlignment||"middle";t.markerDx=h.x,"left"===u?t.markerDx+=t.markerWidth/2-r[0]:"right"===u?t.markerDx-=t.markerWidth/2-i.width-r[0]:t.markerDx+=i.width/2;var l=e.verticalAlignment||"middle";t.markerDy=h.y,"top"===l?t.markerDy+=t.markerHeight/2-r[1]:"bottom"===l?t.markerDy-=t.markerHeight/2-i.height-r[1]:t.markerDy+=i.height/2}this._refreshing=!0,this.updateSymbol(t),delete this._refreshing},e.prototype._getBoxSize=function(t){t.markerType||(t.markerType="square");var e=this.getBoxStyle(),n=this._getTextSize(t),i=void 0,r=void 0,o=e.padding||this._getDefaultPadding();return i=n.width+2*o[0],r=n.height+2*o[1],e.minWidth&&(!i||i<e.minWidth)&&(i=e.minWidth),e.minHeight&&(!r||r<e.minHeight)&&(r=e.minHeight),[new ce(i,r),n]},e}(pr);gr.mergeOptions({boxStyle:null,textSymbol:null}),gr.registerJSONType("Label");var yr=function(t){return function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e._hasConnectors=function(t){return!m(t.__connectors)&&t.__connectors.length>0},e._getConnectors=function(t){return t.__connectors},e.prototype.getConnectSource=function(){return this._connSource},e.prototype.setConnectSource=function(t){var e=this._connTarget;return this.onRemove(),this._connSource=t,this._connTarget=e,this.onAdd(),this},e.prototype.getConnectTarget=function(){return this._connTarget},e.prototype.setConnectTarget=function(t){var e=this._connSource;return this.onRemove(),this._connSource=e,this._connTarget=t,this._updateCoordinates(),this._registerEvents(),this},e.prototype._updateCoordinates=function(){var t=this.getMap();if(!t&&this._connSource&&(t=this._connSource.getMap()),!t&&this._connTarget&&(t=this._connTarget.getMap()),t&&this._connSource&&this._connTarget){for(var e=this._connSource._getConnectPoints(),n=this._connTarget._getConnectPoints(),i=0,r=this.getCoordinates(),o=void 0,s=void 0,a=0,h=e.length;a<h;a++)for(var u=e[a],l=0,c=n.length;l<c;l++){var f=n[l],p=t.computeLength(u,f);0===a&&0===l?(o=u,s=f,i=p):p<i&&(o=u,s=f)}Z(r)&&r[0].equals(o)&&r[1].equals(s)||this.setCoordinates([o,s])}},e.prototype.onAdd=function(){this._registerEvents(),this._updateCoordinates()},e.prototype.onRemove=function(){if(this._connSource&&(this._connSource.__connectors&&G(this,this._connSource.__connectors),this._connSource.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connSource.off("dragstart mousedown mouseover",this._showConnect,this),this._connSource.off("dragend mouseup mouseout",this.hide,this),this._connSource.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connSource),this._connTarget&&(G(this,this._connTarget.__connectors),this._connTarget.off("dragging positionchange",this._updateCoordinates,this).off("remove",this.onRemove,this),this._connTarget.off("show",this._showConnect,this).off("hide",this.hide,this),delete this._connTarget),!(this._connSource instanceof Ni&&this._connTarget instanceof Ni)){var t=this.getMap();t&&t.off("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}},e.prototype._showConnect=function(){this._connSource&&this._connTarget&&this._connSource.isVisible()&&this._connTarget.isVisible()&&(this._updateCoordinates(),this.show())},e.prototype._registerEvents=function(){if(this._connSource&&this._connTarget){this._connSource.__connectors||(this._connSource.__connectors=[]),this._connTarget.__connectors||(this._connTarget.__connectors=[]),this._connSource.__connectors.push(this),this._connTarget.__connectors.push(this),this._connSource.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connTarget.on("dragging positionchange",this._updateCoordinates,this).on("remove",this.remove,this),this._connSource.on("show",this._showConnect,this).on("hide",this.hide,this),this._connTarget.on("show",this._showConnect,this).on("hide",this.hide,this);var t=this.options.showOn;if(this.hide(),"moving"===t?(this._connSource.on("dragstart",this._showConnect,this).on("dragend",this.hide,this),this._connTarget.on("dragstart",this._showConnect,this).on("dragend",this.hide,this)):"click"===t?(this._connSource.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this),this._connTarget.on("mousedown",this._showConnect,this).on("mouseup",this.hide,this)):"mouseover"===t?(this._connSource.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this),this._connTarget.on("mouseover",this._showConnect,this).on("mouseout",this.hide,this)):this._showConnect(),!(this._connSource instanceof Ni&&this._connTarget instanceof Ni)){var e=this.getMap();e&&e.on("movestart moving moveend zoomstart zooming zoomend rotate pitch fovchange spatialreferencechange",this._updateCoordinates,this)}}},e}(t)},mr={showOn:"always"},vr=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,null,r));return 1===arguments.length&&(r=n,n=null,i=null),o._connSource=n,o._connTarget=i,o}return p(e,t),e}(yr(Ui));vr.mergeOptions(mr),vr.registerJSONType("ConnectorLine");var _r=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,null,r));return 1===arguments.length&&(r=n,n=null,i=null),o._connSource=n,o._connTarget=i,o}return p(e,t),e}(yr(hr));_r.mergeOptions(mr),_r.registerJSONType("ArcConnectorLine");var xr=function(t){function e(n,i,r){f(this,e),i&&!(i instanceof Ni)&&!Array.isArray(i)&&s.indexOf(i.type)<0&&(r=i,i=null);var o=d(this,t.call(this,n,r));return o._maxZIndex=0,o._minZIndex=0,o._initCache(),i&&o.addGeometry(i),o}return p(e,t),e.prototype.getGeometryById=function(t){return m(t)||""===t?null:this._geoMap[t]?this._geoMap[t]:null},e.prototype.getGeometries=function(t,e){if(!t)return this._geoList.slice(0);for(var n=[],i=void 0,r=0,o=this._geoList.length;r<o;r++)i=this._geoList[r],(e?t.call(e,i):t(i))&&n.push(i);return n},e.prototype.getFirstGeometry=function(){return this._geoList.length?this._geoList[0]:null},e.prototype.getLastGeometry=function(){var t=this._geoList.length;return 0===t?null:this._geoList[t-1]},e.prototype.getCount=function(){return this._geoList.length},e.prototype.getExtent=function(){if(0===this.getCount())return null;var t=new Sn(this.getProjection());return this.forEach(function(e){t._combine(e.getExtent())}),t},e.prototype.forEach=function(t,e){for(var n=this._geoList.slice(0),i=0,r=n.length;i<r;i++)e?t.call(e,n[i],i):t(n[i],i);return this},e.prototype.filter=function(){return Yi.prototype.filter.apply(this,arguments)},e.prototype.isEmpty=function(){return!this._geoList.length},e.prototype.addGeometry=function(t,e){if(!t)return this;if("FeatureCollection"===t.type)return this.addGeometry(nr.toGeometry(t),e);if(!Array.isArray(t)){var n=arguments.length,i=arguments[n-1];return t=Array.prototype.slice.call(arguments,0,n-1),e=i,x(i)&&(t.push(i),e=!1),this.addGeometry(t,e)}if(0===t.length)return this;this._initCache();var r=void 0;!0===e&&(r=new Sn),this._toSort=this._maxZIndex>0;for(var o=[],s=0,a=t.length;s<a;s++){var h=t[s];if(!h)throw new Error("Invalid geometry to add to layer("+this.getId()+") at index:"+s);if(!(h instanceof Ni)&&(h=Ni.fromJSON(h),Array.isArray(h)))for(var u=0,l=h.length;u<l;u++)this._add(h[u],r,s),o.push(h[u]);Array.isArray(h)||(this._add(h,r,s),o.push(h))}var c=this.getMap();if(c&&(this._getRenderer().onGeometryAdd(o),!0===e&&!m(r.xmin))){var f=c.getFitZoom(r);c.setCenterAndZoom(r.getCenter(),f)}return this.fire("addgeo",{geometries:t}),this},e.prototype.getGeoMinZIndex=function(){return this._minZIndex},e.prototype.getGeoMaxZIndex=function(){return this._maxZIndex},e.prototype._add=function(t,e,n){this._toSort||(this._toSort=0!==t.getZIndex()),this._updateZIndex(t.getZIndex());var i=t.getId();if(!m(i)){if(!m(this._geoMap[i]))throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+i+", at index:"+n);this._geoMap[i]=t}var r=A();t._setInternalId(r),this._geoList.push(t),this.onAddGeometry&&this.onAddGeometry(t),t._bindLayer(this),t.onAdd&&t.onAdd(),e&&e._combine(t.getExtent()),t._fireEvent("add",{layer:this})},e.prototype.removeGeometry=function(t){if(!Array.isArray(t))return this.removeGeometry([t]);for(var e=t.length-1;e>=0;e--)t[e]instanceof Ni||(t[e]=this.getGeometryById(t[e])),t[e]&&this===t[e].getLayer()&&t[e].remove();return this.fire("removegeo",{geometries:t}),this},e.prototype.clear=function(){this._clearing=!0,this.forEach(function(t){t.remove()}),this._geoMap={};var t=this._geoList;return this._geoList=[],this._getRenderer()&&this._getRenderer().onGeometryRemove(t),this._clearing=!1,this.fire("clear"),this},e.prototype.onRemoveGeometry=function(t){if(t&&!this._clearing&&(this===t.getLayer()&&!m(t._getInternalId()))){var e=t.getId();m(e)||delete this._geoMap[e];var n=this._findInList(t);n>=0&&this._geoList.splice(n,1),this._getRenderer()&&this._getRenderer().onGeometryRemove([t])}},e.prototype.hide=function(){for(var t=0,e=this._geoList.length;t<e;t++)this._geoList[t].onHide();return $n.prototype.hide.call(this)},e.prototype.identify=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._hitGeos(this._geoList,t,e)},e.prototype._hitGeos=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.filter,r=n.tolerance,o=[],s=this.getMap(),a=s.coordToPoint(e),h=s._pointToContainerPoint(a),u=t.length-1;u>=0;u--){var l=t[u];if(l&&l.isVisible()&&l._getPainter()){if(!(l instanceof Ui&&(l._getArrowStyle()||l instanceof ar))){var c=l.getContainerExtent();if(r&&(c=c.expand(r)),!c||!c.contains(h))continue}if(l._containsPoint(h,r)&&(!i||i(l))&&(o.push(l),n.count&&o.length>=n.count))break}}return o},e.prototype._initCache=function(){this._geoList||(this._geoList=[],this._geoMap={})},e.prototype._updateZIndex=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this._maxZIndex=Math.max(this._maxZIndex,Math.max.apply(Math,e)),this._minZIndex=Math.min(this._minZIndex,Math.min.apply(Math,e))},e.prototype._sortGeometries=function(){var t=this;this._toSort&&(this._maxZIndex=0,this._minZIndex=0,this._geoList.sort(function(e,n){return t._updateZIndex(e.getZIndex(),n.getZIndex()),t._compare(e,n)}),this._toSort=!1)},e.prototype._compare=function(t,e){return t.getZIndex()===e.getZIndex()?t._getInternalId()-e._getInternalId():t.getZIndex()-e.getZIndex()},e.prototype._findInList=function(t){var e=this._geoList.length;if(0===e)return-1;for(var n=0,i=e-1,r=void 0;n<=i;){if(r=Math.floor((n+i)/2),this._geoList[r]===t)return r;this._compare(this._geoList[r],t)>0?i=r-1:n=r+1}return-1},e.prototype._onGeometryEvent=function(t){if(t&&t.target){var e=t.type;"idchange"===e?this._onGeometryIdChange(t):"zindexchange"===e?this._onGeometryZIndexChange(t):"positionchange"===e?this._onGeometryPositionChange(t):"shapechange"===e?this._onGeometryShapeChange(t):"symbolchange"===e?this._onGeometrySymbolChange(t):"show"===e?this._onGeometryShow(t):"hide"===e?this._onGeometryHide(t):"propertieschange"===e&&this._onGeometryPropertiesChange(t)}},e.prototype._onGeometryIdChange=function(t){if(t.new!==t.old||!this._geoMap[t.old]||this._geoMap[t.old]!==t.target){if(!m(t.new)){if(this._geoMap[t.new])throw new Error("Duplicate geometry id in layer("+this.getId()+"):"+t.new);this._geoMap[t.new]=t.target}m(t.old)||t.new===t.old||delete this._geoMap[t.old]}},e.prototype._onGeometryZIndexChange=function(t){t.old!==t.new&&(this._updateZIndex(t.new),this._toSort=!0,this._getRenderer()&&this._getRenderer().onGeometryZIndexChange(t))},e.prototype._onGeometryPositionChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryPositionChange(t)},e.prototype._onGeometryShapeChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryShapeChange(t)},e.prototype._onGeometrySymbolChange=function(t){this._getRenderer()&&this._getRenderer().onGeometrySymbolChange(t)},e.prototype._onGeometryShow=function(t){this._getRenderer()&&this._getRenderer().onGeometryShow(t)},e.prototype._onGeometryHide=function(t){this._getRenderer()&&this._getRenderer().onGeometryHide(t)},e.prototype._onGeometryPropertiesChange=function(t){this._getRenderer()&&this._getRenderer().onGeometryPropertiesChange(t)},e}($n);xr.mergeOptions({drawImmediate:!1});var wr={debug:!1,enableSimplify:!0,geometryEvents:!0,defaultIconSize:[20,20],cacheVectorOnCanvas:!0,cacheSvgOnCanvas:he.gecko,enableAltitude:!1,altitudeProperty:"altitude",drawAltitude:!1},Cr=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,i,r)),s=o.options.style;return delete o.options.style,s&&o.setStyle(s),o}return p(e,t),e.prototype.getStyle=function(){return this._style?this._style:null},e.prototype.setStyle=function(t){return this._style=t,this._cookedStyles=mt(t),this.forEach(function(t){this._styleGeometry(t)},this),this.fire("setstyle",{style:t}),this},e.prototype.removeStyle=function(){return this._style?(delete this._style,delete this._cookedStyles,this.forEach(function(t){t._setExternSymbol(null)},this),this.fire("removestyle"),this):this},e.prototype.onAddGeometry=function(t){this.getStyle()&&this._styleGeometry(t)},e.prototype.onConfig=function(e){if(t.prototype.onConfig.call(this,e),e.enableAltitude||e.drawAltitude||e.altitudeProperty){var n=this.getRenderer();n&&n.setToRedraw&&n.setToRedraw()}},e.prototype._styleGeometry=function(t){if(!this._cookedStyles)return!1;for(var e=yt(t),n=0,i=this._cookedStyles.length;n<i;n++)if(!0===this._cookedStyles[n].filter(e))return t._setExternSymbol(this._cookedStyles[n].symbol),!0;return!1},e.prototype.identify=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.getRenderer();return n.onlyVisible&&i&&i.identify?i.identify(e,n):t.prototype.identify.call(this,e,n)},e.prototype.toJSON=function(t){t||(t={});var e={type:this.getJSONType(),id:this.getId(),options:this.config()};if((m(t.style)||t.style)&&this.getStyle()&&(e.style=this.getStyle()),m(t.geometries)||t.geometries){var n=void 0;if(t.clipExtent){var i=this.getMap(),r=i?i.getProjection():null;n=new Sn(t.clipExtent,r)}for(var o=[],s=this.getGeometries(),a=0,h=s.length;a<h;a++){var u=s[a],l=u.getExtent();if(l&&(!n||n.intersects(l))){var c=u.toJSON(t.geometries);o.push(c)}}e.geometries=o}return e},e.fromJSON=function(t){if(!t||"VectorLayer"!==t.type)return null;for(var n=new e(t.id,t.options),i=t.geometries,r=[],o=0;o<i.length;o++){var s=Ni.fromJSON(i[o]);s&&r.push(s)}return n.addGeometry(r),t.style&&n.setStyle(t.style),n},e}(xr);Cr.mergeOptions(wr),Cr.registerJSONType("VectorLayer");var Er="_map_tool",Sr=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.addTo=function(t){return t?(this._map=t,t[Er]&&t[Er].disable(),this.onAdd&&this.onAdd(),this.enable(),t[Er]=this,this._fireEvent("add"),this):this},e.prototype.getMap=function(){return this._map},e.prototype.enable=function(){return!this._map||this._enabled?this:(this._enabled=!0,this._switchEvents("off"),this._registerEvents(),this.onEnable&&this.onEnable(),this._fireEvent("enable"),this)},e.prototype.disable=function(){return this._enabled&&this._map?(this._enabled=!1,this._switchEvents("off"),this.onDisable&&this.onDisable(),this._fireEvent("disable"),this):this},e.prototype.isEnabled=function(){return!!this._enabled},e.prototype.remove=function(){return this._map?(this.disable(),this._map&&(delete this._map[Er],delete this._map),this._fireEvent("remove"),this):this},e.prototype._registerEvents=function(){this._switchEvents("on")},e.prototype._switchEvents=function(t){var e=this.getEvents();e&&this._map[t](e,this)},e.prototype._fireEvent=function(t,e){e||(e={}),this.fire(t,e)},e}(cn(dn)),Ir={},br=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i._checkMode(),i._events={click:i._firstClickHandler,mousemove:i._mouseMoveHandler,dblclick:i._doubleClickHandler,mousedown:i._mouseDownHandler,mouseup:i._mouseUpHandler},i}return p(e,t),e.registerMode=function(t,e){Ir[t.toLowerCase()]=e},e.getRegisterMode=function(t){return Ir[t.toLowerCase()]},e.prototype.getMode=function(){return this.options.mode?this.options.mode.toLowerCase():null},e.prototype.setMode=function(t){return this._geometry&&(this._geometry.remove(),delete this._geometry),this._clearStage(),this._switchEvents("off"),this.options.mode=t,this._checkMode(),this.isEnabled()&&(this._switchEvents("on"),this._restoreMapCfg(),this._saveMapCfg()),this},e.prototype.getSymbol=function(){var t=this.options.symbol;return Gt(t||this.options.symbol)},e.prototype.setSymbol=function(t){return t?(this.options.symbol=t,this._geometry&&this._geometry.setSymbol(t),this):this},e.prototype.getCurrentGeometry=function(){return this._geometry},e.prototype.onAdd=function(){this._checkMode()},e.prototype.onEnable=function(){return this._saveMapCfg(),this._drawToolLayer=this._getDrawLayer(),this._clearStage(),this._loadResources(),this},e.prototype.onDisable=function(){var t=this.getMap();return this._restoreMapCfg(),this.endDraw(),this._map&&t.removeLayer(this._getDrawLayer()),this},e.prototype.undo=function(){var t=this._getRegisterMode(),e=t.action;if(!this._shouldRecordHistory(e)||!this._historyPointer)return this;var n=this._clickCoords.slice(0,--this._historyPointer);return t.update(n,this._geometry),this},e.prototype.redo=function(){var t=this._getRegisterMode(),e=t.action;if(!this._shouldRecordHistory(e)||m(this._historyPointer)||this._historyPointer===this._clickCoords.length)return this;var n=this._clickCoords.slice(0,++this._historyPointer);return t.update(n,this._geometry),this},e.prototype._shouldRecordHistory=function(t){return Array.isArray(t)&&"click"===t[0]&&"mousemove"===t[1]&&"dblclick"===t[2]},e.prototype._checkMode=function(){this._getRegisterMode()},e.prototype._saveMapCfg=function(){var t=this.getMap();if(this._mapDoubleClickZoom=t.options.doubleClickZoom,t.config({doubleClickZoom:this.options.doubleClickZoom}),this._getRegisterMode().action.indexOf("mousedown")>-1){var e=this.getMap();this._mapDraggable=e.options.draggable,e.config({draggable:!1})}},e.prototype._restoreMapCfg=function(){var t=this.getMap();t.config({doubleClickZoom:this._mapDoubleClickZoom}),m(this._mapDraggable)||t.config("draggable",this._mapDraggable),delete this._mapDraggable,delete this._mapDoubleClickZoom},e.prototype._loadResources=function(){var t=Rt(this.getSymbol());t.length>0&&this._drawToolLayer._getRenderer().loadResources(t)},e.prototype._getProjection=function(){return this._map.getProjection()},e.prototype._getRegisterMode=function(){var t=this.getMode(),n=e.getRegisterMode(t);if(!n)throw new Error(t+" is not a valid mode of DrawTool.");return n},e.prototype.getEvents=function(){var t=this._getRegisterMode().action,e={};if(Array.isArray(t)){for(var n=0;n<t.length;n++)e[t[n]]=this._events[t[n]];return e}return null},e.prototype._mouseDownHandler=function(t){this._createGeometry(t)},e.prototype._mouseUpHandler=function(t){this.endDraw(t)},e.prototype._firstClickHandler=function(t){var e=this._getRegisterMode(),n=t.coordinate;this._geometry?(m(this._historyPointer)||(this._clickCoords=this._clickCoords.slice(0,this._historyPointer)),this._clickCoords.push(n),this._historyPointer=this._clickCoords.length,e.clickLimit&&e.clickLimit===this._historyPointer?(e.update([n],this._geometry,t),this.endDraw(t)):e.update(this._clickCoords,this._geometry,t),this._fireEvent("drawvertex",t)):this._createGeometry(t)},e.prototype._createGeometry=function(t){var e=this.getMode(),n=this._getRegisterMode(),i=t.coordinate,r=this.getSymbol();this._geometry||(this._clickCoords=[i],this._geometry=n.create(this._clickCoords,t),r&&"point"!==e?this._geometry.setSymbol(r):this.options.hasOwnProperty("symbol")&&this._geometry.setSymbol(this.options.symbol),this._addGeometryToStage(this._geometry),this._fireEvent("drawstart",t)),"point"===e&&this.endDraw(t)},e.prototype._mouseMoveHandler=function(t){var e=this.getMap(),n=t.coordinate;if(this._geometry&&e&&!e.isInteracting()){var i=this._getMouseContainerPoint(t);if(this._isValidContainerPoint(i)){var r=this._getRegisterMode();if(this._shouldRecordHistory(r.action)){var o=this._clickCoords.slice(0,this._historyPointer);if(o&&o.length>0&&n.equals(o[o.length-1]))return;null!==this._historyPointer&&(this._clickCoords=this._clickCoords.slice(0,this._historyPointer)),this._historyPointer=this._clickCoords.length,r.update(o.concat([n]),this._geometry,t)}else r.update([n],this._geometry,t);this._fireEvent("mousemove",t)}}},e.prototype._doubleClickHandler=function(t){if(this._geometry){var e=this._getMouseContainerPoint(t);if(this._isValidContainerPoint(e)){var n=this._getRegisterMode(),i=this._clickCoords;if(!(i.length<2)){for(var r=[i[0]],o=1,s=i.length;o<s;o++)i[o].x===i[o-1].x&&i[o].y===i[o-1].y||r.push(i[o]);r.length<2||this._geometry&&this._geometry instanceof Vi&&r.length<3||(n.update(r,this._geometry,t),this.endDraw(t))}}}},e.prototype._addGeometryToStage=function(t){this._getDrawLayer().addGeometry(t)},e.prototype.endDraw=function(t){if(!this._geometry||this._ending)return this;this._ending=!0;var e=this._geometry;return this._clearStage(),t=t||{},this._geometry=e,this._fireEvent("drawend",t),delete this._geometry,this.options.once&&this.disable(),delete this._ending,this},e.prototype._clearStage=function(){this._getDrawLayer().clear(),delete this._geometry,delete this._clickCoords},e.prototype._getMouseContainerPoint=function(t){return"mousedown"===this._getRegisterMode().action&&je(t.domEvent),t.containerPoint},e.prototype._isValidContainerPoint=function(t){var e=this._map.getSize(),n=e.width,i=e.height;return!(t.x<0||t.y<0)&&!(t.x>n||t.y>i)},e.prototype._getDrawLayer=function(){var t=r+"drawtool",e=this._map.getLayer(t);return e||(e=new Cr(t,{enableSimplify:!1}),this._map.addLayer(e)),e},e.prototype._fireEvent=function(t,e){e||(e={}),this._geometry&&(e.geometry=this._getRegisterMode().generate(this._geometry).copy()),Sr.prototype._fireEvent.call(this,t,e)},e}(Sr);br.mergeOptions({symbol:{lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3},doubleClickZoom:!1,mode:null,once:!1,ignoreMouseleave:!0});var Pr=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i.drawTool=new br({mode:"boxZoom",ignoreMouseleave:!1}),i}return p(e,t),e.prototype.addHooks=function(){this.target.on("_mousedown",this._onMouseDown,this)},e.prototype.removeHooks=function(){this.target.off("_mousedown",this._onMouseDown,this),this.drawTool.isEnabled()&&this.drawTool.remove()},e.prototype._onMouseDown=function(t){this.target.options.boxZoom&&t.domEvent.shiftKey&&this.drawTool.setSymbol(this.target.options.boxZoomSymbol).on("drawend",this._boxZoom,this).addTo(this.target)},e.prototype._boxZoom=function(t){var e=this.target;this.drawTool.remove();var n=t.geometry,i=n.getCenter(),r=n.getSymbol(),o=r.markerWidth,s=r.markerHeight,a=new Sn(i,e.locateByPoint(i,o,s),e.getProjection()),h=e.getFitZoom(a);e.animateTo({center:a.getCenter(),zoom:h})},e}(pn);ri.mergeOptions({boxZoom:!0,boxZoomSymbol:{markerType:"rectangle",markerLineWidth:3,markerLineColor:"#1bbc9b",markerLineDasharray:[10,5],markerFillOpacity:.1,markerFill:"#1bbc9b",markerWidth:1,markerHeight:1}}),ri.addOnLoadHook("addHandler","boxZoom",Pr),ri.include({animateTo:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments[2];this._stopAnim(this._animPlayer),C(n)&&(i=n,n={});var r=this.getProjection(),o=this.getView(),s={},a=!0;for(var h in t)if(S(t,h)&&!m(o[h]))if(a=!1,"center"===h){var u=new wn(o[h]).toFixed(7),l=new wn(t[h]).toFixed(7);u.equals(l)||(s.center=[u,l])}else o[h]!==t[h]&&"around"!==h&&(s[h]=[o[h],t[h]]);if(a)return null;var c=t.around||new le(this.width/2,this.height/2),f=this.getView(),p=this._getRenderer(),d=this._animPlayer=zi.animate(s,{easing:n.easing||"out",duration:n.duration||this.options.zoomAnimationDuration,framer:function(t){p.callInNextFrame(t)}},function(t){if(e.isRemoved())d.finish();else{if("running"===d.playState){var o=e.getView();if(!n.continueOnViewChanged&&!function(t,e){for(var n in t)if(S(t,n))if("center"===n){if(t[n][0]!==e[n][0]||t[n][1]!==e[n][1])return!1}else if(t[n]!==e[n])return!1;return!0}(o,f))return void e._stopAnim(d);if(t.styles.center){var a=t.styles.center;e._setPrjCenter(r.project(a)),e.onMoving(e._parseEventFromCoord(e.getCenter()))}m(t.styles.zoom)||e.onZooming(t.styles.zoom,c),m(t.styles.pitch)||e.setPitch(t.styles.pitch),m(t.styles.bearing)||e.setBearing(t.styles.bearing),f=e.getView(),e._fireEvent("animating")}else"finished"===d.playState&&(d._interupted||(s.center&&e._setPrjCenter(r.project(s.center[1])),m(s.pitch)||e.setPitch(s.pitch[1]),m(s.bearing)||e.setBearing(s.bearing[1])),e._endAnim(d,s,c,n),f=e.getView());i&&i(t)}});return this._startAnim(s,c),d},isAnimating:function(){return!!this._animPlayer},isRotating:function(){return this.isDragRotating()||!!this._animRotating},_endAnim:function(t,e,n,i){delete this._animRotating;var r=t._interupted?"animateinterupted":"animateend";if(t===this._animPlayer&&delete this._animPlayer,e.center){var o=void 0;o=t._interupted?this.getCenter():e.center[1],this.onMoveEnd(this._parseEventFromCoord(o))}m(e.zoom)||(t._interupted?this.onZoomEnd(this.getZoom(),n):i.wheelZoom?this.onZooming(e.zoom[1],n):this.onZoomEnd(e.zoom[1],n)),r&&this._fireEvent(r)},_startAnim:function(t,e){this._animPlayer&&(t.center&&this.onMoveStart(),t.zoom&&!this.isZooming()&&this.onZoomStart(t.zoom[1],e),(t.pitch||t.bearing)&&(this._animRotating=!0),this._fireEvent("animatestart"),this._animPlayer.play())},_stopAnim:function(t){t&&"finished"!==t.playState&&(t._interupted=!0,t.finish())}});var Mr="mousedown mouseup mouseover mouseout mouseenter mouseleave mousemove click dblclick contextmenu keypress touchstart touchmove touchend ";function Tr(t,e,n){var i,r,o,s,a,h,u,l,c,f,p,d,g=n[0],y=n[1],m=n[2];return e===t?(t[12]=e[0]*g+e[4]*y+e[8]*m+e[12],t[13]=e[1]*g+e[5]*y+e[9]*m+e[13],t[14]=e[2]*g+e[6]*y+e[10]*m+e[14],t[15]=e[3]*g+e[7]*y+e[11]*m+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],l=e[7],c=e[8],f=e[9],p=e[10],d=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t[6]=u,t[7]=l,t[8]=c,t[9]=f,t[10]=p,t[11]=d,t[12]=i*g+a*y+c*m+e[12],t[13]=r*g+h*y+f*m+e[13],t[14]=o*g+u*y+p*m+e[14],t[15]=s*g+l*y+d*m+e[15]),t}function Lr(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Nr(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],h=e[5],u=e[6],l=e[7],c=e[8],f=e[9],p=e[10],d=e[11],g=e[12],y=e[13],m=e[14],v=e[15],_=n[0],x=n[1],w=n[2],C=n[3];return t[0]=_*i+x*a+w*c+C*g,t[1]=_*r+x*h+w*f+C*y,t[2]=_*o+x*u+w*p+C*m,t[3]=_*s+x*l+w*d+C*v,_=n[4],x=n[5],w=n[6],C=n[7],t[4]=_*i+x*a+w*c+C*g,t[5]=_*r+x*h+w*f+C*y,t[6]=_*o+x*u+w*p+C*m,t[7]=_*s+x*l+w*d+C*v,_=n[8],x=n[9],w=n[10],C=n[11],t[8]=_*i+x*a+w*c+C*g,t[9]=_*r+x*h+w*f+C*y,t[10]=_*o+x*u+w*p+C*m,t[11]=_*s+x*l+w*d+C*v,_=n[12],x=n[13],w=n[14],C=n[15],t[12]=_*i+x*a+w*c+C*g,t[13]=_*r+x*h+w*f+C*y,t[14]=_*o+x*u+w*p+C*m,t[15]=_*s+x*l+w*d+C*v,t}function Rr(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],h=e[6],u=e[7],l=e[8],c=e[9],f=e[10],p=e[11],d=e[12],g=e[13],y=e[14],m=e[15],v=n*a-i*s,_=n*h-r*s,x=n*u-o*s,w=i*h-r*a,C=i*u-o*a,E=r*u-o*h,S=l*g-c*d,I=l*y-f*d,b=l*m-p*d,P=c*y-f*g,M=c*m-p*g,T=f*m-p*y,L=v*T-_*M+x*P+w*b-C*I+E*S;return L?(L=1/L,t[0]=(a*T-h*M+u*P)*L,t[1]=(r*M-i*T-o*P)*L,t[2]=(g*E-y*C+m*w)*L,t[3]=(f*C-c*E-p*w)*L,t[4]=(h*b-s*T-u*I)*L,t[5]=(n*T-r*b+o*I)*L,t[6]=(y*x-d*E-m*_)*L,t[7]=(l*E-f*x+p*_)*L,t[8]=(s*M-a*b+u*S)*L,t[9]=(i*b-n*M-o*S)*L,t[10]=(d*C-g*x+m*v)*L,t[11]=(c*x-l*C-p*v)*L,t[12]=(a*I-s*P-h*S)*L,t[13]=(n*P-i*I+r*S)*L,t[14]=(g*_-d*w-y*v)*L,t[15]=(l*w-c*_+f*v)*L,t):null}function Or(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ar(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function Dr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function kr(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function Fr(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Gr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function zr(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],h=n[2];return t[0]=r*h-o*a,t[1]=o*s-i*h,t[2]=i*a-r*s,t}function jr(t,e,n){var i=e[0],r=e[1],o=e[2],s=1/(n[3]*i+n[7]*r+n[11]*o+n[15]);return t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])*s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])*s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])*s,t}ri.include({_registerDomEvents:function(){ke(this._panels.mapWrapper||this._containerDOM,Mr,this._handleDOMEvent,this)},_removeDomEvents:function(){Fe(this._panels.mapWrapper||this._containerDOM,Mr,this._handleDOMEvent)},_handleDOMEvent:function(t){var e=t.type;if("contextmenu"===e&&ze(t),!this._ignoreEvent(t)){var n=!1;if("mousedown"===e||"touchstart"===e&&1===t.touches.length)this._mouseDownTime=g();else if("click"===e||"touchend"===e||"contextmenu"===e){if(!this._mouseDownTime)return;var i=this._mouseDownTime;if(delete this._mouseDownTime,g()-i>300){if("click"===e||"contextmenu"===e)return}else"touchend"===e&&(n=!0)}this._fireDOMEvent(this,t,e),n&&(this._clickTime&&g()-this._clickTime<=300?(delete this._clickTime,this._fireDOMEvent(this,t,"dblclick")):(this._clickTime=g(),this._fireDOMEvent(this,t,"click")))}},_ignoreEvent:function(t){if(!t||!this._panels.control)return!1;if(this._isEventOutMap(t))return!0;var e=t.srcElement||t.target,n=void 0;if(e)for(;e&&e!==this._containerDOM;){if(e.className&&e.className.indexOf&&(e.className.indexOf("maptalks-control")>=0||e.className.indexOf("maptalks-ui")>=0&&!n.eventsPropagation))return!0;n=e,e=e.parentNode}return!1},_isEventOutMap:function(t){if(this.getPitch()>this.options.maxVisualPitch){var e=qe(this._getActualEvent(t),this._containerDOM);if(!this.getContainerExtent().contains(e))return!0}return!1},_parseEvent:function(t,e){if(!t)return null;var n={domEvent:t};if("keypress"!==e){var i=this._getActualEvent(t);if(i){var r=qe(i,this._containerDOM);n=y(n,{coordinate:this.containerPointToCoord(r),containerPoint:r,viewPoint:this.containerPointToViewPoint(r),point2d:this._containerPointToPoint(r)})}}return n},_parseEventFromCoord:function(t){var e=this.coordToContainerPoint(t);return{coordinate:t,containerPoint:e,viewPoint:this.containerPointToViewPoint(e),point2d:this.coordToPoint(t)}},_getActualEvent:function(t){return t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t},_fireDOMEvent:function(t,e,n){if(!this.isRemoved()){var i=this._parseEvent(e,n);this._fireEvent(n,i)}}}),ri.addOnLoadHook("_registerDomEvents"),ri.include({isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},requestFullScreen:function(t){return this._fireEvent("fullscreenstart"),this._requestFullScreen(t||this._containerDOM),this._fireEvent("fullscreenend"),this},cancelFullScreen:function(){return this._cancelFullScreen(),this._fireEvent("cancelfullscreen"),this},_requestFullScreen:function(t){if(t.requestFullScreen)t.requestFullScreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.webkitRequestFullScreen)t.webkitRequestFullScreen();else if(t.msRequestFullScreen)t.msRequestFullScreen();else{var e="fullscreen=1,status=no,resizable=yes,top=0,left=0,scrollbars=no,titlebar=no,menubar=no,location=no,toolbar=no,z-look=yes,width="+(screen.availWidth-8)+",height="+(screen.availHeight-45);null!==window.open(location.href,"_blank",e)&&(window.opener=null,window.close())}},_cancelFullScreen:function(){if(document.cancelFullScreen)document.cancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else{null!==window.open(location.href,"_blank","fullscreen=no,status=yes,resizable=yes,scrollbars=no,titlebar=no,menubar=yes,location=yes,toolbar=yes,z-look=yes")&&(window.opener=null,window.close())}}}),ri.include({panTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];return t?(C(e)&&(n=e,e={}),t=new wn(t),void 0===e.animation||e.animation?this._panAnimation(t,e.duration,n):(this.setCenter(t),this)):this},panBy:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if(!t)return this;if(C(e)&&(n=e,e={}),t=new le(t).multi(-1),this.onMoveStart(),void 0===e.animation||e.animation){var i=this.locateByPoint(this.getCenter(),t.x,t.y);this._panAnimation(i,e.duration,n)}else this._offsetCenterByPixel(t),this.onMoveEnd(this._parseEventFromCoord(this.getCenter()));return this},_panAnimation:function(t,e,n){return this.animateTo({center:t},{duration:e||this.options.panAnimationDuration},n)}}),Ni.fromJSON=function(t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var r=Ni.fromJSON(t[n]);Array.isArray(t)?e=e.concat(r):e.push(r)}return e}if(t&&!t.feature)return nr.toGeometry(t);var o=void 0;return t.subType?(o=Ni.getJSONClass(t.subType).fromJSON(t),m(t.feature.id)||o.setId(t.feature.id)):(o=nr.toGeometry(t.feature),t.options&&o.config(t.options)),t.symbol&&o.setSymbol(t.symbol),t.infoWindow&&o.setInfoWindow(t.infoWindow),o},$n.fromJSON=function(t){if(!t)return null;var e=t.type,n=$n.getJSONClass(e);if(!n||!n.fromJSON)throw new Error("unsupported layer type:"+e);return n.fromJSON(t)},ri.include({JSON_VERSION:"1.0",toJSON:function(t){t||(t={});var e={version:this.JSON_VERSION,extent:this.getExtent().toJSON()};e.options=this.config(),e.options.center=this.getCenter(),e.options.zoom=this.getZoom();var n=this.getBaseLayer();(m(t.baseLayer)||t.baseLayer)&&n&&(e.baseLayer=n.toJSON(t.baseLayer));var i={};t.clipExtent&&(!0===t.clipExtent?i.clipExtent=this.getExtent():i.clipExtent=t.clipExtent);var r=[];if(m(t.layers)||t.layers&&!Array.isArray(t.layers)){for(var o=this.getLayers(),s=0,a=o.length;s<a;s++)if(o[s].toJSON){var h=y({},x(t.layers)?t.layers:{},i);r.push(o[s].toJSON(h))}e.layers=r}else if(Z(t.layers)){for(var u=t.layers,l=0;l<u.length;l++){var c=u[l],f=this.getLayer(c.id);if(f.toJSON){var p=y({},c.options,i);r.push(f.toJSON(p))}}e.layers=r}else e.layers=[];return e}}),ri.fromJSON=function(t,e,n){if(!t||!e)return null;n||(n={});var i=new ri(t,e.options);if(m(n.baseLayer)||n.baseLayer){var r=$n.fromJSON(e.baseLayer);r&&i.setBaseLayer(r)}if(m(n.layers)||n.layers){for(var o=[],s=e.layers,a=0;a<s.length;a++){var h=$n.fromJSON(s[a]);o.push(h)}i.addLayer(o)}return i},ri.include({computeLength:function(t,e){if(!this.getProjection())return null;var n=new wn(t),i=new wn(e);return n.equals(i)?0:this.getProjection().measureLength(n,i)},computeGeometryLength:function(t){return t._computeGeodesicLength(this.getProjection())},computeGeometryArea:function(t){return t._computeGeodesicArea(this.getProjection())},identify:function(t,e){if(!t)return this;var n=t.layers;if(!Z(n))return this;for(var i=[],o=0,s=n.length;o<s;o++)w(n[o])?i.push(this.getLayer(n[o])):i.push(n[o]);for(var a=new wn(t.coordinate),h=y({},t),u=[],l=i.length-1;l>=0&&!(t.count&&u.length>=t.count);l--){var c=i[l];if(c&&c.getMap()&&(t.includeInvisible||c.isVisible())&&(t.includeInternals||!(c.getId().indexOf(r)>=0))){var f=c.identify(a,h);f&&(Array.isArray(f)?F(u,f):u.push(f))}}return e.call(this,u),this}}),ri.include({_zoom:function(t,e){this.options.zoomable&&!this.isZooming()&&(e=this._checkZoomOrigin(e),t=this._checkZoom(t),this.onZoomStart(t,e),this._frameZoom=this.getZoom(),this.onZoomEnd(t,e))},_zoomAnimation:function(t,e,n){this.options.zoomable&&!this.isZooming()&&(t=this._checkZoom(t),this.getZoom()!==t&&(e=this._checkZoomOrigin(e),this._startZoomAnim(t,e,n)))},_checkZoomOrigin:function(t){return t&&!this.options.zoomInCenter||(t=new le(this.width/2,this.height/2)),t},_startZoomAnim:function(t,e,n){m(n)&&(n=1);var i=this._getResolution(this._startZoomVal)/this._getResolution(t),r=this.options.zoomAnimationDuration*Math.abs(i-n)/Math.abs(i-1);this._frameZoom=this._startZoomVal,this.animateTo({zoom:t,around:e},{continueOnViewChanged:!0,duration:r})},onZoomStart:function(t,e){this.options.zoomable&&!this.isZooming()&&(this._zooming=!0,this._startZoomVal=this.getZoom(),this._startZoomCoord=this._containerPointToPrj(e),this._fireEvent("zoomstart",{from:this._startZoomVal,to:t}))},onZooming:function(t,e,n){if(this.options.zoomable&&this._frameZoom!==t){m(n)&&(n=1),this._zoomTo(t,e);var i=this.getResolution(t),r=this.getResolution(this._startZoomVal)/i/n,o=this._prjToContainerPoint(this._startZoomCoord,this._startZoomVal),s=this.getViewPoint();if(!this.isRotating()&&!o.equals(e)&&1!==r){var a=this.getPitch(),h=o._sub(e)._multi(1/(1-r));a&&(h.y/=Math.cos(a*Math.PI/180)),e=e.add(h)}var u={view:[r,0,0,r,(e.x-s.x)*(1-r),(e.y-s.y)*(1-r)]};he.retina&&(e=e.multi(2)),u.container=[r,0,0,r,e.x*(1-r),e.y*(1-r)],this._fireEvent("zooming",{from:this._startZoomVal,to:t,origin:e,matrix:u}),this._frameZoom=t}},onZoomEnd:function(t,e){if(this.options.zoomable){var n=this._startZoomVal;this._zoomTo(t,e),this._zooming=!1,this._getRenderer().onZoomEnd(),this._fireEvent("zoomend",{from:n,to:t}),this._verifyExtent(this.getCenter())||this.panTo(this.getMaxExtent().getCenter())}},_zoomTo:function(t,e){this._zoomLevel=t,this._calcMatrices(),e&&this._setPrjCoordAtContainerPoint(this._startZoomCoord,e)},_checkZoom:function(t){var e=this.getMaxZoom(),n=this.getMinZoom();return t<n&&(t=n),t>e&&(t=e),t}});var Br,Hr,Vr,qr,Wr,Zr,Ur,Yr,Xr,Jr,Kr,Qr,$r,to=Math.PI/180;function eo(){return Or(new Array(16))}ri.include({getFov:function(){return this._fov||(this._fov=.6435011087932844),this._fov/to},setFov:function(t){if(this.isZooming())return this;if(t=Math.max(.01,Math.min(60,t)),this._fov===t)return this;var e=this.getFov();return this._fov=t*to,this._calcMatrices(),this._renderLayers(),this._fireEvent("fovchange",{from:e,to:this.getFov()}),this},getBearing:function(){return this._angle?-this._angle/to:0},setBearing:function(t){if(he.ie9)throw new Error("map can't rotate in IE9.");var e=-q(t,-180,180)*to;if(this._angle===e)return this;var n=this.getBearing();return this._fireEvent("rotatestart",{from:n,to:e}),this._angle=e,this._calcMatrices(),this._renderLayers(),this._fireEvent("rotate",{from:n,to:e}),this._fireEvent("rotateend",{from:n,to:e}),this},getPitch:function(){return this._pitch?this._pitch/Math.PI*180:0},setPitch:function(t){if(he.ie9)throw new Error("map can't tilt in IE9.");var e=W(t,0,this.options.maxPitch)*to;if(this._pitch===e)return this;var n=this.getPitch();return this._fireEvent("pitchstart",{from:n,to:e}),this._pitch=e,this._calcMatrices(),this._renderLayers(),this._fireEvent("pitch",{from:n,to:e}),this._fireEvent("pitchend",{from:n,to:e}),this},isTransforming:function(){return!(!this._pitch&&!this._angle)},getFrustumAltitude:function(){var t=90-this.getPitch(),e=this.getFov()/2,n=this.cameraPosition?this.cameraPosition[2]:0;if(e<=t)return n;e=Math.PI*e/180;var i=new le(this.cameraPosition).distanceTo(new le(this.cameraLookAt)),r=n*Math.tan(2*e);return n+Math.tan(e)*(i+r)},_pointToContainerPoint:($r=[0,0,0],function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t=this._pointToPoint(t,e),this.isTransforming()||n){n*=this.getResolution(e)/this.getResolution();var i=this._glScale;Ar($r,t.x*i,t.y*i,n*i);var r=this._projIfBehindCamera($r,this.cameraPosition,this.cameraForward);jr(r,r,this.projViewMatrix);var o=this.width/2,s=this.height/2;return r[0]=r[0]*o+o,r[1]=-r[1]*s+s,new le(r[0],r[1])}var a=this._prjToPoint(this._getPrjCenter());return t._sub(a)._add(this.width/2,this.height/2)}),_projIfBehindCamera:(Xr=new Array(3),Jr=new Array(3),Kr=new Array(3),Qr=new Array(3),function(t,e,n){var i,r,o;if(Dr(Xr,t,e),Gr(n,Fr(Jr,Xr))<=0){var s=Gr(n,Xr);r=n,o=1.01*s,(i=Kr)[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2]}(t,e,Dr(Qr,Xr,Kr))}return t}),_containerPointToPoint:(Zr=[0,0,0],Ur=[0,0,0,1],Yr=[0,0,0,1],function(t,e){if(this.isTransforming()){var n=this.width/2||1,i=this.height/2||1;Ar(Zr,(t.x-n)/n,(i-t.y)/i,0),Ar(Ur,Zr[0],Zr[1],0),Ar(Yr,Zr[0],Zr[1],1),Ur[3]=Yr[3]=1,jr(Ur,Ur,this.projViewMatrixInverse),jr(Yr,Yr,this.projViewMatrixInverse);var r=Ur[0],o=Yr[0],s=Ur[1],a=Yr[1],h=Ur[2],u=Yr[2],l=h===u?0:(0-h)/(u-h),c=new le(V(r,o,l),V(s,a,l))._multi(1/this._glScale);return void 0===e||this.getZoom()===e?c:this._pointToPointAtZoom(c,e)}var f=this._prjToPoint(this._getPrjCenter(),e),p=void 0!==e?this._getResolution()/this._getResolution(e):1,d=p*(t.x-this.width/2),g=p*(t.y-this.height/2);return f._add(d,g)}),_calcMatrices:(qr=he.ie9?null:eo(),Wr=he.ie9?null:eo(),function(){if(!he.ie9){var t=this.getSize(),e=t.width||1,n=t.height||1;this._glScale=this.getGLScale();var i,r,o,s,a,h,u,l=this.getFov()*Math.PI/180,c=this.getScale(this.getMinZoom())/this.getScale(this.getMaxNativeZoom())*n/2/this._getFovRatio()*1.4,f=this.projMatrix||eo();i=f,r=l,o=e/n,s=.1,a=c,h=1/Math.tan(r/2),u=1/(s-a),i[0]=h/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=h,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(a+s)*u,i[11]=-1,i[12]=0,i[13]=0,i[14]=2*a*s*u,i[15]=0,this.projMatrix=f;var p=this._getCameraWorldMatrix();this.viewMatrix=Rr(qr,p),this.projViewMatrix=Nr(this.projViewMatrix||eo(),f,this.viewMatrix),this.projViewMatrixInverse=Nr(this.projViewMatrixInverse||eo(),p,Rr(Wr,f)),this.domCssMatrix=this._calcDomMatrix()}}),_calcDomMatrix:(Br=he.ie9?null:eo(),Hr=[1,-1,1],Vr=[0,0,0],function(){var t,e,n,i,r,o,s,a,h,u,l,c,f,p=.5/Math.tan(this._fov/2)*this.height;Lr(Br,this.projMatrix,Hr),Tr(Br,Br,Ar(Vr,0,0,-p)),this._pitch&&(t=Br,e=Br,n=this._pitch,i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],h=e[7],u=e[8],l=e[9],c=e[10],f=e[11],e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=s*r+l*i,t[6]=a*r+c*i,t[7]=h*r+f*i,t[8]=u*r-o*i,t[9]=l*r-s*i,t[10]=c*r-a*i,t[11]=f*r-h*i),this._angle&&function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],h=e[3],u=e[4],l=e[5],c=e[6],f=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=s*r+l*i,t[2]=a*r+c*i,t[3]=h*r+f*i,t[4]=u*r-o*i,t[5]=l*r-s*i,t[6]=c*r-a*i,t[7]=f*r-h*i}(Br,Br,this._angle);var d=eo();return Lr(d,d,Ar(Vr,this.width/2,-this.height/2,1)),Nr(this.domCssMatrix||eo(),d,Br)}),_getCameraWorldMatrix:function(){var t={},e=[1,-1,1];return function(){var n=this.getGLZoom(),i=this.getSize(),r=this.getGLScale(),o=this._prjToPoint(this._prjCenter,n);this.cameraLookAt=Ar(this.cameraLookAt||[0,0,0],o.x,o.y,0);var s=this.getPitch()*to,a=-this.getBearing()*to,h=this._getFovRatio(),u=r*(i.height||1)/2/h,l=u*Math.cos(s),c=Math.sin(s)*u,f=o.x+c*Math.sin(a),p=o.y+c*Math.cos(a);this.cameraPosition=Ar(this.cameraPosition||[0,0,0],f,p,l);var d=c||1,g=this.cameraUp=Ar(this.cameraUp||[0,0,0],Math.sin(a)*d,Math.cos(a)*d,0),y=this.cameraWorldMatrix=this.cameraWorldMatrix||eo();!function(t,e,n,i){var r=[0,0,0],o=[0,0,0],s=[0,0,0];Dr(s,e,n),0===kr(s)&&(s[2]=1),Fr(s,s),zr(r,i,s),0===kr(s)&&(1===Math.abs(i[2])?s[0]+=1e-4:s[2]+=1e-4,Fr(s,s),zr(r,i,s)),Fr(r,r),zr(o,s,r),t[0]=r[0],t[4]=o[0],t[8]=s[0],t[1]=r[1],t[5]=o[1],t[9]=s[1],t[2]=r[2],t[6]=o[2],t[10]=s[2]}(y,this.cameraPosition,this.cameraLookAt,g);var m,v,_,x=this.cameraForward||[0,0,0];return Dr(x,this.cameraLookAt,this.cameraPosition),this.cameraForward=Fr(x,x),function(t,e){var n=e[0],i=e[4],r=e[8],o=e[1],s=e[5],a=e[9],h=e[2],u=e[6],l=e[10],c=n+s+l,f=void 0;c>0?(f=.5/Math.sqrt(c+1),t.w=.25/f,t.x=(u-a)*f,t.y=(r-h)*f,t.z=(o-i)*f):n>s&&n>l?(f=2*Math.sqrt(1+n-s-l),t.w=(u-a)/f,t.x=.25*f,t.y=(i+o)/f,t.z=(r+h)/f):s>l?(f=2*Math.sqrt(1+s-n-l),t.w=(r-h)/f,t.x=(i+o)/f,t.y=.25*f,t.z=(a+u)/f):(f=2*Math.sqrt(1+l-n-s),t.w=(o-i)/f,t.x=(r+h)/f,t.y=(a+u)/f,t.z=.25*f)}(t,y),function(t,e){var n=t,i=e.x,r=e.y,o=e.z,s=e.w,a=i+i,h=r+r,u=o+o,l=i*a,c=i*h,f=i*u,p=r*h,d=r*u,g=o*u,y=s*a,m=s*h,v=s*u;n[0]=1-(p+g),n[4]=c-v,n[8]=f+m,n[1]=c+v,n[5]=1-(l+g),n[9]=d-y,n[2]=f-m,n[6]=d+y,n[10]=1-(l+p),n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(y,t),m=y,v=this.cameraPosition,(_=m)[12]=v[0],_[13]=v[1],_[14]=v[2],Lr(y,y,e),y}}(),_getFovRatio:function(){var t=this.getFov();return Math.tan(t/2*to)},_renderLayers:function(){this.isInteracting()||this._getLayers().forEach(function(t){if(t){var e=t._getRenderer();e&&e.setToRedraw&&e.setToRedraw()}})}}),ri.include({_onViewChange:function(t){this._viewHistory||(this._viewHistory=[],this._viewHistoryPointer=0);for(var e=this._getCurrentView(),n=this._viewHistory.length-1;n>=0;n--)if(it(t,this._viewHistory[n]))return this._viewHistoryPointer=n,void this._fireViewChange(e,t);this._viewHistoryPointer<this._viewHistory.length-1&&this._viewHistory.splice(this._viewHistoryPointer+1),this._viewHistory.push(t);var i=this.options.viewHistoryCount;i>0&&this._viewHistory.length>i&&this._viewHistory.splice(0,this._viewHistory.length-i),this._viewHistoryPointer=this._viewHistory.length-1,this._fireViewChange(e,t)},zoomToPreviousView:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.hasPreviousView())return null;var e=this._viewHistory[--this._viewHistoryPointer];return this._zoomToView(e,t),e},hasPreviousView:function(){return!(!this._viewHistory||0===this._viewHistoryPointer)},zoomToNextView:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.hasNextView())return null;var e=this._viewHistory[++this._viewHistoryPointer];return this._zoomToView(e,t),e},hasNextView:function(){return!(!this._viewHistory||this._viewHistoryPointer===this._viewHistory.length-1)},_zoomToView:function(t,e){var n=this,i=this.getView();e.animation?this.animateTo(t,{duration:e.duration},function(e){"finished"===e.state.playState&&n._fireViewChange(i,t)}):(this.setView(t),this._fireViewChange(i,t))},getViewHistory:function(){return this._viewHistory},_fireViewChange:function(t,e){this._fireEvent("viewchange",{old:t,new:e})},_getCurrentView:function(){return this._viewHistory?this._viewHistory[this._viewHistoryPointer]:null}}),ri.mergeOptions({viewHistory:!0,viewHistoryCount:10});var no=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i.on("enable",i._afterEnable,i).on("disable",i._afterDisable,i),i._measureLayers=[],i}return p(e,t),e.prototype.clear=function(){if(Z(this._measureLayers))for(var t=0;t<this._measureLayers.length;t++)this._measureLayers[t].remove();return delete this._lastMeasure,delete this._lastVertex,this._measureLayers=[],this},e.prototype.getMeasureLayers=function(){return this._measureLayers},e.prototype.getLastMeasure=function(){return this._lastMeasure?this._lastMeasure:0},e.prototype._measure=function(t){var e=this.getMap(),n=void 0;t instanceof Ni?n=e.computeGeometryLength(t):Array.isArray(t)&&(n=e.getProjection().measureLength(t)),this._lastMeasure=n;var i=void 0;i="zh-CN"===this.options.language?[" 米"," 公里"," 英尺"," 英里"]:[" m"," km"," feet"," mile"];var r="";return this.options.metric&&(r+=n<1e3?n.toFixed(0)+i[0]:(n/1e3).toFixed(2)+i[1]),this.options.imperial&&(n*=3.2808399,r.length>0&&(r+="\n"),r+=n<5280?n.toFixed(0)+i[2]:(n/5280).toFixed(2)+i[3]),r},e.prototype._registerMeasureEvents=function(){this.on("drawstart",this._msOnDrawStart,this).on("drawvertex",this._msOnDrawVertex,this).on("mousemove",this._msOnMouseMove,this).on("drawend",this._msOnDrawEnd,this)},e.prototype._afterEnable=function(){this._registerMeasureEvents()},e.prototype._afterDisable=function(){this.off("drawstart",this._msOnDrawStart,this).off("drawvertex",this._msOnDrawVertex,this).off("mousemove",this._msOnMouseMove,this).off("drawend",this._msOnDrawEnd,this)},e.prototype._msOnDrawStart=function(t){var e=this.getMap(),n=A(),i="distancetool_"+n,r="distancetool_markers_"+n;e.getLayer(i)?(this._measureLineLayer=e.getLayer(i),this._measureMarkerLayer=e.getLayer(r)):(this._measureLineLayer=new Cr(i).addTo(e),this._measureMarkerLayer=new Cr(r).addTo(e)),this._measureLayers.push(this._measureLineLayer),this._measureLayers.push(this._measureMarkerLayer),new Wi(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);var o="zh-CN"===this.options.language?"起点":"start",s=new gr(o,t.coordinate,this.options.labelOptions);this._measureMarkerLayer.addGeometry(s)},e.prototype._msOnMouseMove=function(t){var e=this._measure(this._msGetCoordsToMeasure(t));if(!this._tailMarker){var n=Gt(this.options.vertexSymbol);n.markerWidth/=2,n.markerHeight/=2,this._tailMarker=new Wi(t.coordinate,{symbol:n}).addTo(this._measureMarkerLayer),this._tailLabel=new gr(e,t.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer)}this._tailMarker.setCoordinates(t.coordinate),this._tailLabel.setContent(e),this._tailLabel.setCoordinates(t.coordinate)},e.prototype._msGetCoordsToMeasure=function(t){return t.geometry.getCoordinates().concat([t.coordinate])},e.prototype._msOnDrawVertex=function(t){var e=t.geometry;new Wi(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);var n=this._measure(e),i=new gr(n,t.coordinate,this.options.labelOptions);this._measureMarkerLayer.addGeometry(i),this._lastVertex=i},e.prototype._msOnDrawEnd=function(t){this._clearTailMarker();var e=this._lastVertex.getSize();e||(e=new ce(10,10)),this._addClearMarker(this._lastVertex.getCoordinates(),e.width);var n=t.geometry.copy();n.addTo(this._measureLineLayer),this._lastMeasure=n.getLength()},e.prototype._addClearMarker=function(t,e){var n=this.options.clearButtonSymbol,i={markerDx:(n.markerDx||0)+e,textDx:(n.textDx||0)+e};Array.isArray(n)&&(i=n.map(function(t){return t?{markerDx:(t.markerDx||0)+e,textDx:(t.textDx||0)+e}:null})),n=Gt(n,i);var r=new Wi(t,{symbol:n}),o=this._measureLineLayer,s=this._measureMarkerLayer;r.on("click",function(){return o.remove(),s.remove(),!1},this),r.addTo(this._measureMarkerLayer)},e.prototype._clearTailMarker=function(){this._tailMarker&&(this._tailMarker.remove(),delete this._tailMarker),this._tailLabel&&(this._tailLabel.remove(),delete this._tailLabel)},e}(br);no.mergeOptions({mode:"LineString",language:"zh-CN",metric:!0,imperial:!1,symbol:{lineColor:"#000",lineWidth:3,lineOpacity:1},vertexSymbol:{markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:3,markerWidth:11,markerHeight:11},labelOptions:{textSymbol:{textFaceName:"monospace",textLineSpacing:1,textHorizontalAlignment:"right",textDx:15},boxStyle:{padding:[6,2],symbol:{markerType:"square",markerFill:"#fff",markerFillOpacity:.9,markerLineColor:"#b4b3b3"}}},clearButtonSymbol:[{markerType:"square",markerFill:"#fff",markerLineColor:"#b4b3b3",markerLineWidth:2,markerWidth:15,markerHeight:15,markerDx:20},{markerType:"x",markerWidth:10,markerHeight:10,markerDx:20}]});var io=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i.on("enable",i._afterEnable,i).on("disable",i._afterDisable,i),i._measureLayers=[],i}return p(e,t),e.prototype._measure=function(t){var e=this.getMap(),n=void 0;t instanceof Ni?n=e.computeGeometryArea(t):Array.isArray(t)&&(n=e.getProjection().measureArea(t)),this._lastMeasure=n;var i=void 0;i="zh-CN"===this.options.language?[" 平方米"," 平方公里"," 平方英尺"," 平方英里"]:[" sq.m"," sq.km"," sq.ft"," sq.mi"];var r="";if(this.options.metric&&(r+=n<1e6?n.toFixed(0)+i[0]:(n/1e6).toFixed(2)+i[1]),this.options.imperial){n*=3.2808399,r.length>0&&(r+="\n");r+=n<27878400?n.toFixed(0)+i[2]:(n/27878400).toFixed(2)+i[3]}return r},e.prototype._msGetCoordsToMeasure=function(t){return t.geometry.getShell().concat([t.coordinate])},e.prototype._msOnDrawVertex=function(t){var e=new Wi(t.coordinate,{symbol:this.options.vertexSymbol}).addTo(this._measureMarkerLayer);this._measure(t.geometry),this._lastVertex=e},e.prototype._msOnDrawEnd=function(t){this._clearTailMarker();var e=this._measure(t.geometry),n=new gr(e,t.coordinate,this.options.labelOptions).addTo(this._measureMarkerLayer).getSize();n||(n=new ce(10,10)),this._addClearMarker(t.coordinate,n.width);var i=t.geometry.copy();i.addTo(this._measureLineLayer),this._lastMeasure=i.getArea()},e}(no);function ro(t){for(var e=t.tileInfo,n=[e.cols,e.rows],i=[],r=e.lods,o=0,s=r.length;o<s;o++)i.push(r[o].resolution);var a=t.fullExtent,h=e.origin,u=[1,-1,h.x,h.y];return delete a.spatialReference,{spatialReference:{resolutions:i,fullExtent:a},tileSystem:u,tileSize:n}}io.mergeOptions({mode:"Polygon",symbol:{lineColor:"#000000",lineWidth:2,lineOpacity:1,lineDasharray:"",polygonFill:"#ffffff",polygonOpacity:.5}}),br.registerMode("circle",{clickLimit:2,action:["click","mousemove","click"],create:function(t){return new ir(t[0],0)},update:function(t,e){var n=e.getMap().computeLength(e.getCenter(),t[t.length-1]);e.setRadius(n)},generate:function(t){return t}}),br.registerMode("freeHandCircle",{action:["mousedown","mousemove","mouseup"],create:function(t){return new ir(t[0],0)},update:function(t,e){var n=e.getMap().computeLength(e.getCenter(),t[t.length-1]);e.setRadius(n)},generate:function(t){return t}}),br.registerMode("ellipse",{clickLimit:2,action:["click","mousemove","click"],create:function(t){return new rr(t[0],0,0)},update:function(t,e){var n=e.getMap(),i=e.getCenter(),r=n.computeLength(i,new wn({x:t[t.length-1].x,y:i.y})),o=n.computeLength(i,new wn({x:i.x,y:t[t.length-1].y}));e.setWidth(2*r),e.setHeight(2*o)},generate:function(t){return t}}),br.registerMode("freeHandEllipse",{action:["mousedown","mousemove","mouseup"],create:function(t){return new rr(t[0],0,0)},update:function(t,e){var n=e.getMap(),i=e.getCenter(),r=n.computeLength(i,new wn({x:t[t.length-1].x,y:i.y})),o=n.computeLength(i,new wn({x:i.x,y:t[t.length-1].y}));e.setWidth(2*r),e.setHeight(2*o)},generate:function(t){return t}}),br.registerMode("rectangle",{clickLimit:2,action:["click","mousemove","click"],create:function(t){var e=new Vi([]);return e._firstClick=t[0],e},update:function(t,e,n){var i=e.getMap(),r=n.containerPoint,o=i.coordToContainerPoint(e._firstClick),s=[[o.x,o.y],[r.x,o.y],[r.x,r.y],[o.x,r.y]];e.setCoordinates(s.map(function(t){return i.containerPointToCoord(new le(t))}))},generate:function(t){return t}}),br.registerMode("freeHandRectangle",{action:["mousedown","mousemove","mouseup"],create:function(t){var e=new Vi([]);return e._firstClick=t[0],e},update:function(t,e){var n=e._firstClick,i=[[n.x,n.y],[t[0].x,n.y],[t[0].x,t[0].y],[n.x,t[0].y]];e.setCoordinates(i)},generate:function(t){return t}}),br.registerMode("point",{clickLimit:1,action:["click"],create:function(t){return new Wi(t[0])},generate:function(t){return t}}),br.registerMode("polygon",{action:["click","mousemove","dblclick"],create:function(t){return new Ui(t)},update:function(t,e){var n=e.getSymbol();e.setCoordinates(t);var i=e.getLayer();if(i){var r=i.getGeometryById("polygon");if(!r&&t.length>=3){if(r=new Vi([t],{id:"polygon"}),n){var o=Gt(n,{lineOpacity:0});r.setSymbol(o)}r.addTo(i)}r&&r.setCoordinates(t)}},generate:function(t){return new Vi(t.getCoordinates(),{symbol:t.getSymbol()})}}),br.registerMode("freeHandPolygon",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Ui(t)},update:function(t,e){var n=e.getCoordinates(),i=e.getSymbol();e.setCoordinates(n.concat(t));var r=e.getLayer();if(r){var o=r.getGeometryById("polygon");if(!o&&t.length>=3){if(o=new Vi([t],{id:"polygon"}),i){var s=Gt(i,{lineOpacity:0});o.setSymbol(s)}o.addTo(r)}o&&o.setCoordinates(t)}},generate:function(t){return new Vi(t.getCoordinates(),{symbol:t.getSymbol()})}}),br.registerMode("linestring",{action:["click","mousemove","dblclick"],create:function(t){return new Ui(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),br.registerMode("freeHandLinestring",{action:["mousedown","mousemove","mouseup"],create:function(t){return new Ui(t)},update:function(t,e){var n=e.getCoordinates();e.setCoordinates(n.concat(t))},generate:function(t){return t}}),br.registerMode("arccurve",{action:["click","mousemove","dblclick"],create:function(t){return new hr(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),br.registerMode("quadbeziercurve",{action:["click","mousemove","dblclick"],create:function(t){return new lr(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),br.registerMode("cubicbeziercurve",{action:["click","mousemove","dblclick"],create:function(t){return new ur(t)},update:function(t,e){e.setCoordinates(t)},generate:function(t){return t}}),br.registerMode("boxZoom",{action:["mousedown","mousemove","mouseup"],create:function(t){var e=new Wi(t[0]);return e._firstClick=t[0],e},update:function(t,e,n){var i=e.getMap(),r=i.coordToContainerPoint(e._firstClick),o=n.containerPoint,s=i.containerPointToCoordinate(new wn(Math.min(r.x,o.x),Math.min(r.y,o.y)));e.setCoordinates(s).updateSymbol({markerWidth:Math.abs(r.x-o.x),markerHeight:Math.abs(r.y-o.y)})},generate:function(t){return t}}),ni.loadArcgis=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{jsonp:!0};if(w(t)&&"{"!==t.substring(0,1))rn.getJSON(t,function(t,n){if(t)e(t);else{var i=ro(n);e(null,i)}},n);else{w(t)&&(t=k(t));var i=ro(t);e(null,i)}return this};var oo=function(t){function e(n){return f(this,e),d(this,t.call(this,n))}return p(e,t),e.prototype.addTo=function(t){return this._owner=t,this._switchEvents("on"),this.onAdd&&this.onAdd(),this.fire("add"),this},e.prototype.getMap=function(){return this._owner?this._owner.getBaseLayer?this._owner:this._owner.getMap():null},e.prototype.show=function(t){var e=this.getMap();if(!e)return this;this._mapEventsOn||this._switchMapEvents("on"),t=t||this._coordinate||this._owner.getCenter();var n=this.isVisible();this.fire("showstart");var i=this._getUIContainer();this._coordinate=t,this._removePrevDOM();var r=this.__uiDOM=this.buildOn(e);if(r.eventsPropagation=this.options.eventsPropagation,!r)return this.fire("showend"),this;this._measureSize(r),this._singleton()&&(e[this._uiDomKey()]=r),this._setPosition(),r.style[Ne]=null,i.appendChild(r);var o=this._getAnimation();if(n&&(o.ok=!1),o.ok&&(o.fade&&(r.style.opacity=0),o.scale)){if(this.getTransformOrigin){var s=this.getTransformOrigin();r.style[Le]=s}r.style[Te]=so(this._pos)+" scale(0)"}r.style.display="",this.options.eventsToStop&&tn(r,this.options.eventsToStop,je),this.options.autoPan&&this._autoPan();var a=o.transition;return o.ok&&a&&(r.offsetHeight,a&&(r.style[Ne]=a),o.fade&&(r.style.opacity=1),o.scale&&(r.style[Te]=so(this._pos)+" scale(1)")),this.fire("showend"),this},e.prototype.hide=function(){if(!this.getDOM()||!this.getMap())return this;var t=this._getAnimation(),e=this.getDOM();return this.options.animationOnHide||(t.ok=!1),t.ok?(e.offsetHeight,e.style[Ne]=t.transition,setTimeout(function(){e.style.display="none"},this.options.animationDuration)):e.style.display="none",t.fade&&(e.style.opacity=0),t.scale&&(e.style[Te]=so(this._pos)+" scale(0)"),this.fire("hide"),this},e.prototype.isVisible=function(){var t=this.getDOM();return this.getMap()&&t&&t.parentNode&&"none"!==t.style.display},e.prototype.remove=function(){return delete this._mapEventsOn,this._owner?(this.hide(),this._switchEvents("off"),this.onRemove&&this.onRemove(),!this._singleton()&&this.__uiDOM&&this._removePrevDOM(),delete this._owner,this.fire("remove"),this):this},e.prototype.getSize=function(){return this._size?this._size.copy():null},e.prototype.getOwner=function(){return this._owner},e.prototype.getDOM=function(){return this.__uiDOM},e.prototype.getPosition=function(){if(!this.getMap())return null;var t=this._getViewPoint()._round();if(this.getOffset){var e=this.getOffset()._round();e&&t._add(e)}return t},e.prototype._getAnimation=function(){for(var t={fade:!1,scale:!1},e=this.options.animation?this.options.animation.split(","):[],n=0;n<e.length;n++){var i=fe(e[n]);"fade"===i?t.fade=!0:"scale"===i&&(t.scale=!0)}var r=null;return t.fade&&(r="opacity "+this.options.animationDuration+"ms"),t.scale&&(r=r?r+",":"",r+=Te+" "+this.options.animationDuration+"ms"),t.transition=r,t.ok=null!==r,t},e.prototype._getViewPoint=function(){return this.getMap().coordToViewPoint(this._coordinate)._add(this.options.dx,this.options.dy)},e.prototype._autoPan=function(){var t=this.getMap(),e=this.getDOM();if(!t.isMoving()){var n=this._pos,i=t.getSize(),r=i.width,o=i.height,s=t.viewPointToContainerPoint(n),a=parseInt(e.clientWidth),h=parseInt(e.clientHeight),u=0,l=0;s.x<0?u=-(s.x-a/2):s.x+a-35>r&&(u=r-(s.x+3*a/2)),s.y<0?l=50-s.y:s.y>o&&(l=o-s.y-h-30),0===l&&0===u||t.panBy(new le(u,l),{duration:this.options.autoPanDuration})}},e.prototype._measureSize=function(t){var e=this._getUIContainer();t.style.position="absolute",t.style.left="-99999px";var n=t.style.bottom?"bottom":"top";return t.style[n]="-99999px",t.style.display="",e.appendChild(t),this._size=new ce(t.clientWidth,t.clientHeight),t.style.display="none",t.style.left="0px",t.style[n]="0px",this._size},e.prototype._removePrevDOM=function(){this.onDomRemove&&this.onDomRemove();var t=this.options.eventsToStop;if(this._singleton()){var e=this.getMap(),n=this._uiDomKey();e[n]&&(t&&en(e[n],t,je),De(e[n]),delete e[n]),delete this.__uiDOM}else this.__uiDOM&&(t&&en(this.__uiDOM,t,je),De(this.__uiDOM),delete this.__uiDOM)},e.prototype._uiDomKey=function(){return"__ui_"+this._getClassName()},e.prototype._singleton=function(){return this.options.single},e.prototype._getUIContainer=function(){return this.getMap()._panels.ui},e.prototype._getClassName=function(){return"UIComponent"},e.prototype._switchMapEvents=function(t){var e=this.getMap();if(e){this._mapEventsOn="on"===t;var n=this._getDefaultEvents();if(this.getEvents&&y(n,this.getEvents()),n)for(var i in n)n.hasOwnProperty(i)&&e[t](i,n[i],this)}},e.prototype._switchEvents=function(t){this._switchMapEvents(t);var e=this._getOwnerEvents();if(this._owner)for(var n in e)e.hasOwnProperty(n)&&this._owner[t](n,e[n],this)},e.prototype._getDefaultEvents=function(){return{"zooming rotate pitch":this.onEvent,zoomend:this.onZoomEnd,moving:this.onMoving}},e.prototype._getOwnerEvents=function(){var t={};return this._owner&&this._owner instanceof Ni&&(t.positionchange=this.onGeometryPositionChange),this.getOwnerEvents&&y(t,this.getOwnerEvents()),t},e.prototype.onGeometryPositionChange=function(t){this._owner&&this.isVisible()&&this.show(t.target.getCenter())},e.prototype.onMoving=function(){this.isVisible()&&this.getMap().isTransforming()&&this._updatePosition()},e.prototype.onEvent=function(){this.isVisible()&&this._updatePosition()},e.prototype.onZoomEnd=function(){this.isVisible()&&this._setPosition()},e.prototype._updatePosition=function(){this.getMap()._getRenderer().callInNextFrame(this._setPosition.bind(this))},e.prototype._setPosition=function(){var t=this.getDOM(),e=this.getPosition();this._pos=e,t.style[Ne]=null,t.style[Te]=so(e)+" scale(1)"},e}(cn(dn));function so(t){return t?he.any3d?"translate3d("+t.x+"px,"+t.y+"px, 0px)":"translate("+t.x+"px,"+t.y+"px)":""}oo.mergeOptions({eventsPropagation:!1,eventsToStop:null,dx:0,dy:0,autoPan:!1,autoPanDuration:600,single:!0,animation:"scale",animationOnHide:!0,animationDuration:500});var ao="mousedown mouseup mouseenter mouseover mouseout mousemove click dblclick contextmenu keypress touchstart touchmove touchend",ho=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r._markerCoord=new wn(n),r}return p(e,t),e.prototype._getClassName=function(){return"UIMarker"},e.prototype.setCoordinates=function(t){return this._markerCoord=t,this.fire("positionchange"),this.isVisible()&&(this._coordinate=this._markerCoord,this._setPosition()),this},e.prototype.getCoordinates=function(){return this._markerCoord},e.prototype.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(),this},e.prototype.getContent=function(){return this.options.content},e.prototype.onAdd=function(){this.show()},e.prototype.show=function(){return t.prototype.show.call(this,this._markerCoord)},e.prototype.flash=function(t,e,n,i){return ot.call(this,t,e,n,i)},e.prototype.buildOn=function(){var t=void 0;return w(this.options.content)?(t=Oe("div")).innerHTML=this.options.content:t=this.options.content,this._registerDOMEvents(t),t},e.prototype.getOffset=function(){var t=this.getSize();return new le(-t.width/2,-t.height/2)},e.prototype.getTransformOrigin=function(){return"center center"},e.prototype.onDomRemove=function(){var t=this.getDOM();this._removeDOMEvents(t)},e.prototype.isDragging=function(){return!!this.draggable&&this.draggable.isDragging()},e.prototype._registerDOMEvents=function(t){tn(t,ao,this._onDomEvents,this)},e.prototype._onDomEvents=function(t){var e=this.getMap()._parseEvent(t,t.type);this.fire(t.type,e)},e.prototype._removeDOMEvents=function(t){en(t,ao,this._onDomEvents,this)},e.prototype._getConnectPoints=function(){var t=this.getMap(),e=t.coordToContainerPoint(this.getCoordinates()),n=this.getSize(),i=n.width,r=n.height;return[t.containerPointToCoordinate(e.add(-i/2,0)),t.containerPointToCoordinate(e.add(i/2,0)),t.containerPointToCoordinate(e.add(0,r/2)),t.containerPointToCoordinate(e.add(0,-r/2))]},e}(mn(oo));ho.mergeOptions({eventsPropagation:!0,draggable:!1,single:!1,content:null});var uo=he.touch?"touchstart mousedown":"mousedown",lo=function(t){function e(n){return f(this,e),d(this,t.call(this,n))}return p(e,t),e.prototype.addHooks=function(){this.target.on(uo,this._startDrag,this)},e.prototype.removeHooks=function(){this.target.off(uo,this._startDrag,this)},e.prototype._startDrag=function(t){var e=t.domEvent;e.touches&&e.touches.length>1||2===e.button||this.isDragging()||(this.target.on("click",this._endDrag,this),this._lastCoord=t.coordinate,this._lastPoint=t.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(t.domEvent),this.target.fire("dragstart",t))},e.prototype._prepareDragHandler=function(){this._dragHandler=new xn(this.target.getDOM(),{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this._dragHandler.on("mousedown",this._onMouseDown,this),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},e.prototype._cancelOn=function(t){var e=(t.srcElement||t.target).tagName.toLowerCase();return"button"===e||"input"===e||"select"===e||"option"===e||"textarea"===e},e.prototype._onMouseDown=function(t){je(t.domEvent)},e.prototype._dragging=function(t){var e=this.target,n=e.getMap()._parseEvent(t.domEvent),i=n.domEvent;if(!(i.touches&&i.touches.length>1))if(this._isDragging){var r=n.coordinate,o=n.containerPoint;this._lastCoord||(this._lastCoord=r),this._lastPoint||(this._lastPoint=o);var s=r.sub(this._lastCoord),a=o.sub(this._lastPoint);this._lastCoord=r,this._lastPoint=o,this.target.setCoordinates(this.target.getCoordinates().add(s)),n.coordOffset=s,n.pointOffset=a,e.fire("dragging",n)}else this._isDragging=!0},e.prototype._endDrag=function(t){var e=this.target,n=e.getMap();if(this._dragHandler&&(e.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1,n){var i=n._parseEvent(t.domEvent);e.fire("dragend",i)}},e.prototype.isDragging=function(){return!!this._isDragging},e}(pn);ho.addInitHook("addHandler","draggable",lo);var co=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype._getClassName=function(){return"InfoWindow"},e.prototype.addTo=function(e){return e instanceof Ni&&(e.getInfoWindow()&&e.getInfoWindow()!==this&&e.removeInfoWindow(),e._infoWindow=this),t.prototype.addTo.call(this,e)},e.prototype.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(this._coordinate),this},e.prototype.getContent=function(){return this.options.content},e.prototype.setTitle=function(t){var e=t;return this.options.title=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.show(this._coordinate),this},e.prototype.getTitle=function(){return this.options.title},e.prototype.buildOn=function(){if(this.options.custom){if(w(this.options.content)){var t=Oe("div");return t.innerHTML=this.options.content,t}return this.options.content}var e=Oe("div");e.className="maptalks-msgBox",e.style.width=this._getWindowWidth()+"px",e.style.bottom="0px";var n='<em class="maptalks-ico"></em>';this.options.title&&(n+="<h2>"+this.options.title+"</h2>");var i="\"this.parentNode.style.display='none';return false;\"";return n+='<a href="javascript:void(0);" onclick='+i+" ontouchend="+i+' class="maptalks-close"></a><div class="maptalks-msgContent">'+this.options.content+"</div>",e.innerHTML=n,e},e.prototype.getTransformOrigin=function(){return this.getSize().width/2+"px bottom"},e.prototype.getOffset=function(){var t=this.getSize(),e=new le(-t.width/2,0);this.options.custom||e._sub(4,12);var n=this.getOwner();if(n instanceof Wi){var i=n._getPainter();if(i){var r=n.getSize(),o=i.getFixedExtent();e._add(o.xmax-r.width/2,o.ymin)}}return e},e.prototype.show=function(e){return this.getMap()&&this.getMap().options.enableInfoWindow?t.prototype.show.call(this,e):this},e.prototype.getEvents=function(){if(!this.options.autoCloseOn)return null;var t={};return t[this.options.autoCloseOn]=this.hide,t},e.prototype.getOwnerEvents=function(){var t=this.getOwner();if(!this.options.autoOpenOn||!t)return null;var e={};return e[this.options.autoOpenOn]=this._onAutoOpen,e},e.prototype._onAutoOpen=function(t){var e=this,n=this.getOwner();setTimeout(function(){n instanceof Wi?e.show(n.getCoordinates()):e.show(t.coordinate)},1)},e.prototype._getWindowWidth=function(){var t=this.options.width;return t||(t=300),t},e}(oo);co.mergeOptions({autoPan:!0,autoCloseOn:null,autoOpenOn:"click",width:300,minHeight:120,custom:!1,title:null,content:null});var fo={width:0,height:0,animation:"fade",cssName:"maptalks-tooltip",showTimeout:400},po=function(t){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,e);var r=d(this,t.call(this,i));return r._content=n,r}return p(e,t),e.prototype._getClassName=function(){return"ToolTip"},e.prototype.addTo=function(e){if(e instanceof Ni)return e.on("mousemove",this.onMouseMove,this),e.on("mouseout",this.onMouseOut,this),t.prototype.addTo.call(this,e);throw new Error("Invalid geometry the tooltip is added to.")},e.prototype.setStyle=function(t){return this.options.cssName=t,this},e.prototype.getStyle=function(){return this.options.cssName},e.prototype.getContent=function(){return this._content},e.prototype.buildOn=function(){var t=Oe("div");fo.height&&(t.style.height=fo.height+"px"),fo.width&&(t.style.width=fo.width+"px");var e=this.options.cssName;return!e&&fo.height&&(t.style.lineHeight=fo.height+"px"),t.innerHTML='<div class="'+e+'">'+this._content+"</div>",t},e.prototype.onMouseOut=function(){clearTimeout(this._timeout),this.isVisible()&&this._removePrevDOM()},e.prototype.onMouseMove=function(t){var e=this;clearTimeout(this._timeout);var n=this.getMap();if(n){var i=n.locateByPoint(t.coordinate,-5,25);0===this.options.showTimeout?this.show(i):this._timeout=setTimeout(function(){n&&e.show(i)},this.options.showTimeout)}},e.prototype.onRemove=function(){clearTimeout(this._timeout),this._owner&&(this._owner.off("mouseover",this.onMouseOver,this),this._owner.off("mouseout",this.onMouseOut,this))},e}(oo);po.mergeOptions(fo);var go=function(t){function e(n){return f(this,e),d(this,t.call(this,n))}return p(e,t),e.prototype._getClassName=function(){return"Menu"},e.prototype.addTo=function(t){return t._menu&&t._menu!==this&&t.removeMenu(),t._menu=this,oo.prototype.addTo.apply(this,arguments)},e.prototype.setItems=function(t){return this.options.items=t,this},e.prototype.getItems=function(){return this.options.items||[]},e.prototype.buildOn=function(){if(this.options.custom){if(w(this.options.items)){var t=Oe("div");return t.innerHTML=this.options.items,t}return this.options.items}var e=Oe("div");Ue(e,"maptalks-menu"),e.style.width=this._getMenuWidth()+"px";var n=this._createMenuItemDom();return e.appendChild(n),tn(e,"contextmenu",ze),e},e.prototype.getOffset=function(){if(!this.getMap())return null;var t=this.getMap().getSize(),e=this.getMap().viewPointToContainerPoint(this._getViewPoint()),n=this.getSize(),i=0,r=0;return e.x+n.width>t.width&&(i=-n.width),e.y+n.height>t.height&&(r=-n.height),new le(i,r)},e.prototype.getTransformOrigin=function(){var t=this.getOffset()._multi(-1);return t.x+"px "+t.y+"px"},e.prototype.getEvents=function(){return{"_zoomstart _zoomend _movestart _dblclick _click":this._removePrevDOM}},e.prototype._createMenuItemDom=function(){var t=this,e=this.getMap(),n=Oe("ul");Ue(n,"maptalks-menu-items");var i=this.getItems();function r(n){return function(i){var r=e._parseEvent(i,"click");r.target=t,r.owner=t._owner,r.index=n,!1!==this._callback(r)&&t.hide()}}for(var o=void 0,s=void 0,a=0,h=i.length;a<h;a++){if("-"===(o=i[a])||"_"===o)Ue(s=Oe("li"),"maptalks-menu-splitter");else{s=Oe("li");var u=o.item;C(u)&&(u=u({owner:this._owner,index:a})),s.innerHTML=u,s._callback=o.click,tn(s,"click",r(a))}n.appendChild(s)}var l=this.options.maxHeight||0;return l>0&&We(n,"max-height: "+l+"px; overflow-y: auto;"),n},e.prototype._getMenuWidth=function(){return this.options.width||160},e}(oo);go.mergeOptions({animation:null,animationDelay:10,animationOnHide:!1,autoPan:!1,width:160,maxHeight:0,custom:!1,items:[]});var yo={setMenu:function(t){return this._menuOptions=t,this._menu?this._menu.setOptions(t):this.on("contextmenu",this._defaultOpenMenu,this),this},openMenu:function(t){var e=this instanceof ri?this:this.getMap();return t||(t=this.getCenter()),this._menu?this._menu.show(t):this._menuOptions&&e&&(this._bindMenu(this._menuOptions),this._menu.show(t)),this},setMenuItems:function(t){return this._menuOptions||(this._menuOptions={}),Array.isArray(t)&&(this._menuOptions.custom=!1),this._menuOptions.items=t,this.setMenu(this._menuOptions),this},getMenuItems:function(){return this._menu?this._menu.getItems():this._menuOptions&&this._menuOptions.items||[]},closeMenu:function(){return this._menu&&this._menu.hide(),this},removeMenu:function(){return this.off("contextmenu",this._defaultOpenMenu,this),this._unbindMenu(),delete this._menuOptions,this},_bindMenu:function(t){return this._menu=new go(t),this._menu.addTo(this),this},_unbindMenu:function(){return this._menu&&(this.closeMenu(),this._menu.remove(),delete this._menu),this},_defaultOpenMenu:function(t){return this.listens("contextmenu")>1||(this.openMenu(t.coordinate),!1)}};ri.include(yo),Ni.include(yo);var mo=Object.freeze({UIComponent:oo,UIMarker:ho,InfoWindow:co,ToolTip:po,Menuable:yo,Menu:go}),vo=function(t){function e(n){return f(this,e),n&&n.position&&!w(n.position)&&(n.position=y({},n.position)),d(this,t.call(this,n))}return p(e,t),e.prototype.addTo=function(t){if(this.remove(),!t.options.control)return this;this._map=t;var e=t._panels.control;return this.__ctrlContainer=Oe("div"),We(this.__ctrlContainer,"position:absolute;overflow:visible;"),this.update(),e.appendChild(this.__ctrlContainer),this.onAdd&&this.onAdd(),this.fire("add",{dom:e}),this},e.prototype.update=function(){return this.__ctrlContainer.innerHTML="",this._controlDom=this.buildOn(this.getMap()),this._controlDom&&(this._updatePosition(),this.__ctrlContainer.appendChild(this._controlDom)),this},e.prototype.getMap=function(){return this._map},e.prototype.getPosition=function(){return y({},this._parse(this.options.position))},e.prototype.setPosition=function(t){return w(t)?this.options.position=t:this.options.position=y({},t),this._updatePosition(),this},e.prototype.getContainerPoint=function(){var t=this.getPosition(),e=this.getMap().getSize(),n=void 0,i=void 0;return m(t.left)?m(t.right)||(n=e.width-parseInt(t.right)):n=parseInt(t.left),m(t.top)?m(t.bottom)||(i=e.height-parseInt(t.bottom)):i=parseInt(t.top),new le(n,i)},e.prototype.getContainer=function(){return this.__ctrlContainer},e.prototype.getDOM=function(){return this._controlDom},e.prototype.show=function(){return this.__ctrlContainer.style.display="",this},e.prototype.hide=function(){return this.__ctrlContainer.style.display="none",this},e.prototype.isVisible=function(){return this.__ctrlContainer&&""===this.__ctrlContainer.style.display},e.prototype.remove=function(){return this._map?(De(this.__ctrlContainer),this.onRemove&&this.onRemove(),delete this._map,delete this.__ctrlContainer,delete this._controlDom,this.fire("remove"),this):this},e.prototype._parse=function(t){var n=t;return w(t)&&(n=e.positions[n]),n},e.prototype._updatePosition=function(){var t=this.getPosition();for(var e in t||(t={top:20,left:20}),t)t.hasOwnProperty(e)&&(t[e]=parseInt(t[e]),this.__ctrlContainer.style[e]=t[e]+"px");this.fire("positionchange",{position:y({},t)})},e}(cn(dn));vo.positions={"top-left":{top:20,left:20},"top-right":{top:20,right:20},"bottom-left":{bottom:20,left:20},"bottom-right":{bottom:20,right:20}},ri.mergeOptions({control:!0}),ri.include({addControl:function(t){return this._containerDOM.getContext?this:(t.addTo(this),this)},removeControl:function(t){return t&&t.getMap()===this?(t.remove(),this):this}});var _o="addlayer removelayer setbaselayer baselayerremove",xo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(){return this._attributionContainer=Oe("div"),this._attributionContainer.className="maptalks-attribution",this._update(),this._attributionContainer},e.prototype.onAdd=function(){this.getMap().on(_o,this._update,this)},e.prototype.onRemove=function(){this.getMap().off(_o,this._update,this)},e.prototype._update=function(){var t=this.getMap();if(t){var e=t._getLayers(function(t){return t.options.attribution}).reverse().map(function(t){return t.options.attribution}),n=this.options.content+(e.length>0?" - "+e.join(", "):"");this._attributionContainer.innerHTML='<span style="padding:0px 4px">'+n+"</span>"}},e}(vo);xo.mergeOptions({position:{bottom:0,left:0},content:'<a href="http://maptalks.org" target="_blank">maptalks</a>'}),ri.mergeOptions({attribution:!0}),ri.addOnLoadHook(function(){var t=this.options.attribution||this.options.attributionControl;t&&(this.attributionControl=new xo(t),this.addControl(this.attributionControl))});var wo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(){var t=this.container=Oe("div",this.options.containerClass),e=this.panel=Oe("div","panel"),n=this.button=Oe("button");return t.appendChild(n),t.appendChild(e),t},e.prototype.onAdd=function(){tn(this.button,"mouseover",this._show,this),tn(this.panel,"mouseleave",this._hide,this),tn(this.getMap(),"click",this._hide,this)},e.prototype.onRemove=function(){this.panel&&(en(this.button,"mouseover",this._show,this),en(this.panel,"mouseleave",this._hide,this),en(this.getMap(),"click",this._hide,this),De(this.panel),De(this.button),delete this.panel,delete this.button,delete this.container)},e.prototype._show=function(){Ze(this.container,"shown")||(Ue(this.container,"shown"),this._createPanel())},e.prototype._hide=function(t){this.panel.contains(t.toElement||t.relatedTarget)||Ye(this.container,this.options.containerClass)},e.prototype._createPanel=function(){this.panel.innerHTML="";var t=Oe("ul");this.panel.appendChild(t),this._renderLayers(this.getMap(),t)},e.prototype._renderLayers=function(t,e){var n=t.getBaseLayer(),i=t.getLayers(),r=i.length;if(n){var o=n.layers||[n],s=Oe("li","group"),a=Oe("ul"),h=Oe("label");h.innerHTML=this.options.baseTitle,s.appendChild(h);for(var u=0,l=o.length;u<l;u++){var c=o[u];this._isExcluded(c)&&(a.appendChild(this._renderLayer(o[u],!0)),s.appendChild(a),e.appendChild(s))}}if(r){var f=Oe("li","group"),p=Oe("ul"),d=Oe("label");d.innerHTML=this.options.overlayTitle,f.appendChild(d);for(var g=0;g<r;g++){var y=i[g];this._isExcluded(y)&&p.appendChild(this._renderLayer(y))}f.appendChild(p),e.appendChild(f)}},e.prototype._isExcluded=function(t){var e=t.getId(),n=this.options.excludeLayers;return!(n.length&&n.indexOf(e)>=0)},e.prototype._renderLayer=function(t,e){var n=this,i=Oe("li","layer"),r=Oe("label"),o=Oe("input"),s=this.getMap(),a=t.options.visible;t.options.visible=!0;var h=t.isVisible();return t.options.visible=a,i.className="layer",e?(o.type="radio",o.name="base"):o.type="checkbox",o.checked=a&&h,h||o.setAttribute("disabled","disabled"),o.onchange=function(e){if("radio"===e.target.type){var i=s.getBaseLayer(),r=i.layers;if(r)for(var o=0,a=r.length;o<a;o++){var h=r[o];h[h===t?"show":"hide"]()}else i.isVisible()||i.show();s._fireEvent("setbaselayer")}else t[e.target.checked?"show":"hide"]();n.fire("layerchange",{target:t})},i.appendChild(o),r.innerHTML=t.getId(),i.appendChild(r),i},e}(vo);wo.mergeOptions({position:"top-right",baseTitle:"Base Layers",overlayTitle:"Layers",excludeLayers:[],containerClass:"maptalks-layer-switcher"}),ri.mergeOptions({layerSwitcherControl:!1}),ri.addOnLoadHook(function(){this.options.layerSwitcherControl&&(this.layerSwitcherControl=new wo(this.options.layerSwitcherControl),this.addControl(this.layerSwitcherControl))});var Co=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(){var t=this.options.size;this.options.maximize||(t=[0,0]);var e=Oe("div"),n=this.mapContainer=Oe("div");n.style.width=t[0]+"px",n.style.height=t[1]+"px",n.className=this.options.containerClass;var i=this.button=Oe("div");return i.className=this.options.buttonClass,e.appendChild(n),e.appendChild(i),e},e.prototype.onAdd=function(){this.options.maximize&&this._createOverview(),this.getMap().on("resize moving zooming rotate dragrotating viewchange",this._update,this).on("setbaselayer",this._updateBaseLayer,this).on("spatialreferencechange",this._updateSpatialReference,this),tn(this.button,"click",this._onButtonClick,this),this._updateButtonText()},e.prototype.onRemove=function(){this.getMap().off("resize moving zooming rotate dragrotating viewchange",this._update,this).off("setbaselayer",this._updateBaseLayer,this).off("spatialreferencechange",this._updateSpatialReference,this),this._overview&&(this._overview.remove(),delete this._overview,delete this._perspective),en(this.button,"click",this._onButtonClick,this)},e.prototype.maxmize=function(){var t=this.options.size,e=this.mapContainer;e.style.width=t[0]+"px",e.style.height=t[1]+"px",this._createOverview()},e.prototype.minimize=function(){this._overview&&this._overview.remove(),delete this._overview,delete this._perspective;var t=this.mapContainer;t.style.width="0px",t.style.height="0px"},e.prototype._onButtonClick=function(){this._overview?this.minimize():this.maxmize(),this._updateButtonText()},e.prototype._updateButtonText=function(){this._overview?this.button.innerHTML="-":this.button.innerHTML="+"},e.prototype._createOverview=function(){var t=this.getMap(),e=this.mapContainer,n=t.config();y(n,{center:t.getCenter(),zoom:this._getOverviewZoom(),zoomAnimationDuration:150,pitch:0,bearing:0,scrollWheelZoom:!1,checkSize:!1,doubleClickZoom:!1,touchZoom:!1,control:!1,draggable:!1,maxExtent:null}),this._overview=new ri(e,n),this._updateBaseLayer(),this._perspective=new Vi(this._getPerspectiveCoords(),{draggable:!0,cursor:"move",symbol:this.options.symbol}).on("dragend",this._onDragEnd,this),new Cr("perspective_layer",this._perspective).addTo(this._overview),this.fire("load")},e.prototype._getOverviewZoom=function(){var t=this.getMap(),e=t.getZoom(),n=t.getMinZoom(),i=this.options.level;if(i>0){for(var r=i;r>0;r--)if(e-r>=n)return e-r}else for(var o=i;o<0;o++)if(e-o>=n)return e-o;return e},e.prototype._onDragEnd=function(){var t=this._perspective.getCenter();this._overview.setCenter(t),this.getMap().panTo(t)},e.prototype._getPerspectiveCoords=function(){var t=this.getMap();return t.getContainerExtent().toArray().map(function(e){return t.containerPointToCoordinate(e)})},e.prototype._update=function(){if(this._overview){var t=this._getPerspectiveCoords();this._perspective.setCoordinates(t),this._overview.setCenterAndZoom(this.getMap().getCenter(),this._getOverviewZoom())}},e.prototype._updateSpatialReference=function(){if(this._overview){var t=this.getMap().options.spatialReference;this._overview.setSpatialReference(t)}},e.prototype._updateBaseLayer=function(){if(this._overview){var t=this.getMap().getBaseLayer();if(t){var e=t.layers,n=0;if(e)for(var i=0,r=e.length;i<r;i++){if(e[i].isVisible()){n=i;break}}var o=t.toJSON(),s=null;e?(s=o.layers[n].options).visible=!0:s=o.options,this._overview.setMinZoom(s.minZoom||null).setMaxZoom(s.maxZoom||null),delete s.minZoom,delete s.maxZoom,delete o.options.canvas,o.options.visible=!0,o.options.renderer="canvas";var a=$n.fromJSON(o);for(var h in t)C(t[h])&&t.hasOwnProperty(h)&&t[h]!==t.constructor.prototype[h]&&(a[h]=t[h]);this._overview.setBaseLayer(a)}else this._overview.setBaseLayer(null)}},e}(vo);Co.mergeOptions({level:4,position:{right:1,bottom:1},size:[300,200],maximize:!0,symbol:{lineWidth:3,lineColor:"#1bbc9b",polygonFill:"#1bbc9b",polygonOpacity:.4},containerClass:"maptalks-overview",buttonClass:"maptalks-overview-button"}),ri.mergeOptions({overviewControl:!1}),ri.addOnLoadHook(function(){this.options.overviewControl&&(this.overviewControl=new Co(this.options.overviewControl),this.addControl(this.overviewControl))});var Eo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(){var t=void 0;if(this.options.custom)w(this.options.content)?(t=Oe("div")).innerHTML=this.options.content:t=this.options.content;else{if(t=Oe("div","maptalks-panel"),this.options.closeButton){var e=Oe("a","maptalks-close");e.href="javascript:;",e.onclick=function(){t.style.display="none"},t.appendChild(e)}var n=Oe("div","maptalks-panel-content");n.innerHTML=this.options.content,t.appendChild(n)}return this.draggable=new xn(t,{cancelOn:this._cancelOn.bind(this),ignoreMouseleave:!0}),this.draggable.on("dragstart",this._onDragStart,this).on("dragging",this._onDragging,this).on("dragend",this._onDragEnd,this),this.options.draggable&&this.draggable.enable(),t},e.prototype.update=function(){return this.draggable&&(this.draggable.disable(),delete this.draggable),vo.prototype.update.call(this)},e.prototype.setContent=function(t){var e=this.options.content;return this.options.content=t,this.fire("contentchange",{old:e,new:t}),this.isVisible()&&this.update(),this},e.prototype.getContent=function(){return this.options.content},e.prototype._cancelOn=function(t){var e=(t.srcElement||t.target).tagName.toLowerCase();return"button"===e||"input"===e||"select"===e||"option"===e||"textarea"===e},e.prototype._onDragStart=function(t){this._startPos=t.mousePos,this._startPosition=y({},this.getPosition()),this.fire("dragstart",t)},e.prototype._onDragging=function(t){var e=t.mousePos.sub(this._startPos),n=this._startPosition,i=this.getPosition();m(i.top)||(i.top=parseInt(n.top)+e.y),m(i.bottom)||(i.bottom=parseInt(n.bottom)-e.y),m(i.left)||(i.left=parseInt(n.left)+e.x),m(i.right)||(i.right=parseInt(n.right)-e.x),this.setPosition(i),this.fire("dragging",t)},e.prototype._onDragEnd=function(t){delete this._startPos,delete this._startPosition,this.fire("dragend",t)},e.prototype._getConnectPoints=function(){var t=this.getMap(),e=this.getContainerPoint(),n=this.getDOM(),i=parseInt(n.clientWidth),r=parseInt(n.clientHeight);return[t.containerPointToCoordinate(e.add(i/2,0)),t.containerPointToCoordinate(e.add(i,r/2)),t.containerPointToCoordinate(e.add(i/2,r)),t.containerPointToCoordinate(e.add(0,r/2))]},e}(vo);Eo.mergeOptions({position:"top-right",draggable:!0,custom:!1,content:"",closeButton:!0});var So=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(t){return this._map=t,this._scaleContainer=Oe("div"),this._addScales(),t.on("zoomend",this._update,this),this._map._loaded&&this._update(),this._scaleContainer},e.prototype.onRemove=function(){this.getMap().off("zoomend",this._update,this)},e.prototype._addScales=function(){var t="border: 2px solid #000000;border-top: none;line-height: 1.1;padding: 2px 5px 1px;color: #000000;font-size: 11px;text-align:center;white-space: nowrap;overflow: hidden;-moz-box-sizing: content-box;box-sizing: content-box;background: #fff; background: rgba(255, 255, 255, 0);";this.options.metric&&(this._mScale=Ae("div",t,this._scaleContainer)),this.options.imperial&&(this._iScale=Ae("div",t,this._scaleContainer))},e.prototype._update=function(){var t=this._map.pixelToDistance(this.options.maxWidth,0);this._updateScales(t)},e.prototype._updateScales=function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},e.prototype._updateMetric=function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},e.prototype._updateImperial=function(t){var e=3.2808399*t,n=void 0,i=void 0,r=void 0;e>5280?(n=e/5280,i=this._getRoundNum(n),this._updateScale(this._iScale,i+" mile",i/n)):(r=this._getRoundNum(e),this._updateScale(this._iScale,r+" feet",r/e))},e.prototype._updateScale=function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},e.prototype._getRoundNum=function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)},e}(vo);So.mergeOptions({position:"bottom-left",maxWidth:100,metric:!0,imperial:!1}),ri.mergeOptions({scaleControl:!1}),ri.addOnLoadHook(function(){this.options.scaleControl&&(this.scaleControl=new So(this.options.scaleControl),this.addControl(this.scaleControl))});var Io=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(t){this._map=t;var e=Oe("div"),n=Oe("ul","maptalks-toolbar-hx");e.appendChild(n),this.options.vertical?Ue(e,"maptalks-toolbar-vertical"):Ue(e,"maptalks-toolbar-horizonal");var i=this;function r(t,e,n,r){var o=i._getItems()[e];return function(i){return je(i),t({target:o,index:e,childIndex:n,dom:r})}}var o=this.options.items;if(Z(o))for(var s=0,a=o.length;s<a;s++){var h=o[s],u=Oe("li");if(28!==this.options.height&&(u.style.lineHeight=this.options.height+"px"),u.style.height=this.options.height+"px",u.style.cursor="pointer",Ke(h.item)){u.style.textAlign="center";var l=Qe("div",h.item);u.innerHTML='<div style="margin-top:'+(this.options.height-l.height)/2+'px;">'+h.item+"</div>"}else u.innerHTML=h.item;if(h.click&&tn(u,"click",r(h.click,s,null,u)),Z(h.children)){var c=this._createDropMenu(s);u.appendChild(c),u._menu=c,tn(u,"mouseover",function(){this._menu.style.display=""}),tn(u,"mouseout",function(){this._menu.style.display="none"})}n.appendChild(u)}return e},e.prototype._createDropMenu=function(t){var e=this;function n(t,n,i){var r=e._getItems()[n].children[i];return function(e){return je(e),t({target:r,index:n,childIndex:i})}}var i=Oe("div","maptalks-dropMenu"),r=this._getItems(),o=r.length,s=Oe("ul"),a=r[t].children;t===o-1&&a&&(i.style.cssText="right: 0px;",s.style.cssText="right: 0px;position: absolute;",this.options.reverseMenu&&(s.style.bottom=0)),i.appendChild(Oe("em","maptalks-ico"));for(var h=0,u=0,l=a.length;u<l;u++){var c=_e(a[u].item,"12px");c.width>h&&(h=c.width)}for(var f=0,p=a.length;f<p;f++){var d=a[f],g=Oe("li");g.innerHTML='<a href="javascript:;">'+d.item+"</a>",g.style.cursor="pointer",g.style.width=h+24+"px",tn(g.childNodes[0],"click",n(d.click,t,f)),s.appendChild(g)}if(this.options.vertical){var y=h<95?95:h;this.options.reverseMenu?i.style.right=-(y+20)+"px":i.style.left=-(y+20)+"px"}else this.options.reverseMenu?i.style.bottom="28px":i.style.top="28px";return i.appendChild(s),i.style.display="none",i},e.prototype._getItems=function(){return this.options.items||[]},e}(vo);Io.mergeOptions({height:28,vertical:!1,position:"top-right",reverseMenu:!1,items:{}});var bo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.buildOn=function(t){var e=this.options,n=Oe("div","maptalks-zoom");if(e.zoomLevel){var i=Oe("span","maptalks-zoom-zoomlevel");n.appendChild(i),this._levelDOM=i}var r=Oe("div","maptalks-zoom-slider"),o=Oe("a","maptalks-zoom-zoomin");if(o.href="javascript:;",o.innerHTML="+",r.appendChild(o),this._zoomInButton=o,e.slider){var s=Oe("div","maptalks-zoom-slider-box"),a=Oe("div","maptalks-zoom-slider-ruler"),h=Oe("span","maptalks-zoom-slider-reading"),u=Oe("span","maptalks-zoom-slider-dot");a.appendChild(h),s.appendChild(a),s.appendChild(u),r.appendChild(s),this._sliderBox=s,this._sliderRuler=a,this._sliderReading=h,this._sliderDot=u}var l=Oe("a","maptalks-zoom-zoomout");return l.href="javascript:;",l.innerHTML="-",r.appendChild(l),this._zoomOutButton=l,n.appendChild(r),t.on("_zoomend _zoomstart _spatialreferencechange",this._update,this),this._update(),this._registerDomEvents(),n},e.prototype.onRemove=function(){this.getMap().off("_zoomend _zoomstart _spatialreferencechange",this._update,this),this._zoomInButton&&en(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&en(this._zoomOutButton,"click",this._onZoomOutClick,this),this._sliderRuler&&(en(this._sliderRuler,"click",this._onClickRuler,this),this.dotDragger.disable(),delete this.dotDragger)},e.prototype._update=function(){var t=this.getMap();if(this._sliderBox){var e=10*(t.getMaxZoom()-t.getMinZoom());this._sliderBox.style.height=e+16+"px",this._sliderRuler.style.height=e+8+"px",this._sliderRuler.style.cursor="pointer";var n=10*(t.getMaxZoom()-t.getZoom());this._sliderReading.style.height=10*(t.getZoom()-t.getMinZoom()+1)+"px",this._sliderDot.style.top=n+"px"}this._updateText()},e.prototype._updateText=function(){if(this._levelDOM){var t=this.getMap().getZoom();_(t)||(t=t.toFixed(1)),this._levelDOM.innerHTML=t}},e.prototype._registerDomEvents=function(){this._zoomInButton&&tn(this._zoomInButton,"click",this._onZoomInClick,this),this._zoomOutButton&&tn(this._zoomOutButton,"click",this._onZoomOutClick,this),this._sliderRuler&&(tn(this._sliderRuler,"click",this._onClickRuler,this),this.dotDragger=new xn(this._sliderDot,{ignoreMouseleave:!0}),this.dotDragger.on("dragstart",this._onDotDragstart,this).on("dragging dragend",this._onDotDrag,this).enable())},e.prototype._onZoomInClick=function(t){ze(t),this.getMap().zoomIn()},e.prototype._onZoomOutClick=function(t){ze(t),this.getMap().zoomOut()},e.prototype._onClickRuler=function(t){ze(t);var e=this.getMap(),n=qe(t,this._sliderRuler).y,i=e.getMaxZoom(),r=Math.floor(i-n/10);e.setZoom(r)},e.prototype._onDotDragstart=function(t){ze(t.domEvent);var e=this.getMap(),n=e.getSize().toPoint()._multi(.5);e.onZoomStart(e.getZoom(),n)},e.prototype._onDotDrag=function(t){ze(t.domEvent);var e=this.getMap(),n=e.getSize().toPoint()._multi(.5),i=qe(t.domEvent,this._sliderRuler),r=e.getMaxZoom(),o=e.getMinZoom(),s=i.y,a=r-s/10;r<a?(a=r,s=0):o>a&&(a=o,s=10*(r-o)),"dragging"===t.type?e.onZooming(a,n,1):"dragend"===t.type&&(this.options.seamless?e.onZoomEnd(a,n):e.onZoomEnd(Math.round(a),n)),this._sliderDot.style.top=s+"px",this._sliderReading.style.height=10*(e.getZoom()-o+1)+"px",this._updateText()},e}(vo);bo.mergeOptions({position:"top-left",slider:!0,zoomLevel:!0,seamless:!1}),ri.mergeOptions({zoomControl:!1}),ri.addOnLoadHook(function(){this.options.zoomControl&&(this.zoomControl=new bo(this.options.zoomControl),this.addControl(this.zoomControl))});var Po=Object.freeze({Control:vo,Attribution:xo,LayerSwitcher:wo,Overview:Co,Panel:Eo,Scale:So,Toolbar:Io,Zoom:bo}),Mo=function(){function t(e,n,i,r){f(this,t),Array.isArray(e)?(this.scale={x:e[0],y:e[1]},this.origin={x:e[2],y:e[3]}):(this.scale={x:e,y:n},this.origin={x:i,y:r})}return t.getDefault=function(t){return"baidu"===t.code.toLowerCase()?"baidu":t.code.toLowerCase()==="EPSG:4326".toLowerCase()?"tms-global-geodetic":"identity"===t.code.toLowerCase()?[1,-1,0,0]:"web-mercator"},t}(),To=6378137*Math.PI;y(Mo,{"web-mercator":new Mo([1,-1,-To,To]),"tms-global-mercator":new Mo([1,1,-To,-To]),"tms-global-geodetic":new Mo([1,1,-180,-90]),baidu:new Mo([1,1,0,0])});var Lo=function(){function t(e,n,i){f(this,t),this.tileSize=i,this.fullExtent=n,this.prepareTileInfo(e,n)}return t.prototype.prepareTileInfo=function(t,e){if(w(t)?t=Mo[t.toLowerCase()]:Array.isArray(t)&&(t=new Mo(t)),!t)throw new Error("Invalid TileSystem");this.tileSystem=t;var n=e.right>e.left?1:-1,i=e.top>e.bottom?-1:1,r=t.origin.x,o=t.origin.y;this.transformation=new bn([n,i,r,o])},t.prototype._getTileNum=function(t,e){var n=this.tileSystem,i=this.tileSize,r=Math.floor(1e-7+t.x/(i.width*e)),o=-Math.floor(1e-7+t.y/(i.height*e));return{x:n.scale.x*r,y:n.scale.y*o}},t.prototype.getTileIndex=function(t,e){var n=this.tileSystem,i=this.transformation.transform(t,1),r=this._getTileNum(i,e);return n.scale.x<0&&(r.x-=1),n.scale.y>0&&(r.y-=1),this.getNeighorTileIndex(r.x,r.y,0,0,!0)},t.prototype.getNeighorTileIndex=function(t,e,n,i,r,o){var s=this.tileSystem,a=t+s.scale.x*n,h=e-s.scale.y*i,u=a,l=h;if(o){var c=this._getTileFullIndex(r);a<c.xmin?(a=c.xmax-(c.xmin-a)%(c.xmax-c.xmin))===c.xmax&&(a=c.xmin):a>=c.xmax&&(a=c.xmin+(a-c.xmin)%(c.xmax-c.xmin)),h>=c.ymax?h=c.ymin+(h-c.ymin)%(c.ymax-c.ymin):h<c.ymin&&(h=c.ymax-(c.ymin-h)%(c.ymax-c.ymin))===c.ymax&&(h=c.ymin)}return{x:a,y:h,idx:u,idy:l}},t.prototype._getTileFullIndex=function(t){var e=this.fullExtent,n=this.transformation,i=this._getTileNum(n.transform(new wn(e.left,e.top),1),t),r=this._getTileNum(n.transform(new wn(e.right,e.bottom),1),t);return new Sn(i,r)},t.prototype.getTilePrjNW=function(t,e,n){var i=this.tileSystem,r=this.tileSize,o=i.origin.y+i.scale.y*(e+(1===i.scale.y?1:0))*(n*r.height),s=i.scale.x*(t+(1===i.scale.x?0:1))*n*r.width+i.origin.x;return new wn(s,o)},t.prototype.getTilePrjSE=function(t,e,n){var i=this.tileSystem,r=this.tileSize,o=i.origin.y+i.scale.y*(e+(1===i.scale.y?0:1))*(n*r.height),s=i.scale.x*(t+(1===i.scale.x?1:0))*n*r.width+i.origin.x;return new wn(s,o)},t.prototype.getTilePrjExtent=function(t,e,n){var i=this.getTilePrjNW(t,e,n),r=this.getTilePrjSE(t,e,n);return new Sn(i,r)},t}(),No={urlTemplate:null,subdomains:null,repeatWorld:!0,background:!0,backgroundZoomDiff:6,loadingLimitOnInteracting:3,placeholder:!1,crossOrigin:null,tileSize:[256,256],offset:[0,0],tileSystem:null,fadeAnimation:!M,debug:!1,spatialReference:null,maxCacheSize:256,renderer:he.webgl?"gl":"canvas",clipByPitch:!0,maxAvailableZoom:null,cascadeTiles:!0,minPitchToCascade:35},Ro=/\{ *([\w_]+) *\}/g,Oo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.fromJSON=function(t){return t&&"TileLayer"===t.type?new e(t.id,t.options):null},e.prototype.getTileSize=function(){return new ce(this.options.tileSize)},e.prototype.getTiles=function(t){var e=this.getMap(),n=e.getContainerExtent(),i=[],r=0,o=this.getMinZoom(),s=this.options.minPitchToCascade,a=m(t)?this._getTileZoom(e.getZoom()):t;if(!m(t)||!this.options.cascadeTiles||e.getPitch()<=s||!m(o)&&a<=o){var h=this._getTiles(a,n);return h&&(r+=h.tiles.length,i.push(h)),{tileGrids:i,count:r}}var u=Math.floor(e._getVisualHeight(s)),l=new In(0,e.height-u,e.width,e.height),c=this._getTiles(a,l,0);r+=c?c.tiles.length:0;var f=new In(0,n.ymin,e.width,l.ymin),p=e.getSpatialReference().getZoomDirection(),d=this._getTiles(a-p,f,1);return r+=d?d.tiles.length:0,i.push(c,d),{tileGrids:i,count:r}},e.prototype.getTileUrl=function(t,e,n){var i=this.options.urlTemplate,r="";if(this.options.subdomains){var o=this.options.subdomains;if(Z(o)){var s=(t+e)%o.length;s<0&&(s=0),r=o[s]}}if(C(i))return i(t,e,n,r);var a={x:t,y:e,z:n,s:r};return i.replace(Ro,function(t,e){var n=a[e];if(void 0===n)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(a)),n})},e.prototype.clear=function(){return this._renderer&&this._renderer.clear(),this.fire("clear"),this},e.prototype.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),options:this.config()}},e.prototype.getSpatialReference=function(){var t=this.getMap();return!t||this.options.spatialReference&&!ni.equals(this.options.spatialReference,t.options.spatialReference)?(this._sr=this._sr||new ni(this.options.spatialReference),this._sr):t.getSpatialReference()},e.prototype._getTileZoom=function(t){var e=this.getMap();_(t)||(t=e.isZooming()?t>e._frameZoom?Math.floor(t):Math.ceil(t):Math.round(t));var n=this.options.maxAvailableZoom;return!m(n)&&t>n&&(t=n),t},e.prototype._getTiles=function(t,e,n){var i=this.getMap();if(!(i&&this.isVisible()&&i.width&&i.height))return null;var r=this.getMinZoom(),o=this.getMaxZoom();if(!m(r)&&t<r||!m(o)&&t>o)return null;var s=this._getTileConfig();if(!s)return null;var a=t,h=this.getSpatialReference(),u=i.getSpatialReference(),l=h.getResolution(a),c={zoom:a,extent:null,tiles:[]},f=this._getTileOffset(a),p=f[0]||f[1],d=e.convertTo(function(t){return i._containerPointToPoint(t)})._add(f),g=this._getInnerExtent(a,e,d),y=this._getMask2DExtent();if(y){var v=y.intersection(d);if(!v)return c;e=v.convertTo(function(t){return i._pointToContainerPoint(t)})}var _=i._containerPointToPrj(e.getCenter()),x=void 0;x=p?this._project(i._pointToPrj(i._prjToPoint(_)._add(f))):this._project(_);for(var w=this._project(i._pointToPrj(d.getMin())),C=this._project(i._pointToPrj(d.getMax())),E=s.getTileIndex(x,l),S=s.getTileIndex(w,l),I=s.getTileIndex(C,l),b=Math.ceil(Math.abs(E.y-S.y)),P=Math.ceil(Math.abs(E.x-S.x)),M=Math.ceil(Math.abs(E.y-I.y)),T=Math.ceil(Math.abs(E.x-I.x)),L=this.getId(),N=this.getRenderer(),R=this.getTileSize(),O=this._getTileConfig().tileSystem.scale,A=[],D=new In,k=-P;k<=T;k++)for(var F=-b;F<=M;F++){var G=s.getNeighorTileIndex(E.x,E.y,k,F,l,this.options.repeatWorld),z=s.getTilePrjNW(G.x,G.y,l),j=i._prjToPoint(this._unproject(z),a),B=void 0,H=void 0;if(h===u)B=R.width,H=R.height;else{var V=s.getTilePrjSE(G.x,G.y,l),q=i._prjToPoint(this._unproject(V),a);B=Math.abs(Math.round(q.x-j.x)),H=Math.abs(Math.round(q.y-j.y))}var W=O.x*(G.idx-G.x)*B,Z=-O.y*(G.idy-G.y)*H;(W||Z)&&j._add(W,Z),h!==u&&(B++,H++),p&&j._sub(f);var U=new In(j,j.add(B,H)),Y={point:j,z:a,x:G.x,y:G.y,extent2d:U,mask:n};(g.intersects(U)||!g.equals(d)&&this._isTileInExtent(Y,e))&&(p&&(Y.point._add(f),Y.extent2d._add(f)),Y.size=[B,H],Y.dupKey=j.round().toArray().join()+","+B+","+H+","+L,Y.id=this._getTileId(G,a),Y.layer=L,N&&N.isTileCachedOrLoading(Y.id)||(Y.url=this.getTileUrl(G.x,G.y,a)),A.push(Y),D._combine(U))}var X=i._containerPointToPoint(e.getCenter(),a)._add(f);return A.sort(function(t,e){return t.point.distanceTo(X)-e.point.distanceTo(X)}),{offset:f,zoom:a,extent:D,tiles:A}},e.prototype._getInnerExtent=function(t,e,n){var i=this.getMap(),r=i.getResolution(t),o=i.getResolution()/r,s=n.getCenter()._multi(o),a=i.getBearing()*Math.PI/180,h=e.getHeight()/2*o,u=e.getWidth()/2*o,l=Math.abs(Math.cos(a)*h)||h,c=Math.abs(Math.sin(a)*h)||u;return new In(s.sub(c,l),s.add(c,l))},e.prototype._getTileOffset=function(t){var e=this.getMap(),n=e._getResolution()/e._getResolution(t),i=this.options.offset;return C(i)&&(i=i(this)),i[0]*=n,i[1]*=n,i},e.prototype._getTileId=function(t,e,n){return[n||this.getId(),t.idy,t.idx,e].join("__")},e.prototype._project=function(t){var e=this.getMap(),n=this.getSpatialReference();return n!==e.getSpatialReference()?n.getProjection().project(e.getProjection().unproject(t)):t},e.prototype._unproject=function(t){var e=this.getMap(),n=this.getSpatialReference();return n!==e.getSpatialReference()?e.getProjection().project(n.getProjection().unproject(t)):t},e.prototype._initTileConfig=function(){var t=this.getMap(),e=this.getTileSize(),n=this.getSpatialReference(),i=n.getProjection(),r=n.getFullExtent();if(this._defaultTileConfig=new Lo(Mo.getDefault(i),r,e),this.options.tileSystem&&(this._tileConfig=new Lo(this.options.tileSystem,r,e)),t&&!this._tileConfig&&t.getSpatialReference()===n&&t.getBaseLayer()&&t.getBaseLayer()!==this&&t.getBaseLayer()._getTileConfig){var o=t.getBaseLayer()._getTileConfig();this._tileConfig=new Lo(o.tileSystem,o.fullExtent,e)}},e.prototype._getTileConfig=function(){return this._defaultTileConfig||this._initTileConfig(),this._tileConfig||this._defaultTileConfig},e.prototype._bindMap=function(e){var n=e.getBaseLayer();return n===this&&(n.options.hasOwnProperty("forceRenderOnMoving")||this.config({forceRenderOnMoving:!0})),t.prototype._bindMap.apply(this,arguments)},e.prototype._isTileInExtent=function(t,e){var n=this.getMap();if(!n)return!1;var i=t.z,r=t.extent2d.convertTo(function(t){return n._pointToContainerPoint(t,i)});return!(r.getWidth()<5||r.getHeight()<5)&&e.intersects(r)},e.prototype.getEvents=function(){return{spatialreferencechange:this._onSpatialReferenceChange}},e.prototype._onSpatialReferenceChange=function(){delete this._tileConfig,delete this._defaultTileConfig,delete this._sr},e}($n);Oo.registerJSONType("TileLayer"),Oo.mergeOptions(No);var Ao=function(t){function e(n,i,r){f(this,e);var o=d(this,t.call(this,n,r));return o.layers=i||[],o._checkChildren(),o.layerMap={},o._groupChildren=[],o}return p(e,t),e.fromJSON=function(t){if(!t||"GroupTileLayer"!==t.type)return null;var n=t.layers.map(function(t){return $n.fromJSON(t)});return new e(t.id,n,t.options)},e.prototype.getLayers=function(){return this.layers},e.prototype.toJSON=function(){return{type:this.getJSONType(),id:this.getId(),layers:this.layers.map(function(t){return t.toJSON()}),options:this.config()}},e.prototype.getTiles=function(t){for(var e=this.layers,n=[],i=0,r=0,o=e.length;r<o;r++){var s=e[r];if(s.options.visible){var a=s.getTiles(t);a&&0!==a.count&&(i+=a.count,F(n,a.tileGrids))}}return{count:i,tileGrids:n}},e.prototype.onAdd=function(){var e=this,n=this.getMap();this.layers.forEach(function(t){e.layerMap[t.getId()]=t,t.getChildLayer&&e._groupChildren.push(t),t._bindMap(n),t.on("show hide",e._onLayerShowHide,e)}),t.prototype.onAdd.call(this)},e.prototype.onRemove=function(){var e=this;this.layers.forEach(function(t){t._doRemove(),t.off("show hide",e._onLayerShowHide,e)}),delete this.layerMap,delete this._groupChildren,t.prototype.onRemove.call(this)},e.prototype.getChildLayer=function(t){var e=this.layerMap[t];if(e)return e;for(var n=0;n<this._groupChildren.length;n++){var i=this._groupChildren[n].getChildLayer(t);if(i)return i}return null},e.prototype._onLayerShowHide=function(){var t=this.getRenderer();t&&t.setToRedraw()},e.prototype.isVisible=function(){if(!t.prototype.isVisible.call(this))return!1;for(var e=this.layers,n=0,i=e.length;n<i;n++)if(e[n].isVisible())return!0;return!1},e.prototype._checkChildren=function(){var t=this,e={};this.layers.forEach(function(n){var i=n.getId();if(e[i])throw new Error("Duplicate child layer id ("+i+") in the GroupTileLayer ("+t.getId()+")");e[i]=1})},e}(Oo);Ao.registerJSONType("GroupTileLayer");var Do={service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},ko=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,n)),o=y({},Do);for(var s in i)s in r.options||(o[s]=i[s]);r.setOptions(i);var a=i.detectRetina&&he.retina?2:1,h=r.getTileSize();return o.width=h.width*a,o.height=h.height*a,r.wmsParams=o,r._wmsVersion=parseFloat(o.version),r}return p(e,t),e.prototype.onAdd=function(){var e=this.options.crs||this.getMap().getProjection().code,n=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[n]=e,t.prototype.onAdd.call(this)},e.prototype.getTileUrl=function(e,n,i){var r=this.getMap()._getResolution(i),o=this._getTileConfig().getTilePrjExtent(e,n,r),s=o.getMax(),a=o.getMin(),h=(this._wmsVersion>=1.3&&"EPSG:4326"===this.wmsParams.crs?[a.y,a.x,s.y,s.x]:[a.x,a.y,s.x,s.y]).join(","),u=t.prototype.getTileUrl.call(this,e,n,i);return u+function(t,e,n){var i=[];for(var r in t)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}(this.wmsParams,u,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+h},e.prototype.toJSON=function(){return{type:"WMSTileLayer",id:this.getId(),options:this.config()}},e.fromJSON=function(t){return t&&"WMSTileLayer"===t.type?new e(t.id,t.options):null},e}(Oo);ko.registerJSONType("WMSTileLayer"),ko.mergeOptions({crs:null,uppercase:!1,detectRetina:!1});var Fo=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,n,i));return r.options.hasOwnProperty("forceRenderOnMoving")||(r.options.forceRenderOnMoving=!1),r}return p(e,t),e.prototype.drawTile=function(){},e.prototype.toJSON=function(){return{type:"CanvasTileLayer",id:this.getId(),options:this.config()}},e.fromJSON=function(t){return t&&"CanvasTileLayer"===t.type?new e(t.id,t.options):null},e}(Oo);function Go(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error("Failed to compile shader: "+r)}return i}Fo.registerJSONType("CanvasTileLayer");var zo="\n        attribute vec3 a_position;\n\n        attribute vec2 a_texCoord;\n\n        uniform mat4 u_matrix;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n            gl_Position = u_matrix * vec4(a_position, 1.0);\n\n            v_texCoord = a_texCoord;\n        }\n    ",jo="\n        precision mediump float;\n\n        uniform sampler2D u_image;\n\n        uniform float u_opacity;\n\n        varying vec2 v_texCoord;\n\n        void main() {\n\n            gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n\n        }\n    ",Bo=[0,0],Ho=[0,0,0],Vo=new Array(16),qo=function(t){var e,n=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.drawGLImage=function(t,e,n,i,r,o){var s=this.gl;this.loadTexture(t),Ho[0]=e||0,Ho[1]=n||0;var a=Or(Vo);Tr(a,a,Ho),Nr(a,this.getMap().projViewMatrix,a),s.uniformMatrix4fv(this.program.u_matrix,!1,a),s.uniform1f(this.program.u_opacity,o),t.glBuffer?s.bindBuffer(s.ARRAY_BUFFER,t.glBuffer):t.glBuffer=this.bufferTileData(0,0,i,r),Bo[0]="a_position",Bo[1]=3,this.enableVertexAttrib(Bo),s.drawArrays(s.TRIANGLE_STRIP,0,4)},e.prototype.bufferTileData=function(t,e,n,i,r){var o=t,s=t+n,a=e,h=e+i;return this.loadImageBuffer(this.set12(o,a,0,o,h,0,s,a,0,s,h,0),r)},e.prototype.drawTinImage=function(t,e,n,i,r){var o=this.gl;this.loadTexture(t),o.uniformMatrix4fv(this.program.u_matrix,!1,this.getMap().projViewMatrix),o.uniform1f(this.program.u_opacity,r),o.bindBuffer(o.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(e),o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),o.bufferData(o.ARRAY_BUFFER,new Float32Array(n),o.DYNAMIC_DRAW),o.bufferData(o.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),o.DYNAMIC_DRAW),o.drawElements(o.TRIANGLES,i.length,o.UNSIGNED_SHORT,0)},e.prototype.createCanvas2=function(){this.canvas2=sn.createCanvas(this.canvas.width,this.canvas.height)},e.prototype.createGLContext=function(){var t=this.gl=function(t,e){for(var n={alpha:!0,stencil:!0,preserveDrawingBuffer:!0,antialias:!1},i=["webgl","experimental-webgl"],r=null,o=0;o<i.length;++o){try{r=t.getContext(i[o],e||n)}catch(t){}if(r)break}return r}(this.canvas2||this.canvas,this.layer.options.glOptions);t.clearColor(0,0,0,0),t.disable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program=this.createProgram(zo,this.layer.options.fragmentShader||jo,["u_matrix","u_image","u_opacity"]),this.useProgram(this.program),this.texBuffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.texBuffer),this.enableVertexAttrib(["a_texCoord",2]),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW),this.enableSampler("u_image"),t.activeTexture(t.TEXTURE0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.posBuffer=this.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.posBuffer),this.enableVertexAttrib(["a_position",3]),this.indicesBuffer=this.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},e.prototype.resizeGLCanvas=function(){this.gl&&this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this.canvas2&&(this.canvas2.width===this.canvas.width&&this.canvas2.height===this.canvas.height||(this.canvas2.width=this.canvas.width,this.canvas2.height=this.canvas.height))},e.prototype.clearGLCanvas=function(){this.gl&&this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},e.prototype.disposeImage=function(t){t&&(t.texture&&this.saveTexture(t.texture),t.glBuffer&&this.saveImageBuffer(t.glBuffer),delete t.texture,delete t.glBuffer)},e.prototype._createTexture=function(t){var e=this.gl,n=this.getTexture()||e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),_(H(t.width))&&_(H(t.width))&&e.generateMipmap(e.TEXTURE_2D),n},e.prototype.getTexture=function(){this._textures||(this._textures=[]);var t=this._textures;return t&&t.length>0?t.pop():null},e.prototype.saveTexture=function(t){this._textures.push(t)},e.prototype.loadTexture=function(t){var e=this.gl,n=t.texture;return n||(n=this._createTexture(t),t.texture=n),e.bindTexture(e.TEXTURE_2D,n),n},e.prototype.getImageBuffer=function(){this._imageBuffers||(this._imageBuffers=[]);var t=this._imageBuffers;return t&&t.length>0?t.pop():null},e.prototype.saveImageBuffer=function(t){this._imageBuffers.push(t)},e.prototype.loadImageBuffer=function(t,e){var n=this.gl,i=e||this.createImageBuffer();return n.bindBuffer(n.ARRAY_BUFFER,i),n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW),i},e.prototype.createImageBuffer=function(){return this.getImageBuffer()||this.createBuffer()},e.prototype.removeGLCanvas=function(){var t=this.gl;if(t){this._buffers&&(this._buffers.forEach(function(e){t.deleteBuffer(e)}),delete this._buffers),this._textures&&(this._textures.forEach(function(e){return t.deleteTexture(e)}),delete this._textures),delete this.posBuffer;var e=t.program;t.deleteShader(e.fragmentShader),t.deleteShader(e.vertexShader),t.deleteProgram(e),delete this.gl,delete this.canvas2}},e.prototype.createBuffer=function(){var t=this.gl.createBuffer();if(!t)throw new Error("Failed to create the buffer object");return this._buffers||(this._buffers=[]),this._buffers.push(t),t},e.prototype.enableVertexAttrib=function(t){!function(t,e,n){if(Array.isArray(n[0])){for(var i=Float32Array.BYTES_PER_ELEMENT,r=0,o=0;o<n.length;o++)r+=n[o][1]||0;for(var s=0,a=0;a<n.length;a++){var h=t.getAttribLocation(e,n[a][0]);if(h<0)throw new Error("Failed to get the storage location of "+n[a][0]);t.vertexAttribPointer(h,n[a][1],t[n[a][2]||"FLOAT"],!1,i*r,i*s),s+=n[a][1]||0,t.enableVertexAttribArray(h)}}else{var u=t.getAttribLocation(e,n[0]);t.vertexAttribPointer(u,n[1],t[n[2]||"FLOAT"],!1,0,0),t.enableVertexAttribArray(u)}}(this.gl,this.gl.program,t)},e.prototype.createProgram=function(t,e,n){var i=function(t,e,n){var i=Go(t,t.VERTEX_SHADER,e),r=Go(t,t.FRAGMENT_SHADER,n);if(!i||!r)return null;var o=t.createProgram();return o?(t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),{program:o,vertexShader:i,fragmentShader:r}):null}(this.gl,t,e),r=i.program,o=i.vertexShader,s=i.fragmentShader;return r.vertexShader=o,r.fragmentShader=s,this._initUniforms(r,n),r},e.prototype.useProgram=function(t){var e=this.gl;return e.useProgram(t),e.program=t,this},e.prototype.enableSampler=function(t,e){var n=this.gl,i=this._getUniform(n.program,t);return e||(e=0),n.uniform1i(i,e),i},e.prototype._initUniforms=function(t,e){for(var n=0;n<e.length;n++){var i=e[n],r=e[n],o=i.indexOf("[");o>=0&&(i=i.substring(0,o),M||(r=r.substring(0,o))),t[i]=this._getUniform(t,r)}},e.prototype._getUniform=function(t,e){var n=this.gl.getUniformLocation(t,e);if(!n)throw new Error("Failed to get the storage location of "+e);return n},e}(t);return y(n.prototype,{set12:(e=he.ie9?null:new Float32Array(12),function(t,n,i,r,o,s,a,h,u,l,c,f){return e[0]=t,e[1]=n,e[2]=i,e[3]=r,e[4]=o,e[5]=s,e[6]=a,e[7]=h,e[8]=u,e[9]=l,e[10]=c,e[11]=f,e})}),n},Wo={renderer:he.webgl?"gl":"canvas",crossOrigin:null},Zo=function(t){function e(n,i,r){f(this,e),Array.isArray(i)||i.url||(r=i,i=null);var o=d(this,t.call(this,n,r));return o._prepareImages(i),o}return p(e,t),e.prototype.setImages=function(t){return this._images=t,this._prepareImages(t),this},e.prototype.getImages=function(){return this._images},e.prototype._prepareImages=function(t){t=t||[],Array.isArray(t)||(t=[t]),this._imageData=t.map(function(t){return y({},t,{extent:new Sn(t.extent)})}),this._images=t;var e=this.getRenderer();e&&e.refreshImages()},e}($n);Zo.mergeOptions(Wo);var Uo=[],Yo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("ImageLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),!1)},e.prototype.checkResources=function(){var t=this;if(this._imageLoaded)return Uo;var e=this.layer._imageData.map(function(t){return[t.url,null,null]});if(this.resources){var n=[],i=new Qn;e.forEach(function(e){if(t.resources.isResourceLoaded(e)){var r=t.resources.getImage(e);i.addResource(e,r)}else n.push(e)}),this.resources.forEach(function(e,n){i.isResourceLoaded(e)||t.retireImage(n.image)}),this.resources=i,e=n}return this._imageLoaded=!0,e},e.prototype.retireImage=function(){},e.prototype.refreshImages=function(){this._imageLoaded=!1,this.setToRedraw()},e.prototype.needToRedraw=function(){var e=this.getMap();return!(e.isZooming()&&!e.getPitch())&&t.prototype.needToRedraw.call(this)},e.prototype.draw=function(){this.isDrawable()&&(this.prepareCanvas(),this._painted=!1,this._drawImages(),this.completeRender())},e.prototype._drawImages=function(){var t=this.layer._imageData,e=this.getMap().getExtent();if(t&&t.length)for(var n=0;n<t.length;n++){var i=t[n].extent,r=this.resources&&this.resources.getImage(t[n].url);r&&e.intersects(i)&&(this._painted=!0,this._drawImage(r,i,t[n].opacity||1))}},e.prototype._drawImage=function(t,e,n){var i=0,r=this.context;n<1&&(i=r.globalAlpha,r.globalAlpha=n);var o=this.getMap(),s=o.coordToPoint(e.getMin()),a=o.coordToPoint(e.getMax()),h=o._pointToContainerPoint(s),u=h.x,l=h.y,c=o.getBearing();c&&(r.save(),r.translate(u,l),c&&r.rotate(-c*Math.PI/180),u=l=0),r.drawImage(t,u,l,a.x-s.x,a.y-s.y),c&&r.restore(),i&&(r.globalAlpha=i)},e.prototype.drawOnInteracting=function(){this.draw()},e}(Kn),Xo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.isDrawable=function(){return!0},e.prototype._drawImage=function(t,e,n){var i=this.getMap(),r=e.__imagelayerposition;r||(r=e.__imagelayerposition=e.convertTo(function(t){return i.coordToPoint(t,i.getGLZoom())})),this.drawGLImage(t,r.xmin,r.ymin,r.getWidth(),r.getHeight(),n)},e.prototype.createContext=function(){this.createGLContext()},e.prototype.resizeCanvas=function(e){this.canvas&&(t.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},e.prototype.clearCanvas=function(){this.canvas&&(t.prototype.clearCanvas.call(this),this.clearGLCanvas())},e.prototype.retireImage=function(t){this.disposeImage(t)},e.prototype.onRemove=function(){this.removeGLCanvas(),t.prototype.onRemove.call(this)},e}(qo(Yo));Zo.registerRenderer("canvas",Yo),Zo.registerRenderer("gl",Xo);var Jo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getPrepareParams=function(){return[]},e.prototype.getDrawParams=function(){return[]},e.prototype.onCanvasCreate=function(){this.canvas&&this.layer.options.doubleBuffer&&(this.buffer=sn.createCanvas(this.canvas.width,this.canvas.height,this.getMap().CanvasClass))},e.prototype.needToRedraw=function(){return!!this.layer.options.animation||!(this.getMap().isInteracting()&&!this.layer.drawOnInteracting)&&t.prototype.needToRedraw.call(this)},e.prototype.draw=function(){this.prepareCanvas(),this.prepareDrawContext(),this._drawLayer()},e.prototype.drawOnInteracting=function(){this._drawLayerOnInteracting()},e.prototype.getCanvasImage=function(){var e=t.prototype.getCanvasImage.call(this);if(e&&e.image&&this.layer.options.doubleBuffer){var n=e.image;this.buffer.width===n.width&&this.buffer.height===n.height||(this.buffer.width=n.width,this.buffer.height=n.height);var i=this.buffer.getContext("2d"),r=this.layer.doubleBuffer(i,this.context);(void 0===r||r)&&(sn.image(i,n,0,0),e.image=this.buffer)}return e},e.prototype.remove=function(){return delete this._drawContext,t.prototype.remove.call(this)},e.prototype.onZoomStart=function(e){this.layer.onZoomStart(e),t.prototype.onZoomStart.call(this,e)},e.prototype.onZooming=function(e){this.layer.onZooming(e),t.prototype.onZooming.call(this,e)},e.prototype.onZoomEnd=function(e){this.layer.onZoomEnd(e),t.prototype.onZoomEnd.call(this,e)},e.prototype.onMoveStart=function(e){this.layer.onMoveStart(e),t.prototype.onMoveStart.call(this,e)},e.prototype.onMoving=function(e){this.layer.onMoving(e),t.prototype.onMoving.call(this,e)},e.prototype.onMoveEnd=function(e){this.layer.onMoveEnd(e),t.prototype.onMoveEnd.call(this,e)},e.prototype.onResize=function(e){this.layer.onResize(e),t.prototype.onResize.call(this,e)},e.prototype.prepareDrawContext=function(){if(!this._predrawed){var t=Ko(this.getPrepareParams());this._drawContext=this.layer.prepareToDraw.apply(this.layer,[this.context].concat(t)),this._drawContext||(this._drawContext=[]),Array.isArray(this._drawContext)||(this._drawContext=[this._drawContext]),this._predrawed=!0}},e.prototype._prepareDrawParams=function(){if(!this.getMap())return null;var t=this.getViewExtent();if(t.maskExtent&&!t.extent.intersects(t.maskExtent))return this.completeRender(),null;var e=[this.context,t],n=Ko(this.getDrawParams());return e.push.apply(e,n),e.push.apply(e,this._drawContext),e},e.prototype._drawLayer=function(){var t=this._prepareDrawParams();t&&(this.layer.draw.apply(this.layer,t),this.completeRender())},e.prototype._drawLayerOnInteracting=function(){if(this.layer.drawOnInteracting){var t=this._prepareDrawParams();t&&(this.layer.drawOnInteracting.apply(this.layer,t),this.completeRender())}},e}(Kn);function Ko(t){return t||(t=[]),Array.isArray(t)||(t=[t]),t}var Qo=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.isCanvasRender=function(){return!0},e.prototype.prepareToDraw=function(){},e.prototype.draw=function(){},e.prototype.redraw=function(){return this._getRenderer()&&this._getRenderer().setToRedraw(),this},e.prototype.play=function(){return this.config("animation",!0),this},e.prototype.pause=function(){return this.config("animation",!1),this},e.prototype.isPlaying=function(){return this.options.animation},e.prototype.clearCanvas=function(){return this._getRenderer()&&this._getRenderer().clearCanvas(),this},e.prototype.requestMapToRender=function(){return this._getRenderer()&&this._getRenderer().requestMapToRender(),this},e.prototype.completeRender=function(){return this._getRenderer()&&this._getRenderer().completeRender(),this},e.prototype.onCanvasCreate=function(){return this},e.prototype.onZoomStart=function(){},e.prototype.onZooming=function(){},e.prototype.onZoomEnd=function(){},e.prototype.onMoveStart=function(){},e.prototype.onMoving=function(){},e.prototype.onMoveEnd=function(){},e.prototype.onResize=function(){},e.prototype.doubleBuffer=function(t){return t.clearRect(0,0,t.canvas.width,t.canvas.height),this},e}($n);Qo.mergeOptions({doubleBuffer:!1,animation:!1}),Qo.registerRenderer("canvas",Jo);var $o=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.getParticles=function(){},e.prototype.draw=function(t,e){var n=this.getParticles(g());if(n&&0!==n.length){var i=this.getMap(),r=e.extent;e.maskExtent&&(r=e.extent.intersection(e.maskExtent)),r=r.convertTo(function(t){return i._pointToContainerPoint(t)});for(var o=2*Math.PI,s=0,a=n.length;s<a;s++){var h=n[s].point;if(r.contains(h)){var u=n[s].color||this.options.lineColor||"#fff",l=n[s].r;t.fillStyle!==u&&(t.fillStyle=u),l<=2?t.fillRect(h.x-l/2,h.y-l/2,l,l):(t.beginPath(),t.arc(h.x,h.y,l/2,0,o),t.fill())}}this._fillCanvas(t)}else{this._getRenderer()&&(this._getRenderer()._shouldClear=!0)}},e.prototype._fillCanvas=function(t){var e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out";var n=this.options.trail||30;t.fillStyle="rgba(0, 0, 0, "+1/n+")",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.globalCompositeOperation=e},e}(Qo);$o.mergeOptions({animation:!0}),$o.registerRenderer("canvas",function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.draw=function(){this.canvas&&this.layer.options.animation&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this.prepareDrawContext(),this._drawLayer()},e.prototype.drawOnInteracting=function(){this.draw(),this._shouldClear=!1},e.prototype.onSkipDrawOnInteracting=function(){this._shouldClear=!0},e}(Jo));var ts=r+"_edit_stage_";function es(t,e){return{markerType:t,markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:e}}var ns={fixAspectRatio:!1,symbol:null,removeVertexOn:"contextmenu",centerHandleSymbol:es("ellipse",1),vertexHandleSymbol:es("square",1),newVertexHandleSymbol:es("square",.4)},is=function(t){function e(n,i){f(this,e);var r=d(this,t.call(this,i));return r._geometry=n,r._geometry?r:d(r)}return p(e,t),e.prototype.getMap=function(){return this._geometry.getMap()},e.prototype.prepare=function(){this.getMap()&&(this.options.symbol&&(this._originalSymbol=this._geometry.getSymbol(),this._geometry.setSymbol(this.options.symbol)),this._prepareEditStageLayer())},e.prototype._prepareEditStageLayer=function(){var t=this.getMap(),e=A(),n=ts+e,i=ts+e+"_shadow";this._editStageLayer=t.getLayer(n),this._shadowLayer=t.getLayer(i),this._editStageLayer||(this._editStageLayer=new Cr(n),t.addLayer(this._editStageLayer)),this._shadowLayer||(this._shadowLayer=new Cr(i),t.addLayer(this._shadowLayer))},e.prototype.start=function(){var t=this;if(this._geometry&&this._geometry.getMap()&&!this._geometry.editing){var e=this.getMap();this.editing=!0;var n=this._geometry;this._geometryDraggble=n.options.draggable,n.config("draggable",!1),this.prepare();var i=n.copy();i.setSymbol(n._getInternalSymbol()),i.copyEventListeners(n),n._getParent()&&i.copyEventListeners(n._getParent()),i.setId(null).config({draggable:!1}),this._shadow=i,this._switchGeometryEvents("on"),n.hide(),(n instanceof Wi||n instanceof ir||n instanceof or||n instanceof rr)&&this._createOrRefreshOutline(),this._shadowLayer.bringToFront().addGeometry(i),this._editStageLayer.bringToFront(),this._addListener([e,"zoomstart",function(){t._editStageLayer.hide()}]),this._addListener([e,"zoomend",function(){t._editStageLayer.show()}]),n instanceof Wi?(i.config("draggable",!0),i.on("dragend",this._onMarkerDragEnd,this)):this._createCenterHandle(),n instanceof Wi?this.createMarkerEditor():n instanceof ir?this.createCircleEditor():n instanceof or?this.createEllipseOrRectEditor():n instanceof rr?this.createEllipseOrRectEditor():n instanceof sr||(n instanceof Vi||n instanceof Ui)&&this.createPolygonEditor()}},e.prototype.stop=function(){delete this._history,delete this._historyPointer,delete this._editOutline,this._switchGeometryEvents("off"),this.getMap()&&(delete this._shadow,this._geometry.config("draggable",this._geometryDraggble),delete this._geometryDraggble,this._geometry.show(),this._editStageLayer.remove(),this._shadowLayer.remove(),this._clearAllListeners(),this._refreshHooks=[],this.options.symbol&&(this._geometry.setSymbol(this._originalSymbol),delete this._originalSymbol),this.editing=!1)},e.prototype.isEditing=function(){return!m(this.editing)&&this.editing},e.prototype._getGeometryEvents=function(){return{symbolchange:this._onGeoSymbolChange,"positionchange shapechange":this._exeAndReset}},e.prototype._switchGeometryEvents=function(t){if(this._geometry){var e=this._getGeometryEvents();for(var n in e)this._geometry[t](n,e[n],this)}},e.prototype._onGeoSymbolChange=function(t){this._shadow&&this._shadow.setSymbol(t.target._getInternalSymbol())},e.prototype._onMarkerDragEnd=function(){this._update("setCoordinates",this._shadow.getCoordinates().toArray()),this._refresh()},e.prototype._createOrRefreshOutline=function(){var t=this._geometry,e=this._editOutline;return e?(e.remove(),this._editOutline=e=t.getOutline(),this._editStageLayer.addGeometry(e)):(e=t.getOutline(),this._editStageLayer.addGeometry(e),this._editOutline=e,this._addRefreshHook(this._createOrRefreshOutline)),e},e.prototype._createCenterHandle=function(){var t=this,e=this._shadow.getCenter(),n=this.options.centerHandleSymbol,i=void 0,r=this.createHandle(e,{symbol:n,cursor:"move",onDown:function(){var e=Ft((i=t._shadow.copy())._getInternalSymbol(),.5);i.setSymbol(e).addTo(t._editStageLayer)},onMove:function(t,e){var n=e.coordOffset;i.translate(n)},onUp:function(){t._update("setCoordinates",wn.toNumberArrays(i.getCoordinates())),i.remove(),t._refresh()}});this._addRefreshHook(function(){var e=t._shadow.getCenter();r.setCoordinates(e)})},e.prototype._createHandleInstance=function(t,e){var n=e.symbol;return new Wi(t,{draggable:!0,dragShadow:!1,dragOnAxis:e.axis,cursor:e.cursor,symbol:n})},e.prototype.createHandle=function(t,e){e||(e={});var n=this.getMap(),i=this._createHandleInstance(t,e),r=this;function o(t){return e.onDown&&e.onDown.call(r,t.viewPoint,t),!1}function s(t){r._hideContext();var o=n._prjToViewPoint(i._getPrjCoordinates());return e.onMove&&e.onMove.call(r,o,t),!1}function a(t){return e.onUp&&e.onUp.call(r,t),!1}return i.on("dragstart",o,this),i.on("dragging",s,this),i.on("dragend",a,this),i.on("removestart",function t(){i.config("draggable",!1),i.off("dragstart",o,r),i.off("dragging",s,r),i.off("dragend",a,r),i.off("removestart",t,r),delete i["maptalks--editor-refresh-fn"]},this),e.onRefresh&&(i["maptalks--editor-refresh-fn"]=e.onRefresh),this._editStageLayer.addGeometry(i),i},e.prototype._createResizeHandles=function(t,e,n){var i=this,r=["nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize"],o=[null,"y",null,"x","x",null,"y",null],s=this._geometry;t||(t=[]);var a=this,h=[],u={},l=this.getMap(),c=this.options.vertexHandleSymbol,f=function(){for(var f,p=s._getPainter().get2DExtent(),d=[(f=p).getMin(),new le((f.xmax+f.xmin)/2,f.ymin),new le(f.xmax,f.ymin),new le(f.xmin,(f.ymax+f.ymin)/2),new le(f.xmax,(f.ymax+f.ymin)/2),new le(f.xmin,f.ymax),new le((f.xmax+f.xmin)/2,f.ymax),f.getMax()],g=function(f){if(Array.isArray(t)&&t.some(function(t){return t===f}))return"continue";var p,g=d[f],y=l.pointToCoordinate(g);if(h.length<d.length-t.length){var m=i.createHandle(y,{symbol:c,cursor:r[f],axis:o[f],onMove:(p=f,function(t){a._updating=!0,e(t,p),s.fire("resizing")}),onUp:function(){a._updating=!1,n(),i._refresh()}});m.setId(f),u[f]=h.length,h.push(m)}else h[u[f]].setCoordinates(y)},y=0;y<d.length;y++)g(y)};return f(),this._addRefreshHook(f),h},e.prototype.createMarkerEditor=function(){var t=this,e=this._geometry,n=this._shadow,i=this.getMap();if(n._canEdit()){this._history||this._recordHistory(c());var r=n._getInternalSymbol(),o=new le(0,0);v(r.markerDx)&&(o.x=r.markerDx),v(r.markerDy)&&(o.y=r.markerDy);var s=null;mi.test(r)?"pin"!==r.markerType&&"pie"!==r.markerType&&"bar"!==r.markerType||(s=[5,6,7]):(_i.test(r)||Ei.test(r))&&(s=[5,6,7]);var a=[2,1,2,0,0,2,1,2],h=void 0;if(this.options.fixAspectRatio){var u=n.getSize();h=u.width/u.height}var l=this._createResizeHandles(null,function(r,u){if(s&&s.indexOf(u)>=0){var c=i.viewPointToCoordinate(r.sub(o)),f=n.getCoordinates();c.x=f.x,n.setCoordinates(c),t._updateCoordFromShadow(!0);var p=l[l.length-1-u];r=i.coordToViewPoint(p.getCoordinates())}var d=i._pointToViewPoint(n._getCenter2DPoint()).add(o),g=n._getInternalSymbol(),y=r.sub(d);s&&r.y>d.y&&(y.y=0);var m=s?1:2,v=2*Math.abs(y.x),_=Math.abs(y.y)*m;h&&(_=(v=Math.max(v,_*h))/h);var x=a[u];n instanceof dr?((h||0===x||2===x)&&(n.setWidth(v),e.setWidth(v)),(h||1===x||2===x)&&(n.setHeight(_),e.setHeight(_))):((h||0===x||2===x)&&(g.markerWidth=v),(h||1===x||2===x)&&(g.markerHeight=_),n.setSymbol(g),e.setSymbol(g))},function(){t._update(c())});this._addListener([i,"zoomend",function(){this._refresh()}])}else console&&console.warn("A marker can't be resized with symbol:",n.getSymbol());function c(){var t=[["setCoordinates",n.getCoordinates().toArray()]];return n instanceof dr?(t.push(["setWidth",n.getWidth()]),t.push(["setHeight",n.getHeight()])):t.push(["setSymbol",n.getSymbol()]),t}},e.prototype.createCircleEditor=function(){var t=this,e=this._geometry,n=this._shadow,i=this.getMap();this._history||this._recordHistory([["setCoordinates",n.getCoordinates().toArray()],["setRadius",n.getRadius()]]),this._createResizeHandles(null,function(t){var r=i._pointToViewPoint(n._getCenter2DPoint()),o=t.sub(r),s=Math.abs(o.x),a=Math.abs(o.y),h=void 0;h=s>a?i.pixelToDistance(s,0):i.pixelToDistance(0,a),n.setRadius(h),e.setRadius(h)},function(){t._update("setRadius",n.getRadius())})},e.prototype.createEllipseOrRectEditor=function(){var t=this,e=[2,1,2,0,0,2,1,2],n=this._geometry,i=this._shadow;this._history||this._recordHistory(h());var r=this.getMap(),o=this._geometry instanceof or,s=void 0;this.options.fixAspectRatio&&(s=n.getWidth()/n.getHeight());var a=this._createResizeHandles(null,function(h,u){var l=o?1:2,c=void 0,f=void 0,p=void 0,d=h,g=e[u];if(o){var y=a[7-u],m=r.coordToViewPoint(y.getCoordinates()),v=(c=d.sub(m)).abs();f=r.pixelToDistance(v.x,0),p=r.pixelToDistance(0,v.y);var _=n.getSize();0===g?(s&&(v.y=v.x/s,_.height=Math.abs(v.y),p=f/s),d.y=m.y-_.height/2):1===g?(s&&(v.x=v.y*s,_.width=Math.abs(v.x),f=p*s),d.x=m.x-_.width/2):s&&(f>p*s?(p=f/s,d.y=m.y+v.x*B(c.y)/s):(f=p*s,d.x=m.x+v.y*B(c.x)*s));var x=r.viewPointToCoordinate(new le(Math.min(d.x,m.x),Math.min(d.y,m.y)));i.setCoordinates(x),t._updateCoordFromShadow(!0)}else{c=r.coordToViewPoint(n.getCenter()).sub(d)._abs(),f=r.pixelToDistance(c.x,0),p=r.pixelToDistance(0,c.y),s&&(p=(f=Math.max(f,p*s))/s)}(s||0===g||2===g)&&(i.setWidth(f*l),n.setWidth(f*l)),(s||1===g||2===g)&&(i.setHeight(p*l),n.setHeight(p*l))},function(){t._update(h())});function h(){return[["setCoordinates",i.getCoordinates().toArray()],["setWidth",i.getWidth()],["setHeight",i.getHeight()]]}},e.prototype.createPolygonEditor=function(){var t=this.getMap(),e=this._shadow,n=this,i=t.getProjection();this._history||this._recordHistory("setCoordinates",wn.toNumberArrays(e.getCoordinates()));var r=e instanceof Vi?3:2,o="maptalks--editor-refresh-fn",s="maptalks--editor-vertex-index",a=[],h=[];function u(){if(e instanceof Vi){var t=e.getCoordinates()[0];return t.slice(0,t.length-1)}return e.getCoordinates()}function l(){return e._getPrjCoordinates()}function c(){for(var t=a.length-1;t>=0;t--)a[t][s]=t;for(var e=h.length-1;e>=0;e--)h[e][s]=e;n._updateCoordFromShadow()}function f(t){var i=t.target[s],o=l();if(!(o.length<=r)){o.splice(i,1),e._setPrjCoordinates(o),e._updateCache(),a.splice(i,1)[0].remove(),i<h.length&&h.splice(i,1)[0].remove();var u=void 0;u=0===i?h.length-1:i-1,h.splice(u,1)[0].remove(),h.splice(u,0,g.call(n,u)),c(),n._refresh()}}function p(i,r){var s=l(),a=t._viewPointToPrj(i),u=s[r];u.x=a.x,u.y=a.y,e._updateCache(),e.onShapeChanged(),n._updateCoordFromShadow(!0);var c=void 0;c=0===r?h.length-1:r-1,h[r]&&h[r][o](),h[c]&&h[c][o]()}function d(t){var e=u()[t],i=n.createHandle(e,{symbol:n.options.vertexHandleSymbol,cursor:"pointer",axis:null,onMove:function(t){p(t,i[s])},onRefresh:function(){e=u()[i[s]],i.setCoordinates(e)},onUp:function(){n._refresh(),n._updateCoordFromShadow()}});return i[s]=t,i.on(n.options.removeVertexOn,f),i}function g(t){var r=u(),o=void 0;o=t+1>=r.length?r[0]:r[t+1];var f=r[t].add(o).multi(.5),y=n.createHandle(f,{symbol:n.options.newVertexHandleSymbol,cursor:"pointer",axis:null,onDown:function(t,r){if(!r||!r.domEvent||2!==r.domEvent.button){var o=l(),a=y[s],u=i.project(y.getCoordinates());o.splice(a+1,0,u),e._setPrjCoordinates(o),e._updateCache();var c=y.getSymbol();delete c.opacity,y.setSymbol(c),h.splice(a,0,g.call(n,a),g.call(n,a+1))}},onMove:function(t){p(t,y[s]+1)},onUp:function(t){if(!t||!t.domEvent||2!==t.domEvent.button){var e=y[s];G(y,h),y.remove(),a.splice(e+1,0,d.call(n,e+1)),c(),n._updateCoordFromShadow(),n._refresh()}},onRefresh:function(){r=u();var t=y[s],e=void 0;e=t===r.length-1?0:t+1;var n=r[t].add(r[e]).multi(.5);y.setCoordinates(n)}});return y[s]=t,y}for(var y=u(),m=0,v=y.length;m<v;m++)a.push(d.call(this,m)),m<v-1&&h.push(g.call(this,m));e instanceof Vi&&h.push(g.call(this,y.length-1)),this._addRefreshHook(function(){for(var t=h.length-1;t>=0;t--)h[t][o]();for(var e=a.length-1;e>=0;e--)a[e][o]()})},e.prototype._refresh=function(){if(this._refreshHooks)for(var t=this._refreshHooks.length-1;t>=0;t--)this._refreshHooks[t].call(this)},e.prototype._hideContext=function(){this._geometry&&(this._geometry.closeMenu(),this._geometry.closeInfoWindow())},e.prototype._addListener=function(t){this._eventListeners||(this._eventListeners=[]),this._eventListeners.push(t),t[0].on(t[1],t[2],this)},e.prototype._clearAllListeners=function(){if(this._eventListeners&&this._eventListeners.length>0){for(var t=this._eventListeners.length-1;t>=0;t--){var e=this._eventListeners[t];e[0].off(e[1],e[2],this)}this._eventListeners=[]}},e.prototype._addRefreshHook=function(t){t&&(this._refreshHooks||(this._refreshHooks=[]),this._refreshHooks.push(t))},e.prototype._update=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this._exeHistory([t,n]),this._recordHistory.apply(this,[t].concat(n))},e.prototype._updateCoordFromShadow=function(t){if(this._shadow){var e=this._shadow.getCoordinates(),n=this._geometry,i=this._updating;this._updating=!0,n.setCoordinates(e),t||this._recordHistory("setCoordinates",wn.toNumberArrays(n.getCoordinates())),this._updating=i}},e.prototype._recordHistory=function(t){this._history||(this._history=[],this._historyPointer=0),this._historyPointer<this._history.length-1&&this._history.splice(this._historyPointer+1);for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this._history.push([t,n]),this._historyPointer=this._history.length-1,this._geometry.fire("editrecord")},e.prototype.undo=function(){if(!this._history||0===this._historyPointer)return this;var t=this._history[--this._historyPointer];return this._exeAndReset(t),this},e.prototype.redo=function(){if(!this._history||this._historyPointer===this._history.length-1)return null;var t=this._history[++this._historyPointer];return this._exeAndReset(t),this},e.prototype._exeAndReset=function(t){if(!this._updating){this._exeHistory(t);var e=this._history,n=this._historyPointer;this.stop(),this._history=e,this._historyPointer=n,this.start()}},e.prototype._exeHistory=function(t){var e=this;if(Array.isArray(t)){var n=this._updating;this._updating=!0;var i=this._geometry;Array.isArray(t[0])?t[0].forEach(function(t){var n=t[0],r=t.slice(1);e._shadow[n].apply(e._shadow,r),i[n].apply(i,r)}):(this._shadow[t[0]].apply(this._shadow,t[1]),i[t[0]].apply(i,t[1])),this._updating=n}},e}(cn(dn));is.mergeOptions(ns);var rs={startEditText:function(){return this.getMap()?(this.hide(),this.endEditText(),this._prepareEditor(),this._fireEvent("edittextstart"),this):this},endEditText:function(){if(this._textEditor){var t=this._textEditor.innerHTML;t=t.replace(/<p>/gi,"").replace(/<\/p>/gi,"<br/>"),this._textEditor.innerHTML=t;var e=this._textEditor.innerText.replace(/[\r\n]+$/gi,"");this.setContent(e),en(this._textEditor,"mousedown dblclick",je),this.getMap().off("mousedown",this.endEditText,this),this._editUIMarker.remove(),delete this._editUIMarker,this._textEditor.onkeyup=null,delete this._textEditor,this.show(),this._fireEvent("edittextend")}return this},isEditingText:function(){return!!this._textEditor},getTextEditor:function(){return this._editUIMarker},_prepareEditor:function(){var t=this.getMap(),e=this._createEditor();this._textEditor=e,t.on("mousedown",this.endEditText,this);var n=this._getEditorOffset();this._editUIMarker=new ho(this.getCoordinates(),{animation:null,content:e,dx:n.dx,dy:n.dy}).addTo(t),this._setCursorToLast(this._textEditor)},_getEditorOffset:function(){var t=this._getInternalSymbol()||{},e=0,n=0,i=t.textHorizontalAlignment;return"middle"===i||m(i)?(e=(t.textDx||0)-2,n=(t.textDy||0)-2):(e=(t.markerDx||0)-2,n=(t.markerDy||0)-2),{dx:e,dy:n}},_createEditor:function(){var t=this.getContent(),e=this.getSize(),n=this._getInternalSymbol()||{},i=e.width,r=n.textFill||"#000000",o=n.textSize||12,s=e.height,a=n.markerLineColor||"#000",h=n.markerFill||"#3398CC",u=n.textLineSpacing||0,l=Oe("div");return l.contentEditable=!0,l.style.cssText="background:"+h+"; border:1px solid "+a+";\n            color:"+r+";font-size:"+o+"px;width:"+(i-2)+"px;height:"+(s-2)+"px;margin: auto;\n            line-height:"+(o+u)+"px;outline: 0; padding:0; margin:0;word-wrap: break-word;\n            overflow: hidden;-webkit-user-modify: read-write-plaintext-only;",l.innerText=t,tn(l,"mousedown dblclick",je),l.onkeyup=function(t){var e=l.style.height||0;13===t.keyCode&&(l.style.height=parseInt(e)+o/2+"px")},l},_setCursorToLast:function(t){var e=void 0;window.getSelection?(t.focus(),(e=window.getSelection()).selectAllChildren(t),e.collapseToEnd()):document.selection&&((e=document.selection.createRange()).moveToElementText(t),e.collapse(!1),e.select())}};pr.include(rs),Ni.include({animate:function(t,e,n){var i=this;this._animPlayer&&this._animPlayer.finish(),C(e)&&(n=e),e||(e={});var r=this.getMap(),o=this._getProjection(),s=this.getSymbol()||{},a=this._prepareAnimationStyles(t),h=void 0,u=e.focus;if(delete this._animationStarted,r){var l=r._getRenderer();e.framer=function(t){l.callInNextFrame(t)}}var c=zi.animate(a,e,function(t){if(r&&r.isRemoved())c.finish();else{r&&!i._animationStarted&&u&&r.onMoveStart();var e=t.styles;for(var a in e)if("symbol"!==a&&"translate"!==a&&e.hasOwnProperty(a)){var l="set"+a[0].toUpperCase()+a.slice(1);i[l](e[a])}var f=e.translate;if(f){var p=f;h&&(p=f.sub(h)),h=f,i.translate(p)}var d=e.symbol;if(d&&i.setSymbol(Gt(s,d)),r&&u){var g=o.project(i.getCenter());r._setPrjCenter(g);var y=r._parseEventFromCoord(o.unproject(g));"running"!==c.playState?r.onMoveEnd(y):r.onMoving(y)}i._fireAnimateEvent(c.playState),n&&n(t)}});return this._animPlayer=c,this._animPlayer.play()},_prepareAnimationStyles:function(t){var e=this._getInternalSymbol(),n={};for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if("translate"!==i&&"symbol"!==i){var o=this["get"+i[0].toUpperCase()+i.substring(1)]();n[i]=[o,r]}else if("symbol"===i){var s=void 0;if(Array.isArray(t.symbol)){if(!Array.isArray(e))throw new Error("geometry'symbol isn't a composite symbol, while the symbol in styles is.");s=[];for(var a=t.symbol,h=0;h<a.length;h++)if(a[h]){var u={};for(var l in a[h])a[h].hasOwnProperty(l)&&(u[l]=[e[h][l],a[h][l]]);s.push(u)}else s.push(null)}else{if(Array.isArray(e))throw new Error("geometry'symbol is a composite symbol, while the symbol in styles isn't.");for(var c in s={},r)r.hasOwnProperty(c)&&(s[c]=[e[c],r[c]])}n.symbol=s}else"translate"===i&&(n.translate=new wn(r))}return n},_fireAnimateEvent:function(t){"finished"===t?(delete this._animationStarted,this._fireEvent("animateend")):"running"===t&&(this._animationStarted?this._fireEvent("animating"):(this._fireEvent("animatestart"),this._animationStarted=!0))}});var os=r+"_drag_stage",ss=he.touch?"touchstart mousedown":"mousedown",as=function(t){function e(n){return f(this,e),d(this,t.call(this,n))}return p(e,t),e.prototype.addHooks=function(){this.target.on(ss,this._startDrag,this)},e.prototype.removeHooks=function(){this._endDrag(),this.target.off(ss,this._startDrag,this),delete this.container},e.prototype._prepareDragHandler=function(){this._dragHandler=new xn(this.container),this._dragHandler.on("dragging",this._dragging,this).on("mouseup",this._endDrag,this).enable()},e.prototype._prepareShadow=function(){var t=this.target;this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var e=this._shadow=t.copy();if(this._shadow.setSymbol(t._getInternalSymbol()),t.options.dragShadow){var n=Ft(e._getInternalSymbol(),.5);e.setSymbol(n)}e.setId(null),this._prepareShadowConnectors()},e.prototype._prepareShadowConnectors=function(){var t=this.target,e=this._shadow,n=this._dragStageLayer._getRenderer().resources,i=[];if(vr._hasConnectors(t))for(var r=vr._getConnectors(t),o=0,s=r.length;o<s;o++){var a=r[o],h=a.config(),u=a._getInternalSymbol();h.symbol=Ft(u,.5);var l=void 0;l=a.getConnectSource()===t?new a.constructor(e,a.getConnectTarget(),h):new a.constructor(a.getConnectSource(),e,h),i.push(l),a.getLayer()&&a.getLayer()._getRenderer()&&n.merge(a.getLayer()._getRenderer().resources)}this._shadowConnectors=i,i.push(e),this._dragStageLayer.bringToFront().addGeometry(i)},e.prototype._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target._getSymbol())},e.prototype._prepareDragStageLayer=function(){var t=this.target.getMap(),e=this.target.getLayer();this._dragStageLayer=t.getLayer(os),this._dragStageLayer||(this._dragStageLayer=new Cr(os,{enableAltitude:e.options.enableAltitude,altitudeProperty:e.options.altitudeProperty}),t.addLayer(this._dragStageLayer));var n=new Qn;n.merge(e._getRenderer().resources),this._dragStageLayer._getRenderer().resources=n},e.prototype._startDrag=function(t){var e=this.target.getMap();if(e&&(!this.target._getParent()&&!this.isDragging())){var n=t.domEvent;n.touches&&n.touches.length>1||2===n.button||(this.container=e._panels.mapWrapper||e._containerDOM,this.target.on("click",this._endDrag,this),this._lastCoord=this._correctCoord(t.coordinate),this._lastPoint=t.containerPoint,this._prepareDragHandler(),this._dragHandler.onMouseDown(t.domEvent),tn(this.container,"mouseleave",this._endDrag,this),this._startParam=t,this._moved=!1)}},e.prototype._dragging=function(t){var e=this.target,n=e.getMap()._parseEvent(t.domEvent),i=n.domEvent;if(!(i.touches&&i.touches.length>1)){if(!this._moved)return this._moved=!0,e.on("symbolchange",this._onTargetUpdated,this),this._isDragging=!0,this._prepareShadow(),e.options.dragShadow||e.hide(),this._shadow._fireEvent("dragstart",n),this.target._fireEvent("dragstart",this._startParam||n),void delete this._startParam;if(this._shadow){var r=this._shadow.options.dragOnAxis,o=this._correctCoord(n.coordinate),s=n.containerPoint;this._lastPoint=this._lastPoint||s,this._lastCoord=this._lastCoord||o;var a=s.sub(this._lastPoint),h=o.sub(this._lastCoord);"x"===r?a.y=h.y=0:"y"===r&&(a.x=h.x=0),this._lastPoint=s,this._lastCoord=o,this._shadow.translate(h),e.options.dragShadow||e.translate(h),n.coordOffset=h,n.pointOffset=a,this._shadow._fireEvent("dragging",n),e._fireEvent("dragging",n)}}},e.prototype._endDrag=function(t){if(this._dragHandler&&(this._dragHandler.disable(),delete this._dragHandler),this.container&&en(this.container,"mouseleave",this._endDrag,this),this.target){var e=this.target;e.off("click",this._endDrag,this),e.off("symbolchange",this._onTargetUpdated,this),delete this._lastCoord,delete this._lastPoint,this._isDragging=!1;var n=e.getMap();if(this.enabled()&&n){var i=n._parseEvent(t?t.domEvent:null);this._updateTargetAndRemoveShadow(i),this._moved&&e._fireEvent("dragend",i)}}},e.prototype.isDragging=function(){return!!this._isDragging},e.prototype._updateTargetAndRemoveShadow=function(t){var e=this.target,n=e.getMap();e.options.dragShadow||e.show();var i=this._shadow;i&&(e.options.dragShadow&&e.setCoordinates(i.getCoordinates()),i._fireEvent("dragend",t),i.remove(),delete this._shadow),this._shadowConnectors&&(n.getLayer(os).removeGeometry(this._shadowConnectors),delete this._shadowConnectors),this._dragStageLayer&&this._dragStageLayer.remove()},e.prototype._correctCoord=function(t){var e=this.target.getMap();if(!e.getPitch())return t;var n=this.target._getPainter();if(!n.getMinAltitude())return t;var i=(n.getMinAltitude()+n.getMaxAltitude())/2;return e.locateByPoint(t,0,-i)},e}(pn);Ni.mergeOptions({draggable:!1,dragShadow:!0,dragOnAxis:null}),Ni.addInitHook("addHandler","draggable",as),Ni.include({isDragging:function(){return this._getParent()?this._getParent().isDragging():!!this.draggable&&this.draggable.isDragging()}}),Ni.include({startEdit:function(t){return this.getMap()&&this.options.editable?(this.endEdit(),this._editor=new is(this,t),this._editor.start(),this.fire("editstart"),this):this},endEdit:function(){return this._editor&&(this._editor.stop(),delete this._editor,this.fire("editend")),this},redoEdit:function(){return this.isEditing()?(this._editor.redo(),this.fire("redoedit"),this):this},undoEdit:function(){return this.isEditing()?(this._editor.undo(),this.fire("undoedit"),this):this},isEditing:function(){return!!this._editor&&this._editor.isEditing()}}),Ni.include({_onEvent:function(t,e){if(this.getMap()){var n=e||this._getEventTypeToFire(t);"contextmenu"===n&&this.listens("contextmenu")&&(je(t),ze(t));var i=this._getEventParams(t);this._fireEvent(n,i)}},_getEventTypeToFire:function(t){return t.type},_getEventParams:function(t){var e=this.getMap(),n={domEvent:t},i=t.touches&&t.touches.length>0?t.touches[0]:t.changedTouches&&t.changedTouches.length>0?t.changedTouches[0]:t;if(i){var r=qe(i,e._containerDOM);n.coordinate=e.containerPointToCoordinate(r),n.containerPoint=r,n.viewPoint=e.containerPointToViewPoint(r),n.pont2d=e._containerPointToPoint(r)}return n}}),Ni.include({setInfoWindow:function(t){return this.removeInfoWindow(),t instanceof co?(this._infoWindow=t,this._infoWinOptions=y({},this._infoWindow.options),this._infoWindow.addTo(this),this):(this._infoWinOptions=y({},t),this._infoWindow?this._infoWindow.setOptions(t):this.getMap()&&this._bindInfoWindow(this._infoWinOptions),this)},getInfoWindow:function(){return this._infoWindow?this._infoWindow:null},openInfoWindow:function(t){return this.getMap()?(t||(t=this.getCenter()),this._infoWindow?this._infoWindow.show(t):this._infoWinOptions&&this.getMap()&&(this._bindInfoWindow(this._infoWinOptions),this._infoWindow.show(t)),this):this},closeInfoWindow:function(){return this._infoWindow&&this._infoWindow.hide(),this},removeInfoWindow:function(){return this._unbindInfoWindow(),delete this._infoWinOptions,delete this._infoWindow,this},_bindInfoWindow:function(t){return this._infoWindow=new co(t),this._infoWindow.addTo(this),this},_unbindInfoWindow:function(){return this._infoWindow&&(this.closeInfoWindow(),this._infoWindow.remove(),delete this._infoWindow),this}});var hs=function(){function t(e,n){f(this,t),this.max=e,this.onRemove=n,this.reset()}return t.prototype.reset=function(){for(var t in this.data)this.onRemove(this.data[t]);return this.data={},this.order=[],this},t.prototype.clear=function(){this.reset(),delete this.onRemove},t.prototype.add=function(t,e){if(this.has(t))this.order.splice(this.order.indexOf(t),1),this.data[t]=e,this.order.push(t);else if(this.data[t]=e,this.order.push(t),this.order.length>this.max){var n=this.getAndRemove(this.order[0]);n&&this.onRemove(n)}return this},t.prototype.has=function(t){return t in this.data},t.prototype.keys=function(){return this.order},t.prototype.getAndRemove=function(t){if(!this.has(t))return null;var e=this.data[t];return delete this.data[t],this.order.splice(this.order.indexOf(t),1),e},t.prototype.get=function(t){return this.has(t)?this.data[t]:null},t.prototype.remove=function(t){if(!this.has(t))return this;var e=this.data[t];return delete this.data[t],this.onRemove(e),this.order.splice(this.order.indexOf(t),1),this},t.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this.getAndRemove(this.order[0]);e&&this.onRemove(e)}return this},t}(),us=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i.tilesInView={},i.tilesLoading={},i._parentTiles=[],i._childTiles=[],i.tileCache=new hs(n.options.maxCacheSize,i.deleteTile.bind(i)),i}return p(e,t),e.prototype.draw=function(){var t=this.getMap();if(this.isDrawable()){var e=this.prepareCanvas();if(!e||e.intersects(this.canvasExtent2D)){var n=this.layer.getTiles().tileGrids;if(n&&n.length){var i=0,r=!1,o={},s=[],a=[],h={},u=[],l={},c=[],f={},p={},d=this._markTiles(),g=this._getLoadLimit(),y=n.length;this._tileZoom=n[0].zoom,this._tileOffset=n[0].offset;for(var m=0;m<y;m++)for(var v=n[m],_=v.tiles,x=this._generatePlaceHolder(v.zoom),w=0,C=_.length;w<C;w++){var E=_[w],S=E.id,I=this._getCachedTile(S),b=!1;if(this._isLoadingTile(S))b=r=!0,this.tilesLoading[S].current=!0;else if(I)this.getTileOpacity(I.image)<1&&(b=r=!0),s.push(I);else{b=r=!0,g&&i+d[0]>g||t.isInteracting()&&!t.isMoving()&&!t.isRotating()||(i++,p[S+"@"+E.point.toArray().join()]=E)}if(b&&!o[E.dupKey]){o[E.dupKey]=1,x&&!f[E.dupKey]&&(E.cache=!1,c.push({image:x,info:E}),f[E.dupKey]=1);var P=this._findParentTile(E);if(P){var M=P.info.dupKey;void 0===h[M]&&(h[M]=a.length,a.push(P))}else{var T=this._findChildTiles(E);T.length&&T.forEach(function(t){l[t.info.dupKey]||(u.push(t),l[t.info.dupKey]=1)})}}}this._drawTiles(s,a,u,c),i?this.loadTileQueue(p):r||(!t.isAnimating()&&this._parentTiles.length>0&&(this._parentTiles=[],this._childTiles=[],this.setToRedraw()),this.completeRender()),this._retireTiles()}else this.completeRender()}else this.completeRender()}},e.prototype.isTileCachedOrLoading=function(t){return this.tilesLoading[t]||this.tilesInView[t]||this.tileCache.has(t)},e.prototype._drawTiles=function(t,e,n,i){var r=this;e.length&&(e.sort(function(t,e){return Math.abs(e.info.z-r._tileZoom)-Math.abs(t.info.z-r._tileZoom)}),this._parentTiles=e),n.length&&(this._childTiles=n);var o={tiles:t,parentTiles:e,childTiles:n};this.onDrawTileStart(o),this._parentTiles.forEach(function(t){return r._drawTileAndCache(t)}),this._childTiles.forEach(function(t){return r._drawTileOffset(t.info,t.image)}),i.forEach(function(t){return r._drawTileOffset(t.info,t.image)});var s=this.layer,a=this.getMap();if(!s.options.cascadeTiles||a.getPitch()<=s.options.minPitchToCascade)t.forEach(function(t){return r._drawTileAndCache(t)});else{this.writeZoomStencil();for(var h=!1,u=0,l=t.length;u<l;u++)t[u].info.z!==this._tileZoom?h?this.resumeZoomStencilTest():(this.startZoomStencilTest(),h=!0):h&&this.pauseZoomStencilTest(),this._drawTileAndCache(t[u]);this.endZoomStencilTest()}this.onDrawTileEnd(o)},e.prototype.writeZoomStencil=function(){},e.prototype.startZoomStencilTest=function(){},e.prototype.endZoomStencilTest=function(){},e.prototype.pauseZoomStencilTest=function(){},e.prototype.resumeZoomStencilTest=function(){},e.prototype.onDrawTileStart=function(){},e.prototype.onDrawTileEnd=function(){},e.prototype._drawTileOffset=function(t,e){var n=this._tileOffset;if(n[0]||n[1]){var i=this.getMap(),r=i._getResolution(this._tileZoom)/i._getResolution(t.z);n[0]*=r,n[1]*=r,t.point._sub(n),t.extent2d._sub(n),this.drawTile(t,e),t.point._add(n),t.extent2d._add(n),n[0]/=r,n[1]/=r}else this.drawTile(t,e)},e.prototype._drawTileAndCache=function(t){t.current=!0,this.tilesInView[t.info.id]=t,this._drawTileOffset(t.info,t.image),this.tileCache.add(t.info.id,t)},e.prototype.drawOnInteracting=function(){this.draw()},e.prototype.needToRedraw=function(){var e=this.getMap();return e.getPitch()?t.prototype.needToRedraw.call(this):!(!e.isRotating()&&!e.isZooming())||(e.isMoving()?!!this.layer.options.forceRenderOnMoving:t.prototype.needToRedraw.call(this))},e.prototype.hitDetect=function(){return!1},e.prototype._getLoadLimit=function(){return this.getMap().isInteracting()?this.layer.options.loadingLimitOnInteracting:0},e.prototype.isDrawable=function(){return!this.getMap().getPitch()||(console&&console.warn("TileLayer with canvas renderer can't be pitched, use gl renderer ('renderer' : 'gl') instead."),this.clear(),!1)},e.prototype.clear=function(){this._retireTiles(!0),this.tileCache.reset(),this.tilesInView={},this.tilesLoading={},this._parentTiles=[],this._childTiles=[],t.prototype.clear.call(this)},e.prototype._isLoadingTile=function(t){return!!this.tilesLoading[t]},e.prototype.clipCanvas=function(e){return this.layer.getMask()?t.prototype.clipCanvas.call(this,e):this._clipByPitch(e)},e.prototype._clipByPitch=function(t){var e=this.getMap();if(e.getPitch()<=e.options.maxVisualPitch)return!1;if(!this.layer.options.clipByPitch)return!1;var n=e.getContainerExtent(),i=he.retina?2:1;return t.save(),t.strokeStyle="rgba(0, 0, 0, 0)",t.beginPath(),t.rect(0,Math.ceil(n.ymin)*i,Math.ceil(n.getWidth())*i,Math.ceil(n.getHeight())*i),t.stroke(),t.clip(),!0},e.prototype.loadTileQueue=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e],i=this.loadTile(n);void 0===i.loadTime&&(this.tilesLoading[n.id]={image:i,current:!0,info:n})}},e.prototype.loadTile=function(t){var e=this.layer.getTileSize(),n=new Image;n.width=e.width,n.height=e.height,n.onload=this.onTileLoad.bind(this,n,t),n.onerror=this.onTileError.bind(this,n,t);var i=this.layer.options.crossOrigin;return m(i)||(n.crossOrigin=i),this.loadTileImage(n,t.url),n},e.prototype.loadTileImage=function(t,e){return R(t,[e])},e.prototype.abortTileLoading=function(t){t&&(t.onload=ls,t.onerror=ls,t.src=nt)},e.prototype.onTileLoad=function(t,e){if(this.layer){var n=e.id;this.tilesInView&&(t.loadTime=g(),delete this.tilesLoading[n],this._addTileToCache(e,t),this.setToRedraw(),this.layer.fire("tileload",{tile:e,tileImage:t}))}},e.prototype.onTileError=function(t,e){this.layer&&(t instanceof Image&&this.abortTileLoading(t),t.loadTime=0,delete this.tilesLoading[e.id],this._addTileToCache(e,t),this.setToRedraw(),this.layer.fire("tileerror",{tile:e}))},e.prototype.drawTile=function(t,e){if(e&&this.getMap()){var n=t.point,i=t.z,r=t.id,o=this.getMap(),s=t.size,a=o.getZoom(),h=this.context,u=o._pointToContainerPoint(n,i),l=o.getBearing(),c=l||a!==i,f=this.getTileOpacity(e),p=h.globalAlpha;f<1&&(h.globalAlpha=f,this.setToRedraw()),c||u._round();var d=u.x,g=u.y,y=s[0],m=s[1];if(c){if(y++,m++,h.save(),h.translate(d,g),l&&h.rotate(-l*Math.PI/180),a!==i){var v=o._getResolution(i)/o._getResolution();h.scale(v,v)}d=g=0}if(sn.image(h,e,d,g,y,m),this.layer.options.debug){var _=new le(d,g),x=this.layer.options.debugOutline,w=r.split("__");h.save(),h.strokeStyle=x,h.fillStyle=x,h.strokeWidth=10,h.font="15px monospace",sn.rectangle(h,_,s,1,0),sn.fillText(h,"x:"+w[2]+", y:"+w[1]+", z:"+w[3],_.add(10,20),x),sn.drawCross(h,_.add(y/2,m/2),2,x),h.restore()}c&&h.restore(),h.globalAlpha!==p&&(h.globalAlpha=p),this.setCanvasUpdated()}},e.prototype._findChildTiles=function(t){var e=this._getLayerOfTile(t.layer);if(!e.options.background)return[];for(var n=this.getMap(),i=[],r=t.extent2d.getMin(),o=t.extent2d.getMax(),s=e._project(n._pointToPrj(r,t.z)),a=e._project(n._pointToPrj(o,t.z)),h=1;h<3;h++)this._findChildTilesAt(i,s,a,e,t.z+h);return i},e.prototype._findChildTilesAt=function(t,e,n,i,r){for(var o=i.getId(),s=i.getSpatialReference().getResolution(r),a=i._getTileConfig().getTileIndex(e,s),h=i._getTileConfig().getTileIndex(n,s),u=Math.min(a.idx,h.idx),l=Math.max(a.idx,h.idx),c=Math.min(a.idy,h.idy),f=Math.max(a.idy,h.idy),p=void 0,d=void 0,g=u;g<l;g++)for(var y=c;y<f;y++)p=i._getTileId({idx:g,idy:y},r,o),this.tileCache.has(p)&&(d=this.tileCache.getAndRemove(p),t.push(d),this.tileCache.add(p,d))},e.prototype._findParentTile=function(t){var e=this.getMap(),n=this._getLayerOfTile(t.layer);if(!n.options.background)return null;for(var i=n.getSpatialReference(),r=i.getZoomDirection(),o=n.options.backgroundZoomDiff,s=t.extent2d.getCenter(),a=n._project(e._pointToPrj(s,t.z)),h=1;h<=o;h++){var u=t.z-r*h,l=i.getResolution(u),c=n._getTileConfig().getTileIndex(a,l),f=n._getTileId(c,u,t.layer);if(this.tileCache.has(f)){var p=this.tileCache.getAndRemove(f);return this.tileCache.add(f,p),p}}return null},e.prototype._getLayerOfTile=function(t){return this.layer.getChildLayer?this.layer.getChildLayer(t):this.layer},e.prototype._getCachedTile=function(t){var e=this.tilesInView,n=this.tileCache.getAndRemove(t);if(n){e[t]=n;var i=this.tilesLoading;i&&i[t]&&(i[t].current=!1,this.abortTileLoading(i[t]),delete i[t])}else n=e[t];return n},e.prototype._addTileToCache=function(t,e){this.tilesInView[t.id]={image:e,current:!0,info:t}},e.prototype.getTileOpacity=function(t){return this.layer.options.fadeAnimation&&t.loadTime?Math.min(1,(g()-t.loadTime)/(1e3/60*10)):1},e.prototype.onRemove=function(){this.clear(),delete this.tileCache,delete this._tilePlaceHolder,t.prototype.onRemove.call(this)},e.prototype._markTiles=function(){var t=0,e=0;if(this.tilesLoading)for(var n in this.tilesLoading)this.tilesLoading[n].current=!1,t++;if(this.tilesInView)for(var i in this.tilesInView)this.tilesInView[i].current=!1,e++;return[t,e]},e.prototype._retireTiles=function(t){for(var e in this.tilesLoading){var n=this.tilesLoading[e];!t&&n.current||(n.image&&this.abortTileLoading(n.image),this.deleteTile(n),delete this.tilesLoading[e])}for(var i in this.tilesInView){var r=this.tilesInView[i];r.current||(delete this.tilesInView[i],this.tileCache.has(i)||this.deleteTile(r))}},e.prototype.deleteTile=function(t){t&&t.image&&(t.image.onload=null,t.image.onerror=null)},e.prototype._generatePlaceHolder=function(t){var e=this.getMap(),n=this.layer.options.placeholder;if(!n||e.getPitch())return null;var i=this.layer.getTileSize(),r=e._getResolution(t)/e._getResolution(),o=this._tilePlaceHolder=this._tilePlaceHolder||sn.createCanvas(1,1);return o.width=i.width*r,o.height=i.height*r,C(n)?n(o):function(t){var e=t.getContext("2d"),n=t.width,i=t.height,r=n/16,o=i/16;e.beginPath();for(var s=0;s<16;s++)e.moveTo(0,s*o),e.lineTo(n,s*o),e.moveTo(s*r,0),e.lineTo(s*r,i);e.strokeStyle="rgba(180, 180, 180, 0.1)",e.lineWidth=1,e.stroke(),e.beginPath();for(var a=[[0,0],[n,0],[0,i],[n,i],[0,0],[0,i],[n,0],[n,i],[0,i/2],[n,i/2],[n/2,0],[n/2,i]],h=1;h<a.length;h+=2)e.moveTo(a[h-1][0],a[h-1][1]),e.lineTo(a[h][0],a[h][1]);e.lineWidth=4,e.stroke()}(o),o},e}(Kn);function ls(){return!1}Oo.registerRenderer("canvas",us);var cs=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.isDrawable=function(){return!0},e.prototype.needToRedraw=function(){var e=this.getMap();return!(!this._gl()||e.getPitch()||!e.isZooming()||e.isMoving()||e.isRotating())||t.prototype.needToRedraw.call(this)},e.prototype.drawTile=function(e,n){var i=this.getMap();if(e&&i&&n.src!==nt){var r=i.getGLScale(e.z),o=e.size[0]*r,s=e.size[1]*r;if(!1!==e.cache&&this._bindGLBuffer(n,o,s),this._gl()){var a=e.point,h=a.x*r,u=a.y*r,l=this.getTileOpacity(n);this.drawGLImage(n,h,u,o,s,l),l<1?this.setToRedraw():this.setCanvasUpdated()}else t.prototype.drawTile.call(this,e,n)}},e.prototype.writeZoomStencil=function(){var t=this.gl;t.stencilFunc(t.ALWAYS,1,255),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE)},e.prototype.startZoomStencilTest=function(){var t=this.gl;t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(t.EQUAL,0,255)},e.prototype.endZoomStencilTest=function(){this.pauseZoomStencilTest()},e.prototype.pauseZoomStencilTest=function(){var t=this.gl;t.stencilFunc(t.ALWAYS,1,255)},e.prototype.resumeZoomStencilTest=function(){var t=this.gl;t.stencilFunc(t.EQUAL,0,255)},e.prototype._bindGLBuffer=function(t,e,n){t.glBuffer||(t.glBuffer=this.bufferTileData(0,0,e,n))},e.prototype.loadTileImage=function(t,e){t.crossOrigin=this.layer.options.crossOrigin||"",t.src=e},e.prototype.onCanvasCreate=function(){this.createCanvas2()},e.prototype.createContext=function(){t.prototype.createContext.call(this),this.createGLContext()},e.prototype.resizeCanvas=function(e){this.canvas&&(t.prototype.resizeCanvas.call(this,e),this.resizeGLCanvas())},e.prototype.clearCanvas=function(){this.canvas&&(t.prototype.clearCanvas.call(this),this.clearGLCanvas())},e.prototype.getCanvasImage=function(){if(!this._gl())return t.prototype.getCanvasImage.call(this);var e=t.prototype.getCanvasImage.call(this);return e&&(e.image=this.canvas2),e},e.prototype._gl=function(){return this.getMap()&&!!this.getMap().getPitch()||this.layer&&!!this.layer.options.fragmentShader},e.prototype.deleteTile=function(e){t.prototype.deleteTile.call(this,e),e&&e.image&&this.disposeImage(e.image)},e.prototype.onRemove=function(){this.removeGLCanvas()},e}(qo(us));function fs(t){var e=this.layer.getTileSize(),n=this.canvas.constructor,i=this.getMap(),r=he.retina?2:1,o=sn.createCanvas(e.width*r,e.height*r,n);o.layer=this.layer;var s=this,a=new Sn(i.pointToCoordinate(t.point),i.pointToCoordinate(t.point.add(e.toPoint())),i.getProjection());return this.layer.drawTile(o,{url:t.url,point:t.point,center:i.pointToCoordinate(t.point.add(e.width/2,e.height/2)),extent:a,z:t.z,x:t.x,y:t.y},function(e){e?s.onTileError(o,t):s.onTileLoad(o,t)}),o}Oo.registerRenderer("gl",cs);var ps=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.loadTile=function(){return fs.apply(this,arguments)},e}(us),ds=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.loadTile=function(){return fs.apply(this,arguments)},e}(us);Fo.registerRenderer("canvas",ps),Fo.registerRenderer("gl",ds);var gs=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.checkResources=function(){var t=this._geosToCheck;if(this._resourceChecked||t||(t=this.layer._geoList),!Z(t))return[];for(var e=[],n={},i=t.length-1;i>=0;i--){var r=t[i]._getExternalResources();if(r.length)if(this.resources)for(var o=0;o<r.length;o++){var s=r[o][0];this.resources.isResourceLoaded(r[o])||n[s]||(e.push(r[o]),n[s]=1)}else e.push.apply(e,r)}return this._resourceChecked=!0,delete this._geosToCheck,e},e.prototype.render=function(){return this.layer._sortGeometries(),t.prototype.render.apply(this,arguments)},e.prototype._addGeoToCheckRes=function(t){t&&(Array.isArray(t)||(t=[t]),this._geosToCheck||(this._geosToCheck=[]),F(this._geosToCheck,t))},e.prototype.onGeometryAdd=function(t){this._addGeoToCheckRes(t),ys(this)},e.prototype.onGeometryRemove=function(){ys(this)},e.prototype.onGeometrySymbolChange=function(t){this._addGeoToCheckRes(t.target),ys(this)},e.prototype.onGeometryShapeChange=function(){ys(this)},e.prototype.onGeometryPositionChange=function(){ys(this)},e.prototype.onGeometryZIndexChange=function(){ys(this)},e.prototype.onGeometryShow=function(){ys(this)},e.prototype.onGeometryHide=function(){ys(this)},e.prototype.onGeometryPropertiesChange=function(){ys(this)},e}(Kn);function ys(t){t.layer.options.drawImmediate&&t.render(),t.setToRedraw()}var ms=function(t){function e(){return f(this,e),d(this,t.apply(this,arguments))}return p(e,t),e.prototype.checkResources=function(){var e=this,n=t.prototype.checkResources.apply(this,arguments),i=this.layer.getStyle();return i&&(Array.isArray(i)||(i=[i]),i.forEach(function(t){for(var i=Rt(t.symbol,!0),r=0,o=i.length;r<o;r++)e.resources.isResourceLoaded(i[r])||n.push(i[r])})),n},e.prototype.needToRedraw=function(){var e=this.getMap();return!(!e.isInteracting()||!this.layer.options.enableAltitude)||!(e.isZooming()&&!e.isRotating()&&!e.getPitch()&&!this._hasPoint&&this.layer.constructor===Cr)&&t.prototype.needToRedraw.call(this)},e.prototype.draw=function(){if(this.getMap()){if(!this.layer.isVisible()||this.layer.isEmpty())return this.clearCanvas(),void this.completeRender();this.prepareCanvas(),this.drawGeos(),this.completeRender()}},e.prototype.isBlank=function(){return!!this.context&&!this.context.canvas._drawn},e.prototype.drawOnInteracting=function(){if(this._geosToDraw){this._updateDisplayExtent();for(var t=0,e=this._geosToDraw.length;t<e;t++)this._geosToDraw[t].isVisible()&&this._geosToDraw[t]._paint(this._displayExtent)}},e.prototype.show=function(){this.layer.forEach(function(t){t._repaint()}),t.prototype.show.apply(this,arguments)},e.prototype.forEachGeo=function(t,e){this.layer.forEach(t,e)},e.prototype.drawGeos=function(){this._updateDisplayExtent(),this.prepareToDraw(),this.forEachGeo(this.checkGeo,this);for(var t=0,e=this._geosToDraw.length;t<e;t++)this._geosToDraw[t]._paint()},e.prototype.prepareToDraw=function(){this._hasPoint=!1,this._geosToDraw=[]},e.prototype.checkGeo=function(t){if(t&&t.isVisible()&&t.getMap()&&t.getLayer()&&t.getLayer().isCanvasRender()){var e=t._getPainter(),n=e.get2DExtent(this.resources);n&&n.intersects(this._displayExtent)&&(e.hasPoint()&&(this._hasPoint=!0),this._geosToDraw.push(t))}},e.prototype.onZoomEnd=function(){delete this.canvasExtent2D,t.prototype.onZoomEnd.apply(this,arguments)},e.prototype.onRemove=function(){this.forEachGeo(function(t){t.onHide()}),delete this._geosToDraw},e.prototype.onGeometryPropertiesChange=function(e){e&&this.layer._styleGeometry(e.target),t.prototype.onGeometryPropertiesChange.call(this,e)},e.prototype._updateDisplayExtent=function(){var t=this.canvasExtent2D;if(this._maskExtent){if(!this._maskExtent.intersects(t))return void this.completeRender();t=t.intersection(this._maskExtent)}this._displayExtent=t},e.prototype.identify=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._geosToDraw;return n?this.layer._hitGeos(n,t,e):[]},e}(gs);Cr.registerRenderer("canvas",ms);var vs=function(t){function e(n){f(this,e);var i=d(this,t.call(this));return i.map=n,i._handlerQueue={},i}return p(e,t),e.prototype.callInNextFrame=function(t){this._handlerQueue.push(t)},e.prototype.executeFrameCallbacks=function(){var t=this._handlerQueue;this._handlerQueue=[];for(var e=0,n=t.length;e<n;e++)t[e]()},e.prototype.offsetPlatform=function(t){if(!this.map._panels.front)return this;if(0===t.x&&0===t.y)return this;var e=this.map.offsetPlatform().add(t)._round(),n=this.map._panels;return He(n.back,e),He(n.front,e),this},e.prototype.resetContainer=function(){if(this.map&&(this.map._resetMapViewPoint(),this.map._panels.front)){var t=new le(0,0);He(this.map._panels.back,t),He(this.map._panels.front,t)}},e.prototype.onZoomEnd=function(){this.resetContainer()},e.prototype.onLoad=function(){this._frameLoop()},e}(dn),_s=function(t){function e(n){f(this,e);var i=d(this,t.call(this,n));return i._containerIsCanvas=!!n._containerDOM.getContext,i._registerEvents(),i._loopTime=0,i}return p(e,t),e.prototype.load=function(){this.initContainer()},e.prototype.renderFrame=function(t){if(!this.map)return!1;var e=this.map;e._fireEvent("framestart"),this.updateMapDOM();var n=this._getAllLayerToRender();return this.drawLayers(n,t),this.drawLayerCanvas(n),e._fireEvent("frameend"),this._recordView(),this._mapview=this._getMapView(),delete this._spatialRefChanged,this._fireLayerLoadEvents(),this.executeFrameCallbacks(),this._needRedraw=!1,!0},e.prototype.updateMapDOM=function(){var t=this.map;if(!t.isZooming()){var e=t._getViewPointFrameOffset();e&&t.offsetPlatform(e)}},e.prototype.drawLayers=function(t,e){for(var n=this.map,i=n.isInteracting(),r=[],o=[],s=n.options.fpsOnInteracting||0,a=0===s?0:1e3/s,h=this.map.options.layerCanvasLimitOnInteracting,u=t.length,l=n.getBaseLayer(),c=0,f=0;f<u;f++){var p=t[f];if(p.isVisible()){var d=p.isCanvasRender();d&&r.push(p.getId());var g=p._getRenderer();if(g){var y=this._checkLayerRedraw(p);if(d&&g.isCanvasUpdated()&&(y||o.push(p.getId()),this.setToRedraw()),delete g.__shouldZoomTransform,y){if(i&&d){if(h>0&&u-1-f>h&&p!==l){p._getRenderer().clearCanvas();continue}c+=this._drawCanvasLayerOnInteracting(p,c,a,e)}else i&&g.drawOnInteracting?(g.prepareRender&&g.prepareRender(),g.drawOnInteracting(this._eventParam,e)):g.render(e);d&&(o.push(p.getId()),this.setToRedraw())}else d&&i&&(n.isZooming()&&!n.getPitch()?(g.prepareRender(),g.__shouldZoomTransform=!0):(n.getPitch()||n.isRotating())&&g.clearCanvas())}}}var m=this._canvasIds||[],v=this._updatedIds||[];if(this._canvasIds=r,this._updatedIds=o,!this._needToRedraw()){m.join("---")===r.join("---")&&v.join("---")===o.join("---")||this.setToRedraw()}},e.prototype._checkLayerRedraw=function(t){if(this.isSpatialReferenceChanged())return!0;var e=this.map,n=t._getRenderer();return t.isCanvasRender()?n.testIfNeedRedraw():!(!n.needToRedraw||!n.needToRedraw())||(e.isInteracting()||this.isViewChanged())},e.prototype._drawCanvasLayerOnInteracting=function(t,e,n,i){var r=this.map,o=t._getRenderer(),s=o.getDrawTime(),a=0===n||n>0&&e+s<=n;if(o.mustRenderOnInteracting&&o.mustRenderOnInteracting())o.render(i);else{if(o.drawOnInteracting&&(t===r.getBaseLayer()||a||r.isZooming()&&t.options.forceRenderOnZooming||r.isMoving()&&t.options.forceRenderOnMoving||r.isRotating()&&t.options.forceRenderOnRotating))return o.prepareRender(),o.prepareCanvas(),o.drawOnInteracting(this._eventParam,i),s;!r.isZooming()||r.getPitch()||r.isRotating()?(r.getPitch()||r.isRotating())&&o.clearCanvas():(o.prepareRender(),o.__shouldZoomTransform=!0)}return o.drawOnInteracting&&!a&&o.onSkipDrawOnInteracting(this._eventParam,i),0},e.prototype._fireLayerLoadEvents=function(){if(this._updatedIds&&this._updatedIds.length>0){var t=this.map;this._updatedIds.reverse().forEach(function(e){var n=t.getLayer(e);if(n){var i=n._getRenderer();i&&i.isRenderComplete()&&n.fire("layerload")}})}},e.prototype._needToRedraw=function(){return this._needRedraw},e.prototype.setToRedraw=function(){this._needRedraw=!0},e.prototype.drawLayerCanvas=function(t){var e=this.map;if(e&&(this._needToRedraw()||this.isViewChanged())){this.canvas||this.createCanvas(),e._fireEvent("renderstart",{context:this.context}),this._updateCanvasSize()||this.clearCanvas();for(var n=e.isInteracting(),i=e.options.layerCanvasLimitOnInteracting,r=t.length,o=void 0,s=[],a=0;a<r;a++){if(t[a].isVisible()&&t[a].isCanvasRender())if(t[a]._getRenderer()){var h=this._getLayerImage(t[a]);h&&h.image&&(t[a]===e.getBaseLayer()?o=[t[a],h]:s.push([t[a],h]))}}o&&(this._drawLayerCanvasImage(o[0],o[1]),this._drawFog()),r=s.length;for(var u=n&&i>=0&&r>i?r-i:0;u<r;u++)this._drawLayerCanvasImage(s[u][0],s[u][1]);this._drawCenterCross(),e._fireEvent("renderend",{context:this.context})}},e.prototype.updateMapSize=function(t){if(t&&!this._containerIsCanvas){var e=t.width+"px",n=t.height+"px",i=this.map._panels;i.mapWrapper.style.width=e,i.mapWrapper.style.height=n,this._updateCanvasSize()}},e.prototype.getMainPanel=function(){return this.map?this._containerIsCanvas?this.map._containerDOM:this.map._panels?this.map._panels.mapWrapper:null:null},e.prototype.toDataURL=function(t){return this.canvas?this.canvas.toDataURL(t):null},e.prototype.remove=function(){he.webgl&&"undefined"!=typeof document&&Fe(document,"visibilitychange",this._onVisibilitychange),this._resizeInterval&&clearInterval(this._resizeInterval),delete this.context,delete this.canvas,delete this.map,delete this._spatialRefChanged,this._cancelFrameLoop()},e.prototype.hitDetect=function(t){var e=this.map;if(e&&e.options.hitDetect&&!e.isInteracting()){for(var n=e._getLayers(),i="default",r=e.options.hitDetectLimit||0,o=0,s=n.length-1;s>=0;s--){var a=n[s];if(!a.isEmpty||!a.isEmpty()){var h=a._getRenderer();if(h&&h.hitDetect&&(!h.isBlank||!h.isBlank())){if("default"!==a.options.cursor&&h.hitDetect(t)){i=a.options.cursor||"pointer";break}if(r>0&&++o>r)break}}}e._trySetCursor(i)}},e.prototype._getLayerImage=function(t){var e=t._getRenderer();return e.getCanvasImage?e.getCanvasImage():null},e.prototype.initContainer=function(){var t=this.map._panels;function e(e,n,i,r){var o=Oe("div",n);return i&&(o.style.cssText=i),t[e]=o,r||Be(o),o}var n=this.map._containerDOM;if(!this._containerIsCanvas){n.innerHTML="";var i="position:absolute;top:0px;left:0px;",r=e("mapWrapper","maptalks-wrapper","position:absolute;overflow:hidden;",!0),o=e("allLayers","maptalks-all-layers",i+"padding:0px;margin:0px;z-index:0;overflow:visible;",!0),s=e("backStatic","maptalks-back-static",i+"z-index:0;",!0),a=e("back","maptalks-back",i+"z-index:1;"),h=e("backLayer","maptalks-back-layer",i),u=e("canvasContainer","maptalks-canvas-layer",i+"border:none;z-index:2;"),l=e("frontStatic","maptalks-front-static",i+"z-index:3;",!0),c=e("front","maptalks-front",i+"z-index:4;",!0),f=e("frontLayer","maptalks-front-layer",i+"z-index:0;"),p=e("ui","maptalks-ui",i+"border:none;z-index:1;",!0),d=e("control","maptalks-control","z-index:1",!0);n.appendChild(r),o.appendChild(s),a.appendChild(h),o.appendChild(a),o.appendChild(u),c.appendChild(f),o.appendChild(l),o.appendChild(c),c.appendChild(p),r.appendChild(o),r.appendChild(d),this.createCanvas(),this.resetContainer();var g=this.map._getContainerDomSize();this.updateMapSize(g)}},e.prototype.isViewChanged=function(){var t=this._mapview,e=this._getMapView();return!t||!it(t,e)},e.prototype._recordView=function(){var t=this.map;!t._onViewChange||t.isInteracting()||t.isAnimating()||it(t.getView(),t._getCurrentView())||t._onViewChange(t.getView())},e.prototype.isSpatialReferenceChanged=function(){return this._spatialRefChanged},e.prototype._getMapView=function(){var t=this.map,e=t._getPrjCenter();return{x:e.x,y:e.y,zoom:t.getZoom(),pitch:t.getPitch(),bearing:t.getBearing(),width:t.width,height:t.height}},e.prototype._frameLoop=function(t){var e=this;this.map?(this.renderFrame(t),this._animationFrame=T(function(t){e._frameLoop(t)})):this._cancelFrameLoop()},e.prototype._cancelFrameLoop=function(){this._animationFrame&&L(this._animationFrame)},e.prototype._drawLayerCanvasImage=function(t,e){var n=this.context,i=e.point.round();he.retina&&i._multi(2);var r=e.image;if(!(i.x+r.width<=0||i.y+r.height<=0)){var o=t.options.opacity;if(v(o)||(o=1),!(o<=0)){var s=e.opacity;if(v(s)||(s=1),!(s<=0)){var a=n.globalAlpha;o<1&&(n.globalAlpha*=o),s<1&&(n.globalAlpha*=s),t.options.cssFilter&&(n.filter=t.options.cssFilter);var h=this._zoomMatrix,u=!!t._getRenderer().__shouldZoomTransform,l=t.getRenderer().clipCanvas(this.context);h&&u&&(n.save(),n.setTransform.apply(n,h)),n.drawImage(r,i.x,i.y),h&&u&&n.restore(),l&&n.restore(),"none"!==n.filter&&(n.filter="none"),n.globalAlpha=a}}}},e.prototype._drawCenterCross=function(){var t=this.map.options.centerCross;if(t){var e=this.context,n=new le(this.canvas.width/2,this.canvas.height/2);C(t)?t(e,n):sn.drawCross(this.context,n,2,"#f00")}},e.prototype._drawFog=function(){var t=this.map;if(!(t.getPitch()<=t.options.maxVisualPitch)&&t.options.fog){var e=he.retina?2:1,n=this.context,i=t.getContainerExtent(),r=(t.height-t._getVisualHeight(75))*e;r<0&&(r=0);var o=i.ymin*e,s=Math.ceil(o-r),a=t.options.fogColor.join(),h=n.createLinearGradient(0,r,0,o+30),u=1-30/(s+30);h.addColorStop(0,"rgba("+a+", 0)"),h.addColorStop(.3,"rgba("+a+", 0.3)"),h.addColorStop(u,"rgba("+a+", 1)"),h.addColorStop(1,"rgba("+a+", 0)"),n.beginPath(),n.fillStyle=h,n.fillRect(0,r,Math.ceil(i.getWidth())*e,Math.ceil(s+30))}},e.prototype._getAllLayerToRender=function(){return this.map._getLayers()},e.prototype.clearCanvas=function(){this.canvas&&sn.clearRect(this.context,0,0,this.canvas.width,this.canvas.height)},e.prototype._updateCanvasSize=function(){if(!this.canvas||this._containerIsCanvas)return!1;var t=this.map.getSize(),e=this.canvas,n=he.retina?2:1;return(t.width*n!==e.width||t.height*n!==e.height)&&(e.height=n*t.height,e.width=n*t.width,e.style&&(e.style.width=t.width+"px",e.style.height=t.height+"px"),!0)},e.prototype.createCanvas=function(){this._containerIsCanvas?this.canvas=this.map._containerDOM:(this.canvas=Oe("canvas"),this._updateCanvasSize(),this.map._panels.canvasContainer.appendChild(this.canvas)),this.context=this.canvas.getContext("2d")},e.prototype._checkSize=function(){this.map&&!this.map.isInteracting()&&(Ve(this.map._containerDOM),this.map.checkSize())},e.prototype._setCheckSizeInterval=function(t){var e=this;clearInterval(this._resizeInterval),this._checkSizeInterval=t,this._resizeInterval=setInterval(function(){!e.map||e.map.isRemoved()?clearInterval(e._resizeInterval):e._checkSize()},this._checkSizeInterval)},e.prototype._registerEvents=function(){var t=this,e=this.map;e.options.checkSize&&!M&&"undefined"!=typeof window&&this._setCheckSizeInterval(1e3),he.mobile||e.on("_mousemove",this._onMapMouseMove,this),e.on("_dragrotatestart _dragrotating _dragrotateend _movestart _moving _moveend _zoomstart",function(e){t._eventParam=e}),e.on("_zooming",function(n){e.getPitch()||(t._zoomMatrix=n.matrix.container),t._eventParam=n}),e.on("_zoomend",function(e){t._eventParam=e,delete t._zoomMatrix}),e.on("_spatialreferencechange",function(){t._spatialRefChanged=!0}),he.webgl&&"undefined"!=typeof document&&ke(document,"visibilitychange",this._onVisibilitychange,this)},e.prototype._onMapMouseMove=function(t){var e=this,n=this.map;!n.isInteracting()&&n.options.hitDetect&&(this._hitDetectFrame&&L(this._hitDetectFrame),this._hitDetectFrame=T(function(){e.hitDetect(t.containerPoint)}))},e.prototype._getCanvasLayers=function(){return this.map._getLayers(function(t){return t.isCanvasRender()})},e.prototype._onVisibilitychange=function(){if("visible"===document.visibilityState)for(var t=this._getAllLayerToRender(),e=0,n=t.length;e<n;e++){var i=t[e].getRenderer();i&&i.canvas&&i.setToRedraw&&i.setToRedraw()}},e}(vs);ri.registerRenderer("canvas",_s),ri.mergeOptions({fog:!0,fogColor:[233,233,233]});var xs=Object.freeze({ResourceCache:Qn,CanvasRenderer:Kn,ImageGLRenderable:qo,MapRenderer:vs,MapCanvasRenderer:_s,Renderable:Zn,ImageLayerCanvasRenderer:Yo,ImageLayerGLRenderer:Xo,TileLayerCanvasRenderer:us,TileLayerGLRenderer:cs,CanvasTileLayerCanvasRenderer:ps,CanvasTileLayerGLRenderer:ds,OverlayLayerCanvasRenderer:gs,VectorLayerCanvasRenderer:ms,CanvasLayerRenderer:Jo}),ws={_getRenderPoints:function(){return[[this._getCenter2DPoint(this.getMap().getGLZoom())],null]}};Wi.include(ws),rr.include(ws),ir.include(ws),sr.include(ws),or.include({_getRenderPoints:function(t){var e=this.getMap();if("vertex"===t){for(var n=this._trimRing(this.getShell()),i=[],r=0,o=n.length;r<o;r++)i.push(e.coordToPoint(n[r],e.getGLZoom()));return[i,null]}return[[e.coordToPoint(this.getCenter(),e.getGLZoom())],null]}});var Cs={_getRenderPoints:function(t){var e=this.getMap(),n=e.getGLZoom(),i=void 0,r=null;if("point"===t)(i=this._getPath2DPoints(this._getPrjCoordinates(),!1,n))&&i.length>0&&Array.isArray(i[0])&&(i=i[0].concat(i[1]));else if("vertex"===t)if(r=[],(i=this._getPath2DPoints(this._getPrjCoordinates(),!1,n))&&i.length>0&&Array.isArray(i[0])){for(var o=0,s=i.length;o<s;o++)for(var a=0,h=i[o].length;a<h;a++)0===a?r.push([i[o][a],i[o][a+1]]):r.push([i[o][a-1],i[o][a]]);i=i[0].concat(i[1])}else for(var u=0,l=i.length;u<l;u++)0===u?r.push([i[u],i[u+1]]):r.push([i[u-1],i[u]]);else if("line"===t){i=[],r=[];var c=this._getPath2DPoints(this._getPrjCoordinates(),!1,n);if(c.length>0&&Array.isArray(c[0]))for(var f=void 0,p=1,d=c.length;p<d;p++){f=c[p],this instanceof Vi&&f.length>0&&!f[0].equals(f[f.length-1])&&f.push(f[0]);for(var g=1,y=f.length;g<y;g++)i.push(f[g].add(f[g-1])._multi(.5)),r.push([f[g-1],f[g]])}else{this instanceof Vi&&c.length>0&&!c[0].equals(c[c.length-1])&&c.push(c[0]);for(var m=1,v=c.length;m<v;m++)i.push(c[m].add(c[m-1])._multi(.5)),r.push([c[m-1],c[m]])}}else if("vertex-first"===t){var _=this._getPrjCoordinates();i=[e._prjToPoint(_[0],n)],r=[[e._prjToPoint(_[0],n),e._prjToPoint(_[1],n)]]}else if("vertex-last"===t){var x=this._getPrjCoordinates(),w=x.length;i=[e._prjToPoint(x[w-1],n)],r=[[e._prjToPoint(x[w-2],n),e._prjToPoint(x[w-1],n)]]}else{var C=this._getProjection().project(this.getCenter());i=[e._prjToPoint(C,n)]}return[i,r]}};Ui.include(Cs),Vi.include(Cs),Ni.include({_redrawWhenPitch:function(){return!1},_redrawWhenRotate:function(){return!1}});var Es={_redrawWhenPitch:function(){return!0},_redrawWhenRotate:function(){return this instanceof rr||this instanceof sr},_paintAsPath:function(){var t=this.getMap();return this._getPainter().getAltitude()>0||t.getPitch()||this instanceof rr&&t.getBearing()},_getPaintParams:function(){var t=this.getMap();if(this._paintAsPath())return Vi.prototype._getPaintParams.call(this,!0);var e=this._getPrjCoordinates(),n=t._prjToPoint(e,t.getGLZoom()),i=this._getRenderSize();return[n,i.width,i.height]},_paintOn:function(){return this._paintAsPath()?sn.polygon.apply(sn,arguments):sn.ellipse.apply(sn,arguments)},_getRenderSize:function(){var t=this.getMap(),e=t.getGLZoom(),n=this._getPrjExtent(),i=t._prjToPoint(n.getMin(),e),r=t._prjToPoint(n.getMax(),e);return new ce(Math.abs(r.x-i.x)/2,Math.abs(r.y-i.y)/2)}};rr.include(Es),ir.include(Es),or.include({_getPaintParams:function(){var t=this.getMap().getGLZoom(),e=this._getPrjShell();return[this._getPath2DPoints(e,!1,t)]},_paintOn:sn.polygon}),sr.include(Es,{_redrawWhenPitch:function(){return!0},_getPaintParams:function(){if(this._paintAsPath())return Vi.prototype._getPaintParams.call(this,!0);var t=this.getMap();return[t._prjToPoint(this._getPrjCoordinates(),t.getGLZoom()),this._getRenderSize().width,[this.getStartAngle(),this.getEndAngle()]]},_paintOn:function(){if(this._paintAsPath())return sn.polygon.apply(sn,arguments);var t=this.getMap().getBearing(),e=arguments;return t&&(e[3]=e[3].slice(0),e[3][0]+=t,e[3][1]+=t),sn.sector.apply(sn,e)}}),Hi.include({_paintAsPath:function(){return!0}}),Ui.include({arrowStyles:{classic:[3,4]},_getArrowShape:function(t,e,n,i,r){r||(r=0);var o=n*i[0],s=n*i[1]+r,a=o/2+r,h=void 0;(h=e.nextCtrlPoint||e.prevCtrlPoint?e.prevCtrlPoint?e.sub(new le(e.prevCtrlPoint)):e.sub(new le(e.nextCtrlPoint)):e.sub(t))._unit();var u=e.sub(h.multi(s));h._perp();var l=u.add(h.multi(a));return h._multi(-1),[l,e,u.add(h.multi(a)),l]},_getPaintParams:function(){var t=this._getPrjCoordinates();return[this._getPath2DPoints(t,!1,this.getMap().getGLZoom())]},_paintOn:function(t,e,n,i,r){this.options.smoothness?sn.paintSmoothLine(t,e,n,this.options.smoothness,!1,this._animIdx,this._animTailRatio):sn.path(t,e,n,null,r),this._paintArrow(t,e,n)},_getArrowPlacement:function(){return this.options.arrowPlacement},_getArrowStyle:function(){var t=this.options.arrowStyle;return t?Array.isArray(t)?t:this.arrowStyles[t]:null},_getArrows:function(t,e,n){var i=this._getArrowStyle();if(!i||t.length<2)return[];for(var r=t.length>0&&Array.isArray(t[0])?t:[t],o=this._getArrowPlacement(),s=[],a=this.getMap(),h=a.coordToContainerPoint(this.getFirstCoordinate()),u=a.coordToContainerPoint(this.getLastCoordinate()),l=r.length-1;l>=0;l--)("vertex-first"===o||"vertex-firstlast"===o&&r[l][0].closeTo(h,.01))&&s.push(this._getArrowShape(r[l][1],r[l][0],e,i,n)),"vertex-last"===o||"vertex-firstlast"===o&&r[l][r[l].length-1].closeTo(u,.01)?s.push(this._getArrowShape(r[l][r[l].length-2],r[l][r[l].length-1],e,i,n)):"point"===o&&this._getArrowPoints(s,r[l],e,i,n);return s},_getArrowPoints:function(t,e,n,i,r){for(var o=0,s=e.length-1;o<s;o++)t.push(this._getArrowShape(e[o],e[o+1],n,i,r))},_paintArrow:function(t,e,n){var i=this._getInternalSymbol().lineWidth;(!v(i)||i<3)&&(i=3);var r=this._getArrows(e,i);if(r.length){t.setLineDash&&t.setLineDash([]);for(var o=r.length-1;o>=0;o--)t.fillStyle=t.strokeStyle,sn.polygon(t,r[o],n,n)}}}),Vi.include({_getPaintParams:function(t){var e=this.getMap().getGLZoom(),n=this._getPrjShell(),i=this._getPath2DPoints(n,t,e),r=i.length>0&&Array.isArray(i[0]);r&&(i=[[i[0]],[i[1]]]);var o=this._getPrjHoles(),s=[];if(o&&o.length>0)for(var a=0;a<o.length;a++){var h=this._getPath2DPoints(o[a],t,e);Array.isArray(h)&&r?Array.isArray(h[0])?(i[0].push(h[0]),i[1].push(h[1])):i[0].push(h):s.push(h)}return r||F(i=[i],s),[i]},_paintOn:function(t,e,n,i,r){sn.polygon(t,e,n,i,r,this.options.smoothness)}}),"undefined"!=typeof console&&console.log("maptalks v0.40.5")}.call(e,n("W2nU"),n("DuR2"))},mmLd:function(t,e){t.exports=function(t,e){var n=t.geometry.coordinates[0],i=t.geometry.coordinates[1],r=e.geometry.coordinates[0][0][0],o=e.geometry.coordinates[0][0][1],s=e.properties.a,a=e.geometry.coordinates[0][1][0],h=e.geometry.coordinates[0][1][1],u=e.properties.b,l=e.geometry.coordinates[0][2][0],c=e.geometry.coordinates[0][2][1],f=e.properties.c;return(f*(n-r)*(i-h)+s*(n-a)*(i-c)+u*(n-l)*(i-o)-u*(n-r)*(i-c)-f*(n-a)*(i-o)-s*(n-l)*(i-h))/((n-r)*(i-h)+(n-a)*(i-c)+(n-l)*(i-o)-(n-r)*(i-c)-(n-a)*(i-o)-(n-l)*(i-h))}},mnuZ:function(t,e,n){var i=n("1Ldu");t.exports=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(e).reduce(function(t,e){return t[e.replace("Multi","")]=e,t},{});function r(t,n,i){i?e[n].coordinates=e[n].coordinates.concat(t.geometry.coordinates):e[n].coordinates.push(t.geometry.coordinates),e[n].properties.push(t.properties)}return i.featureEach(t,function(t){t.geometry&&(e[t.geometry.type]?r(t,t.geometry.type,!0):n[t.geometry.type]&&r(t,n[t.geometry.type],!1))}),{type:"FeatureCollection",features:Object.keys(e).filter(function(t){return e[t].coordinates.length}).sort().map(function(t){return{type:"Feature",properties:{collectedProperties:e[t].properties},geometry:{type:t,coordinates:e[t].coordinates}}})}}},ng5e:function(t,e,n){"use strict";"use restrict";function i(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}t.exports=i;var r=i.prototype;Object.defineProperty(r,"length",{get:function(){return this.roots.length}}),r.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},r.find=function(t){for(var e=t,n=this.roots;n[t]!==t;)t=n[t];for(;n[e]!==t;){var i=n[e];n[e]=t,e=i}return t},r.link=function(t,e){var n=this.find(t),i=this.find(e);if(n!==i){var r=this.ranks,o=this.roots,s=r[n],a=r[i];s<a?o[n]=i:a<s?o[i]=n:(o[i]=n,++r[n])}}},nun3:function(t,e,n){var i=n("Ckg5").getCoord,r=n("WSCq"),o=r.point,s=r.distanceToRadians;t.exports=function(t,e,n,r){var a=Math.PI/180,h=180/Math.PI,u=i(t),l=a*u[0],c=a*u[1],f=a*n,p=s(e,r),d=Math.asin(Math.sin(c)*Math.cos(p)+Math.cos(c)*Math.sin(p)*Math.cos(f)),g=l+Math.atan2(Math.sin(f)*Math.sin(p)*Math.cos(c),Math.cos(p)-Math.sin(c)*Math.sin(d));return o([h*g,h*d])}},pRlo:function(t,e,n){var i=n("WSCq").point,r=n("WSCq").featureCollection,o=n("fJ48");t.exports=function(t,e,n){for(var s=r([]),a=e/o(i([t[0],t[1]]),i([t[2],t[1]]),n)*(t[2]-t[0]),h=e/o(i([t[0],t[1]]),i([t[0],t[3]]),n)*(t[3]-t[1]),u=t[0];u<=t[2];){for(var l=t[1];l<=t[3];)s.features.push(i([u,l])),l+=h;u+=a}return s}},"q/PK":function(t,e,n){var i=n("fJ48");t.exports=function(t){if(i(t.slice(0,2),[t[2],t[1]],"miles")>=i(t.slice(0,2),[t[0],t[3]],"miles")){var e=(t[1]+t[3])/2;return[t[0],e-(t[2]-t[0])/2,t[2],e+(t[2]-t[0])/2]}var n=(t[0]+t[2])/2;return[n-(t[3]-t[1])/2,t[1],n+(t[3]-t[1])/2,t[3]]}},rIaE:function(t,e,n){"use strict";t.exports=function(t,e){try{return i(t,!0)}catch(a){var n=r(t);if(n.length<=e)return[];var o=function(t,e){for(var n=t.length,i=new Array(n),r=0;r<e.length;++r)i[r]=t[e[r]];for(var o=e.length,r=0;r<n;++r)e.indexOf(r)<0&&(i[o++]=t[r]);return i}(t,n),s=i(o,!0);return function(t,e){for(var n=t.length,i=e.length,r=0;r<n;++r)for(var o=t[r],s=0;s<o.length;++s){var a=o[s];if(a<i)o[s]=e[a];else{a-=i;for(var h=0;h<i;++h)a>=e[h]&&(a+=1);o[s]=a}}return t}(s,n)}};var i=n("MAmB"),r=n("FG9u")},sijn:function(t,e,n){(function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function n(){}function i(){}function r(){}function o(){}function s(){}function a(){}function h(){}function u(t){this.message=t}function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}function c(){if(0===arguments.length)u.call(this);else if(1===arguments.length){var t=arguments[0];u.call(this,t)}}function f(){}function p(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)p.call(this,0,0);else if(1===arguments.length){var t=arguments[0];p.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];p.call(this,e,n,p.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.x=i,this.y=r,this.z=o}}function d(){if(this.dimensionsToTest=2,0===arguments.length)d.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new i("only 2 or 3 dimensions may be specified");this.dimensionsToTest=t}}function g(){}function y(){}function m(t){this.message=t||""}function v(){}function _(t){this.message=t||""}function x(t){this.message=t||""}function w(){this.array_=[],arguments[0]instanceof y&&this.addAll(arguments[0])}function C(){if(w.apply(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}function E(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.init(r,o,s,a)}}function S(){}function I(){S.call(this,"Projective point not representable on the Cartesian plane.")}function b(){}function P(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1}function M(){}function T(t){this.str=t}function L(t){this.value=t}function N(){}function R(){if(this.hi=0,this.lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof R){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];R.call(this,R.parse(n))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}}function O(){}function A(){}function D(){}function k(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof k&&arguments[1]instanceof k){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof p&&arguments[1]instanceof p){var o=arguments[0],s=arguments[1];this.x=o.y-s.y,this.y=s.x-o.x,this.w=o.x*s.y-s.x*o.y}}else if(3===arguments.length){var a=arguments[0],h=arguments[1],u=arguments[2];this.x=a,this.y=h,this.w=u}else if(4===arguments.length){var l=arguments[0],c=arguments[1],f=arguments[2],d=arguments[3],g=l.y-c.y,y=c.x-l.x,m=l.x*c.y-c.x*l.y,v=f.y-d.y,_=d.x-f.x,x=f.x*d.y-d.x*f.y;this.x=y*x-_*m,this.y=v*m-g*x,this.w=g*_-v*y}}function F(){}function G(){}function z(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function j(){}function B(){}function H(){}function V(){}function q(){}function W(){}function Z(){}function U(){}function Y(){}function X(){}function J(){}function K(){}function Q(){this.array_=[],arguments[0]instanceof y&&this.addAll(arguments[0])}function $(t){return null==t?Do:t.color}function tt(t){return null==t?null:t.parent}function et(t,e){null!==t&&(t.color=e)}function nt(t){return null==t?null:t.left}function it(t){return null==t?null:t.right}function rt(){this.root_=null,this.size_=0}function ot(){}function st(){}function at(){this.array_=[],arguments[0]instanceof y&&this.addAll(arguments[0])}function ht(){}function ut(){}function lt(){}function ct(){}function ft(){this.geometries=null;var t=arguments[0],e=arguments[1];if(z.call(this,e),null===t&&(t=[]),z.hasNullElements(t))throw new i("geometries must not contain null elements");this.geometries=t}function pt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function dt(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,1===arguments.length){var t=arguments[0];dt.call(this,t,B.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.geom=e,this.geomFact=e.getFactory(),this.bnRule=n}}function gt(){this.count=null}function yt(){}function mt(){}function vt(){}function _t(){this.points=null;var t=arguments[0],e=arguments[1];z.call(this,e),this.init(t)}function xt(){}function wt(){this.coordinates=null;var t=arguments[0],e=arguments[1];z.call(this,e),this.init(t)}function Ct(){}function Et(){this.shell=null,this.holes=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(z.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),z.hasNullElements(e))throw new i("holes must not contain null elements");if(t.isEmpty()&&z.hasNonEmptyElements(e))throw new i("shell is empty but holes are not");this.shell=t,this.holes=e}function St(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function It(){if(arguments[0]instanceof p&&arguments[1]instanceof jt){var t=arguments[0],e=arguments[1];It.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(P(arguments[0],A)&&arguments[1]instanceof jt){var n=arguments[0],i=arguments[1];_t.call(this,n,i),this.validateConstruction()}}function bt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function Pt(){if(this.factory=null,this.isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.factory=t}}function Mt(){}function Tt(){}function Lt(){}function Nt(){}function Rt(){if(this.dimension=3,this.coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];Rt.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.coordinates=new Array(e).fill(null);for(var n=0;e>n;n++)this.coordinates[n]=new p}else if(P(arguments[0],A)){var i=arguments[0];if(null===i)return this.coordinates=new Array(0).fill(null),null;this.dimension=i.getDimension(),this.coordinates=new Array(i.size()).fill(null);for(n=0;n<this.coordinates.length;n++)this.coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this.coordinates=r,this.dimension=o,null===r&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this.coordinates=new Array(s).fill(null),this.dimension=a;for(n=0;s>n;n++)this.coordinates[n]=new p}}function Ot(){}function At(t,e){return t===e||t!=t&&e!=e}function Dt(t,e,n){var i=[0],r=!1;return t.push(i),{next:function(){var o,s=i[0];return!r&&s<e.length?(o=n?[e[s],n[s]]:e[s],i[0]++):(r=!0,t.splice(t.indexOf(i),1)),{done:r,value:o}}}}function kt(){return this._values.length}function Ft(){this.map_=new jo}function Gt(){if(this.modelType=null,this.scale=null,0===arguments.length)this.modelType=Gt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof zt){var t=arguments[0];this.modelType=t,t===Gt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this.modelType=Gt.FIXED,this.setScale(e)}else if(arguments[0]instanceof Gt){var n=arguments[0];this.modelType=n.modelType,this.scale=n.scale}}function zt(){this.name=null;var t=arguments[0];this.name=t,zt.nameToTypeMap.put(t,this)}function jt(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,0===arguments.length)jt.call(this,new Gt,0);else if(1===arguments.length){if(P(arguments[0],F)){var t=arguments[0];jt.call(this,new Gt,0,t)}else if(arguments[0]instanceof Gt){var e=arguments[0];jt.call(this,e,0,jt.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];jt.call(this,n,i,jt.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.precisionModel=r,this.coordinateSequenceFactory=s,this.SRID=o}}function Bt(t){this.geometryFactory=t||new jt}function Ht(t){this.parser=new Bt(t)}function Vt(){this.result=null,this.inputLines=Array(2).fill().map(function(){return Array(2)}),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new p,this.intPt[1]=new p,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function qt(){Vt.apply(this)}function Wt(){}function Zt(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function Ut(){}function Yt(){if(this.p0=null,this.p1=null,0===arguments.length)Yt.call(this,new p,new p);else if(1===arguments.length){var t=arguments[0];Yt.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];Yt.call(this,new p(i,r),new p(o,s))}}function Xt(){if(this.matrix=null,0===arguments.length)this.matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(ut.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];Xt.call(this),this.set(t)}else if(arguments[0]instanceof Xt){var e=arguments[0];Xt.call(this),this.matrix[b.INTERIOR][b.INTERIOR]=e.matrix[b.INTERIOR][b.INTERIOR],this.matrix[b.INTERIOR][b.BOUNDARY]=e.matrix[b.INTERIOR][b.BOUNDARY],this.matrix[b.INTERIOR][b.EXTERIOR]=e.matrix[b.INTERIOR][b.EXTERIOR],this.matrix[b.BOUNDARY][b.INTERIOR]=e.matrix[b.BOUNDARY][b.INTERIOR],this.matrix[b.BOUNDARY][b.BOUNDARY]=e.matrix[b.BOUNDARY][b.BOUNDARY],this.matrix[b.BOUNDARY][b.EXTERIOR]=e.matrix[b.BOUNDARY][b.EXTERIOR],this.matrix[b.EXTERIOR][b.INTERIOR]=e.matrix[b.EXTERIOR][b.INTERIOR],this.matrix[b.EXTERIOR][b.BOUNDARY]=e.matrix[b.EXTERIOR][b.BOUNDARY],this.matrix[b.EXTERIOR][b.EXTERIOR]=e.matrix[b.EXTERIOR][b.EXTERIOR]}}function Jt(){this.areaBasePt=null,this.triangleCent3=new p,this.areasum2=0,this.cg3=new p,this.lineCentSum=new p,this.totalLength=0,this.ptCount=0,this.ptCentSum=new p;var t=arguments[0];this.areaBasePt=null,this.add(t)}function Kt(t){this.message=t||""}function Qt(){this.array_=[]}function $t(){this.treeSet=new at,this.list=new w}function te(){if(this.geomFactory=null,this.inputPts=null,1===arguments.length){var t=arguments[0];te.call(this,te.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputPts=$t.filterCoordinates(e),this.geomFactory=n}}function ee(){this.origin=null;var t=arguments[0];this.origin=t}function ne(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function ie(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new Yt,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof _t&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];ie.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.srcPts=n,this._isClosed=ie.isClosed(n),this.snapTolerance=i}}function re(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function oe(){if(ne.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this.snapTolerance=t,this.snapPts=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.snapTolerance=n,this.snapPts=i,this.isSelfSnap=r}}function se(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function ae(){this.commonCoord=null,this.ccFilter=new he}function he(){this.commonBitsX=new se,this.commonBitsY=new se}function ue(){this.trans=null;var t=arguments[0];this.trans=t}function le(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function ce(){if(this.boundaryRule=B.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new i("Rule must be non-null");this.boundaryRule=t}}function fe(){}function pe(){}function de(){this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function ge(){}function ye(){this.bounds=null,this.item=null;var t=arguments[0],e=arguments[1];this.bounds=t,this.item=e}function me(){this._size=null,this.items=null,this._size=0,this.items=new w,this.items.add(null)}function ve(){}function _e(){}function xe(){if(this.childBoundables=new w,this.bounds=null,this.level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.level=t}}function we(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.boundable1=t,this.boundable2=e,this.itemDistance=n,this._distance=this.distance()}function Ce(){if(this.root=null,this.built=!1,this.itemBoundables=new w,this.nodeCapacity=null,0===arguments.length)Ce.call(this,Ce.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];f.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Ee(){}function Se(){if(0===arguments.length)Se.call(this,Se.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];Ce.call(this,t)}}function Ie(){var t=arguments[0];xe.call(this,t)}function be(){}function Pe(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.segString=t,this.coord=new p(e),this.segmentIndex=n,this.segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}function Me(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function Te(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function Le(){}function Ne(){this.nodeList=new Me(this),this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function Re(){this.tempEnv1=new E,this.tempEnv2=new E,this.overlapSeg1=new Yt,this.overlapSeg2=new Yt}function Oe(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.pts=t,this.start=e,this.end=n,this.context=i}function Ae(){}function De(){}function ke(){}function Fe(){if(this.segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}function Ge(){if(this.monoChains=new w,this.index=new Se,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];Fe.call(this,t)}}function ze(){Re.apply(this),this.si=null;var t=arguments[0];this.si=t}function je(){if(this.pt=null,1===arguments.length){var t=arguments[0];u.call(this,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];u.call(this,je.msgWithCoord(e,n)),this.pt=new p(n)}}function Be(){}function He(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new w,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function Ve(){this.li=new qt,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function qe(){this.nv=null;var t=arguments[0];this.nv=new Ve(qe.toSegmentStrings(t))}function We(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function Ze(){}function Ue(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[Ze.ON]=e}else if(arguments[0]instanceof Ue){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.init(3),this.location[Ze.ON]=r,this.location[Ze.LEFT]=o,this.location[Ze.RIGHT]=s}}function Ye(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Ue(t),this.elt[1]=new Ue(t)}else if(arguments[0]instanceof Ye){var e=arguments[0];this.elt[0]=new Ue(e.elt[0]),this.elt[1]=new Ue(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new Ue(b.NONE),this.elt[1]=new Ue(b.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.elt[0]=new Ue(r,o,s),this.elt[1]=new Ue(r,o,s)}else if(4===arguments.length){var a=arguments[0],h=arguments[1],u=arguments[2],l=arguments[3];this.elt[0]=new Ue(b.NONE,b.NONE,b.NONE),this.elt[1]=new Ue(b.NONE,b.NONE,b.NONE),this.elt[a].setLocations(h,u,l)}}function Xe(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new w,this.pts=new w,this.label=new Ye(b.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new w,this.geometryFactory=null;var t=arguments[0],e=arguments[1];this.geometryFactory=e,this.computePoints(t),this.computeRing()}function Je(){var t=arguments[0],e=arguments[1];Xe.call(this,t,e)}function Ke(){var t=arguments[0],e=arguments[1];Xe.call(this,t,e)}function Qe(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.label=t}}function $e(){Qe.apply(this),this.coord=null,this.edges=null;var t=arguments[0],e=arguments[1];this.coord=t,this.edges=e,this.label=new Ye(0,b.NONE)}function tn(){this.nodeMap=new rt,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function en(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,1===arguments.length){var t=arguments[0];this.edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];en.call(this,e,n,i,null)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];en.call(this,r),this.init(o,s),this.label=a}}function nn(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(en.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function rn(){}function on(){if(this.edges=new w,this.nodes=null,this.edgeEndList=new w,0===arguments.length)this.nodes=new tn(new rn);else if(1===arguments.length){var t=arguments[0];this.nodes=new tn(t)}}function sn(){this.geometryFactory=null,this.shellList=new w;var t=arguments[0];this.geometryFactory=t}function an(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new w,this.resultLineList=new w;var t=arguments[0],e=arguments[1],n=arguments[2];this.op=t,this.geometryFactory=e,this.ptLocator=n}function hn(){this.op=null,this.geometryFactory=null,this.resultPointList=new w;var t=arguments[0],e=arguments[1];arguments[2],this.op=t,this.geometryFactory=e}function un(){}function ln(){this.geom=null;var t=arguments[0];this.geom=t}function cn(){this.edgeMap=new rt,this.edgeList=null,this.ptInAreaLocation=[b.NONE,b.NONE]}function fn(){cn.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function pn(){rn.apply(this)}function dn(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function gn(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.eventType=gn.DELETE,this.xValue=t,this.insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.eventType=gn.INSERT,this.label=n,this.xValue=i,this.obj=r}}function yn(){}function mn(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.li=t,this.includeProper=e,this.recordIsolated=n}function vn(){yn.apply(this),this.events=new w,this.nOverlaps=null}function _n(){this.min=r.POSITIVE_INFINITY,this.max=r.NEGATIVE_INFINITY}function xn(){}function wn(){_n.apply(this),this.item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.min=t,this.max=e,this.item=n}function Cn(){_n.apply(this),this.node1=null,this.node2=null;var t=arguments[0],e=arguments[1];this.node1=t,this.node2=e,this.buildExtent(this.node1,this.node2)}function En(){this.leaves=new w,this.root=null,this.level=0}function Sn(){if(this.lines=null,this.isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this.lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.lines=e,this.isForcedToLineString=n}}function In(){this.items=new w}function bn(){this.index=null;var t=arguments[0];if(!P(t,Ct))throw new i("Argument must be Polygonal");this.index=new Mn(t)}function Pn(){this.counter=null;var t=arguments[0];this.counter=t}function Mn(){this.index=new En;var t=arguments[0];this.init(t)}function Tn(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new p(t),this.segmentIndex=e,this.dist=n}function Ln(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function Nn(){}function Rn(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new E,this.env2=new E;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Nn;this.startIndex=e.getChainStartIndices(this.pts)}function On(){this.depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;2>t;t++)for(var e=0;3>e;e++)this.depth[t][e]=On.NULL_VALUE}function An(){if(Qe.apply(this),this.pts=null,this.env=null,this.eiList=new Ln(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new On,this.depthDelta=0,1===arguments.length){var t=arguments[0];An.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this.label=n}}function Dn(){if(on.apply(this),this.parentGeom=null,this.lineEdgeMap=new Ft,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new ce,2===arguments.length){var t=arguments[0],e=arguments[1];Dn.call(this,t,e,B.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.argIndex=n,this.parentGeom=i,this.boundaryNodeRule=r,null!==i&&this.add(i)}}function kn(){if(this.li=new qt,this.resultPrecisionModel=null,this.arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new Dn(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];kn.call(this,e,n,B.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new Dn(0,i,o),this.arg[1]=new Dn(1,r,o)}}function Fn(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=Fn.orientation(t)}function Gn(){this.edges=new w,this.ocaMap=new rt}function zn(){this.ptLocator=new ce,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new Gn,this.resultPolyList=new w,this.resultLineList=new w,this.resultPointList=new w;var t=arguments[0],e=arguments[1];kn.call(this,t,e),this.graph=new on(new pn),this.geomFact=t.getFactory()}function jn(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()}function Bn(){this.geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e}function Hn(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function Vn(){this.poly=null,this.centreY=null,this.hiY=r.MAX_VALUE,this.loY=-r.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=Hn.avg(this.loY,this.hiY)}function qn(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this.interiorPoint&&this.addEndpoints(t)}function Wn(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function Zn(){}function Un(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}function Yn(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function Xn(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new Yt,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,1===arguments.length){var t=arguments[0];Xn.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isConvex=n}}function Jn(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function Kn(){ne.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function Qn(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function $n(){this._isMarked=!1;var t=arguments[0];Qn.call(this,t)}function ti(){this.vertexMap=new Ft}function ei(){this._isStart=!1;var t=arguments[0];$n.call(this,t)}function ni(){ti.apply(this)}function ii(){this.result=null,this.factory=null,this.graph=null,this.lines=new w,this.nodeEdgeStack=new Qt,this.ringStartEdge=null,this.graph=new ni}function ri(){this.items=new w,this.subnode=new Array(4).fill(null)}function oi(){}function si(){this.pt=new p,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function ai(){ri.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],e=arguments[1];this.env=t,this.level=e,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function hi(){}function ui(){ri.apply(this)}function li(){this.root=null,this.minExtent=1,this.root=new ui}function ci(t){this.geometryFactory=t||new jt}function fi(t){this.geometryFactory=t||new jt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ci(this.geometryFactory)}function pi(){this.parser=new ci(this.geometryFactory)}function di(t){this.geometryFactory=t||new jt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Bt(this.geometryFactory)}function gi(t){return[t.x,t.y]}function yi(t){this.geometryFactory=t||new jt}function mi(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];mi.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],i=arguments[1];arguments[2],arguments[3],this.noder=n,this.scaleFactor=i,this.isScaled=!this.isIntegerPrecision()}}function vi(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this.inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isClosedEndpointsInInterior=!n.isInBoundary(2)}}function _i(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function xi(){if(this.quadrantSegments=xi.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=xi.CAP_ROUND,this.joinStyle=xi.JOIN_ROUND,this.mitreLimit=xi.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this.simplifyFactor=xi.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(o),this.setMitreLimit(s)}}function wi(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function Ci(){this.array_=[]}function Ei(){this.finder=null,this.dirEdgeList=new w,this.nodes=new w,this.rightMostCoord=null,this.env=null,this.finder=new wi}function Si(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=Ut.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Ii(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new w}function bi(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new Yt,this.seg1=new Yt,this.offset0=new Yt,this.offset1=new Yt,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.precisionModel=t,this.bufParams=e,this.li=new qt,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===xi.JOIN_ROUND&&(this.closingSegLengthFactor=bi.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function Pi(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],e=arguments[1];this.precisionModel=t,this.bufParams=e}function Mi(){this.subgraphs=null,this.seg=new Yt,this.cga=new Ut;var t=arguments[0];this.subgraphs=t}function Ti(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],e=arguments[1];this.upwardSeg=new Yt(t),this.leftDepth=e}function Li(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new w;var t=arguments[0],e=arguments[1],n=arguments[2];this.inputGeom=t,this.distance=e,this.curveBuilder=n}function Ni(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function Ri(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new Gn;var t=arguments[0];this.bufParams=t}function Oi(){this.li=new qt,this.segStrings=null;var t=arguments[0];this.segStrings=t}function Ai(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=n,0>=e)throw new i("Scale factor must be non-zero");1!==e&&(this.pt=new p(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new p,this.p1Scaled=new p),this.initCorners(this.pt)}function Di(){this.tempEnv1=new E,this.selectedSegment=new Yt}function ki(){this.index=null;var t=arguments[0];this.index=t}function Fi(){Di.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.hotPixel=t,this.parentEdge=e,this.hotPixelVertexIndex=n}function Gi(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new w}function zi(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new qt,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function ji(){if(this.argGeom=null,this.distance=null,this.bufParams=new xi,this.resultGeometry=null,this.saveException=null,1===arguments.length){var t=arguments[0];this.argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.argGeom=e,this.bufParams=n}}function Bi(){this.comps=null;var t=arguments[0];this.comps=t}function Hi(){if(this.component=null,this.segIndex=null,this.pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];Hi.call(this,t,Hi.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.component=n,this.segIndex=i,this.pt=r}}function Vi(){this.pts=null;var t=arguments[0];this.pts=t}function qi(){this.locations=null;var t=arguments[0];this.locations=t}function Wi(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new ce,this.minDistanceLocation=null,this.minDistance=r.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];Wi.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],o=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=n,this.geom[1]=i,this.terminateDistance=o}}function Zi(){this.factory=null,this.directedEdges=new w,this.coordinates=null;var t=arguments[0];this.factory=t}function Ui(){this._isMarked=!1,this._isVisited=!1,this.data=null}function Yi(){Ui.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.from=t,this.to=e,this.edgeDirection=i,this.p0=t.getCoordinate(),this.p1=n;var r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y;this.quadrant=Ae.quadrant(r,o),this.angle=Math.atan2(o,r)}function Xi(){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Yi.call(this,t,e,n,i)}function Ji(){if(Ui.apply(this),this.dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}function Ki(){this.outEdges=new w,this.sorted=!1}function Qi(){if(Ui.apply(this),this.pt=null,this.deStar=null,1===arguments.length){var t=arguments[0];Qi.call(this,t,new Ki)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pt=e,this.deStar=n}}function $i(){Ji.apply(this),this.line=null;var t=arguments[0];this.line=t}function tr(){this.nodeMap=new rt}function er(){this.edges=new Q,this.dirEdges=new Q,this.nodeMap=new tr}function nr(){er.apply(this)}function ir(){this.graph=new nr,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function rr(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Yi.call(this,t,e,n,i)}function or(){Ji.apply(this),this.line=null;var t=arguments[0];this.line=t}function sr(){this.factory=null,this.deList=new w,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function ar(){}function hr(){er.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function ur(){if(this.lineStringAdder=new lr(this),this.graph=null,this.dangles=new w,this.cutEdges=new w,this.invalidRingLines=new w,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,0===arguments.length)ur.call(this,!1);else if(1===arguments.length){var t=arguments[0];this.extractOnlyPolygonal=t}}function lr(){this.p=null;var t=arguments[0];this.p=t}function cr(){}function fr(){if(this.edgeEnds=new w,1===arguments.length){var t=arguments[0];fr.call(this,null,t)}else if(2===arguments.length){var e=(arguments[0],arguments[1]);en.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new Ye(e.getLabel())),this.insert(e)}}function pr(){cn.apply(this)}function dr(){var t=arguments[0],e=arguments[1];$e.call(this,t,e)}function gr(){rn.apply(this)}function yr(){this.li=new qt,this.ptLocator=new ce,this.arg=null,this.nodes=new tn(new gr),this.im=null,this.isolatedEdges=new w,this.invalidPoint=null;var t=arguments[0];this.arg=t}function mr(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function vr(){this.li=new qt,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new p(t.getMinX(),t.getMinY()),this.diagUp1=new p(t.getMaxX(),t.getMaxY()),this.diagDown0=new p(t.getMinX(),t.getMaxY()),this.diagDown1=new p(t.getMaxX(),t.getMinY())}function _r(){this._isDone=!1}function xr(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function wr(){_r.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function Cr(){_r.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function Er(){_r.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new p,this.p1=new p;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new vr(this.rectEnv)}function Sr(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];kn.call(this,t,e),this._relate=new yr(this.arg)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];kn.call(this,n,i,r),this._relate=new yr(this.arg)}}function Ir(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=Ir.extractFactory(t),this.inputGeoms=t}function br(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],e=arguments[1];this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()}function Pr(){this.sortIndex=-1,this.comps=null;var t=arguments[0],e=arguments[1];this.sortIndex=t,this.comps=e}function Mr(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,null===this.inputPolys&&(this.inputPolys=new w)}function Tr(){if(this.polygons=new w,this.lines=new w,this.points=new w,this.geomFact=null,1===arguments.length){if(P(arguments[0],y)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof z){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.geomFact=i,this.extract(n)}}function Lr(){this.geometryFactory=new jt,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function Nr(){this.items=new w,this.subnode=[null,null]}function Rr(){if(this.min=null,this.max=null,0===arguments.length)this.min=0,this.max=0;else if(1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.init(e,n)}}function Or(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function Ar(){Nr.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],e=arguments[1];this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2}function Dr(){Nr.apply(this)}function kr(){this.root=null,this.minExtent=1,this.root=new Dr}function Fr(){}function Gr(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new Rr;var t=arguments[0];this.ring=t,this.buildIndex()}function zr(){Di.apply(this),this.mcp=null,this.p=null;var t=arguments[0],e=arguments[1];this.mcp=t,this.p=e}function jr(){this.nodes=new tn(new gr)}function Br(){this.li=new qt,this.geomGraph=null,this.nodeGraph=new jr,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function Hr(){this.graph=null,this.rings=new w,this.totalEnv=new E,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function Vr(){if(this.errorType=null,this.pt=null,1===arguments.length){var t=arguments[0];Vr.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.errorType=e,null!==n&&(this.pt=n.copy())}}function qr(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function Wr(){Pt.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],e=arguments[1];this.targetPM=t,this.removeCollapsed=e}function Zr(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function Ur(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new Yt;var t=arguments[0];this.pts=t}function Yr(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function Xr(){ne.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],e=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=e}function Jr(){if(this.parent=null,this.index=null,2===arguments.length){var t=arguments[0],e=arguments[1];Jr.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];Yt.call(this,n,i),this.parent=r,this.index=o}}function Kr(){if(this.parentLine=null,this.segs=null,this.resultSegs=new w,this.minimumSize=null,1===arguments.length){var t=arguments[0];Kr.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.parentLine=e,this.minimumSize=n,this.init()}}function Qr(){this.index=new li}function $r(){this.querySeg=null,this.items=new w;var t=arguments[0];this.querySeg=t}function to(){this.li=new qt,this.inputIndex=new Qr,this.outputIndex=new Qr,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],e=arguments[1];this.inputIndex=t,this.outputIndex=e}function eo(){this.inputIndex=new Qr,this.outputIndex=new Qr,this.distanceTolerance=0}function no(){this.inputGeom=null,this.lineSimplifier=new eo,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function io(){ne.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function ro(){this.tps=null;var t=arguments[0];this.tps=t}function oo(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function so(){}function ao(){}function ho(){}function uo(){if(this.p=null,1===arguments.length){var t=arguments[0];this.p=new p(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p=new p(e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.p=new p(i,r,o)}}function lo(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];uo.call(this,t)}function co(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function fo(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function po(){}function go(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function yo(){if(this.seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];u.call(this,t)}else if(arguments[0]instanceof Yt){var e=arguments[0];u.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new Yt(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];u.call(this,yo.msgWithSpatial(n,i)),this.seg=new Yt(i)}}function mo(){}function vo(){this.visitedKey=0,this.quadEdges=new w,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new Yt,this.triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this.tolerance=e,this.edgeCoincidenceTolerance=e/vo.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new go(this)}function _o(){}function xo(){this.triList=new w}function wo(){this.triList=new w}function Co(){this.coordList=new C,this.triCoords=new w}function Eo(){if(this.ls=null,this.data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.ls=new Yt(t,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.ls=new Yt(n,i),this.data=r}else if(6===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],h=arguments[3],u=arguments[4],l=arguments[5];Eo.call(this,new p(o,s,a),new p(h,u,l))}else if(7===arguments.length){var c=arguments[0],f=arguments[1],d=arguments[2],g=arguments[3],y=arguments[4],m=arguments[5],v=arguments[6];Eo.call(this,new p(c,f,d),new p(g,y,m),v)}}function So(){}function Io(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.p=new p(t),this.left=null,this.right=null,this.count=1,this.data=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.p=new p(n,i),this.left=null,this.right=null,this.count=1,this.data=r}}function bo(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,0===arguments.length)bo.call(this,0);else if(1===arguments.length){var t=arguments[0];this.tolerance=t}}function Po(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],e=arguments[1];this.p=t,this.tolerance=e}function Mo(){this.initialVertices=null,this.segVertices=null,this.segments=new w,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new ao,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],e=arguments[1];this.initialVertices=new w(t),this.tolerance=e,this.kdt=new bo(e)}function To(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function Lo(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new rt}function No(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function Ro(){}Array.prototype.fill||(Array.prototype.fill=function(t){for(var e=Object(this),n=parseInt(e.length,10),i=arguments[1],r=parseInt(i,10)||0,o=0>r?Math.max(n+r,0):Math.min(r,n),s=arguments[2],a=void 0===s?n:parseInt(s,10)||0,h=0>a?Math.max(n+a,0):Math.min(a,n);h>o;o++)e[o]=t;return e}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},e(n.prototype,{interfaces_:function(){return[]},getClass:function(){return n}}),n.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},r.isNaN=function(t){return Number.isNaN(t)},r.doubleToLongBits=function(t){return t},r.longBitsToDouble=function(t){return t},r.isInfinite=function(t){return!Number.isFinite(t)},r.MAX_VALUE=Number.MAX_VALUE,l(c,u),e(c.prototype,{interfaces_:function(){return[]},getClass:function(){return c}}),e(f.prototype,{interfaces_:function(){return[]},getClass:function(){return f}}),f.shouldNeverReachHere=function(){if(0===arguments.length)f.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new c("Should never reach here"+(null!==t?": "+t:""))}},f.isTrue=function(){if(1===arguments.length){var t=arguments[0];f.isTrue(t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!e)throw null===n?new c:new c(n)}},f.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];f.equals(t,e,null)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(!i.equals(n))throw new c("Expected "+n+" but encountered "+i+(null!==r?": "+r:""))}},e(p.prototype,{setOrdinate:function(t,e){switch(t){case p.X:this.x=e;break;case p.Y:this.y=e;break;case p.Z:this.z=e;break;default:throw new i("Invalid ordinate index: "+t)}},equals2D:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!n.equalsWithTolerance(this.x,e.x,i)&&!!n.equalsWithTolerance(this.y,e.y,i)}},getOrdinate:function(t){switch(t){case p.X:return this.x;case p.Y:return this.y;case p.Z:return this.z}throw new i("Invalid ordinate index: "+t)},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||r.isNaN(this.z)&&r.isNaN(t.z))},equals:function(t){return t instanceof p&&this.equals2D(t)},equalInZ:function(t,e){return n.equalsWithTolerance(this.z,t.z,e)},compareTo:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},clone:function(){try{var t=null;return null}catch(t){if(t instanceof CloneNotSupportedException)return f.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}},copy:function(){return new p(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*t+p.hashCode(this.x))+p.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[o,s,h]},getClass:function(){return p}}),p.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=r.doubleToLongBits(t);return Math.trunc(e^e>>>32)}},e(d.prototype,{compare:function(t,e){var n=t,i=e,r=d.compare(n.x,i.x);if(0!==r)return r;var o=d.compare(n.y,i.y);return 0!==o?o:this.dimensionsToTest<=2?0:d.compare(n.z,i.z)},interfaces_:function(){return[a]},getClass:function(){return d}}),d.compare=function(t,e){return e>t?-1:t>e?1:r.isNaN(t)?r.isNaN(e)?0:-1:r.isNaN(e)?1:0},p.DimensionalComparator=d,p.serialVersionUID=0x5cbf2c235c7e5800,p.NULL_ORDINATE=r.NaN,p.X=0,p.Y=1,p.Z=2,g.prototype.hasNext=function(){},g.prototype.next=function(){},g.prototype.remove=function(){},y.prototype.add=function(){},y.prototype.addAll=function(){},y.prototype.isEmpty=function(){},y.prototype.iterator=function(){},y.prototype.size=function(){},y.prototype.toArray=function(){},y.prototype.remove=function(){},m.prototype=new Error,m.prototype.name="IndexOutOfBoundsException",v.prototype=Object.create(y.prototype),v.prototype.constructor=v,v.prototype.get=function(){},v.prototype.set=function(){},v.prototype.isEmpty=function(){},_.prototype=new Error,_.prototype.name="NoSuchElementException",x.prototype=new Error,x.prototype.name="OperationNotSupported",w.prototype=Object.create(v.prototype),w.prototype.constructor=w,w.prototype.ensureCapacity=function(){},w.prototype.interfaces_=function(){return[v,y]},w.prototype.add=function(t){return this.array_.push(t),!0},w.prototype.clear=function(){this.array_=[]},w.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},w.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},w.prototype.iterator=function(){return new Oo(this)},w.prototype.get=function(t){if(0>t||t>=this.size())throw new m;return this.array_[t]},w.prototype.isEmpty=function(){return 0===this.array_.length},w.prototype.size=function(){return this.array_.length},w.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},w.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;i>n;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var Oo=function(t){this.arrayList_=t,this.position_=0};Oo.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new _;return this.arrayList_.get(this.position_++)},Oo.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},Oo.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},Oo.prototype.remove=function(){throw new x},l(C,w),e(C.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=!1,i=t.iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n}return w.prototype.addAll.apply(this,arguments)},clone:function(){for(var t=w.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},toCoordinateArray:function(){return this.toArray(C.coordArrayType)},add:function(){if(1===arguments.length){var t=arguments[0];w.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof p&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1)if(this.get(this.size()-1).equals2D(i))return null;w.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1];return this.add(r,o),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];if(arguments[2])for(var h=0;h<s.length;h++)this.add(s[h],a);else for(h=s.length-1;h>=0;h--)this.add(s[h],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof p){var u=arguments[0],l=arguments[1];if(!arguments[2]){var c=this.size();if(c>0){if(u>0)if(this.get(u-1).equals2D(l))return null;if(c>u)if(this.get(u).equals2D(l))return null}}w.prototype.add.call(this,u,l)}}else if(4===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=arguments[3],m=1;g>y&&(m=-1);for(h=g;h!==y;h+=m)this.add(f[h],d);return!0}},closeRing:function(){this.size()>0&&this.add(new p(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return C}}),C.coordArrayType=new Array(0).fill(null),e(E.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof E))return!1;var e=t;return this.isNull()?e.isNull():this.maxx===e.getMaxX()&&this.maxy===e.getMaxY()&&this.minx===e.getMinX()&&this.miny===e.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new E;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny;return new E(e,this.maxx<t.maxx?this.maxx:t.maxx,n,this.maxy<t.maxy?this.maxy:t.maxy)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof E){var e=arguments[0];return!this.isNull()&&!e.isNull()&&(e.getMinX()>=this.minx&&e.getMaxX()<=this.maxx&&e.getMinY()>=this.miny&&e.getMaxY()<=this.maxy)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&(n>=this.minx&&n<=this.maxx&&i>=this.miny&&i<=this.maxy)}},intersects:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof p){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this.maxx||n<this.minx||i>this.maxy||i<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this.minx=e.getMinX(),this.maxx=e.getMaxX(),this.miny=e.getMinY(),this.maxy=e.getMaxY()):(e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this.minx=n,this.maxx=n,this.miny=i,this.maxy=i):(n<this.minx&&(this.minx=n),n>this.maxx&&(this.maxx=n),i<this.miny&&(this.miny=i),i>this.maxy&&(this.maxy=i))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e>t?t:e},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this.minx<e.minx?-1:this.minx>e.minx?1:this.miny<e.miny?-1:this.miny>e.miny?1:this.maxx<e.maxx?-1:this.maxx>e.maxx?1:this.maxy<e.maxy?-1:this.maxy>e.maxy?1:0},translate:function(t,e){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},expandBy:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this.minx-=e,this.maxx+=e,this.miny-=n,this.maxy+=n,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},centre:function(){return this.isNull()?null:new p((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.minx=e.minx,this.maxx=e.maxx,this.miny=e.miny,this.maxy=e.maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];o>r?(this.minx=r,this.maxx=o):(this.minx=o,this.maxx=r),a>s?(this.miny=s,this.maxy=a):(this.miny=a,this.maxy=s)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx?e=t.minx-this.maxx:this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny?n=t.miny-this.maxy:this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*(t=37*(t=37*t+p.hashCode(this.minx))+p.hashCode(this.maxx))+p.hashCode(this.miny))+p.hashCode(this.maxy)},interfaces_:function(){return[o,h]},getClass:function(){return E}}),E.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),h=Math.max(o.x,s.x),u=Math.min(i.x,r.x),l=Math.max(i.x,r.x);return!(u>h)&&(!(a>l)&&(a=Math.min(o.y,s.y),h=Math.max(o.y,s.y),u=Math.min(i.y,r.y),l=Math.max(i.y,r.y),!(u>h)&&!(a>l)))}},E.serialVersionUID=0x51845cd552189800,l(I,S),e(I.prototype,{interfaces_:function(){return[]},getClass:function(){return I}}),e(b.prototype,{interfaces_:function(){return[]},getClass:function(){return b}}),b.toLocationSymbol=function(t){switch(t){case b.EXTERIOR:return"e";case b.BOUNDARY:return"b";case b.INTERIOR:return"i";case b.NONE:return"-"}throw new i("Unknown location value: "+t)},b.INTERIOR=0,b.BOUNDARY=1,b.EXTERIOR=2,b.NONE=-1,e(M.prototype,{interfaces_:function(){return[]},getClass:function(){return M}}),M.log10=function(t){var e=Math.log(t);return r.isInfinite(e)?e:r.isNaN(e)?e:e/M.LOG_10},M.min=function(t,e,n,i){var r=t;return r>e&&(r=e),r>n&&(r=n),r>i&&(r=i),r},M.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return e>t?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return r>i?r:i>o?o:i}},M.wrap=function(t,e){return 0>t?e- -t%e:t%e},M.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return e>(i=t)&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var i,r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];return o>(i=r)&&(i=o),s>i&&(i=s),a>i&&(i=a),i}},M.average=function(t,e){return(t+e)/2},M.LOG_10=Math.log(10),T.prototype.append=function(t){this.str+=t},T.prototype.setCharAt=function(t,e){return this.str.substr(0,t)+e+this.str.substr(t+1)},T.prototype.toString=function(t){return this.str},L.prototype.intValue=function(){return this.value},L.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},L.isNaN=function(t){return Number.isNaN(t)},N.isWhitespace=function(t){return 32>=t&&t>=0||127==t},N.toUpperCase=function(t){return t.toUpperCase()},e(R.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,e){var n=this.abs(),i=R.magnitude(n.hi),r=R.TEN.pow(i);(n=n.divide(r)).gt(R.TEN)?(n=n.divide(R.TEN),i+=1):n.lt(R.ONE)&&(n=n.multiply(R.TEN),i-=1);for(var o=i+1,s=new T,a=R.MAX_PRINT_DIGITS-1,h=0;a>=h;h++){t&&h===o&&s.append(".");var u=Math.trunc(n.hi);if(0>u)break;var l=!1,c=0;u>9?(l=!0,c="9"):c="0"+u,s.append(c),n=n.subtract(R.valueOf(u)).multiply(R.TEN),l&&n.selfAdd(R.TEN);var f=!0,p=R.magnitude(n.hi);if(0>p&&Math.abs(p)>=a-h&&(f=!1),!f)break}return e[0]=i,s.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof R){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},equals:function(){if(1===arguments.length){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return 0===this.hi&&0===this.lo},selfSubtract:function(){if(arguments[0]instanceof R){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(1===arguments.length){if(arguments[0]instanceof R){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],h=null,u=null,l=null,c=null;return r=this.hi/s,c=(h=(l=R.SPLIT*r)-(h=l-r))*(u=(c=R.SPLIT*s)-(u=c-s))-(o=r*s)+h*(i=s-u)+(n=r-h)*u+n*i,c=r+(l=(this.hi-o-c+this.lo-r*a)/s),this.hi=c,this.lo=r-c+l,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof R){var t,e,n,i,o=arguments[0],s=null,a=null,h=null,u=null;return n=this.hi/o.hi,s=(h=R.SPLIT*n)-n,u=R.SPLIT*o.hi,t=n-(s=h-s),a=u-o.hi,i=n*o.hi,u=s*(a=u-a)-i+s*(e=o.hi-a)+t*a+t*e,new R(u=n+(h=(this.hi-i-u+this.lo-n*o.lo)/o.hi),n-u+h)}if("number"==typeof arguments[0]){var l=arguments[0];return r.isNaN(l)?R.createNaN():R.copy(this).selfDivide(l,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(0===t)return R.valueOf(1);var e=new R(this),n=R.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return 0>t?n.reciprocal():n},ceil:function(){if(this.isNaN())return R.NaN;var t=Math.ceil(this.hi),e=0;return t===this.hi&&(e=Math.ceil(this.lo)),new R(t,e)},compareTo:function(t){var e=t;return this.hi<e.hi?-1:this.hi>e.hi?1:this.lo<e.lo?-1:this.lo>e.lo?1:0},rint:function(){return this.isNaN()?this:this.add(.5).floor()},setValue:function(){if(arguments[0]instanceof R){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return R.valueOf(0);if(this.isNegative())return R.NaN;var t=1/Math.sqrt(this.hi),e=this.hi*t,n=R.valueOf(e),i=this.subtract(n.sqr()).hi*(.5*t);return n.add(i)},selfAdd:function(){if(1===arguments.length){if(arguments[0]instanceof R){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,s=null,a=null;return o=(r=this.hi+e)-(s=r-this.hi),i=(a=(o=e-s+(this.hi-o))+this.lo)+(r-(n=r+a)),this.hi=n+i,this.lo=i+(n-this.hi),this}}else if(2===arguments.length){var h,u=arguments[0],l=arguments[1],c=(n=null,i=null,null);r=null,o=null,s=null,a=null;r=this.hi+u,h=this.lo+l,o=r-(s=r-this.hi),c=h-(a=h-this.lo),o=u-s+(this.hi-o),c=l-a+(this.lo-c);var f=(n=r+(s=o+h))+(s=c+(i=s+(r-n))),p=s+(n-f);return this.hi=f,this.lo=p,this}},selfMultiply:function(){if(1===arguments.length){if(arguments[0]instanceof R){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,h=null,u=null;s=(h=R.SPLIT*this.hi)-this.hi,u=R.SPLIT*r,s=h-s,n=this.hi-s,a=u-r;var l=(h=this.hi*r)+(u=s*(a=u-a)-h+s*(i=r-a)+n*a+n*i+(this.hi*o+this.lo*r)),c=u+(s=h-l);return this.hi=l,this.lo=c,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return R.NaN;var t=Math.floor(this.hi),e=0;return t===this.hi&&(e=Math.floor(this.lo)),new R(t,e)},negate:function(){return this.isNaN()?this:new R(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}},multiply:function(){if(arguments[0]instanceof R){var t=arguments[0];return t.isNaN()?R.createNaN():R.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return r.isNaN(e)?R.createNaN():R.copy(this).selfMultiply(e,0)}},isNaN:function(){return r.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=R.magnitude(this.hi);return t>=-3&&20>=t?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(0>i)r="0."+R.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+R.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},reciprocal:function(){var t,e,n,i,r=null,o=null,s=null,a=null;n=1/this.hi,r=(s=R.SPLIT*n)-n,a=R.SPLIT*this.hi,t=n-(r=s-r),o=a-this.hi;var h=n+(s=(1-(i=n*this.hi)-(a=r*(o=a-o)-i+r*(e=this.hi-o)+t*o+t*e)-n*this.lo)/this.hi);return new R(h,n-h+s)},toSciNotation:function(){if(this.isZero())return R.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=R.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},abs:function(){return this.isNaN()?R.NaN:this.isNegative()?this.negate():new R(this)},isPositive:function(){return this.hi>0||0===this.hi&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof R){var t=arguments[0];return R.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return R.copy(this).selfAdd(e)}},init:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof R){var e=arguments[0];this.hi=e.hi,this.lo=e.lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.hi=n,this.lo=i}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||0===this.hi&&this.lo<0},trunc:function(){return this.isNaN()?R.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[h,o,s]},getClass:function(){return R}}),R.sqr=function(t){return R.valueOf(t).selfMultiply(t)},R.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return R.parse(t)}if("number"==typeof arguments[0])return new R(arguments[0])},R.sqrt=function(t){return R.valueOf(t).sqrt()},R.parse=function(t){for(var e=0,n=t.length;N.isWhitespace(t.charAt(e));)e++;var i=!1;if(n>e){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new R,s=0,a=0,h=0;!(e>=n);){var u=t.charAt(e);if(e++,N.isDigit(u)){var l=u-"0";o.selfMultiply(R.TEN),o.selfAdd(l),s++}else{if("."!==u){if("e"===u||"E"===u){var c=t.substring(e);try{h=L.parseInt(c)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+c+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var f=o,p=s-a-h;if(0===p)f=o;else if(p>0){var d=R.TEN.pow(p);f=o.divide(d)}else if(0>p){d=R.TEN.pow(-p);f=o.multiply(d)}return i?f.negate():f},R.createNaN=function(){return new R(r.NaN,r.NaN)},R.copy=function(t){return new R(t)},R.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return e>=10*Math.pow(10,i)&&(i+=1),i},R.stringOfChar=function(t,e){for(var n=new T,i=0;e>i;i++)n.append(t);return n.toString()},R.PI=new R(3.141592653589793,1.2246467991473532e-16),R.TWO_PI=new R(6.283185307179586,2.4492935982947064e-16),R.PI_2=new R(1.5707963267948966,6.123233995736766e-17),R.E=new R(2.718281828459045,1.4456468917292502e-16),R.NaN=new R(r.NaN,r.NaN),R.EPS=1.23259516440783e-32,R.SPLIT=134217729,R.MAX_PRINT_DIGITS=32,R.TEN=R.valueOf(10),R.ONE=R.valueOf(1),R.SCI_NOT_EXPONENT_CHAR="E",R.SCI_NOT_ZERO="0.0E0",e(O.prototype,{interfaces_:function(){return[]},getClass:function(){return O}}),O.orientationIndex=function(t,e,n){var i=O.orientationIndexFilter(t,e,n);if(1>=i)return i;var r=R.valueOf(e.x).selfAdd(-t.x),o=R.valueOf(e.y).selfAdd(-t.y),s=R.valueOf(n.x).selfAdd(-e.x),a=R.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},O.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},O.intersection=function(t,e,n,i){var r=R.valueOf(i.y).selfSubtract(n.y).selfMultiply(R.valueOf(e.x).selfSubtract(t.x)),o=R.valueOf(i.x).selfSubtract(n.x).selfMultiply(R.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=R.valueOf(i.x).selfSubtract(n.x).selfMultiply(R.valueOf(t.y).selfSubtract(n.y)),h=R.valueOf(i.y).selfSubtract(n.y).selfMultiply(R.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(h).selfDivide(s).doubleValue(),l=R.valueOf(t.x).selfAdd(R.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),c=R.valueOf(e.x).selfSubtract(t.x).selfMultiply(R.valueOf(t.y).selfSubtract(n.y)),f=R.valueOf(e.y).selfSubtract(t.y).selfMultiply(R.valueOf(t.x).selfSubtract(n.x)),d=c.subtract(f).selfDivide(s).doubleValue();return new p(l,R.valueOf(n.y).selfAdd(R.valueOf(i.y).selfSubtract(n.y).selfMultiply(d)).doubleValue())},O.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(0>=o)return O.signum(s);i=r+o}else{if(!(0>r))return O.signum(s);if(o>=0)return O.signum(s);i=-r-o}var a=O.DP_SAFE_EPSILON*i;return s>=a||-s>=a?O.signum(s):2},O.signum=function(t){return t>0?1:0>t?-1:0},O.DP_SAFE_EPSILON=1e-15,e(A.prototype,{setOrdinate:function(t,e,n){},size:function(){},getOrdinate:function(t,e){},getCoordinate:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[s]},getClass:function(){return A}}),A.X=0,A.Y=1,A.Z=2,A.M=3,D.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;e+r>s;s++)n[i+o]=t[s],o++},D.getProperty=function(t){return{"line.separator":"\n"}[t]},e(k.prototype,{getY:function(){var t=this.y/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new I;return t},getX:function(){var t=this.x/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new I;return t},getCoordinate:function(){var t=new p;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return k}}),k.intersection=function(t,e,n,i){var o=t.y-e.y,s=e.x-t.x,a=t.x*e.y-e.x*t.y,h=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,c=o*u-h*s,f=(s*l-u*a)/c,d=(h*a-o*l)/c;if(r.isNaN(f)||r.isInfinite(f)||r.isNaN(d)||r.isInfinite(d))throw new I;return new p(f,d)},e(F.prototype,{create:function(){1===arguments.length?arguments[0]instanceof Array?arguments[0]:P(arguments[0],A)&&arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return F}}),e(G.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return G}}),e(z.prototype,{isGeometryCollection:function(){return this.getSortIndex()===z.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(1===arguments.length){if(arguments[0]instanceof z){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof z))return!1;var n=e;return this.equalsExact(n)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(z.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return null!==t&&this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];e=n;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,i)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===z.SORTINDEX_GEOMETRYCOLLECTION)throw new i("This method does not support GeometryCollection arguments")},equal:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),new E(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===z.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===z.SORTINDEX_MULTIPOINT||this.getSortIndex()===z.SORTINDEX_MULTILINESTRING||this.getSortIndex()===z.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[s,o,h]},getClass:function(){return z}}),z.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},z.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},z.serialVersionUID=0x799ea46522854c00,z.SORTINDEX_POINT=0,z.SORTINDEX_MULTIPOINT=1,z.SORTINDEX_LINESTRING=2,z.SORTINDEX_LINEARRING=3,z.SORTINDEX_MULTILINESTRING=4,z.SORTINDEX_POLYGON=5,z.SORTINDEX_MULTIPOLYGON=6,z.SORTINDEX_GEOMETRYCOLLECTION=7,z.geometryChangedFilter={interfaces_:function(){return[G]},filter:function(t){t.geometryChangedAction()}},e(j.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return j}}),e(B.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return B}}),e(H.prototype,{isInBoundary:function(t){return t%2==1},interfaces_:function(){return[B]},getClass:function(){return H}}),e(V.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[B]},getClass:function(){return V}}),e(q.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[B]},getClass:function(){return q}}),e(W.prototype,{isInBoundary:function(t){return 1===t},interfaces_:function(){return[B]},getClass:function(){return W}}),B.Mod2BoundaryNodeRule=H,B.EndPointBoundaryNodeRule=V,B.MultiValentEndPointBoundaryNodeRule=q,B.MonoValentEndPointBoundaryNodeRule=W,B.MOD2_BOUNDARY_RULE=new H,B.ENDPOINT_BOUNDARY_RULE=new V,B.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new q,B.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new W,B.OGC_SFS_BOUNDARY_RULE=B.MOD2_BOUNDARY_RULE,e(Z.prototype,{interfaces_:function(){return[]},getClass:function(){return Z}}),Z.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Z.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Z.indexOf(i,e)<0)return i}return null},Z.scroll=function(t,e){var n=Z.indexOf(e,t);if(0>n)return null;var i=new Array(t.length).fill(null);D.arraycopy(t,n,i,0,t.length-n),D.arraycopy(t,0,i,t.length-n,n),D.arraycopy(i,0,t,0,t.length)},Z.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(n=0;n<i.length;n++)if(0!==o.compare(i[n],r[n]))return!1;return!0}},Z.intersection=function(t,e){for(var n=new C,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Z.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Z.removeRepeatedPoints=function(t){return Z.hasRepeatedPoints(t)?new C(t,!1).toCoordinateArray():t},Z.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;n>=i;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Z.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;var r=0;for(n=0;n<t.length;n++)null!==t[n]&&(i[r++]=t[n]);return i},Z.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new p(t[n]);return e}if(5===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4];for(n=0;a>n;n++)o[s+n]=new p(i[r+n])}},Z.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Z.envelope=function(t){for(var e=new E,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Z.toCoordinateArray=function(t){return t.toArray(Z.coordArrayType)},Z.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Z.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Z.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Z.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Z.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Z.extract=function(t,e,n){e=M.clamp(e,0,t.length);var i=(n=M.clamp(n,-1,t.length))-e+1;0>n&&(i=0),e>=t.length&&(i=0),e>n&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;n>=s;s++)r[o++]=t[s];return r},e(U.prototype,{compare:function(t,e){var n=t,i=e;return Z.compare(n,i)},interfaces_:function(){return[a]},getClass:function(){return U}}),e(Y.prototype,{compare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Z.compare(n,i);return Z.isEqualReversed(n,i)?0:r},OLDcompare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Z.increasingDirection(n),o=Z.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,h=0;h<n.length;h++){var u=n[s].compareTo(i[a]);if(0!==u)return u;s+=r,a+=o}return 0},interfaces_:function(){return[a]},getClass:function(){return Y}}),Z.ForwardComparator=U,Z.BidirectionalComparator=Y,Z.coordArrayType=new Array(0).fill(null),X.prototype.get=function(){},X.prototype.put=function(){},X.prototype.size=function(){},X.prototype.values=function(){},X.prototype.entrySet=function(){},J.prototype=new X,K.prototype=new y,K.prototype.contains=function(){},Q.prototype=new K,Q.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++){if(this.array_[e]===t)return!0}return!1},Q.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},Q.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Q.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},Q.prototype.size=function(){return this.array_.length},Q.prototype.isEmpty=function(){return 0===this.array_.length},Q.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},Q.prototype.iterator=function(){return new Ao(this)};var Ao=function(t){this.hashSet_=t,this.position_=0};Ao.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new _;return this.hashSet_.array_[this.position_++]},Ao.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},Ao.prototype.remove=function(){throw new x};var Do=0;rt.prototype=new J,rt.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(0>n)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},rt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Do,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,0>(i=t.compareTo(r.key)))r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Do,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>i?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},rt.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;)if(tt(t)==nt(tt(tt(t)))){1==$(e=it(tt(tt(t))))?(et(tt(t),Do),et(e,Do),et(tt(tt(t)),1),t=tt(tt(t))):(t==it(tt(t))&&(t=tt(t),this.rotateLeft(t)),et(tt(t),Do),et(tt(tt(t)),1),this.rotateRight(tt(tt(t))))}else{var e;1==$(e=nt(tt(tt(t))))?(et(tt(t),Do),et(e,Do),et(tt(tt(t)),1),t=tt(tt(t))):(t==nt(tt(t))&&(t=tt(t),this.rotateRight(t)),et(tt(t),Do),et(tt(tt(t)),1),this.rotateLeft(tt(tt(t))))}this.root_.color=Do},rt.prototype.values=function(){var t=new w,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=rt.successor(e));)t.add(e.value);return t},rt.prototype.entrySet=function(){var t=new Q,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=rt.successor(e));)t.add(e);return t},rt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},rt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},rt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},rt.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},rt.prototype.size=function(){return this.size_},e(ot.prototype,{interfaces_:function(){return[]},getClass:function(){return ot}}),st.prototype=new K,at.prototype=new st,at.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},at.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;n>e;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},at.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},at.prototype.remove=function(t){throw new x},at.prototype.size=function(){return this.array_.length},at.prototype.isEmpty=function(){return 0===this.array_.length},at.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},at.prototype.iterator=function(){return new ko(this)};var ko=function(t){this.treeSet_=t,this.position_=0};ko.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new _;return this.treeSet_.array_[this.position_++]},ko.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},ko.prototype.remove=function(){throw new x},ht.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)return i=function(t,e){return t.compareTo(e)},void r.sort(i);if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else{if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t]);return}if(4===arguments.length){for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t]);return}}},ht.asList=function(t){for(var e=new w,n=0,i=t.length;i>n;n++)e.add(t[n]);return e},e(ut.prototype,{interfaces_:function(){return[]},getClass:function(){return ut}}),ut.toDimensionSymbol=function(t){switch(t){case ut.FALSE:return ut.SYM_FALSE;case ut.TRUE:return ut.SYM_TRUE;case ut.DONTCARE:return ut.SYM_DONTCARE;case ut.P:return ut.SYM_P;case ut.L:return ut.SYM_L;case ut.A:return ut.SYM_A}throw new i("Unknown dimension value: "+t)},ut.toDimensionValue=function(t){switch(N.toUpperCase(t)){case ut.SYM_FALSE:return ut.FALSE;case ut.SYM_TRUE:return ut.TRUE;case ut.SYM_DONTCARE:return ut.DONTCARE;case ut.SYM_P:return ut.P;case ut.SYM_L:return ut.L;case ut.SYM_A:return ut.A}throw new i("Unknown dimension symbol: "+t)},ut.P=0,ut.L=1,ut.A=2,ut.FALSE=-1,ut.TRUE=-2,ut.DONTCARE=-3,ut.SYM_FALSE="F",ut.SYM_TRUE="T",ut.SYM_DONTCARE="*",ut.SYM_P="0",ut.SYM_L="1",ut.SYM_A="2",e(lt.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return lt}}),e(ct.prototype,{filter:function(t,e){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return ct}}),l(ft,z),e(ft.prototype,{computeEnvelopeInternal:function(){for(var t=new E,e=0;e<this.geometries.length;e++)t.expandToInclude(this.geometries[e].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return z.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this.geometries.length;n++)for(var i=this.geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},getArea:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getArea();return t},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.geometries.length!==n.geometries.length)return!1;for(var i=0;i<this.geometries.length;i++)if(!this.geometries[i].equalsExact(n.geometries[i],e))return!1;return!0}return z.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();ht.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=ut.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getBoundaryDimension());return t},getDimension:function(){for(var t=ut.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getDimension());return t},getLength:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getLength();return t},getNumPoints:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=new at(ht.asList(this.geometries)),n=new at(ht.asList(t.geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,s=this.getNumGeometries(),a=o.getNumGeometries(),h=0;s>h&&a>h;){var u=this.getGeometryN(h),l=o.getGeometryN(h),c=u.compareToSameClass(l,r);if(0!==c)return c;h++}return s>h?1:a>h?-1:0}},apply:function(){if(P(arguments[0],j))for(var t=arguments[0],e=0;e<this.geometries.length;e++)this.geometries[e].apply(t);else if(P(arguments[0],ct)){var n=arguments[0];if(0===this.geometries.length)return null;for(e=0;e<this.geometries.length&&(this.geometries[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],lt)){var i=arguments[0];i.filter(this);for(e=0;e<this.geometries.length;e++)this.geometries[e].apply(i)}else if(P(arguments[0],G)){var r=arguments[0];r.filter(this);for(e=0;e<this.geometries.length;e++)this.geometries[e].apply(r)}},getBoundary:function(){return this.checkNotGeometryCollection(this),f.shouldNeverReachHere(),null},clone:function(){var t=z.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var e=0;e<this.geometries.length;e++)t.geometries[e]=this.geometries[e].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new ft(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return ft}}),ft.serialVersionUID=-0x4f07bcb1f857d800,l(pt,ft),e(pt.prototype,{getSortIndex:function(){return z.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?ut.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[t-1-n]=this.geometries[n].reverse();return this.getFactory().createMultiLineString(e)},getBoundary:function(){return new dt(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new pt(t,this.factory)},interfaces_:function(){return[ot]},getClass:function(){return pt}}),pt.serialVersionUID=0x7155d2ab4afa8000,e(dt.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPointFromCoords(e)},getBoundary:function(){return this.geom instanceof _t?this.boundaryLineString(this.geom):this.geom instanceof pt?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){return this.geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint():this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var e=new w;this.endpointMap=new rt;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this.endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this.bnRule.isInBoundary(s)&&e.add(o.getKey())}return Z.toCoordinateArray(e)},addEndpoint:function(t){var e=this.endpointMap.get(t);null===e&&(e=new gt,this.endpointMap.put(t,e)),e.count++},interfaces_:function(){return[]},getClass:function(){return dt}}),dt.getBoundary=function(){return 1===arguments.length?new dt(arguments[0]).getBoundary():2===arguments.length?new dt(arguments[0],arguments[1]).getBoundary():void 0},e(gt.prototype,{interfaces_:function(){return[]},getClass:function(){return gt}}),e(mt.prototype,{interfaces_:function(){return[]},getClass:function(){return mt}}),mt.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;e>i;i++)n[i]=t;return new String(n)},mt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(mt.getStackTrace(i))),a=0;r>a;a++)try{o+=s.readLine()+mt.NEWLINE}catch(t){if(!(t instanceof yt))throw t;f.shouldNeverReachHere()}return o}},mt.split=function(t,e){for(var n=e.length,i=new w,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),h=0;h<a.length;h++)a[h]=i.get(h);return a},mt.toString=function(){if(1===arguments.length){var t=arguments[0];return mt.SIMPLE_ORDINATE_FORMAT.format(t)}},mt.spaces=function(t){return mt.chars(" ",t)},mt.NEWLINE=D.getProperty("line.separator"),mt.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),e(vt.prototype,{interfaces_:function(){return[]},getClass:function(){return vt}}),vt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;r>o;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},vt.isRing=function(t){var e=t.size();return 0===e||!(3>=e)&&(t.getOrdinate(0,A.X)===t.getOrdinate(e-1,A.X)&&t.getOrdinate(0,A.Y)===t.getOrdinate(e-1,A.Y))},vt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),o=0;n>o;o++)for(var s=0;i>s;s++){var a=t.getOrdinate(o,s),h=e.getOrdinate(o,s);if(!(t.getOrdinate(o,s)===e.getOrdinate(o,s)||r.isNaN(a)&&r.isNaN(h)))return!1}return!0},vt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(vt.copy(e,0,i,0,r),r>0)for(var o=r;n>o;o++)vt.copy(e,r-1,i,o,1);return i},vt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;n>=i;i++)vt.swap(t,i,e-i)},vt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},vt.copy=function(t,e,n,i,r){for(var o=0;r>o;o++)vt.copyCoord(t,e+o,n,i+o)},vt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new T;i.append("(");for(var r=0;e>r;r++){r>0&&i.append(" ");for(var o=0;n>o;o++)o>0&&i.append(","),i.append(mt.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},vt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:3>=n?vt.createClosedRing(t,e,4):e.getOrdinate(0,A.X)===e.getOrdinate(n-1,A.X)&&e.getOrdinate(0,A.Y)===e.getOrdinate(n-1,A.Y)?e:vt.createClosedRing(t,e,n+1)},vt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();vt.copy(e,0,i,0,r);for(var o=r;n>o;o++)vt.copy(e,0,i,o,1);return i},l(_t,z),e(_t.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new E:this.points.expandEnvelope(new E)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return z.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.points.size()!==n.points.size())return!1;for(var i=0;i<this.points.size();i++)if(!this.equal(this.points.getCoordinate(i),n.points.getCoordinate(i),e))return!1;return!0}return z.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var e=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(e)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(e))>0&&vt.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?ut.FALSE:0},isClosed:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return Ut.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();return vt.reverse(t),this.getFactory().createLineString(t)},compareToSameClass:function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this.points.size()&&n<t.points.size();){var i=this.points.getCoordinate(e).compareTo(t.points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this.points.size()?1:n<t.points.size()?-1:0}if(2===arguments.length){t=arguments[0];return arguments[1].compare(this.points,t.points)}},apply:function(){if(P(arguments[0],j))for(var t=arguments[0],e=0;e<this.points.size();e++)t.filter(this.points.getCoordinate(e));else if(P(arguments[0],ct)){var n=arguments[0];if(0===this.points.size())return null;for(e=0;e<this.points.size()&&(n.filter(this.points,e),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],lt)){arguments[0].filter(this)}else if(P(arguments[0],G)){arguments[0].filter(this)}},getBoundary:function(){return new dt(this).getBoundary()},isEquivalentClass:function(t){return t instanceof _t},clone:function(){var t=z.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new _t(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return 0===this.points.size()},init:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new i("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var e=0;e<this.points.size();e++)if(this.points.getCoordinate(e).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[ot]},getClass:function(){return _t}}),_t.serialVersionUID=0x2b2b51ba435c8e00,e(xt.prototype,{interfaces_:function(){return[]},getClass:function(){return xt}}),l(wt,z),e(wt.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new E;var t=new E;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return z.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return z.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return 0!==this.coordinates.size()?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return ut.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){t=arguments[0];return arguments[1].compare(this.coordinates,t.coordinates)}},apply:function(){if(P(arguments[0],j)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(P(arguments[0],ct)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],lt)){arguments[0].filter(this)}else if(P(arguments[0],G)){arguments[0].filter(this)}},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=z.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new wt(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return 0===this.coordinates.size()},init:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),f.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[xt]},getClass:function(){return wt}}),wt.serialVersionUID=0x44077bad161cbc00,e(Ct.prototype,{interfaces_:function(){return[]},getClass:function(){return Ct}}),l(Et,z),e(Et.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return z.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this.shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this.holes.length;r++)for(var o=this.holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},getArea:function(){var t=0;t+=Math.abs(Ut.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(Ut.signedArea(this.holes[e].getCoordinateSequence()));return t},isRectangle:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this.shell)return!1;if(5!==this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;5>n;n++){if((o=t.getX(n))!==e.getMinX()&&o!==e.getMaxX())return!1;if((s=t.getY(n))!==e.getMinY()&&s!==e.getMaxY())return!1}var i=t.getX(0),r=t.getY(0);for(n=1;4>=n;n++){var o,s;if((o=t.getX(n))!==i===((s=t.getY(n))!==r))return!1;i=o,r=s}return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this.shell,r=n.shell;if(!i.equalsExact(r,e))return!1;if(this.holes.length!==n.holes.length)return!1;for(var o=0;o<this.holes.length;o++)if(!this.holes[o].equalsExact(n.holes[o],e))return!1;return!0}return z.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(0===arguments.length){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);ht.sort(this.holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);D.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Z.minCoordinate(e.getCoordinates());Z.scroll(i,r),D.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],Ut.isCCW(e.getCoordinates())===n&&Z.reverse(e.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=this.shell,n=t.shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,s=(e=this.shell,n=o.shell,e.compareToSameClass(n,r));if(0!==s)return s;for(var a=this.getNumInteriorRing(),h=o.getNumInteriorRing(),u=0;a>u&&h>u;){var l=this.getInteriorRingN(u),c=o.getInteriorRingN(u),f=l.compareToSameClass(c,r);if(0!==f)return f;u++}return a>u?1:h>u?-1:0}},apply:function(){if(P(arguments[0],j)){var t=arguments[0];this.shell.apply(t);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(t)}else if(P(arguments[0],ct)){var n=arguments[0];if(this.shell.apply(n),!n.isDone())for(e=0;e<this.holes.length&&(this.holes[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(P(arguments[0],lt)){arguments[0].filter(this)}else if(P(arguments[0],G)){var i=arguments[0];i.filter(this),this.shell.apply(i);for(e=0;e<this.holes.length;e++)this.holes[e].apply(i)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var e=0;e<this.holes.length;e++)t[e+1]=this.holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=z.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),e=new Array(this.holes.length).fill(null),n=0;n<e.length;n++)e[n]=this.holes[n].copy();return new Et(t,e,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[Ct]},getClass:function(){return Et}}),Et.serialVersionUID=-0x307ffefd8dc97200,l(St,ft),e(St.prototype,{getSortIndex:function(){return z.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.geometries[t].getCoordinate()}return ft.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return ut.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new St(t,this.factory)},interfaces_:function(){return[xt]},getClass:function(){return St}}),St.serialVersionUID=-0x6fb1ed4162e0fc00,l(It,_t),e(It.prototype,{getSortIndex:function(){return z.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return ut.FALSE},isClosed:function(){return!!this.isEmpty()||_t.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();return vt.reverse(t),this.getFactory().createLinearRing(t)},validateConstruction:function(){if(!this.isEmpty()&&!_t.prototype.isClosed.call(this))throw new i("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<It.MINIMUM_VALID_SIZE)throw new i("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new It(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return It}}),It.MINIMUM_VALID_SIZE=4,It.serialVersionUID=-0x3b229e262367a600,l(bt,ft),e(bt.prototype,{getSortIndex:function(){return z.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new w,e=0;e<this.geometries.length;e++)for(var n=this.geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new bt(t,this.factory)},interfaces_:function(){return[Ct]},getClass:function(){return bt}}),bt.serialVersionUID=-0x7a5aa1369171980,e(Pt.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this.isUserDataCopied&&n.setUserData(t.getUserData()),n},editInternal:function(t,e){return null===this.factory&&(this.factory=t.getFactory()),t instanceof ft?this.editGeometryCollection(t,e):t instanceof Et?this.editPolygon(t,e):t instanceof wt?e.edit(t,this.factory):t instanceof _t?e.edit(t,this.factory):(f.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,e){for(var n=e.edit(t,this.factory),i=new w,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===St?this.factory.createMultiPoint(i.toArray([])):n.getClass()===pt?this.factory.createMultiLineString(i.toArray([])):n.getClass()===bt?this.factory.createMultiPolygon(i.toArray([])):this.factory.createGeometryCollection(i.toArray([]))},editPolygon:function(t,e){var n=e.edit(t,this.factory);if(null===n&&(n=this.factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this.factory.createPolygon();for(var r=new w,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this.factory.createPolygon(i,r.toArray([]))},interfaces_:function(){return[]},getClass:function(){return Pt}}),Pt.GeometryEditorOperation=Mt,e(Tt.prototype,{edit:function(t,e){return t},interfaces_:function(){return[Mt]},getClass:function(){return Tt}}),e(Lt.prototype,{edit:function(t,e){if(t instanceof It)return e.createLinearRing(this.editCoordinates(t.getCoordinates(),t));if(t instanceof _t)return e.createLineString(this.editCoordinates(t.getCoordinates(),t));if(t instanceof wt){var n=this.editCoordinates(t.getCoordinates(),t);return n.length>0?e.createPoint(n[0]):e.createPoint()}return t},interfaces_:function(){return[Mt]},getClass:function(){return Lt}}),e(Nt.prototype,{edit:function(t,e){return t instanceof It?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof _t?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof wt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[Mt]},getClass:function(){return Nt}}),Pt.NoOpGeometryOperation=Tt,Pt.CoordinateOperation=Lt,Pt.CoordinateSequenceOperation=Nt,e(Rt.prototype,{setOrdinate:function(t,e,n){switch(e){case A.X:this.coordinates[t].x=n;break;case A.Y:this.coordinates[t].y=n;break;case A.Z:this.coordinates[t].z=n;break;default:throw new i("invalid ordinateIndex")}},size:function(){return this.coordinates.length},getOrdinate:function(t,e){switch(e){case A.X:return this.coordinates[t].x;case A.Y:return this.coordinates[t].y;case A.Z:return this.coordinates[t].z}return r.NaN},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this.coordinates[e].x,n.y=this.coordinates[e].y,n.z=this.coordinates[e].z}},getCoordinateCopy:function(t){return new p(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].clone();return new Rt(t,this.dimension)},expandEnvelope:function(t){for(var e=0;e<this.coordinates.length;e++)t.expandToInclude(this.coordinates[e]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].copy();return new Rt(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new T(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var e=1;e<this.coordinates.length;e++)t.append(", "),t.append(this.coordinates[e]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[A,h]},getClass:function(){return Rt}}),Rt.serialVersionUID=-0xcb44a778db18e00,e(Ot.prototype,{readResolve:function(){return Ot.instance()},create:function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Rt(arguments[0]);if(P(arguments[0],A))return new Rt(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),2>e?new Rt(t):new Rt(t,e)}},interfaces_:function(){return[F,h]},getClass:function(){return Ot}}),Ot.instance=function(){return Ot.instanceObject},Ot.serialVersionUID=-0x38e49fa6cf6f2e00,Ot.instanceObject=new Ot;var Fo,Go=Object.defineProperty,zo=function(t,e){function n(t){return this&&this.constructor===n?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,void(t&&function(t){this.add?t.forEach(this.add,this):t.forEach(function(t){this.set(t[0],t[1])},this)}.call(this,t))):new n(t)}return e||Go(t,"size",{get:kt}),t.constructor=n,n.prototype=t,n}({delete:function(t){return this.has(t)&&(this._keys.splice(Fo,1),this._values.splice(Fo,1),this._itp.forEach(function(t){Fo<t[0]&&t[0]--})),Fo>-1},has:function(t){return function(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(Fo=t.length;Fo--&&!At(t[Fo],e););else Fo=t.indexOf(e);return Fo>-1}.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[Fo]:void 0},set:function(t,e){return this.has(t)?this._values[Fo]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return Dt(this._itp,this._keys)},values:function(){return Dt(this._itp,this._values)},entries:function(){return Dt(this._itp,this._keys,this._values)},forEach:function(t,e){for(var n=this.entries();;){var i=n.next();if(i.done)break;t.call(e,i.value[1],i.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}}),jo="undefined"!=typeof Map&&Map.prototype.values?Map:zo;Ft.prototype=new X,Ft.prototype.get=function(t){return this.map_.get(t)||null},Ft.prototype.put=function(t,e){return this.map_.set(t,e),e},Ft.prototype.values=function(){for(var t=new w,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Ft.prototype.entrySet=function(){var t=new Q;return this.map_.entries().forEach(function(e){return t.add(e)}),t},Ft.prototype.size=function(){return this.map_.size()},e(Gt.prototype,{equals:function(t){if(!(t instanceof Gt))return!1;var e=t;return this.modelType===e.modelType&&this.scale===e.scale},compareTo:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new L(n).compareTo(new L(i))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===Gt.FLOATING||this.modelType===Gt.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===Gt.FLOATING?t="Floating":this.modelType===Gt.FLOATING_SINGLE?t="Floating-Single":this.modelType===Gt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if("number"==typeof arguments[0]){var t=arguments[0];return r.isNaN(t)?t:this.modelType===Gt.FLOATING_SINGLE?t:this.modelType===Gt.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof p){var e=arguments[0];if(this.modelType===Gt.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===Gt.FLOATING?t=16:this.modelType===Gt.FLOATING_SINGLE?t=6:this.modelType===Gt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[h,o]},getClass:function(){return Gt}}),Gt.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},e(zt.prototype,{readResolve:function(){return zt.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[h]},getClass:function(){return zt}}),zt.serialVersionUID=-552860263173159e4,zt.nameToTypeMap=new Ft,Gt.Type=zt,Gt.serialVersionUID=0x6bee6404e9a25c00,Gt.FIXED=new zt("FIXED"),Gt.FLOATING=new zt("FLOATING"),Gt.FLOATING_SINGLE=new zt("FLOATING SINGLE"),Gt.maximumPreciseValue=9007199254740992,e(jt.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new p(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new p(t.getMinX(),t.getMinY()),new p(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new p(t.getMinX(),t.getMinY()),new p(t.getMinX(),t.getMaxY()),new p(t.getMaxX(),t.getMaxY()),new p(t.getMaxX(),t.getMinY()),new p(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(P(arguments[0],A))return new _t(arguments[0],this)}},createMultiLineString:function(){return 0===arguments.length?new pt(null,this):1===arguments.length?new pt(arguments[0],this):void 0},buildGeometry:function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(jt.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Et)return this.createMultiPolygon(jt.toPolygonArray(t));if(a instanceof _t)return this.createMultiLineString(jt.toLineStringArray(t));if(a instanceof wt)return this.createMultiPoint(jt.toPointArray(t));f.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},createMultiPointFromCoords:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof p){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(P(arguments[0],A))return new wt(arguments[0],this)}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(0===arguments.length)return new Et(null,null,this);if(1===arguments.length){if(P(arguments[0],A)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof It){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){return new Et(arguments[0],arguments[1],this)}},getSRID:function(){return this.SRID},createGeometryCollection:function(){return 0===arguments.length?new ft(null,this):1===arguments.length?new ft(arguments[0],this):void 0},createGeometry:function(t){return new Pt(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return arguments[1],this.coordinateSequenceFactory.create(t)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(P(arguments[0],A))return new It(arguments[0],this)}},createMultiPolygon:function(){return 0===arguments.length?new bt(null,this):1===arguments.length?new bt(arguments[0],this):void 0},createMultiPoint:function(){if(0===arguments.length)return new St(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new St(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(P(arguments[0],A)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());vt.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},interfaces_:function(){return[h]},getClass:function(){return jt}}),jt.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.getDefaultCoordinateSequenceFactory=function(){return Ot.instance()},jt.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},jt.serialVersionUID=-0x5ea75f2051eeb400;var Bo={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};e(Bt.prototype,{read:function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Bo.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Bo.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Vo[n]&&(e=Vo[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var e=t.getGeometryType().toLowerCase();if(!Ho[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Ho[e].apply(this,[t])+")"}});var Ho={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Ho.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ho.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(Ho.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(Ho.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ho.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Ho.linestring.apply(this,[t.shell])+")");for(var n=0,i=t.holes.length;i>n;++n)e.push("("+Ho.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ho.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push(this.extractGeometry(t.geometries[n]));return e.join(",")}},Vo={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Bo.spaces);return this.geometryFactory.createPoint(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(Bo.trimParens,"$1"),i.push(Vo.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].trim().split(Bo.spaces),i.push(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;o>r;++r)e=n[r].trim().split(Bo.spaces),i.push(new p(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Bo.parenComma),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(Bo.trimParens,"$1"),i.push(Vo.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(Bo.parenComma),s=[],a=0,h=o.length;h>a;++a)e=o[a].replace(Bo.trimParens,"$1"),n=Vo.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n.points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Bo.doubleParenComma),i=[],r=0,o=n.length;o>r;++r)e=n[r].replace(Bo.trimParens,"$1"),i.push(Vo.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;r>i;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};e(Ht.prototype,{write:function(t){return this.parser.write(t)}}),e(Ht,{toLineString:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}),e(Vt.prototype,{getIndexAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},getTopologySummary:function(){var t=new T;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,e,n,i){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=i,this.result=this.computeIntersect(t,e,n,i)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(0===arguments.length)null===this.intLineIndex&&(this.intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==Vt.NO_INTERSECTION},getEdgeDistance:function(t,e){return Vt.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},isCollinear:function(){return this.result===Vt.COLLINEAR_INTERSECTION},toString:function(){return Ht.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+Ht.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,e){return this.inputLines[t][e]},isIntersection:function(t){for(var e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][e]]},interfaces_:function(){return[]},getClass:function(){return Vt}}),Vt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return f.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},Vt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return f.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},Vt.DONT_INTERSECT=0,Vt.DO_INTERSECT=1,Vt.COLLINEAR=2,Vt.NO_INTERSECTION=0,Vt.POINT_INTERSECTION=1,Vt.COLLINEAR_INTERSECTION=2,l(qt,Vt),e(qt.prototype,{isInSegmentEnvelopes:function(t){var e=new E(this.inputLines[0][0],this.inputLines[0][1]),n=new E(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},computeIntersection:function(){if(3!==arguments.length)return Vt.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];return this._isProper=!1,E.intersects(e,n,t)&&0===Ut.orientationIndex(e,n,t)&&0===Ut.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this.result=Vt.POINT_INTERSECTION,null):void(this.result=Vt.NO_INTERSECTION)},normalizeToMinimum:function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},safeHCoordinateIntersection:function(t,e,n,i){var r=null;try{r=k.intersection(t,e,n,i)}catch(o){if(!(o instanceof I))throw o;r=qt.nearestEndpoint(t,e,n,i)}return r},intersection:function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new p(qt.nearestEndpoint(t,e,n,i))),null!==this.precisionModel&&this.precisionModel.makePrecise(r),r},smallestInAbsValue:function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},checkDD:function(t,e,n,i,r){var o=O.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);D.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&D.out.println("Distance = "+r.distance(o))},intersectionWithNormalization:function(t,e,n,i){var r=new p(t),o=new p(e),s=new p(n),a=new p(i),h=new p;this.normalizeToEnvCentre(r,o,s,a,h);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=h.x,u.y+=h.y,u},computeCollinearIntersection:function(t,e,n,i){var r=E.intersects(t,e,n),o=E.intersects(t,e,i),s=E.intersects(n,i,t),a=E.intersects(n,i,e);return r&&o?(this.intPt[0]=n,this.intPt[1]=i,Vt.COLLINEAR_INTERSECTION):s&&a?(this.intPt[0]=t,this.intPt[1]=e,Vt.COLLINEAR_INTERSECTION):r&&s?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||o||a?Vt.COLLINEAR_INTERSECTION:Vt.POINT_INTERSECTION):r&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||o||s?Vt.COLLINEAR_INTERSECTION:Vt.POINT_INTERSECTION):o&&s?(this.intPt[0]=i,this.intPt[1]=t,!i.equals(t)||r||a?Vt.COLLINEAR_INTERSECTION:Vt.POINT_INTERSECTION):o&&a?(this.intPt[0]=i,this.intPt[1]=e,!i.equals(e)||r||s?Vt.COLLINEAR_INTERSECTION:Vt.POINT_INTERSECTION):Vt.NO_INTERSECTION},normalizeToEnvCentre:function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,h=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,l=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,p=((o>u?o:u)+(c>a?a:c))/2,d=((s>l?s:l)+(f>h?h:f))/2;r.x=p,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},computeIntersect:function(t,e,n,i){if(this._isProper=!1,!E.intersects(t,e,n,i))return Vt.NO_INTERSECTION;var r=Ut.orientationIndex(t,e,n),o=Ut.orientationIndex(t,e,i);if(r>0&&o>0||0>r&&0>o)return Vt.NO_INTERSECTION;var s=Ut.orientationIndex(n,i,t),a=Ut.orientationIndex(n,i,e);return s>0&&a>0||0>s&&0>a?Vt.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this.intPt[0]=e:0===r?this.intPt[0]=new p(n):0===o?this.intPt[0]=new p(i):0===s?this.intPt[0]=new p(t):0===a&&(this.intPt[0]=new p(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,i)),Vt.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return qt}}),qt.nearestEndpoint=function(t,e,n,i){var r=t,o=Ut.distancePointLine(t,n,i),s=Ut.distancePointLine(e,n,i);return o>s&&(o=s,r=e),o>(s=Ut.distancePointLine(n,t,e))&&(o=s,r=n),o>(s=Ut.distancePointLine(i,t,e))&&(o=s,r=i),r},e(Wt.prototype,{interfaces_:function(){return[]},getClass:function(){return Wt}}),Wt.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return Wt.signOfDet2x2(i,r,o,s)},Wt.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?i>=e||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):-i>=e?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?i>=-e?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(n>=t))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if(1,n-=(s=Math.floor(n/t))*t,0>(i-=s*e))return-r;if(i>e)return r;if(t>n+n){if(i+i>e)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(t-=(s=Math.floor(t/n))*n,0>(e-=s*i))return r;if(e>i)return-r;if(n>t+t){if(e+e>i)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}},e(Zt.prototype,{countSegment:function(t,e){if(t.x<this.p.x&&e.x<this.p.x)return null;if(this.p.x===e.x&&this.p.y===e.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this.p.x>=n&&this.p.x<=i&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var r=t.x-this.p.x,o=t.y-this.p.y,s=e.x-this.p.x,a=e.y-this.p.y,h=Wt.signOfDet2x2(r,o,s,a);if(0===h)return this.isPointOnSegment=!0,null;o>a&&(h=-h),h>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==b.EXTERIOR},getLocation:function(){return this.isPointOnSegment?b.BOUNDARY:this.crossingCount%2==1?b.INTERIOR:b.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return Zt}}),Zt.locatePointInRing=function(){if(arguments[0]instanceof p&&P(arguments[1],A)){for(var t=arguments[0],e=arguments[1],n=new Zt(t),i=new p,r=new p,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof p&&arguments[1]instanceof Array){var s=arguments[0],a=arguments[1];for(n=new Zt(s),o=1;o<a.length;o++){i=a[o],r=a[o-1];if(n.countSegment(i,r),n.isOnSegment())return n.getLocation()}return n.getLocation()}},e(Ut.prototype,{interfaces_:function(){return[]},getClass:function(){return Ut}}),Ut.orientationIndex=function(t,e,n){return O.orientationIndex(t,e,n)},Ut.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(P(arguments[0],A)){var s=arguments[0],a=s.size();if(3>a)return 0;var h=new p,u=new p,l=new p;s.getCoordinate(0,u),s.getCoordinate(1,l);n=u.x;l.x-=n;for(e=0,i=1;a-1>i;i++)h.y=u.y,u.x=l.x,u.y=l.y,s.getCoordinate(i+1,l),l.x-=n,e+=u.x*(h.y-l.y);return e/2}},Ut.distanceLineLine=function(t,e,n,i){if(t.equals(e))return Ut.distancePointLine(t,n,i);if(n.equals(i))return Ut.distancePointLine(i,t,e);var r=!1;if(E.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,h=s/o;(0>h||h>1||0>a||a>1)&&(r=!0)}}else r=!0;return r?M.min(Ut.distancePointLine(t,n,i),Ut.distancePointLine(e,n,i),Ut.distancePointLine(n,t,e),Ut.distancePointLine(i,t,e)):0},Ut.isPointInRing=function(t,e){return Ut.locatePointInRing(t,e)!==b.EXTERIOR},Ut.computeLength=function(t){var e=t.size();if(1>=e)return 0;var n=0,i=new p;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;e>s;s++){t.getCoordinate(s,i);var a=i.x,h=i.y,u=a-r,l=h-o;n+=Math.sqrt(u*u+l*l),r=a,o=h}return n},Ut.isCCW=function(t){var e=t.length-1;if(3>e)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,o=1;e>=o;o++){var s=t[o];s.y>n.y&&(n=s,r=o)}var a=r;do{0>(a-=1)&&(a=e)}while(t[a].equals2D(n)&&a!==r);var h=r;do{h=(h+1)%e}while(t[h].equals2D(n)&&h!==r);var u=t[a],l=t[h];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var c=Ut.computeOrientation(u,n,l);return 0===c?u.x>l.x:c>0},Ut.locatePointInRing=function(t,e){return Zt.locatePointInRing(t,e)},Ut.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},Ut.computeOrientation=function(t,e,n){return Ut.orientationIndex(t,e,n)},Ut.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new i("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var o=Ut.distancePointLine(t,e[r],e[r+1]);n>o&&(n=o)}return n}if(3===arguments.length){var s=arguments[0],a=arguments[1],h=arguments[2];if(a.x===h.x&&a.y===h.y)return s.distance(a);var u=(h.x-a.x)*(h.x-a.x)+(h.y-a.y)*(h.y-a.y),l=((s.x-a.x)*(h.x-a.x)+(s.y-a.y)*(h.y-a.y))/u;if(0>=l)return s.distance(a);if(l>=1)return s.distance(h);var c=((a.y-s.y)*(h.x-a.x)-(a.x-s.x)*(h.y-a.y))/u;return Math.abs(c)*Math.sqrt(u)}},Ut.isOnLine=function(t,e){for(var n=new qt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},Ut.CLOCKWISE=-1,Ut.RIGHT=Ut.CLOCKWISE,Ut.COUNTERCLOCKWISE=1,Ut.LEFT=Ut.COUNTERCLOCKWISE,Ut.COLLINEAR=0,Ut.STRAIGHT=Ut.COLLINEAR,e(Yt.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof Yt){var t=arguments[0],e=Ut.orientationIndex(this.p0,this.p1,t.p0),n=Ut.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):0>=e&&0>=n?Math.max(e,n):0}if(arguments[0]instanceof p){var i=arguments[0];return Ut.orientationIndex(this.p0,this.p1,i)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof Yt))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},intersection:function(t){var e=new qt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},project:function(){if(arguments[0]instanceof p){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new p(t);var e=this.projectionFactor(t),n=new p;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Yt){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(0>=r&&0>=o)return null;var s=this.project(i.p0);0>r&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return 0>o&&(a=this.p0),o>1&&(a=this.p1),new Yt(s,a)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return 0===t?this.p0:this.p1},distancePerpendicular:function(t){return Ut.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return Yt.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return 0>=i?r.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},closestPoints:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=r.MAX_VALUE,o=null,s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;var a=this.closestPoint(t.p1);i>(o=a.distance(t.p1))&&(i=o,n[0]=a,n[1]=t.p1);var h=t.closestPoint(this.p0);i>(o=h.distance(this.p0))&&(i=o,n[0]=this.p0,n[1]=h);var u=t.closestPoint(this.p1);return i>(o=u.distance(this.p1))&&(i=o,n[0]=this.p1,n[1]=u),n},closestPoint:function(t){var e=this.projectionFactor(t);if(e>0&&1>e)return this.project(t);var n=this.p0.distance(t);return this.p1.distance(t)>n?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{return k.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof I))throw t}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,h=0;if(0!==e){if(0>=s)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/s,h=e*o/s}return new p(n-h,i+a)},setCoordinates:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},segmentFraction:function(t){var e=this.projectionFactor(t);return 0>e?e=0:(e>1||r.isNaN(e))&&(e=1),e},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof Yt){var t=arguments[0];return Ut.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof p){var e=arguments[0];return Ut.distancePointLine(e,this.p0,this.p1)}},pointAlong:function(t){var e=new p;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^(Math.trunc(n)^Math.trunc(n>>32))},interfaces_:function(){return[o,h]},getClass:function(){return Yt}}),Yt.midPoint=function(t,e){return new p((t.x+e.x)/2,(t.y+e.y)/2)},Yt.serialVersionUID=0x2d2172135f411c00,e(Xt.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){return(Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])||Xt.isTrue(this.matrix[b.INTERIOR][b.BOUNDARY])||Xt.isTrue(this.matrix[b.BOUNDARY][b.INTERIOR])||Xt.isTrue(this.matrix[b.BOUNDARY][b.BOUNDARY]))&&this.matrix[b.EXTERIOR][b.INTERIOR]===ut.FALSE&&this.matrix[b.EXTERIOR][b.BOUNDARY]===ut.FALSE},isCoveredBy:function(){return(Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])||Xt.isTrue(this.matrix[b.INTERIOR][b.BOUNDARY])||Xt.isTrue(this.matrix[b.BOUNDARY][b.INTERIOR])||Xt.isTrue(this.matrix[b.BOUNDARY][b.BOUNDARY]))&&this.matrix[b.INTERIOR][b.EXTERIOR]===ut.FALSE&&this.matrix[b.BOUNDARY][b.EXTERIOR]===ut.FALSE},set:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.matrix[n][i]=ut.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.matrix[r][o]=s}},isContains:function(){return Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&this.matrix[b.EXTERIOR][b.INTERIOR]===ut.FALSE&&this.matrix[b.EXTERIOR][b.BOUNDARY]===ut.FALSE},setAtLeast:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,ut.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.matrix[r][o]<s&&(this.matrix[r][o]=s)}},setAtLeastIfValid:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},isWithin:function(){return Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&this.matrix[b.INTERIOR][b.EXTERIOR]===ut.FALSE&&this.matrix[b.BOUNDARY][b.EXTERIOR]===ut.FALSE},isTouches:function(t,e){return t>e?this.isTouches(e,t):(t===ut.A&&e===ut.A||t===ut.L&&e===ut.L||t===ut.L&&e===ut.A||t===ut.P&&e===ut.A||t===ut.P&&e===ut.L)&&(this.matrix[b.INTERIOR][b.INTERIOR]===ut.FALSE&&(Xt.isTrue(this.matrix[b.INTERIOR][b.BOUNDARY])||Xt.isTrue(this.matrix[b.BOUNDARY][b.INTERIOR])||Xt.isTrue(this.matrix[b.BOUNDARY][b.BOUNDARY])))},isOverlaps:function(t,e){return t===ut.P&&e===ut.P||t===ut.A&&e===ut.A?Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&Xt.isTrue(this.matrix[b.INTERIOR][b.EXTERIOR])&&Xt.isTrue(this.matrix[b.EXTERIOR][b.INTERIOR]):t===ut.L&&e===ut.L&&(1===this.matrix[b.INTERIOR][b.INTERIOR]&&Xt.isTrue(this.matrix[b.INTERIOR][b.EXTERIOR])&&Xt.isTrue(this.matrix[b.EXTERIOR][b.INTERIOR]))},isEquals:function(t,e){return t===e&&(Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&this.matrix[b.INTERIOR][b.EXTERIOR]===ut.FALSE&&this.matrix[b.BOUNDARY][b.EXTERIOR]===ut.FALSE&&this.matrix[b.EXTERIOR][b.INTERIOR]===ut.FALSE&&this.matrix[b.EXTERIOR][b.BOUNDARY]===ut.FALSE)},toString:function(){for(var t=new T("123456789"),e=0;3>e;e++)for(var n=0;3>n;n++)t.setCharAt(3*e+n,ut.toDimensionSymbol(this.matrix[e][n]));return t.toString()},setAll:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.matrix[e][n]=t},get:function(t,e){return this.matrix[t][e]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(9!==t.length)throw new i("Should be length 9: "+t);for(var e=0;3>e;e++)for(var n=0;3>n;n++)if(!Xt.matches(this.matrix[e][n],t.charAt(3*e+n)))return!1;return!0},add:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.setAtLeast(e,n,t.get(e,n))},isDisjoint:function(){return this.matrix[b.INTERIOR][b.INTERIOR]===ut.FALSE&&this.matrix[b.INTERIOR][b.BOUNDARY]===ut.FALSE&&this.matrix[b.BOUNDARY][b.INTERIOR]===ut.FALSE&&this.matrix[b.BOUNDARY][b.BOUNDARY]===ut.FALSE},isCrosses:function(t,e){return t===ut.P&&e===ut.L||t===ut.P&&e===ut.A||t===ut.L&&e===ut.A?Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&Xt.isTrue(this.matrix[b.INTERIOR][b.EXTERIOR]):t===ut.L&&e===ut.P||t===ut.A&&e===ut.P||t===ut.A&&e===ut.L?Xt.isTrue(this.matrix[b.INTERIOR][b.INTERIOR])&&Xt.isTrue(this.matrix[b.EXTERIOR][b.INTERIOR]):t===ut.L&&e===ut.L&&0===this.matrix[b.INTERIOR][b.INTERIOR]},interfaces_:function(){return[s]},getClass:function(){return Xt}}),Xt.matches=function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],e=arguments[1];return e===ut.SYM_DONTCARE||(e===ut.SYM_TRUE&&(t>=0||t===ut.TRUE)||(e===ut.SYM_FALSE&&t===ut.FALSE||(e===ut.SYM_P&&t===ut.P||(e===ut.SYM_L&&t===ut.L||e===ut.SYM_A&&t===ut.A))))}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return new Xt(n).matches(i)}},Xt.isTrue=function(t){return t>=0||t===ut.TRUE};var qo=Object.freeze({Coordinate:p,CoordinateList:C,Envelope:E,LineSegment:Yt,GeometryFactory:jt,Geometry:z,Point:wt,LineString:_t,LinearRing:It,Polygon:Et,GeometryCollection:ft,MultiPoint:St,MultiLineString:pt,MultiPolygon:bt,Dimension:ut,IntersectionMatrix:Xt});e(Jt.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){null===this.areaBasePt&&(this.areaBasePt=t)},addLineSegments:function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var r=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=i*r;var o=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=i*o}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var e=Ut.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},getCentroid:function(){var t=new p;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!Ut.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},addTriangle:function(t,e,n,i){var r=i?1:-1;Jt.centroid3(t,e,n,this.triangleCent3);var o=Jt.area2(t,e,n);this.cg3.x+=r*o*this.triangleCent3.x,this.cg3.y+=r*o*this.triangleCent3.y,this.areasum2+=r*o},add:function(){if(arguments[0]instanceof Et){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof z){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof wt)this.addPoint(n.getCoordinate());else if(n instanceof _t)this.addLineSegments(n.getCoordinates());else if(n instanceof Et){var i=n;this.add(i)}else if(n instanceof ft){var r=n;for(e=0;e<r.getNumGeometries();e++)this.add(r.getGeometryN(e))}}},interfaces_:function(){return[]},getClass:function(){return Jt}}),Jt.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},Jt.centroid3=function(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null},Jt.getCentroid=function(t){return new Jt(t).getCentroid()},Kt.prototype=new Error,Kt.prototype.name="EmptyStackException",Qt.prototype=new v,Qt.prototype.add=function(t){return this.array_.push(t),!0},Qt.prototype.get=function(t){if(0>t||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},Qt.prototype.push=function(t){return this.array_.push(t),t},Qt.prototype.pop=function(t){if(0===this.array_.length)throw new Kt;return this.array_.pop()},Qt.prototype.peek=function(){if(0===this.array_.length)throw new Kt;return this.array_[this.array_.length-1]},Qt.prototype.empty=function(){return 0===this.array_.length},Qt.prototype.isEmpty=function(){return this.empty()},Qt.prototype.search=function(t){return this.array_.indexOf(t)},Qt.prototype.size=function(){return this.array_.length},Qt.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},e($t.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[j]},getClass:function(){return $t}}),$t.filterCoordinates=function(t){for(var e=new $t,n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()},e(te.prototype,{preSort:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return ht.sort(t,1,t.length,new ee(t[0])),t},computeOctRing:function(t){var e=this.computeOctPts(t),n=new C;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},lineOrPolygon:function(t){if(3===(t=this.cleanRing(t)).length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},cleanRing:function(t){f.equals(t[0],t[t.length-1]);for(var e=new w,n=null,i=0;i<=t.length-2;i++){var r=t[i],o=t[i+1];r.equals(o)||null!==n&&this.isBetween(n,r,o)||(e.add(r),n=r)}e.add(t[t.length-1]);var s=new Array(e.size()).fill(null);return e.toArray(s)},isBetween:function(t,e,n){if(0!==Ut.computeOrientation(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1},reduce:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new at,i=0;i<e.length;i++)n.add(e[i]);for(i=0;i<t.length;i++)Ut.isPointInRing(t[i],e)||n.add(t[i]);var r=Z.toCoordinateArray(n);return r.length<3?this.padArray3(r):r},getConvexHull:function(){if(0===this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1===this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2===this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)},padArray3:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},computeOctPts:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e},toCoordinateArray:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=t.get(n);e[n]=i}return e},grahamScan:function(t){var e=null,n=new Qt;e=n.push(t[0]),e=n.push(t[1]),e=n.push(t[2]);for(var i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&Ut.computeOrientation(n.peek(),e,t[i])>0;)e=n.pop();e=n.push(e),e=n.push(t[i])}return e=n.push(t[0]),n},interfaces_:function(){return[]},getClass:function(){return te}}),te.extractCoordinates=function(t){var e=new $t;return t.apply(e),e.getCoordinates()},e(ee.prototype,{compare:function(t,e){var n=t,i=e;return ee.polarCompare(this.origin,n,i)},interfaces_:function(){return[a]},getClass:function(){return ee}}),ee.polarCompare=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-t.x,s=n.y-t.y,a=Ut.computeOrientation(t,e,n);if(a===Ut.COUNTERCLOCKWISE)return 1;if(a===Ut.CLOCKWISE)return-1;var h=i*i+r*r,u=o*o+s*s;return u>h?-1:h>u?1:0},te.RadialComparator=ee,e(ne.prototype,{transformPoint:function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof It&&!i.isEmpty()||(n=!1);for(var r=new w,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof It||(n=!1),r.add(s))}if(n)return this.factory.createPolygon(i,r.toArray([]));var a=new w;return null!==i&&a.add(i),a.addAll(r),this.factory.buildGeometry(a)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,e){for(var n=new w,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformCoordinates:function(t,e){return this.copy(t)},transformLineString:function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,e){for(var n=new w,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformMultiPolygon:function(t,e){for(var n=new w,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,e){for(var n=new w,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this.pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(jt.toGeometryArray(n)):this.factory.buildGeometry(n)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof wt)return this.transformPoint(t,null);if(t instanceof St)return this.transformMultiPoint(t,null);if(t instanceof It)return this.transformLinearRing(t,null);if(t instanceof _t)return this.transformLineString(t,null);if(t instanceof pt)return this.transformMultiLineString(t,null);if(t instanceof Et)return this.transformPolygon(t,null);if(t instanceof bt)return this.transformMultiPolygon(t,null);if(t instanceof ft)return this.transformGeometryCollection(t,null);throw new i("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this.factory.createLinearRing(null);var i=n.size();return i>0&&4>i&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},interfaces_:function(){return[]},getClass:function(){return ne}}),e(ie.prototype,{snapVertices:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;n>i;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new p(o)),0===i&&this._isClosed&&t.set(t.size()-1,new p(o)))}},findSnapForVertex:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},snapTo:function(t){var e=new C(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},snapSegments:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;n>i;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new p(r),!1)}},findSegmentIndexToSnap:function(t,e){for(var n=r.MAX_VALUE,i=-1,o=0;o<e.size()-1;o++){if(this.seg.p0=e.get(o),this.seg.p1=e.get(o+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var s=this.seg.distance(t);s<this.snapTolerance&&n>s&&(n=s,i=o)}return i},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return ie}}),ie.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},e(re.prototype,{snapTo:function(t,e){return new oe(e,this.extractTargetCoordinates(t)).transform(this.srcGeom)},snapToSelf:function(t,e){var n=new oe(t,this.extractTargetCoordinates(this.srcGeom),!0).transform(this.srcGeom),i=n;return e&&P(i,Ct)&&(i=n.buffer(0)),i},computeSnapTolerance:function(t){return this.computeMinimumSegmentLength(t)/10},extractTargetCoordinates:function(t){for(var e=new at,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var e=r.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);e>i&&(e=i)}return e},interfaces_:function(){return[]},getClass:function(){return re}}),re.snap=function(t,e,n){var i=new Array(2).fill(null),r=new re(t);i[0]=r.snapTo(e,n);var o=new re(e);return i[1]=o.snapTo(i[0],n),i},re.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=re.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Gt.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(re.computeOverlaySnapTolerance(r),re.computeOverlaySnapTolerance(o))}},re.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*re.SNAP_PRECISION_FACTOR},re.snapToSelf=function(t,e,n){return new re(t).snapToSelf(e,n)},re.SNAP_PRECISION_FACTOR=1e-9,l(oe,ne),e(oe.prototype,{snapLine:function(t,e){var n=new ie(t,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(e)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(i)},interfaces_:function(){return[]},getClass:function(){return oe}}),e(se.prototype,{getCommon:function(){return r.longBitsToDouble(this.commonBits)},add:function(t){var e=r.doubleToLongBits(t);return this.isFirst?(this.commonBits=e,this.commonSignExp=se.signExpBits(this.commonBits),this.isFirst=!1,null):se.signExpBits(e)!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=se.numCommonMostSigMantissaBits(this.commonBits,e),void(this.commonBits=se.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(1===arguments.length){var t=arguments[0],e=r.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+Long.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},interfaces_:function(){return[]},getClass:function(){return se}}),se.getBit=function(t,e){return 0!=(t&1<<e)?1:0},se.signExpBits=function(t){return t>>52},se.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},se.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(se.getBit(t,i)!==se.getBit(e,i))return n;n++}return 52},e(ae.prototype,{addCommonBits:function(t){var e=new ue(this.commonCoord);t.apply(e),t.geometryChanged()},removeCommonBits:function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new p(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new ue(e);return t.apply(n),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return ae}}),e(he.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new p(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[j]},getClass:function(){return he}}),e(ue.prototype,{filter:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[ct]},getClass:function(){return ue}}),ae.CommonCoordinateFilter=he,ae.Translater=ue,e(le.prototype,{next:function(){if(this.atStart)return this.atStart=!1,le.isAtomic(this.parent)&&this.index++,this.parent;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new _;var t=this.parent.getGeometryN(this.index++);return t instanceof ft?(this.subcollectionIterator=new le(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[g]},getClass:function(){return le}}),le.isAtomic=function(t){return!(t instanceof ft)},e(ce.prototype,{locateInternal:function(){if(arguments[0]instanceof p&&arguments[1]instanceof Et){var t=arguments[0],e=arguments[1];if(e.isEmpty())return b.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===b.EXTERIOR)return b.EXTERIOR;if(i===b.BOUNDARY)return b.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===b.INTERIOR)return b.EXTERIOR;if(s===b.BOUNDARY)return b.BOUNDARY}return b.INTERIOR}if(arguments[0]instanceof p&&arguments[1]instanceof _t){var a=arguments[0],h=arguments[1];if(!h.getEnvelopeInternal().intersects(a))return b.EXTERIOR;var u=h.getCoordinates();return h.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?Ut.isOnLine(a,u)?b.INTERIOR:b.EXTERIOR:b.BOUNDARY}if(arguments[0]instanceof p&&arguments[1]instanceof wt){var l=arguments[0];return arguments[1].getCoordinate().equals2D(l)?b.INTERIOR:b.EXTERIOR}},locateInPolygonRing:function(t,e){return e.getEnvelopeInternal().intersects(t)?Ut.locatePointInRing(t,e.getCoordinates()):b.EXTERIOR},intersects:function(t,e){return this.locate(t,e)!==b.EXTERIOR},updateLocationInfo:function(t){t===b.INTERIOR&&(this.isIn=!0),t===b.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,e){if(e instanceof wt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof _t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Et)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof pt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof bt){var o=e;for(i=0;i<o.getNumGeometries();i++){var s=o.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,s))}}else if(e instanceof ft)for(var a=new le(e);a.hasNext();){var h=a.next();h!==e&&this.computeLocation(t,h)}},locate:function(t,e){return e.isEmpty()?b.EXTERIOR:e instanceof _t?this.locateInternal(t,e):e instanceof Et?this.locateInternal(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?b.BOUNDARY:this.numBoundaries>0||this.isIn?b.INTERIOR:b.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return ce}}),e(fe.prototype,{interfaces_:function(){return[]},getClass:function(){return fe}}),fe.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof p&&arguments[1]instanceof p){var o=arguments[0],s=arguments[1],a=s.x-o.x,h=s.y-o.y;if(0===a&&0===h)throw new i("Cannot compute the octant for two identical points "+o);return fe.octant(a,h)}},e(pe.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return pe}}),e(de.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:fe.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return Ht.toLineString(new Rt(this.pts))},interfaces_:function(){return[pe]},getClass:function(){return de}}),e(ge.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return ge}}),e(ye.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[ge,h]},getClass:function(){return ye}}),e(me.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var e=null,n=this.items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this.items.get(e+1).compareTo(this.items.get(e))<0&&e++,this.items.get(e).compareTo(n)<0);t=e)this.items.set(t,this.items.get(e));this.items.set(t,n)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return 0===this._size},add:function(t){this.items.add(null),this._size+=1;var e=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(e/2)))<0;e/=2)this.items.set(e,this.items.get(Math.trunc(e/2)));this.items.set(e,t)},interfaces_:function(){return[]},getClass:function(){return me}}),e(ve.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return ve}}),e(_e.prototype,{insert:function(t,e){},remove:function(t,e){},query:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return _e}}),e(xe.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){f.isTrue(null===this.bounds),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[ge,h]},getClass:function(){return xe}}),xe.serialVersionUID=0x5a1e55ec41369800;var Wo={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return Wo.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?ht.sort(n,e):ht.sort(n);for(var i=t.iterator(),r=0,o=n.length;o>r;r++)i.next(),i.set(n[r])},singletonList:function(t){var e=new w;return e.add(t),e}};e(we.prototype,{expandToQueue:function(t,e){var n=we.isComposite(this.boundable1),r=we.isComposite(this.boundable2);if(n&&r)return we.area(this.boundable1)>we.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,e),null):(this.expand(this.boundable2,this.boundable1,t,e),null);if(n)return this.expand(this.boundable1,this.boundable2,t,e),null;if(r)return this.expand(this.boundable2,this.boundable1,t,e),null;throw new i("neither boundable is composite")},isLeaves:function(){return!(we.isComposite(this.boundable1)||we.isComposite(this.boundable2))},compareTo:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},expand:function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=new we(r.next(),e,this.itemDistance);o.getDistance()<i&&n.add(o)}},getBoundable:function(t){return 0===t?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[o]},getClass:function(){return we}}),we.area=function(t){return t.getBounds().getArea()},we.isComposite=function(t){return t instanceof xe},e(Ce.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this.root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof xe?t+=this.size(n):n instanceof ye&&(t+=1)}return t}},removeItem:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof ye&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},itemsTree:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this.root);return null===t?new w:t}if(1===arguments.length){for(var e=arguments[0],n=new w,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof xe){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof ye?n.add(r.getItem()):f.shouldNeverReachHere()}return n.size()<=0?null:n}},insert:function(t,e){f.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new ye(t,e))},boundablesAtLevel:function(){if(1===arguments.length){var t=arguments[0],e=new w;return this.boundablesAtLevel(t,this.root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(f.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof xe?this.boundablesAtLevel(n,s,r):(f.isTrue(s instanceof ye),-1===n&&r.add(s))}return null}},query:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new w;return this.isEmpty()?e:(this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,e),e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),n)&&this.query(n,this.root,i)}else if(3===arguments.length)if(P(arguments[2],ve)&&arguments[0]instanceof Object&&arguments[1]instanceof xe)for(var r=arguments[0],o=arguments[1],s=arguments[2],a=o.getChildBoundables(),h=0;h<a.size();h++){var u=a.get(h);this.getIntersectsOp().intersects(u.getBounds(),r)&&(u instanceof xe?this.query(r,u,s):u instanceof ye?s.visitItem(u.getItem()):f.shouldNeverReachHere())}else if(P(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof xe){var l=arguments[0],c=arguments[1],p=arguments[2];for(a=c.getChildBoundables(),h=0;h<a.size();h++){u=a.get(h);this.getIntersectsOp().intersects(u.getBounds(),l)&&(u instanceof xe?this.query(l,u,p):u instanceof ye?p.add(u.getItem()):f.shouldNeverReachHere())}}},build:function(){return this.built?null:(this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,void(this.built=!0))},getRoot:function(){return this.build(),this.root},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove(t,this.root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var h=a.next();if(this.getIntersectsOp().intersects(h.getBounds(),n)&&h instanceof xe&&(o=this.remove(n,h,r))){s=h;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},createHigherLevels:function(t,e){f.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},depth:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof xe){var i=this.depth(n);i>t&&(t=i)}}return t+1}},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=new w;n.add(this.createNode(e));var i=new w(t);Wo.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[h]},getClass:function(){return Ce}}),Ce.compareDoubles=function(t,e){return t>e?1:e>t?-1:0},Ce.IntersectsOp=function(){},Ce.serialVersionUID=-0x35ef64c82d4c5400,Ce.DEFAULT_NODE_CAPACITY=10,e(Ee.prototype,{distance:function(t,e){},interfaces_:function(){return[]},getClass:function(){return Ee}}),l(Se,Ce),e(Se.prototype,{createParentBoundablesFromVerticalSlices:function(t,e){f.isTrue(t.length>0);for(var n=new w,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},createNode:function(t){return new Ie(t)},size:function(){return 0===arguments.length?Ce.prototype.size.call(this):Ce.prototype.size.apply(this,arguments)},insert:function(){if(2!==arguments.length)return Ce.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];return t.isNull()?null:void Ce.prototype.insert.call(this,t,e)},getIntersectsOp:function(){return Se.intersectsOp},verticalSlices:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;e>o;o++){i[o]=new w;for(var s=0;r.hasNext()&&n>s;){var a=r.next();i[o].add(a),s++}}return i},query:function(){if(1===arguments.length){var t=arguments[0];return Ce.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];Ce.prototype.query.call(this,e,n)}else if(3===arguments.length)if(P(arguments[2],ve)&&arguments[0]instanceof Object&&arguments[1]instanceof xe){var i=arguments[0],r=arguments[1],o=arguments[2];Ce.prototype.query.call(this,i,r,o)}else if(P(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof xe){var s=arguments[0],a=arguments[1],h=arguments[2];Ce.prototype.query.call(this,s,a,h)}},getComparator:function(){return Se.yComparator},createParentBoundablesFromVerticalSlice:function(t,e){return Ce.prototype.createParentBoundables.call(this,t,e)},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Ce.prototype.remove.call(this,t,e)}return Ce.prototype.remove.apply(this,arguments)},depth:function(){return 0===arguments.length?Ce.prototype.depth.call(this):Ce.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new w(t);Wo.sort(i,Se.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},nearestNeighbour:function(){if(1===arguments.length){if(P(arguments[0],Ee)){var t=arguments[0],e=new we(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof we){var n=arguments[0];return this.nearestNeighbour(n,r.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof Se&&P(arguments[1],Ee)){var i=arguments[0],o=arguments[1];e=new we(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(e)}if(arguments[0]instanceof we&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],h=null,u=new me;for(u.add(s);!u.isEmpty()&&a>0;){var l=u.poll(),c=l.getDistance();if(c>=a)break;l.isLeaves()?(a=c,h=l):l.expandToQueue(u,a)}return[h.getBoundable(0).getItem(),h.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[0],p=arguments[1],d=arguments[2],g=new ye(f,p);e=new we(this.getRoot(),g,d);return this.nearestNeighbour(e)[0]}},interfaces_:function(){return[_e,h]},getClass:function(){return Se}}),Se.centreX=function(t){return Se.avg(t.getMinX(),t.getMaxX())},Se.avg=function(t,e){return(t+e)/2},Se.centreY=function(t){return Se.avg(t.getMinY(),t.getMaxY())},l(Ie,xe),e(Ie.prototype,{computeBounds:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new E(n.getBounds()):t.expandToInclude(n.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return Ie}}),Se.STRtreeNode=Ie,Se.serialVersionUID=0x39920f7d5f261e0,Se.xComparator={interfaces_:function(){return[a]},compare:function(t,e){return Ce.compareDoubles(Se.centreX(t.getBounds()),Se.centreX(e.getBounds()))}},Se.yComparator={interfaces_:function(){return[a]},compare:function(t,e){return Ce.compareDoubles(Se.centreY(t.getBounds()),Se.centreY(e.getBounds()))}},Se.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,e){return t.intersects(e)}},Se.DEFAULT_NODE_CAPACITY=10,e(be.prototype,{interfaces_:function(){return[]},getClass:function(){return be}}),be.relativeSign=function(t,e){return e>t?-1:t>e?1:0},be.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=be.relativeSign(e.x,n.x),r=be.relativeSign(e.y,n.y);switch(t){case 0:return be.compareValue(i,r);case 1:return be.compareValue(r,i);case 2:return be.compareValue(r,-i);case 3:return be.compareValue(-i,r);case 4:return be.compareValue(-i,-r);case 5:return be.compareValue(-r,-i);case 6:return be.compareValue(-r,i);case 7:return be.compareValue(i,-r)}return f.shouldNeverReachHere("invalid octant value"),0},be.compareValue=function(t,e){return 0>t?-1:t>0?1:0>e?-1:e>0?1:0},e(Pe.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:be.compare(this.segmentOctant,this.coord,e.coord)},isEndPoint:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},isInterior:function(){return this._isInterior},interfaces_:function(){return[o]},getClass:function(){return Pe}}),e(Me.prototype,{getSplitCoordinates:function(){var t=new C;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new w;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this.edge.getCoordinate(n),n)}},print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},findCollapsesFromExistingVertices:function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),i=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(i)&&t.add(new L(e+1))}},addEdgeCoordinates:function(t,e,n){e.segmentIndex,t.segmentIndex;var i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new p(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this.edge.getCoordinate(o));r&&n.add(new p(e.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},findCollapseIndex:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},findCollapsesFromInsertedNodes:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new L(e[0])),i=r}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new p(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.getCoordinate(a);return r&&(o[s]=new p(e.coord)),new Ne(o,this.edge.getData())},add:function(t,e){var n=new Pe(this.edge,t,e,this.edge.getSegmentOctant(e)),i=this.nodeMap.get(n);return null!==i?(f.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this.nodeMap.put(n,n),n)},checkSplitEdgesCorrectness:function(t){var e=this.edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new u("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new u("bad split edge end point at "+r)},interfaces_:function(){return[]},getClass:function(){return Me}}),e(Te.prototype,{next:function(){return null===this.currNode?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):null===this.nextNode?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex,this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return null!==this.nextNode},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[g]},getClass:function(){return Te}}),e(Le.prototype,{addIntersection:function(t,e){},interfaces_:function(){return[pe]},getClass:function(){return Le}}),e(Ne.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,e){return t.equals2D(e)?0:fe.octant(t,e)},getData:function(){return this.data},addIntersection:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=(arguments[2],arguments[3]),o=new p(n.getIntersection(r));this.addIntersection(o,i)}},toString:function(){return Ht.toLineString(new Rt(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,e){var n=e,i=n+1;if(i<this.pts.length){var r=this.pts[i];t.equals2D(r)&&(n=i)}return this.nodeList.add(t,n)},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[Le]},getClass:function(){return Ne}}),Ne.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new w;return Ne.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){r.next().getNodeList().addSplitEdges(i)}},e(Re.prototype,{overlap:function(){if(2===arguments.length)arguments[0],arguments[1];else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this.overlapSeg1),n.getLineSegment(i,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}},interfaces_:function(){return[]},getClass:function(){return Re}}),e(Oe.prototype,{getLineSegment:function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},computeSelect:function(t,e,n,i){var r=this.pts[e],o=this.pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);s>e&&this.computeSelect(t,e,s,i),n>s&&this.computeSelect(t,s,n,i)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},computeOverlaps:function(t,e){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,e)},setId:function(t){this.id=t},select:function(t,e){this.computeSelect(t,this.start,this.end,e)},getEnvelope:function(){if(null===this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new E(t,e)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,e,n,i,r,o){var s=this.pts[t],a=this.pts[e],h=n.pts[i],u=n.pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(h,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var l=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);l>t&&(c>i&&this.computeOverlapsInternal(t,l,n,i,c,o),r>c&&this.computeOverlapsInternal(t,l,n,c,r,o)),e>l&&(c>i&&this.computeOverlapsInternal(l,e,n,i,c,o),r>c&&this.computeOverlapsInternal(l,e,n,c,r,o))},interfaces_:function(){return[]},getClass:function(){return Oe}}),e(Ae.prototype,{interfaces_:function(){return[]},getClass:function(){return Ae}}),Ae.isNorthern=function(t){return t===Ae.NE||t===Ae.NW},Ae.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},Ae.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=e>t?t:e;return 0===n&&3===(t>e?t:e)?3:n},Ae.isInHalfPlane=function(t,e){return e===Ae.SE?t===Ae.SE||t===Ae.SW:t===e||t===e+1},Ae.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Ae.NE:Ae.SE:e>=0?Ae.NW:Ae.SW}if(arguments[0]instanceof p&&arguments[1]instanceof p){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new i("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?Ae.NE:Ae.SE:r.y>=n.y?Ae.NW:Ae.SW}},Ae.NE=0,Ae.NW=1,Ae.SW=2,Ae.SE=3,e(De.prototype,{interfaces_:function(){return[]},getClass:function(){return De}}),De.getChainStartIndices=function(t){var e=0,n=new w;n.add(new L(e));do{var i=De.findChainEnd(t,e);n.add(new L(i)),e=i}while(e<t.length-1);return De.toIntArray(n)},De.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Ae.quadrant(t[n],t[n+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r]))if(Ae.quadrant(t[r-1],t[r])!==i)break;r++}return r-1},De.getChains=function(){if(1===arguments.length){var t=arguments[0];return De.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new w,r=De.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new Oe(e,r[o],r[o+1],n);i.add(s)}return i}},De.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(ke.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return ke}}),e(Fe.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[ke]},getClass:function(){return Fe}}),l(Ge,Fe),e(Ge.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Ne.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var e=De.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this.idCounter++),this.index.insert(n.getEnvelope(),n),this.monoChains.add(n)}},computeNodes:function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},intersectChains:function(){for(var t=new ze(this.segInt),e=this.monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this.index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return Ge}}),l(ze,Re),e(ze.prototype,{overlap:function(){if(4!==arguments.length)return Re.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=t.getContext(),o=n.getContext();this.si.processIntersections(r,e,o,i)},interfaces_:function(){return[]},getClass:function(){return ze}}),Ge.SegmentOverlapAction=ze,l(je,u),e(je.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return je}}),je.msgWithCoord=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(Be.prototype,{processIntersections:function(t,e,n,i){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return Be}}),e(He.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,e,n,i){if(!this.findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this.isCheckEndSegmentsOnly&&!(this.isEndSegment(t,e)||this.isEndSegment(n,i)))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=r,this.intSegments[1]=o,this.intSegments[2]=s,this.intSegments[3]=a,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,e){return 0===e||e>=t.size()-2},hasIntersection:function(){return null!==this.interiorIntersection},isDone:function(){return!this.findAllIntersections&&null!==this.interiorIntersection},interfaces_:function(){return[Be]},getClass:function(){return He}}),He.createAllIntersectionsFinder=function(t){var e=new He(t);return e.setFindAllIntersections(!0),e},He.createAnyIntersectionFinder=function(t){return new He(t)},He.createIntersectionCounter=function(t){var e=new He(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e},e(Ve.prototype,{execute:function(){return null!==this.segInt?null:void this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new He(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new Ge;return t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection()?(this._isValid=!1,null):void 0},checkValid:function(){if(this.execute(),!this._isValid)throw new je(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+Ht.toLineString(t[0],t[1])+" and "+Ht.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return Ve}}),Ve.computeIntersections=function(t){var e=new Ve(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()},e(qe.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return qe}}),qe.toSegmentStrings=function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next();e.add(new de(i.getCoordinates(),i))}return e},qe.checkValid=function(t){new qe(t).checkValid()},e(We.prototype,{map:function(t){for(var e=new w,n=0;n<t.getNumGeometries();n++){var i=this.mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(jt.toGeometryArray(e))},interfaces_:function(){return[]},getClass:function(){return We}}),We.map=function(t,e){return new We(e).map(t)},e(Ze.prototype,{interfaces_:function(){return[]},getClass:function(){return Ze}}),Ze.opposite=function(t){return t===Ze.LEFT?Ze.RIGHT:t===Ze.RIGHT?Ze.LEFT:t},Ze.ON=0,Ze.LEFT=1,Ze.RIGHT=2,e(Ue.prototype,{setAllLocations:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==b.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===b.NONE&&(this.location[e]=t)},isLine:function(){return 1===this.location.length},merge:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Ze.ON]=this.location[Ze.ON],e[Ze.LEFT]=b.NONE,e[Ze.RIGHT]=b.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===b.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[Ze.LEFT];this.location[Ze.LEFT]=this.location[Ze.RIGHT],this.location[Ze.RIGHT]=t},toString:function(){var t=new T;return this.location.length>1&&t.append(b.toLocationSymbol(this.location[Ze.LEFT])),t.append(b.toLocationSymbol(this.location[Ze.ON])),this.location.length>1&&t.append(b.toLocationSymbol(this.location[Ze.RIGHT])),t.toString()},setLocations:function(t,e,n){this.location[Ze.ON]=t,this.location[Ze.LEFT]=e,this.location[Ze.RIGHT]=n},get:function(t){return t<this.location.length?this.location[t]:b.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===b.NONE)return!0;return!1},setLocation:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Ze.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(b.NONE)},isEqualOnSide:function(t,e){return this.location[e]===t.location[e]},allPositionsEqual:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return Ue}}),e(Ye.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,e){this.elt[t].setAllLocations(e)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var e=0;2>e;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Ue(t.elt[e]):this.elt[e].merge(t.elt[e])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Ze.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},toString:function(){var t=new T;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Ze.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},isEqualOnSide:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},allPositionsEqual:function(t,e){return this.elt[t].allPositionsEqual(e)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new Ue(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return Ye}}),Ye.toLineLabel=function(t){for(var e=new Ye(b.NONE),n=0;2>n;n++)e.setLocation(n,t.getLocation(n));return e},e(Xe.prototype,{computeRing:function(){if(null!==this.ring)return null;for(var t=new Array(this.pts.size()).fill(null),e=0;e<this.pts.size();e++)t[e]=this.pts.get(e);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=Ut.isCCW(this.ring.getCoordinates())},isIsolated:function(){return 1===this.label.getGeometryCount()},computePoints:function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new je("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new je("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.add(e);var i=e.getLabel();f.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this.maxNodeDegree&&(this.maxNodeDegree=e),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this.pts.add(i[o])}else{r=i.length-2;n&&(r=i.length-1);for(o=r;o>=0;o--)this.pts.add(i[o])}},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this.startDe)},containsPoint:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Ut.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this.holes.iterator();n.hasNext();){if(n.next().containsPoint(t))return!1}return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return null===this.shell},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,Ze.RIGHT);if(i===b.NONE)return null;if(this.label.getLocation(n)===b.NONE)return this.label.setLocation(n,i),null}},setShell:function(t){this.shell=t,null!==t&&t.addHole(this)},toPolygon:function(t){for(var e=new Array(this.holes.size()).fill(null),n=0;n<this.holes.size();n++)e[n]=this.holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},interfaces_:function(){return[]},getClass:function(){return Xe}}),l(Je,Xe),e(Je.prototype,{setEdgeRing:function(t,e){t.setMinEdgeRing(e)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return Je}}),l(Ke,Xe),e(Ke.prototype,{buildMinimalRings:function(){var t=new w,e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new Je(e,this.geometryFactory);t.add(n)}e=e.getNext()}while(e!==this.startDe);return t},setEdgeRing:function(t,e){t.setEdgeRing(e)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return Ke}}),e(Qe.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){f.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return Qe}}),l($e,Qe),e($e.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){if(t.next().getEdge().isInResult())return!0}return!1},isIsolated:function(){return 1===this.label.getGeometryCount()},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,e){var n=b.NONE;if(n=this.label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==b.BOUNDARY&&(n=i)}return n},setLabel:function(){if(2!==arguments.length)return Qe.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this.label?this.label=new Ye(t,e):this.label.setLocation(t,e)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof $e){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof Ye)for(var e=arguments[0],n=0;2>n;n++){var i=this.computeMergedLocation(e,n);this.label.getLocation(n)===b.NONE&&this.label.setLocation(n,i)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(null===this.label)return null;var e=b.NONE;null!==this.label&&(e=this.label.getLocation(t));var n=null;switch(e){case b.BOUNDARY:n=b.INTERIOR;break;case b.INTERIOR:n=b.BOUNDARY;break;default:n=b.BOUNDARY}this.label.setLocation(t,n)},interfaces_:function(){return[]},getClass:function(){return $e}}),e(tn.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof p){var t=arguments[0];return null===(e=this.nodeMap.get(t))&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof $e){var e,n=arguments[0];return null===(e=this.nodeMap.get(n.getCoordinate()))?(this.nodeMap.put(n.getCoordinate(),n),n):(e.mergeLabel(n),e)}},print:function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var e=new w,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===b.BOUNDARY&&e.add(i)}return e},add:function(t){var e=t.getCoordinate();this.addNode(e).add(t)},interfaces_:function(){return[]},getClass:function(){return tn}}),e(en.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:Ut.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var e=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+e+"   "+this.label)},compareTo:function(t){var e=t;return this.compareDirection(e)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,e){this.p0=t,this.p1=e,this.dx=e.x-t.x,this.dy=e.y-t.y,this.quadrant=Ae.quadrant(this.dx,this.dy),f.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[o]},getClass:function(){return en}}),l(nn,en),e(nn.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new Ye(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new je("assigned depths do not match",this.getCoordinate());this.depth[t]=e},isInteriorAreaEdge:function(){for(var t=!0,e=0;2>e;e++)this.label.isArea(e)&&this.label.getLocation(e,Ze.LEFT)===b.INTERIOR&&this.label.getLocation(e,Ze.RIGHT)===b.INTERIOR||(t=!1);return t},setNextMin:function(t){this.nextMin=t},print:function(t){en.prototype.print.call(this,t),t.print(" "+this.depth[Ze.LEFT]+"/"+this.depth[Ze.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),e=!this.label.isArea(0)||this.label.allPositionsEqual(0,b.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,b.EXTERIOR);return t&&e&&n},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Ze.LEFT&&(i=-1);var r=Ze.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return nn}}),nn.depthFactor=function(t,e){return t===b.EXTERIOR&&e===b.INTERIOR?1:t===b.INTERIOR&&e===b.EXTERIOR?-1:0},e(rn.prototype,{createNode:function(t){return new $e(t,null)},interfaces_:function(){return[]},getClass:function(){return rn}}),e(on.prototype,{printEdges:function(t){t.println("Edges:");for(var e=0;e<this.edges.size();e++){t.println("edge "+e+":");var n=this.edges.get(e);n.print(t),n.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof $e){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.nodes.addNode(e)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},debugPrintln:function(t){D.out.println(t)},isBoundaryNode:function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===b.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},matchInSameDirection:function(t,e,n,i){return!!t.equals(n)&&(Ut.computeOrientation(t,e,i)===Ut.COLLINEAR&&Ae.quadrant(t,e)===Ae.quadrant(n,i))},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){D.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},addEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var i=new nn(n,!0),r=new nn(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},interfaces_:function(){return[]},getClass:function(){return on}}),on.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}},e(sn.prototype,{sortShellsAndHoles:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},computePolygons:function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this.geometryFactory);e.add(i)}return e},placeFreeHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new je("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},buildMinimalEdgeRings:function(t,e,n){for(var i=new w,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},containsPoint:function(t){for(var e=this.shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},buildMaximalEdgeRings:function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new Ke(i,this.geometryFactory);e.add(r),r.setInResult()}}return e},placePolygonHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},getPolygons:function(){return this.computePolygons(this.shellList)},findEdgeRingContaining:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var h=a.next(),u=h.getLinearRing(),l=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;l.contains(i)&&Ut.isPointInRing(r,u.getCoordinates())&&(c=!0),c&&(null===o||s.contains(l))&&(o=h)}return o},findShell:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return f.isTrue(1>=e,"found two shells in MinimalEdgeRing list"),n},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];on.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new w,o=this.buildMinimalEdgeRings(i,this.shellList,r);this.sortShellsAndHoles(o,this.shellList,r),this.placeFreeHoles(this.shellList,r)}},interfaces_:function(){return[]},getClass:function(){return sn}}),e(an.prototype,{collectLines:function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},labelIsolatedLine:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(e));t.getLabel().setLocation(e,n)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!zn.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this.op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},labelIsolatedLines:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},buildLines:function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(i),n.setInResult(!0)}},collectBoundaryTouchEdge:function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(f.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(zn.isResultOfOp(i,e)&&e===zn.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return an}}),e(hn.prototype,{filterCoveredNodeToPoint:function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},extractNonCoveredResultNodes:function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==zn.INTERSECTION)){var i=n.getLabel();zn.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return hn}}),e(un.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return un}}),e(ln.prototype,{locate:function(t){return ln.locate(t,this.geom)},interfaces_:function(){return[un]},getClass:function(){return ln}}),ln.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&Ut.isPointInRing(t,e.getCoordinates())},ln.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!ln.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(ln.isPointInRing(t,r))return!1}return!0},ln.containsPoint=function(t,e){if(e instanceof Et)return ln.containsPointInPolygon(t,e);if(e instanceof ft)for(var n=new le(e);n.hasNext();){var i=n.next();if(i!==e&&ln.containsPoint(t,i))return!0}return!1},ln.locate=function(t,e){return e.isEmpty()?b.EXTERIOR:ln.containsPoint(t,e)?b.INTERIOR:b.EXTERIOR},e(cn.prototype,{getNextCW:function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.size()-1),this.edgeList.get(n)},propagateSideLabels:function(t){for(var e=b.NONE,n=this.iterator();n.hasNext();){(o=(r=n.next()).getLabel()).isArea(t)&&o.getLocation(t,Ze.LEFT)!==b.NONE&&(e=o.getLocation(t,Ze.LEFT))}if(e===b.NONE)return null;var i=e;for(n=this.iterator();n.hasNext();){var r,o;if((o=(r=n.next()).getLabel()).getLocation(t,Ze.ON)===b.NONE&&o.setLocation(t,Ze.ON,i),o.isArea(t)){var s=o.getLocation(t,Ze.LEFT),a=o.getLocation(t,Ze.RIGHT);if(a!==b.NONE){if(a!==i)throw new je("side location conflict",r.getCoordinate());s===b.NONE&&f.shouldNeverReachHere("found single null side (at "+r.getCoordinate()+")"),i=s}else f.isTrue(o.getLocation(t,Ze.LEFT)===b.NONE,"found single null side"),o.setLocation(t,Ze.RIGHT,i),o.setLocation(t,Ze.LEFT,i)}}},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},print:function(t){D.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Ze.LEFT);f.isTrue(i!==b.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();f.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Ze.LEFT),h=s.getLocation(t,Ze.RIGHT);if(a===h)return!1;if(h!==r)return!1;r=a}return!0},findIndex:function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++){if(this.edgeList.get(e)===t)return e}return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return null===this.edgeList&&(this.edgeList=new w(this.edgeMap.values())),this.edgeList},getLocation:function(t,e,n){return this.ptInAreaLocation[t]===b.NONE&&(this.ptInAreaLocation[t]=ln.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new T;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},computeEdgeEndLabels:function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=(o=n.next()).getLabel(),r=0;2>r;r++)i.isLine(r)&&i.getLocation(r)===b.BOUNDARY&&(e[r]=!0);for(n=this.iterator();n.hasNext();){var o;for(i=(o=n.next()).getLabel(),r=0;2>r;r++)if(i.isAnyNull(r)){var s=b.NONE;if(e[r])s=b.EXTERIOR;else{var a=o.getCoordinate();s=this.getLocation(r,a,t)}i.setAllLocationsIfNull(r,s)}}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,e){this.edgeMap.put(t,e),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return cn}}),l(fn,cn),e(fn.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,i=0;i<this.resultAreaEdgeList.size();i++){var r=this.resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this.SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new je("no outgoing dirEdge found",this.getCoordinate());f.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},insert:function(t){var e=t;this.insertEdgeEnd(e,e)},getRightmostEdge:function(){var t=this.getEdges(),e=t.size();if(1>e)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Ae.isNorthern(r)&&Ae.isNorthern(o)?n:Ae.isNorthern(r)||Ae.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(f.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},print:function(t){D.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new w;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var i=this.edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},computeDepths:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=(t.getLabel(),t.getDepth(Ze.LEFT)),i=t.getDepth(Ze.RIGHT),r=this.computeDepths(e+1,this.edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new je("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],s=arguments[1],a=arguments[2],h=o;s>h;h++){var u=this.edgeList.get(h);u.getLabel(),u.setEdgeDepths(Ze.RIGHT,a),a=u.getDepth(Ze.LEFT)}return a}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var e=null,n=null,i=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var o=this.resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this.SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this.SCANNING_FOR_INCOMING}}i===this.LINKING_TO_OUTGOING&&(f.isTrue(null!==e,"found null for first outgoing dirEdge"),f.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},getOutgoingDegree:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();){e.next().isInResult()&&t++}return t}if(1===arguments.length){var n=arguments[0];for(t=0,e=this.iterator();e.hasNext();){e.next().getEdgeRing()===n&&t++}return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=b.NONE,e=this.iterator();e.hasNext();){var n=(r=e.next()).getSym();if(!r.isLineEdge()){if(r.isInResult()){t=b.INTERIOR;break}if(n.isInResult()){t=b.EXTERIOR;break}}}if(t===b.NONE)return null;var i=t;for(e=this.iterator();e.hasNext();){var r;n=(r=e.next()).getSym();r.isLineEdge()?r.getEdge().setCovered(i===b.INTERIOR):(r.isInResult()&&(i=b.EXTERIOR),n.isInResult()&&(i=b.INTERIOR))}},computeLabelling:function(t){cn.prototype.computeLabelling.call(this,t),this.label=new Ye(b.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;2>i;i++){var r=n.getLocation(i);r!==b.INTERIOR&&r!==b.BOUNDARY||this.label.setLocation(i,b.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return fn}}),l(pn,rn),e(pn.prototype,{createNode:function(t){return new $e(t,new fn)},interfaces_:function(){return[]},getClass:function(){return pn}}),e(dn.prototype,{computeIntersections:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},interfaces_:function(){return[]},getClass:function(){return dn}}),e(gn.prototype,{isDelete:function(){return this.eventType===gn.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var e=t;return this.xValue<e.xValue?-1:this.xValue>e.xValue?1:this.eventType<e.eventType?-1:this.eventType>e.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===gn.INSERT},isSameLabel:function(t){return null!==this.label&&this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[o]},getClass:function(){return gn}}),gn.INSERT=1,gn.DELETE=2,e(yn.prototype,{interfaces_:function(){return[]},getClass:function(){return yn}}),e(mn.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(mn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},setBoundaryNodes:function(t,e){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=e},addIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return mn}}),mn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},l(vn,yn),e(vn.prototype,{prepareEvents:function(){Wo.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof mn&&P(arguments[0],v)&&P(arguments[1],v)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&P(arguments[0],v)&&arguments[1]instanceof mn){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},addEdge:function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new dn(n,r),s=new gn(e,n.getMinX(r),o);this.events.add(s),this.events.add(new gn(n.getMaxX(r),s))}},processOverlaps:function(t,e,n,i){for(var r=n.getObject(),o=t;e>o;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},addEdges:function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];for(t=n.iterator();t.hasNext();){e=t.next();this.addEdge(e,i)}}},interfaces_:function(){return[]},getClass:function(){return vn}}),e(_n.prototype,{getMin:function(){return this.min},intersects:function(t,e){return!(this.min>e||this.max<t)},getMax:function(){return this.max},toString:function(){return Ht.toLineString(new p(this.min,0),new p(this.max,0))},interfaces_:function(){return[]},getClass:function(){return _n}}),e(xn.prototype,{compare:function(t,e){var n=t,i=e,r=(n.min+n.max)/2,o=(i.min+i.max)/2;return o>r?-1:r>o?1:0},interfaces_:function(){return[a]},getClass:function(){return xn}}),_n.NodeComparator=xn,l(wn,_n),e(wn.prototype,{query:function(t,e,n){return this.intersects(t,e)?void n.visitItem(this.item):null},interfaces_:function(){return[]},getClass:function(){return wn}}),l(Cn,_n),e(Cn.prototype,{buildExtent:function(t,e){this.min=Math.min(t.min,e.min),this.max=Math.max(t.max,e.max)},query:function(t,e,n){return this.intersects(t,e)?(null!==this.node1&&this.node1.query(t,e,n),void(null!==this.node2&&this.node2.query(t,e,n))):null},interfaces_:function(){return[]},getClass:function(){return Cn}}),e(En.prototype,{buildTree:function(){Wo.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,e=null,n=new w;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},insert:function(t,e,n){if(null!==this.root)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new wn(t,e,n))},query:function(t,e,n){this.init(),this.root.query(t,e,n)},buildRoot:function(){return null!==this.root?null:void(this.root=this.buildTree())},printNode:function(t){D.out.println(Ht.toLineString(new p(t.min,this.level),new p(t.max,this.level)))},init:function(){return null!==this.root?null:void this.buildRoot()},buildLevel:function(t,e){this.level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new Cn(t.get(n),t.get(n+1));e.add(r)}}},interfaces_:function(){return[]},getClass:function(){return En}}),e(Sn.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof It){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(e),null}t instanceof _t&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[G]},getClass:function(){return Sn}}),Sn.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Sn.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Sn.getLines(e,n))}},Sn.getLines=function(){if(1===arguments.length){var t=arguments[0];return Sn.getLines(t,!1)}if(2===arguments.length){if(P(arguments[0],y)&&P(arguments[1],y)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Sn.getLines(r,n)}return n}if(arguments[0]instanceof z&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1],a=new w;return o.apply(new Sn(a,s)),a}if(arguments[0]instanceof z&&P(arguments[1],y)){var h=arguments[0],u=arguments[1];return h instanceof _t?u.add(h):h.apply(new Sn(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&P(arguments[0],y)&&P(arguments[1],y)){var l=arguments[0],c=arguments[1],f=arguments[2];for(i=l.iterator();i.hasNext();){r=i.next();Sn.getLines(r,c,f)}return c}if("boolean"==typeof arguments[2]&&arguments[0]instanceof z&&P(arguments[1],y)){var p=arguments[0],d=arguments[1],g=arguments[2];return p.apply(new Sn(d,g)),d}}},e(In.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[ve]},getClass:function(){return In}}),e(bn.prototype,{locate:function(t){var e=new Zt(t),n=new Pn(e);return this.index.query(t.y,t.y,n),e.getLocation()},interfaces_:function(){return[un]},getClass:function(){return bn}}),e(Pn.prototype,{visitItem:function(t){var e=t;this.counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},interfaces_:function(){return[ve]},getClass:function(){return Pn}}),e(Mn.prototype,{init:function(t){for(var e=Sn.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},addLine:function(t){for(var e=1;e<t.length;e++){var n=new Yt(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this.index.insert(i,r,n)}},query:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new In;return this.index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this.index.query(i,r,o)}},interfaces_:function(){return[]},getClass:function(){return Mn}}),bn.SegmentVisitor=Pn,bn.IntervalIndexedGeometry=Mn,e(Tn.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},isEndPoint:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},interfaces_:function(){return[o]},getClass:function(){return Tn}}),e(Ln.prototype,{print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new p(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new An(o,new Ye(this.edge.label))},add:function(t,e,n){var i=new Tn(t,e,n),r=this.nodeMap.get(i);return null!==r?r:(this.nodeMap.put(i,i),i)},isIntersection:function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},interfaces_:function(){return[]},getClass:function(){return Ln}}),e(Nn.prototype,{getChainStartIndices:function(t){var e=0,n=new w;n.add(new L(e));do{var i=this.findChainEnd(t,e);n.add(new L(i)),e=i}while(e<t.length-1);return Nn.toIntArray(n)},findChainEnd:function(t,e){for(var n=Ae.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){if(Ae.quadrant(t[i-1],t[i])!==n)break;i++}return i-1},interfaces_:function(){return[]},getClass:function(){return Nn}}),Nn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(Rn.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},getMinX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n>e?e:n},computeIntersectsForChain:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],h=arguments[4],u=arguments[5],l=this.pts[r],c=this.pts[o],f=s.pts[a],p=s.pts[h];if(o-r==1&&h-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(l,c),this.env2.init(f,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+h)/2);d>r&&(g>a&&this.computeIntersectsForChain(r,d,s,a,g,u),h>g&&this.computeIntersectsForChain(r,d,s,g,h,u)),o>d&&(g>a&&this.computeIntersectsForChain(d,o,s,a,g,u),h>g&&this.computeIntersectsForChain(d,o,s,g,h,u))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},interfaces_:function(){return[]},getClass:function(){return Rn}}),e(On.prototype,{getDepth:function(t,e){return this.depth[t][e]},setDepth:function(t,e,n){this.depth[t][e]=n},isNull:function(){if(0===arguments.length){for(var t=0;2>t;t++)for(var e=0;3>e;e++)if(this.depth[t][e]!==On.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this.depth[n][1]===On.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.depth[i][r]===On.NULL_VALUE}},normalize:function(){for(var t=0;2>t;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),0>e&&(e=0);for(var n=1;3>n;n++){var i=0;this.depth[t][n]>e&&(i=1),this.depth[t][n]=i}}},getDelta:function(t){return this.depth[t][Ze.RIGHT]-this.depth[t][Ze.LEFT]},getLocation:function(t,e){return this.depth[t][e]<=0?b.EXTERIOR:b.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(1===arguments.length)for(var t=arguments[0],e=0;2>e;e++)for(var n=1;3>n;n++){var i=t.getLocation(e,n);i!==b.EXTERIOR&&i!==b.INTERIOR||(this.isNull(e,n)?this.depth[e][n]=On.depthAtLocation(i):this.depth[e][n]+=On.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===b.INTERIOR&&this.depth[r][o]++}},interfaces_:function(){return[]},getClass:function(){return On}}),On.depthAtLocation=function(t){return t===b.EXTERIOR?0:t===b.INTERIOR?1:On.NULL_VALUE},On.NULL_VALUE=-1,l(An,Qe),e(An.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new An(t,Ye.toLineLabel(this.label))},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof An))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},getCoordinate:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){An.updateIM(this.label,t)},isCollapsed:function(){return!!this.label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},getMonotoneChainEdge:function(){return null===this.mce&&(this.mce=new Rn(this)),this.mce},getEnvelope:function(){if(null===this.env){this.env=new E;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,e,n,i){var r=new p(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var h=this.pts[a];r.equals2D(h)&&(o=a,s=0)}this.eiList.add(r,o,s)},toString:function(){var t=new T;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[]},getClass:function(){return An}}),An.updateIM=function(){if(2!==arguments.length)return Qe.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Ze.ON),t.getLocation(1,Ze.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Ze.LEFT),t.getLocation(1,Ze.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Ze.RIGHT),t.getLocation(1,Ze.RIGHT),2))},l(Dn,on),e(Dn.prototype,{insertBoundaryPoint:function(t,e){var n=this.nodes.addNode(e).getLabel(),i=1;b.NONE;n.getLocation(t,Ze.ON)===b.BOUNDARY&&i++;var r=Dn.determineBoundary(this.boundaryNodeRule,i);n.setLocation(t,r)},computeSelfNodes:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new mn(n,!0,!1);o.setIsDoneIfProperInt(r);var s=this.createEdgeSetIntersector(),a=this.parentGeom instanceof It||this.parentGeom instanceof Et||this.parentGeom instanceof bt,h=i||!a;return s.computeIntersections(this.edges,o,h),this.addSelfIntersectionNodes(this.argIndex),o}},computeSplitEdges:function(t){for(var e=this.edges.iterator();e.hasNext();){e.next().eiList.addSplitEdges(t)}},computeEdgeIntersections:function(t,e,n){var i=new mn(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,i),i},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof wt){var t=arguments[0].getCoordinate();this.insertPoint(this.argIndex,t,b.INTERIOR)}else if(arguments[0]instanceof p){var e=arguments[0];this.insertPoint(this.argIndex,e,b.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),b.EXTERIOR,b.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,b.INTERIOR,b.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this.argIndex,e[0],b.BOUNDARY),this.insertPoint(this.argIndex,e[e.length-1],b.BOUNDARY)},addLineString:function(t){var e=Z.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=e[0],null;var n=new An(e,new Ye(this.argIndex,b.INTERIOR));this.lineEdgeMap.put(t,n),this.insertEdge(n),f.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,e[0]),this.insertBoundaryPoint(this.argIndex,e[e.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},getBoundaryNodes:function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,e,n){return this.isBoundaryNode(t,e)?null:void(n===b.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n))},addPolygonRing:function(t,e,n){if(t.isEmpty())return null;var i=Z.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=i[0],null;var r=e,o=n;Ut.isCCW(i)&&(r=n,o=e);var s=new An(i,new Ye(this.argIndex,b.BOUNDARY,r,o));this.lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this.argIndex,i[0],b.BOUNDARY)},insertPoint:function(t,e,n){var i=this.nodes.addNode(e),r=i.getLabel();null===r?i.label=new Ye(t,n):r.setLocation(t,n)},createEdgeSetIntersector:function(){return new vn},addSelfIntersectionNodes:function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},add:function(){if(1!==arguments.length)return on.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof bt&&(this.useBoundaryDeterminationRule=!1),t instanceof Et)this.addPolygon(t);else if(t instanceof _t)this.addLineString(t);else if(t instanceof wt)this.addPoint(t);else if(t instanceof St)this.addCollection(t);else if(t instanceof pt)this.addCollection(t);else if(t instanceof bt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},locate:function(t){return P(this.parentGeom,Ct)&&this.parentGeom.getNumGeometries()>50?(null===this.areaPtLocator&&(this.areaPtLocator=new bn(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(1===arguments.length){var t=arguments[0];return this.lineEdgeMap.get(t)}return on.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return Dn}}),Dn.determineBoundary=function(t,e){return t.isInBoundary(e)?b.BOUNDARY:b.INTERIOR},e(kn.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return kn}}),e(Fn.prototype,{compareTo:function(t){var e=t;return Fn.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},interfaces_:function(){return[o]},getClass:function(){return Fn}}),Fn.orientation=function(t){return 1===Z.increasingDirection(t)},Fn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,h=e?0:t.length-1,u=i?0:n.length-1;;){var l=t[h].compareTo(n[u]);if(0!==l)return l;var c=(h+=r)===s,f=(u+=o)===a;if(c&&!f)return-1;if(!c&&f)return 1;if(c&&f)return 0}},e(Gn.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this.edges.size();e++){var n=this.edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},findEdgeIndex:function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var e=new Fn(t.getCoordinates());return this.ocaMap.get(e)},add:function(t){this.edges.add(t);var e=new Fn(t.getCoordinates());this.ocaMap.put(e,t)},interfaces_:function(){return[]},getClass:function(){return Gn}}),l(zn,kn),e(zn.prototype,{insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Ye(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},isCoveredByLA:function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,e,n,i){var r=new w;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?zn.createEmptyResult(i,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(r)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().mergeSymLabels()}},isCovered:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this.ptLocator.locate(t,i)!==b.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new w,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new w;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),qe.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new sn(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var i=new an(this,this.geomFact,this.ptLocator);this.resultLineList=i.build(t);var r=new hn(this,this.geomFact,this.ptLocator);this.resultPointList=r.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},copyPoints:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&zn.isResultOfOp(i.getLocation(0,Ze.RIGHT),i.getLocation(1,Ze.RIGHT),t)&&n.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;2>r;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(f.isTrue(!i.isNull(r,Ze.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Ze.LEFT,i.getLocation(r,Ze.LEFT)),f.isTrue(!i.isNull(r,Ze.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Ze.RIGHT,i.getLocation(r,Ze.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(0,n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return zn}}),zn.overlayOp=function(t,e,n){return new zn(t,e).getResultGeometry(n)},zn.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return zn.createEmptyResult(zn.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return We.map(t,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bn.overlayOp(t,e,zn.INTERSECTION)},zn.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return zn.createEmptyResult(zn.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bn.overlayOp(t,e,zn.SYMDIFFERENCE)},zn.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case zn.INTERSECTION:o=Math.min(i,r);break;case zn.UNION:o=Math.max(i,r);break;case zn.DIFFERENCE:o=i;break;case zn.SYMDIFFERENCE:o=Math.max(i,r)}return o},zn.createEmptyResult=function(t,e,n,i){var r=null;switch(zn.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},zn.difference=function(t,e){return t.isEmpty()?zn.createEmptyResult(zn.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bn.overlayOp(t,e,zn.DIFFERENCE))},zn.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return zn.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===b.BOUNDARY&&(r=b.INTERIOR),o===b.BOUNDARY&&(o=b.INTERIOR),s){case zn.INTERSECTION:return r===b.INTERIOR&&o===b.INTERIOR;case zn.UNION:return r===b.INTERIOR||o===b.INTERIOR;case zn.DIFFERENCE:return r===b.INTERIOR&&o!==b.INTERIOR;case zn.SYMDIFFERENCE:return r===b.INTERIOR&&o!==b.INTERIOR||r!==b.INTERIOR&&o===b.INTERIOR}return!1}},zn.INTERSECTION=1,zn.UNION=2,zn.DIFFERENCE=3,zn.SYMDIFFERENCE=4,e(jn.prototype,{selfSnap:function(t){return new re(t).snapTo(t,this.snapTolerance)},removeCommonBits:function(t){this.cbr=new ae,this.cbr.add(t[0]),this.cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this.cbr.removeCommonBits(t[0].copy()),e[1]=this.cbr.removeCommonBits(t[1].copy()),e},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var e=this.snap(this.geom),n=zn.overlayOp(e[0],e[1],t);return this.prepareResult(n)},checkValid:function(t){t.isValid()||D.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=re.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var e=this.removeCommonBits(t);return re.snap(e[0],e[1],this.snapTolerance)},interfaces_:function(){return[]},getClass:function(){return jn}}),jn.overlayOp=function(t,e,n){return new jn(t,e).getResultGeometry(n)},jn.union=function(t,e){return jn.overlayOp(t,e,zn.UNION)},jn.intersection=function(t,e){return jn.overlayOp(t,e,zn.INTERSECTION)},jn.symDifference=function(t,e){return jn.overlayOp(t,e,zn.SYMDIFFERENCE)},jn.difference=function(t,e){return jn.overlayOp(t,e,zn.DIFFERENCE)},e(Bn.prototype,{getResultGeometry:function(t){var e=null,n=!1,i=null;try{e=zn.overlayOp(this.geom[0],this.geom[1],t);n=!0}catch(t){if(!(t instanceof u))throw t;i=t}if(!n)try{e=jn.overlayOp(this.geom[0],this.geom[1],t)}catch(t){throw t instanceof u?i:t}return e},interfaces_:function(){return[]},getClass:function(){return Bn}}),Bn.overlayOp=function(t,e,n){return new Bn(t,e).getResultGeometry(n)},Bn.union=function(t,e){return Bn.overlayOp(t,e,zn.UNION)},Bn.intersection=function(t,e){return Bn.overlayOp(t,e,zn.INTERSECTION)},Bn.symDifference=function(t,e){return Bn.overlayOp(t,e,zn.SYMDIFFERENCE)},Bn.difference=function(t,e){return Bn.overlayOp(t,e,zn.DIFFERENCE)},e(Hn.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var e=null,n=0,i=this.horizontalBisector(t);if(0===i.getLength())n=0,e=i.getCoordinate();else{var r=Bn.overlayOp(i,t,zn.INTERSECTION),o=this.widestGeometry(r);n=o.getEnvelopeInternal().getWidth(),e=Hn.centre(o.getEnvelopeInternal())}(null===this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof ft){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof z){var i=arguments[0];return i instanceof ft?this.widestGeometry(i):i}},horizontalBisector:function(t){var e=t.getEnvelopeInternal(),n=Vn.getBisectorY(t);return this.factory.createLineString([new p(e.getMinX(),n),new p(e.getMaxX(),n)])},add:function(t){if(t instanceof Et)this.addPolygon(t);else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},interfaces_:function(){return[]},getClass:function(){return Hn}}),Hn.centre=function(t){return new p(Hn.avg(t.getMinX(),t.getMaxX()),Hn.avg(t.getMinY(),t.getMaxY()))},Hn.avg=function(t,e){return(t+e)/2},e(Vn.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));return Hn.avg(this.hiY,this.loY)},process:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var i=e.getY(n);this.updateInterval(i)}},interfaces_:function(){return[]},getClass:function(){return Vn}}),Vn.getBisectorY=function(t){return new Vn(t).getBisectorY()},Hn.SafeBisectorFinder=Vn,e(qn.prototype,{addEndpoints:function(){if(arguments[0]instanceof z){var t=arguments[0];if(t instanceof _t)this.addEndpoints(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof z){var t=arguments[0];if(t instanceof _t)this.addInterior(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];for(n=1;n<i.length-1;n++)this.add(i[n])}},add:function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new p(t),this.minDistance=e)},interfaces_:function(){return[]},getClass:function(){return qn}}),e(Wn.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof z){var t=arguments[0];if(t instanceof wt)this.add(t.getCoordinate());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof p){var i=arguments[0],r=i.distance(this.centroid);r<this.minDistance&&(this.interiorPoint=new p(i),this.minDistance=r)}},interfaces_:function(){return[]},getClass:function(){return Wn}}),e(Zn.prototype,{interfaces_:function(){return[]},getClass:function(){return Zn}}),Zn.toDegrees=function(t){return 180*t/Math.PI},Zn.normalize=function(t){for(;t>Math.PI;)t-=Zn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Zn.PI_TIMES_2;return t},Zn.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Zn.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Zn.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0>i*(n.x-e.x)+r*(n.y-e.y)},Zn.interiorAngle=function(t,e,n){var i=Zn.angle(e,t),r=Zn.angle(e,n);return Math.abs(r-i)},Zn.normalizePositive=function(t){if(0>t){for(;0>t;)t+=Zn.PI_TIMES_2;t>=Zn.PI_TIMES_2&&(t=0)}else{for(;t>=Zn.PI_TIMES_2;)t-=Zn.PI_TIMES_2;0>t&&(t=0)}return t},Zn.angleBetween=function(t,e,n){var i=Zn.angle(e,t),r=Zn.angle(e,n);return Zn.diff(i,r)},Zn.diff=function(t,e){var n=null;return(n=e>t?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Zn.toRadians=function(t){return t*Math.PI/180},Zn.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Zn.COUNTERCLOCKWISE:0>n?Zn.CLOCKWISE:Zn.NONE},Zn.angleBetweenOriented=function(t,e,n){var i=Zn.angle(e,t),r=Zn.angle(e,n)-i;return r<=-Math.PI?r+Zn.PI_TIMES_2:r>Math.PI?r-Zn.PI_TIMES_2:r},Zn.PI_TIMES_2=2*Math.PI,Zn.PI_OVER_2=Math.PI/2,Zn.PI_OVER_4=Math.PI/4,Zn.COUNTERCLOCKWISE=Ut.COUNTERCLOCKWISE,Zn.CLOCKWISE=Ut.CLOCKWISE,Zn.NONE=Ut.COLLINEAR,e(Un.prototype,{area:function(){return Un.area(this.p0,this.p1,this.p2)},signedArea:function(){return Un.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(null===t)throw new i("Supplied point is null.");return Un.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return Un.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return Un.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return Un.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return Un.area3D(this.p0,this.p1,this.p2)},centroid:function(){return Un.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return Un.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return Un}}),Un.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Un.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Un.det=function(t,e,n,i){return t*i-e*n},Un.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,h=n.y-o,u=i.y-o,l=s*u-a*h,c=t.x-r,f=t.y-o,p=(u*c-a*f)/l,d=(-h*c+s*f)/l;return e.z+p*(n.z-e.z)+d*(i.z-e.z)},Un.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},Un.isAcute=function(t,e,n){return!(!Zn.isAcute(t,e,n)||!Zn.isAcute(e,n,t))&&!!Zn.isAcute(n,t,e)},Un.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,h=e.y-r,u=2*Un.det(o,s,a,h);return new p(i-Un.det(s,o*o+s*s,h,a*a+h*h)/u,r+Un.det(o,o*o+s*s,a,a*a+h*h)/u)},Un.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y;return new k(new k(t.x+n/2,t.y+i/2,1),new k(t.x-i+n/2,t.y+n+i/2,1))},Un.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new p(t.x+r*o,t.y+r*s)},Un.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,h=n.z-t.z,u=r*h-o*a,l=o*s-i*h,c=i*a-r*s,f=u*u+l*l+c*c;return Math.sqrt(f)/2},Un.centroid=function(t,e,n){return new p((t.x+e.x+n.x)/3,(t.y+e.y+n.y)/3)},Un.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o;return new p((i*t.x+r*e.x+o*n.x)/s,(i*t.y+r*e.y+o*n.y)/s)},e(Yn.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[1];return this.input.getFactory().createLineString([t,e])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(1===this.input.getNumPoints()){var t=this.input.getCoordinates();return this.extremalPts=[new p(t[0])],null}var e=this.input.convexHull().getCoordinates();t=e;if(e[0].equals2D(e[e.length-1])&&(t=new Array(e.length-1).fill(null),Z.copyDeep(e,0,t,0,e.length-1)),t.length<=2)return this.extremalPts=Z.copyDeep(t),null;for(var n=Yn.lowestPoint(t),i=Yn.pointWitMinAngleWithX(t,n),r=0;r<t.length;r++){var o=Yn.pointWithMinAngleWithSegment(t,n,i);if(Zn.isObtuse(n,o,i))return this.extremalPts=[new p(n),new p(i)],null;if(Zn.isObtuse(o,n,i))n=o;else{if(!Zn.isObtuse(o,i,n))return this.extremalPts=[new p(n),new p(i),new p(o)],null;i=o}}f.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){return null!==this.extremalPts?null:(this.computeCirclePoints(),this.computeCentre(),void(null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0]))))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,e])},getCircle:function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new p((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=Un.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return Yn}}),Yn.pointWitMinAngleWithX=function(t,e){for(var n=r.MAX_VALUE,i=null,o=0;o<t.length;o++){var s=t[o];if(s!==e){var a=s.x-e.x,h=s.y-e.y;0>h&&(h=-h);var u=h/Math.sqrt(a*a+h*h);n>u&&(n=u,i=s)}}return i},Yn.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},Yn.pointWithMinAngleWithSegment=function(t,e,n){for(var i=r.MAX_VALUE,o=null,s=0;s<t.length;s++){var a=t[s];if(a!==e&&a!==n){var h=Zn.angleBetween(e,a,n);i>h&&(i=h,o=a)}}return o},e(Xn.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){this.convexHullPts=t instanceof Et?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=r.MAX_VALUE;for(var e=1,n=new Yt,i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)},computeMinimumDiameter:function(){if(null!==this.minWidthPt)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new te(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,e,n){for(var i=e.distancePerpendicular(t[n]),r=i,o=n,s=o;r>=i;)i=r,o=s,s=Xn.nextIndex(t,o),r=e.distancePerpendicular(t[s]);return i<this.minWidth&&(this.minPtIndex=o,this.minWidth=i,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new Yt(e)),o},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=r.MAX_VALUE,i=-r.MAX_VALUE,o=r.MAX_VALUE,s=-r.MAX_VALUE,a=0;a<this.convexHullPts.length;a++){var h=Xn.computeC(t,e,this.convexHullPts[a]);h>i&&(i=h),n>h&&(n=h);var u=Xn.computeC(-e,t,this.convexHullPts[a]);u>s&&(s=u),o>u&&(o=u)}var l=Xn.computeSegmentForLine(-t,-e,s),c=Xn.computeSegmentForLine(-t,-e,o),f=Xn.computeSegmentForLine(-e,t,i),p=Xn.computeSegmentForLine(-e,t,n),d=f.lineIntersection(l),g=p.lineIntersection(l),y=p.lineIntersection(c),m=f.lineIntersection(c),v=this.inputGeom.getFactory().createLinearRing([d,g,y,m,d]);return this.inputGeom.getFactory().createPolygon(v,null)},interfaces_:function(){return[]},getClass:function(){return Xn}}),Xn.nextIndex=function(t,e){return++e>=t.length&&(e=0),e},Xn.computeC=function(t,e,n){return t*n.y-e*n.x},Xn.getMinimumDiameter=function(t){return new Xn(t).getDiameter()},Xn.getMinimumRectangle=function(t){return new Xn(t).getMinimumRectangle()},Xn.computeSegmentForLine=function(t,e,n){var i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new p(0,n/e),r=new p(1,n/e-t/e)):(i=new p(n/t,0),r=new p(n/t-e/t,1)),new Yt(i,r)};var Zo=Object.freeze({Centroid:Jt,CGAlgorithms:Ut,ConvexHull:te,InteriorPointArea:Hn,InteriorPointLine:qn,InteriorPointPoint:Wn,RobustLineIntersector:qt,MinimumBoundingCircle:Yn,MinimumDiameter:Xn});e(Jn.prototype,{getResultGeometry:function(){return new Kn(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>=t)throw new i("Tolerance must be positive");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return Jn}}),Jn.densifyPoints=function(t,e,n){for(var i=new Yt,r=new C,o=0;o<t.length-1;o++){i.p0=t[o],i.p1=t[o+1],r.add(i.p0,!1);var s=i.getLength(),a=Math.trunc(s/e)+1;if(a>1)for(var h=s/a,u=1;a>u;u++){var l=u*h/s,c=i.pointAlong(l);n.makePrecise(c),r.add(c,!1)}}return r.add(t[t.length-1],!1),r.toCoordinateArray()},Jn.densify=function(t,e){var n=new Jn(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(Kn,ne),e(Kn.prototype,{transformMultiPolygon:function(t,e){var n=ne.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformPolygon:function(t,e){var n=ne.prototype.transformPolygon.call(this,t,e);return e instanceof bt?n:this.createValidArea(n)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=Jn.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof _t&&1===i.length&&(i=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(i)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return Kn}}),Jn.DensifyTransformer=Kn;var Uo=Object.freeze({Densifier:Jn});e(Qn.prototype,{find:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var i=n.oNext();if(i.compareTo(t)!==e||i===this)return n.insertAfter(t),null;n=i}while(n!==this);f.shouldNeverReachHere()},insertAfter:function(t){f.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)},degree:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t},equals:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var e=this.deltaX(),n=this.deltaY(),i=t.deltaX(),r=t.deltaY();if(e===i&&n===r)return 0;var o=Ae.quadrant(e,n),s=Ae.quadrant(i,r);return o>s?1:s>o?-1:Ut.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t},compareTo:function(t){var e=t;return this.compareAngularDirection(e)},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return Qn}}),Qn.init=function(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t},Qn.create=function(t,e){var n=new Qn(t),i=new Qn(e);return n.init(i),n},l($n,Qn),e($n.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return $n}}),$n.setMarkBoth=function(t,e){t.setMark(e),t.sym().setMark(e)},$n.isMarked=function(t){return t.isMarked()},$n.setMark=function(t,e){t.setMark(e)},$n.markBoth=function(t){t.mark(),t.sym().mark()},$n.mark=function(t){t.mark()},e(ti.prototype,{insert:function(t,e,n){var i=this.create(t,e);null!==n?n.insert(i):this.vertexMap.put(t,i);var r=this.vertexMap.get(e);return null!==r?r.insert(i.sym()):this.vertexMap.put(e,i.sym()),i},create:function(t,e){var n=this.createEdge(t),i=this.createEdge(e);return Qn.init(n,i),n},createEdge:function(t){return new Qn(t)},addEdge:function(t,e){if(!ti.isValidEdge(t,e))return null;var n=this.vertexMap.get(t),i=null;return null!==n&&(i=n.find(e)),null!==i?i:this.insert(t,e,n)},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,e){var n=this.vertexMap.get(t);return null===n?null:n.find(e)},interfaces_:function(){return[]},getClass:function(){return ti}}),ti.isValidEdge=function(t,e){return 0!==e.compareTo(t)},l(ei,$n),e(ei.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return ei}}),l(ni,ti),e(ni.prototype,{createEdge:function(t){return new ei(t)},interfaces_:function(){return[]},getClass:function(){return ni}}),e(ii.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym()).isStart()?null===this.ringStartEdge?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return null===this.result&&this.computeResult(),this.result},process:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()},buildRing:function(t){var e=new C,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)},buildLine:function(t){var e=new C,n=t;for(this.ringStartEdge=null,$n.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var i=n.next();if(i===t)return this.buildRing(this.ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,$n.markBoth(n)}e.add(n.dest().copy(),!1),this.stackEdges(n.sym()),this.addLine(e)},stackEdges:function(t){var e=t;do{$n.isMarked(e)||this.nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();$n.isMarked(e)||this.process(e)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();$n.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof z)arguments[0].apply({interfaces_:function(){return[G]},filter:function(t){t instanceof _t&&this.add(t)}});else if(P(arguments[0],y))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof _t){var n=arguments[0];null===this.factory&&(this.factory=n.getFactory());var i=n.getCoordinateSequence(),r=!1;for(t=1;t<i.size();t++){var o=this.graph.addEdge(i.getCoordinate(t-1),i.getCoordinate(t));null!==o&&(r||(o.setStart(),r=!0))}}},interfaces_:function(){return[]},getClass:function(){return ii}}),ii.dissolve=function(t){var e=new ii;return e.add(t),e.getResult()};var Yo=Object.freeze({LineDissolver:ii});e(ri.prototype,{hasChildren:function(){for(var t=0;4>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;4>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},getNodeCount:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},size:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this.items);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].addAllItemsFromOverlapping(t,e)},visitItems:function(t,e){for(var n=this.items.iterator();n.hasNext();)e.visitItem(n.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;4>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},visit:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;4>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},isEmpty:function(){var t=!0;this.items.isEmpty()||(t=!1);for(var e=0;4>e;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},add:function(t){this.items.add(t)},interfaces_:function(){return[h]},getClass:function(){return ri}}),ri.getSubnodeIndex=function(t,e,n){var i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i},oi.exponent=function(t){return function(t,e){var n,i,r,o,s={32:8,64:11}[t];if(o||(n=0>e||0>1/e,isFinite(e)||(o={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}}[t],n&&(o.d+=1<<t/4-1),i=Math.pow(2,s)-1,r=0)),!o){for(i={32:127,64:1023}[t],r=Math.abs(e);r>=2;)i++,r/=2;for(;1>r&&i>0;)i--,r*=2;0>=i&&(r/=2),32===t&&i>254&&(o={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,s)-1,r=0)}return i}(64,t)-1023},oi.powerOf2=function(t){return Math.pow(2,t)},e(si.prototype,{getLevel:function(){return this.level},computeKey:function(){if(1===arguments.length){var t=arguments[0];for(this.level=si.computeQuadLevel(t),this.env=new E,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=oi.powerOf2(e);this.pt.x=Math.floor(n.getMinX()/i)*i,this.pt.y=Math.floor(n.getMinY()/i)*i,this.env.init(this.pt.x,this.pt.x+i,this.pt.y,this.pt.y+i)}},getEnvelope:function(){return this.env},getCentre:function(){return new p((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return si}}),si.computeQuadLevel=function(t){var e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return oi.exponent(i)+1},l(ai,ri),e(ai.prototype,{find:function(t){var e=ri.getSubnodeIndex(t,this.centrex,this.centrey);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var e=ri.getSubnodeIndex(t,this.centrex,this.centrey);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0,i=0,r=0;switch(t){case 0:e=this.env.getMinX(),n=this.centrex,i=this.env.getMinY(),r=this.centrey;break;case 1:e=this.centrex,n=this.env.getMaxX(),i=this.env.getMinY(),r=this.centrey;break;case 2:e=this.env.getMinX(),n=this.centrex,i=this.centrey,r=this.env.getMaxY();break;case 3:e=this.centrex,n=this.env.getMaxX(),i=this.centrey,r=this.env.getMaxY()}return new ai(new E(e,n,i,r),this.level-1)},insertNode:function(t){f.isTrue(null===this.env||this.env.contains(t.env));var e=ri.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this.subnode[e]=n}},interfaces_:function(){return[]},getClass:function(){return ai}}),ai.createNode=function(t){var e=new si(t);return new ai(e.getEnvelope(),e.getLevel())},ai.createExpanded=function(t,e){var n=new E(e);null!==t&&n.expandToInclude(t.env);var i=ai.createNode(n);return null!==t&&i.insertNode(t),i},e(hi.prototype,{interfaces_:function(){return[]},getClass:function(){return hi}}),hi.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var i=n/Math.max(Math.abs(t),Math.abs(e));return oi.exponent(i)<=hi.MIN_BINARY_EXPONENT},hi.MIN_BINARY_EXPONENT=-50,l(ui,ri),e(ui.prototype,{insert:function(t,e){var n=ri.getSubnodeIndex(t,ui.origin.x,ui.origin.y);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getEnvelope().contains(t)){var r=ai.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getEnvelope().contains(e));var i=hi.isZeroWidth(e.getMinX(),e.getMaxX()),r=hi.isZeroWidth(e.getMinY(),e.getMaxY());(i||r?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return ui}}),ui.origin=new p(0,0),e(li.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=li.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){var t=arguments[0],e=new In;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],i=arguments[1];this.root.visit(n,i)}},queryAll:function(){var t=new w;return this.root.addAllItems(t),t},remove:function(t,e){var n=li.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return null!==this.root?this.root.depth():0},isEmpty:function(){return null===this.root},interfaces_:function(){return[_e,h]},getClass:function(){return li}}),li.ensureExtent=function(t,e){var n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),o=t.getMaxY();return n!==i&&r!==o?t:(n===i&&(i=(n-=e/2)+e/2),r===o&&(o=(r-=e/2)+e/2),new E(n,i,r,o))},li.serialVersionUID=-0x678b60c967a25400;var Xo=Object.freeze({Quadtree:li}),Jo=Object.freeze({STRtree:Se}),Ko=Object.freeze({quadtree:Xo,strtree:Jo}),Qo=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];e(ci.prototype,{read:function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!$o[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Qo.indexOf(n)?$o[n].apply(this,[e.coordinates]):"GeometryCollection"===n?$o[n].apply(this,[e.geometries]):$o[n].apply(this,[e])},write:function(t){var e=t.getGeometryType();if(!ts[e])throw new Error("Geometry is not supported");return ts[e].apply(this,[t])}});var $o={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!$o[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=$o.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new p(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new p(t[0],t[1]),new p(t[2],t[1]),new p(t[2],t[3]),new p(t[0],t[3]),new p(t[0],t[1])])},Point:function(t){var e=new p(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push($o.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=$o.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push($o.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=$o.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=$o.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push($o.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},ts={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:ts.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=ts.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(ts.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=ts.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=ts.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var i=0;i<t.holes.length;++i){var r=t.holes[i],o=ts.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=ts.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=i.getGeometryType();e.push(ts[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}};e(fi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Gt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;n>e;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;n>e;e++)this.reducePrecision(t.geometries[e])}}),e(pi.prototype,{write:function(t){return this.parser.write(t)}}),e(di.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Gt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var e=0,n=t.points.coordinates.length;n>e;e++)this.precisionModel.makePrecise(t.points.coordinates[e]);else if(t.geometries)for(var i=0,r=t.geometries.length;r>i;i++)this.reducePrecision(t.geometries[i])}}),e(yi.prototype,{read:function(t){return t instanceof ol.geom.Point?this.convertFromPoint(t):t instanceof ol.geom.LineString?this.convertFromLineString(t):t instanceof ol.geom.LinearRing?this.convertFromLinearRing(t):t instanceof ol.geom.Polygon?this.convertFromPolygon(t):t instanceof ol.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof ol.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof ol.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof ol.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new p(e[0],e[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new p(t[0],t[1])}))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new p(t[0],t[1])}))},convertFromPolygon:function(t){for(var e=t.getLinearRings(),n=null,i=[],r=0;r<e.length;r++){var o=this.convertFromLinearRing(e[r]);0===r?n=o:i.push(o)}return this.geometryFactory.createPolygon(n,i)},convertFromMultiPoint:function(t){var e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)},convertFromMultiLineString:function(t){var e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)},convertFromMultiPolygon:function(t){var e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)},convertFromCollection:function(t){var e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)},write:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0},convertToPoint:function(t){return new ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var e=t.points.coordinates.map(gi);return new ol.geom.LineString(e)},convertToLinearRing:function(t){var e=t.points.coordinates.map(gi);return new ol.geom.LinearRing(e)},convertToPolygon:function(t){for(var e=[t.shell.points.coordinates.map(gi)],n=0;n<t.holes.length;n++)e.push(t.holes[n].points.coordinates.map(gi));return new ol.geom.Polygon(e)},convertToMultiPoint:function(t){return new ol.geom.MultiPoint(t.getCoordinates().map(gi))},convertToMultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToLineString(t.geometries[n]).getCoordinates());return new ol.geom.MultiLineString(e)},convertToMultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToPolygon(t.geometries[n]).getCoordinates());return new ol.geom.MultiPolygon(e)},convertToCollection:function(t){for(var e=[],n=0;n<t.geometries.length;n++){var i=t.geometries[n];e.push(this.write(i))}return new ol.geom.GeometryCollection(e)}});var es=Object.freeze({GeoJSONReader:fi,GeoJSONWriter:pi,OL3Parser:yi,WKTReader:di,WKTWriter:Ht});e(mi.prototype,{rescale:function(){if(P(arguments[0],y))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){var n=arguments[0];2===n.length&&(new p(n[0]),new p(n[1]));for(t=0;t<n.length;t++)n[t].x=n[t].x/this.scaleFactor+this.offsetX,n[t].y=n[t].y/this.scaleFactor+this.offsetY;2===n.length&&n[0].equals2D(n[1])&&D.out.println(n)}},scale:function(){if(P(arguments[0],y)){for(var t=arguments[0],e=new w,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ne(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){var r=arguments[0],o=new Array(r.length).fill(null);for(n=0;n<r.length;n++)o[n]=new p(Math.round((r[n].x-this.offsetX)*this.scaleFactor),Math.round((r[n].y-this.offsetY)*this.scaleFactor),r[n].z);return Z.removeRepeatedPoints(o)}},isIntegerPrecision:function(){return 1===this.scaleFactor},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},interfaces_:function(){return[ke]},getClass:function(){return mi}});var ns=Object.freeze({MCIndexNoder:Ge,ScaledNoder:mi,SegmentString:pe});e(vi.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var e=new at,n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n).getCoordinate();if(e.contains(i))return this.nonSimpleLocation=i,!1;e.add(i)}return!0},isSimplePolygonal:function(t){for(var e=Sn.getLines(t).iterator();e.hasNext();){var n=e.next();if(!this.isSimpleLinearGeometry(n))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var e=new rt,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),r=(i.getMaximumSegmentIndex(),i.isClosed()),o=i.getCoordinate(0);this.addEndpoint(e,o,r);var s=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,s,r)}for(n=e.values().iterator();n.hasNext();){var a=n.next();if(a.isClosed&&2!==a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var e=new Dn(0,t),n=new qt,i=e.computeSelfNodes(n,!0);return!i.hasIntersection()||(i.hasProperIntersection()?(this.nonSimpleLocation=i.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(e)&&(!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(e)))},hasNonEndpointIntersection:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next();if(!o.isEndPoint(i))return this.nonSimpleLocation=o.getCoordinate(),!0}return!1},addEndpoint:function(t,e,n){var i=t.get(e);null===i&&(i=new _i(e),t.put(e,i)),i.addEndpoint(n)},computeSimple:function(t){return this.nonSimpleLocation=null,!!t.isEmpty()||(t instanceof _t?this.isSimpleLinearGeometry(t):t instanceof pt?this.isSimpleLinearGeometry(t):t instanceof St?this.isSimpleMultiPoint(t):P(t,Ct)?this.isSimplePolygonal(t):!(t instanceof ft)||this.isSimpleGeometryCollection(t))},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return vi}}),e(_i.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return _i}}),vi.EndpointInfo=_i,e(xi.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=xi.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=xi.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),0>=t&&(this.quadrantSegments=1),this.joinStyle!==xi.JOIN_ROUND&&(this.quadrantSegments=xi.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=0>t?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return xi}}),xi.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},xi.CAP_ROUND=1,xi.CAP_FLAT=2,xi.CAP_SQUARE=3,xi.JOIN_ROUND=1,xi.JOIN_MITRE=2,xi.JOIN_BEVEL=3,xi.DEFAULT_QUADRANT_SEGMENTS=8,xi.DEFAULT_MITRE_LIMIT=5,xi.DEFAULT_SIMPLIFY_FACTOR=.01,e(wi.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return 0>n&&(n=this.getRightmostSideOfSegment(t,e-1)),0>n&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();f.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],i=Ut.computeOrientation(this.minCoord,n,e),r=!1;e.y<this.minCoord.y&&n.y<this.minCoord.y&&i===Ut.COUNTERCLOCKWISE?r=!0:e.y>this.minCoord.y&&n.y>this.minCoord.y&&i===Ut.CLOCKWISE&&(r=!0),r&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,e){var n=t.getEdge().getCoordinates();if(0>e||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Ze.LEFT;return n[e].y<n[e+1].y&&(i=Ze.RIGHT),i},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode().getEdges();this.minDe=t.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}f.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)===Ze.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return wi}}),Ci.prototype.addLast=function(t){this.array_.push(t)},Ci.prototype.removeFirst=function(){return this.array_.shift()},Ci.prototype.isEmpty=function(){return 0===this.array_.length},e(Ei.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){if((i=n.next()).isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new je("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(n=t.getEdges().iterator();n.hasNext();){var i;(i=n.next()).setVisited(!0),this.copySymDepths(i)}},computeDepth:function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Ze.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Ze.RIGHT)>=1&&e.getDepth(Ze.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},computeDepths:function(t){var e=new Q,n=new Ci,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},compareTo:function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},getEnvelope:function(){if(null===this.env){for(var t=new E,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this.env=t}return this.env},addReachable:function(t){var e=new Qt;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},copySymDepths:function(t){var e=t.getSym();e.setDepth(Ze.LEFT,t.getDepth(Ze.RIGHT)),e.setDepth(Ze.RIGHT,t.getDepth(Ze.LEFT))},add:function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this.dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[o]},getClass:function(){return Ei}}),e(Si.prototype,{isDeletable:function(t,e,n,i){var r=this.inputLine[t],o=this.inputLine[e],s=this.inputLine[n];return!(!this.isConcave(r,o,s)||!this.isShallow(r,o,s,i))&&this.isShallowSampled(r,o,t,n,i)},deleteShallowConcavities:function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),i=!1;n<this.inputLine.length;){var r=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=Si.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},isShallowConcavity:function(t,e,n,i){return Ut.computeOrientation(t,e,n)===this.angleOrientation&&i>Ut.distancePointLine(e,t,n)},isShallowSampled:function(t,e,n,i,r){var o=Math.trunc((i-n)/Si.NUM_PTS_TO_CHECK);0>=o&&(o=1);for(var s=n;i>s;s+=o)if(!this.isShallow(t,e,this.inputLine[s],r))return!1;return!0},isConcave:function(t,e,n){var i=Ut.computeOrientation(t,e,n)===this.angleOrientation;return i},simplify:function(t){this.distanceTol=Math.abs(t),0>t&&(this.angleOrientation=Ut.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===Si.DELETE;)e++;return e},isShallow:function(t,e,n,i){return i>Ut.distancePointLine(e,t,n)},collapseLine:function(){for(var t=new C,e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==Si.DELETE&&t.add(this.inputLine[e]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return Si}}),Si.simplify=function(t,e){return new Si(t).simplify(e)},Si.INIT=0,Si.DELETE=1,Si.KEEP=1,Si.NUM_PTS_TO_CHECK=10,e(Ii.prototype,{getCoordinates:function(){return this.ptList.toArray(Ii.COORDINATE_ARRAY_TYPE)},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var e=new p(t);return this.precisionModel.makePrecise(e),this.isRedundant(e)?null:void this.ptList.add(e)},reverse:function(){},addPts:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(n=t.length-1;n>=0;n--)this.addPt(t[n])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var e=this.ptList.get(this.ptList.size()-1);return t.distance(e)<this.minimimVertexDistance},toString:function(){return(new jt).createLineString(this.getCoordinates()).toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new p(this.ptList.get(0)),e=this.ptList.get(this.ptList.size()-1);return this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(e)?null:void this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Ii}}),Ii.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),e(bi.prototype,{addNextSegment:function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var n=Ut.computeOrientation(this.s0,this.s1,this.s2),i=n===Ut.CLOCKWISE&&this.side===Ze.LEFT||n===Ut.COUNTERCLOCKWISE&&this.side===Ze.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},addLineEndCap:function(t,e){var n=new Yt(t,e),i=new Yt;this.computeOffsetSegment(n,Ze.LEFT,this.distance,i);var r=new Yt;this.computeOffsetSegment(n,Ze.RIGHT,this.distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this.bufParams.getEndCapStyle()){case xi.CAP_ROUND:this.segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,Ut.CLOCKWISE,this.distance),this.segList.addPt(r.p1);break;case xi.CAP_FLAT:this.segList.addPt(i.p1),this.segList.addPt(r.p1);break;case xi.CAP_SQUARE:var h=new p;h.x=Math.abs(this.distance)*Math.cos(a),h.y=Math.abs(this.distance)*Math.sin(a);var u=new p(i.p1.x+h.x,i.p1.y+h.y),l=new p(r.p1.x+h.x,r.p1.y+h.y);this.segList.addPt(u),this.segList.addPt(l)}},getCoordinates:function(){return this.segList.getCoordinates()},addMitreJoin:function(t,e,n,i){var r=!0,o=null;try{o=k.intersection(e.p0,e.p1,n.p0,n.p1),(0>=i?1:o.distance(t)/Math.abs(i))>this.bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof I))throw t;o=new p(0,0),r=!1}r?this.segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this.bufParams.getMitreLimit())},addFilletCorner:function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),h=n.x-t.x,u=n.y-t.y,l=Math.atan2(u,h);i===Ut.CLOCKWISE?l>=a&&(a+=2*Math.PI):a>=l&&(a-=2*Math.PI),this.segList.addPt(e),this.addFilletArc(t,a,l,i,r),this.segList.addPt(n)},addOutsideTurn:function(t,e){return this.offset0.p1.distance(this.offset1.p0)<this.distance*bi.OFFSET_SEGMENT_SEPARATION_FACTOR?(this.segList.addPt(this.offset0.p1),null):void(this.bufParams.getJoinStyle()===xi.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===xi.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},createSquare:function(t){this.segList.addPt(new p(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new p(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new p(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new p(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,e){this.segList.addPts(t,e)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(t,e),this.computeOffsetSegment(this.seg1,n,this.distance,this.offset1)},addLimitedMitreJoin:function(t,e,n,i){var r=this.seg0.p1,o=Zn.angle(r,this.seg0.p0),s=(Zn.angle(r,this.seg1.p1),Zn.angleBetweenOriented(this.seg0.p0,r,this.seg1.p1))/2,a=Zn.normalize(o+s),h=Zn.normalize(a+Math.PI),u=i*n,l=n-u*Math.abs(Math.sin(s)),c=new Yt(r,new p(r.x+u*Math.cos(h),r.y+u*Math.sin(h))),f=c.pointAlongOffset(1,l),d=c.pointAlongOffset(1,-l);this.side===Ze.LEFT?(this.segList.addPt(f),this.segList.addPt(d)):(this.segList.addPt(d),this.segList.addPt(f))},computeOffsetSegment:function(t,e,n,i){var r=e===Ze.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),h=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+h,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+h},addFilletArc:function(t,e,n,i,r){var o=i===Ut.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this.filletAngleQuantum+.5);if(1>a)return null;var h;h=s/a;for(var u=0,l=new p;s>u;){var c=e+o*u;l.x=t.x+r*Math.cos(c),l.y=t.y+r*Math.sin(c),this.segList.addPt(l),u+=h}},addInsideTurn:function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*bi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new p((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var i=new p((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(i)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var e=new p(t.x+this.distance,t.y);this.segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Ii,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*bi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===xi.JOIN_BEVEL||this.bufParams.getJoinStyle()===xi.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,Ut.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return bi}}),bi.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,bi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,bi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,bi.MAX_CLOSING_SEG_LEN_FACTOR=80,e(Pi.prototype,{getOffsetCurve:function(t,e){if(this.distance=e,0===e)return null;var n=0>e,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Z.reverse(o),o},computeSingleSidedBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var r=Si.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Ze.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Si.simplify(t,i),h=a.length-1;n.initSideSegments(a[0],a[1],Ze.LEFT),n.addFirstSegment();for(s=2;h>=s;s++)n.addNextSegment(a[s],!0)}n.addLastSegment(),n.closeRing()},computeRingBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);e===Ze.RIGHT&&(i=-i);var r=Si.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;o>=s;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},computeLineBufferCurve:function(t,e){var n=this.simplifyTolerance(this.distance),i=Si.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Ze.LEFT);for(var o=2;r>=o;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Si.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Ze.LEFT);for(o=a-2;o>=0;o--)e.addNextSegment(s[o],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},computePointCurve:function(t,e){switch(this.bufParams.getEndCapStyle()){case xi.CAP_ROUND:e.createCircle(t);break;case xi.CAP_SQUARE:e.createSquare(t)}},getLineCurve:function(t,e){if(this.distance=e,0>e&&!this.bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this.bufParams.isSingleSided()){var r=0>e;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Pi.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},computeOffsetCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){var r=Si.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Ze.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Si.simplify(t,i),h=a.length-1;n.initSideSegments(a[0],a[1],Ze.LEFT),n.addFirstSegment();for(s=2;h>=s;s++)n.addNextSegment(a[s],!0)}n.addLastSegment()},getSegGen:function(t){return new bi(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return Pi}}),Pi.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new p(t[n]);return e},e(Mi.prototype,{findStabbedSegments:function(){if(1===arguments.length){for(var t=arguments[0],e=new w,n=this.subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(P(arguments[2],v)&&arguments[0]instanceof p&&arguments[1]instanceof nn){var o=arguments[0],s=arguments[1],a=arguments[2],h=s.getEdge().getCoordinates();for(n=0;n<h.length-1;n++){if(this.seg.p0=h[n],this.seg.p1=h[n+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse(),!(Math.max(this.seg.p0.x,this.seg.p1.x)<o.x||this.seg.isHorizontal()||o.y<this.seg.p0.y||o.y>this.seg.p1.y||Ut.computeOrientation(this.seg.p0,this.seg.p1,o)===Ut.RIGHT)){var u=s.getDepth(Ze.LEFT);this.seg.p0.equals(h[n])||(u=s.getDepth(Ze.RIGHT));var l=new Ti(this.seg,u);a.add(l)}}}else if(P(arguments[2],v)&&arguments[0]instanceof p&&P(arguments[1],v)){var c=arguments[0],f=arguments[1],d=arguments[2];for(n=f.iterator();n.hasNext();){var g=n.next();g.isForward()&&this.findStabbedSegments(c,g,d)}}},getDepth:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Wo.min(e).leftDepth},interfaces_:function(){return[]},getClass:function(){return Mi}}),e(Ti.prototype,{compareTo:function(t){var e=t;if(this.upwardSeg.minX()>=e.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=e.upwardSeg.minX())return-1;var n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0!==n?n:0!==(n=-1*e.upwardSeg.orientationIndex(this.upwardSeg))?n:this.upwardSeg.compareTo(e.upwardSeg)},compareX:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[o]},getClass:function(){return Ti}}),Mi.DepthSegment=Ti,e(Li.prototype,{addPoint:function(t){if(this.distance<=0)return null;var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,b.EXTERIOR,b.INTERIOR)},addPolygon:function(t){var e=this.distance,n=Ze.LEFT;this.distance<0&&(e=-this.distance,n=Ze.RIGHT);var i=t.getExteriorRing(),r=Z.removeRepeatedPoints(i.getCoordinates());if(this.distance<0&&this.isErodedCompletely(i,this.distance))return null;if(this.distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,b.EXTERIOR,b.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Z.removeRepeatedPoints(s.getCoordinates());this.distance>0&&this.isErodedCompletely(s,-this.distance)||this.addPolygonRing(a,e,Ze.opposite(n),b.INTERIOR,b.EXTERIOR)}},isTriangleErodedCompletely:function(t,e){var n=new Un(t[0],t[1],t[2]),i=n.inCentre();return Ut.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var e=Z.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,b.EXTERIOR,b.INTERIOR)},addCurve:function(t,e,n){if(null===t||t.length<2)return null;var i=new Ne(t,new Ye(0,b.BOUNDARY,e,n));this.curveList.add(i)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,e,n,i,r){if(0===e&&t.length<It.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=It.MINIMUM_VALID_SIZE&&Ut.isCCW(t)&&(o=r,s=i,n=Ze.opposite(n));var a=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},add:function(t){if(t.isEmpty())return null;if(t instanceof Et)this.addPolygon(t);else if(t instanceof _t)this.addLineString(t);else if(t instanceof wt)this.addPoint(t);else if(t instanceof St)this.addCollection(t);else if(t instanceof pt)this.addCollection(t);else if(t instanceof bt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,e){var n=t.getCoordinates();if(n.length<4)return 0>e;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return 0>e&&2*Math.abs(e)>r},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},interfaces_:function(){return[]},getClass:function(){return Li}}),e(Ni.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(Ni.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[Be]},getClass:function(){return Ni}}),Ni.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},e(Ri.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Ye(t.getLabel())).flip(),n.merge(i);var r=Ri.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this.edgeList.add(t),t.setDepthDelta(Ri.depthDelta(t.getLabel()))},buildSubgraphs:function(t,e){for(var n=new w,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new Mi(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},createSubgraphs:function(t){for(var e=new w,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Ei;r.create(i),e.add(r)}}return Wo.sort(e,Wo.reverseOrder()),e},createEmptyResultGeometry:function(){return this.geomFact.createPolygon()},getNoder:function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new Ge,n=new qt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Ni(n)),e},buffer:function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var i=new Li(t,e,new Pi(n,this.bufParams)).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this.graph=new on(new pn),this.graph.addEdges(this.edgeList.getEdges());var r=this.createSubgraphs(this.graph),o=new sn(this.geomFact);this.buildSubgraphs(r,o);var s=o.getPolygons();return s.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(s)},computeNodedEdges:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new An(r.getCoordinates(),new Ye(s));this.insertUniqueEdge(a)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return Ri}}),Ri.depthDelta=function(t){var e=t.getLocation(0,Ze.LEFT),n=t.getLocation(0,Ze.RIGHT);return e===b.INTERIOR&&n===b.EXTERIOR?1:e===b.EXTERIOR&&n===b.INTERIOR?-1:0},Ri.convertSegStrings=function(t){for(var e=new jt,n=new w;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)},e(Oi.prototype,{checkEndPtVertexIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this.segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this.segStrings)}else if(2===arguments.length){var n=arguments[0];for(t=arguments[1].iterator();t.hasNext();){e=t.next().getCoordinates();for(var i=1;i<e.length-1;i++)if(e[i].equals(n))throw new u("found endpt/interior pt intersection at index "+i+" :pt "+n)}}},checkInteriorIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this.segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),h=0;h<s.length-1;h++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,h,o,l);else if(4===arguments.length){var c=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3];if(c===p&&f===d)return null;var g=c.getCoordinates()[f],y=c.getCoordinates()[f+1],m=p.getCoordinates()[d],v=p.getCoordinates()[d+1];if(this.li.computeIntersection(g,y,m,v),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,g,y)||this.hasInteriorIntersection(this.li,m,v)))throw new u("found non-noded intersection at "+g+"-"+y+" and "+m+"-"+v)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length){var n=arguments[0].getCoordinates();for(t=0;t<n.length-2;t++)this.checkCollapse(n[t],n[t+1],n[t+2])}},hasInteriorIntersection:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},checkCollapse:function(t,e,n){if(t.equals(n))throw new u("found non-noded collapse at "+Oi.fact.createLineString([t,e,n]))},interfaces_:function(){return[]},getClass:function(){return Oi}}),Oi.fact=new jt,e(Ai.prototype,{intersectsScaled:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this.maxx<n||this.minx>i||this.maxy<r||this.miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return f.isTrue(!(s&&a),"Found bad envelope test"),a},initCorners:function(t){this.minx=t.x-.5,this.maxx=t.x+.5,this.miny=t.y-.5,this.maxy=t.y+.5,this.corner[0]=new p(this.maxx,this.maxy),this.corner[1]=new p(this.minx,this.maxy),this.corner[2]=new p(this.minx,this.miny),this.corner[3]=new p(this.maxx,this.miny)},intersects:function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},getSafeEnvelope:function(){if(null===this.safeEnv){var t=Ai.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new E(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},intersectsToleranceSquare:function(t,e){var n=!1,i=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.isProper()||(this.li.hasIntersection()&&(i=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.isProper()||(!(!n||!i)||(!!t.equals(this.pt)||!!e.equals(this.pt))))))},addSnappedNode:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},interfaces_:function(){return[]},getClass:function(){return Ai}}),Ai.SAFE_ENV_EXPANSION_FACTOR=.75,e(Di.prototype,{select:function(){if(1===arguments.length)arguments[0];else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},interfaces_:function(){return[]},getClass:function(){return Di}}),e(ki.prototype,{snap:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new Fi(e,n,i);return this.index.query(r,{interfaces_:function(){return[ve]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return ki}}),l(Fi,Di),e(Fi.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(2!==arguments.length)return Di.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();return null!==this.parentEdge&&n===this.parentEdge&&e===this.hotPixelVertexIndex?null:void(this._isNodeAdded=this.hotPixel.addSnappedNode(n,e))},interfaces_:function(){return[]},getClass:function(){return Fi}}),ki.HotPixelSnapAction=Fi,e(Gi.prototype,{processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this.li.computeIntersection(r,o,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var h=0;h<this.li.getIntersectionNum();h++)this.interiorIntersections.add(this.li.getIntersection(h));t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[Be]},getClass:function(){return Gi}}),e(zi.prototype,{checkCorrectness:function(t){var e=new Oi(Ne.getNodedSubstrings(t));try{e.checkValid()}catch(t){if(!(t instanceof S))throw t;t.printStackTrace()}},getNodedSubstrings:function(){return Ne.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,e){var n=new Gi(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},computeVertexSnaps:function(){if(P(arguments[0],y))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Ne)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new Ai(i[r],this.scaleFactor,this.li);this.pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new Ge,this.pointSnapper=new ki(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var e=t.iterator();e.hasNext();){var n=new Ai(e.next(),this.scaleFactor,this.li);this.pointSnapper.snap(n)}},interfaces_:function(){return[ke]},getClass:function(){return zi}}),e(ji.prototype,{bufferFixedPrecision:function(t){var e=new mi(new zi(new Gt(1)),t.getScale()),n=new Ri(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(0===arguments.length){for(var t=ji.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof je))throw t;this.saveException=t}if(null!==this.resultGeometry)return null}throw this.saveException}if(1===arguments.length){var e=arguments[0],n=new Gt(ji.precisionScaleFactor(this.argGeom,this.distance,e));this.bufferFixedPrecision(n)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),null!==this.resultGeometry)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===Gt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new Ri(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){if(!(t instanceof u))throw t;this.saveException=t}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return ji}}),ji.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new ji(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof z&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2];return(a=new ji(n)).setQuadrantSegments(r),a.getResultGeometry(i)}if(arguments[2]instanceof xi&&arguments[0]instanceof z&&"number"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return(a=new ji(o,arguments[2])).getResultGeometry(s)}}else if(4===arguments.length){var a,h=arguments[0],u=arguments[1],l=arguments[2],c=arguments[3];return(a=new ji(h)).setQuadrantSegments(l),a.setEndCapStyle(c),a.getResultGeometry(u)}},ji.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=M.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},ji.CAP_ROUND=xi.CAP_ROUND,ji.CAP_BUTT=xi.CAP_FLAT,ji.CAP_FLAT=xi.CAP_FLAT,ji.CAP_SQUARE=xi.CAP_SQUARE,ji.MAX_PRECISION_DIGITS=12;var is=Object.freeze({BufferOp:ji,BufferParameters:xi});e(Bi.prototype,{filter:function(t){t instanceof Et&&this.comps.add(t)},interfaces_:function(){return[lt]},getClass:function(){return Bi}}),Bi.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Bi.getPolygons(t,new w)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Et?n.add(e):e instanceof ft&&e.apply(new Bi(n)),n}},e(Hi.prototype,{isInsideArea:function(){return this.segIndex===Hi.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return Hi}}),Hi.INSIDE_AREA=-1,e(Vi.prototype,{filter:function(t){t instanceof wt&&this.pts.add(t)},interfaces_:function(){return[lt]},getClass:function(){return Vi}}),Vi.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof wt?Wo.singletonList(t):Vi.getPoints(t,new w)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof wt?n.add(e):e instanceof ft&&e.apply(new Vi(n)),n}},e(qi.prototype,{filter:function(t){(t instanceof wt||t instanceof _t||t instanceof Et)&&this.locations.add(new Hi(t,0,t.getCoordinate()))},interfaces_:function(){return[lt]},getClass:function(){return qi}}),qi.getLocations=function(t){var e=new w;return t.apply(new qi(e)),e},e(Wi.prototype,{computeContainmentDistance:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=Bi.getPolygons(this.geom[e]);if(r.size()>0){var o=qi.getLocations(this.geom[i]);if(this.computeContainmentDistance(o,r,n),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[i]=n[0],this.minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&P(arguments[0],v)&&P(arguments[1],v)){for(var s=arguments[0],a=arguments[1],h=arguments[2],u=0;u<s.size();u++)for(var l=s.get(u),c=0;c<a.size();c++)if(this.computeContainmentDistance(l,a.get(c),h),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Hi&&arguments[1]instanceof Et){var f=arguments[0],p=arguments[1],d=arguments[2],g=f.getCoordinate();if(b.EXTERIOR!==this.ptLocator.locate(g,p))return this.minDistance=0,d[0]=f,d[1]=new Hi(p,g),null}},computeMinDistanceLinesPoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),e=Sn.getLines(this.geom[0]),n=Sn.getLines(this.geom[1]),i=Vi.getPoints(this.geom[0]),r=Vi.getPoints(this.geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,e){return null===t[0]?null:void(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},nearestPoints:function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},computeMinDistance:function(){if(0===arguments.length){if(null!==this.minDistanceLocation)return null;if(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof _t&&arguments[1]instanceof wt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){if((f=Ut.distancePointLine(r,i[o],i[o+1]))<this.minDistance){this.minDistance=f;var s=new Yt(i[o],i[o+1]).closestPoint(r);n[0]=new Hi(t,o,s),n[1]=new Hi(e,0,r)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof _t&&arguments[1]instanceof _t){var a=arguments[0],h=arguments[1],u=arguments[2];if(a.getEnvelopeInternal().distance(h.getEnvelopeInternal())>this.minDistance)return null;i=a.getCoordinates();var l=h.getCoordinates();for(o=0;o<i.length-1;o++)for(var c=0;c<l.length-1;c++){var f;if((f=Ut.distanceLineLine(i[o],i[o+1],l[c],l[c+1]))<this.minDistance){this.minDistance=f;var p=new Yt(i[o],i[o+1]),d=new Yt(l[c],l[c+1]),g=p.closestPoints(d);u[0]=new Hi(a,o,g[0]),u[1]=new Hi(h,c,g[1])}if(this.minDistance<=this.terminateDistance)return null}}},computeMinDistancePoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,n[0]=new Hi(r,0,r.getCoordinate()),n[1]=new Hi(s,0,s.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(null===this.geom[0]||null===this.geom[1])throw new i("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return Wi}}),Wi.distance=function(t,e){return new Wi(t,e).distance()},Wi.isWithinDistance=function(t,e,n){return new Wi(t,e,n).distance()<=n},Wi.nearestPoints=function(t,e){return new Wi(t,e).nearestPoints()};var rs=Object.freeze({DistanceOp:Wi});e(Zi.prototype,{getCoordinates:function(){if(null===this.coordinates){for(var t=0,e=0,n=new C,i=this.directedEdges.iterator();i.hasNext();){var r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&Z.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return Zi}}),e(Ui.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return Ui}}),Ui.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null},Ui.setVisited=function(t,e){for(;t.hasNext();){t.next().setVisited(e)}},Ui.setMarked=function(t,e){for(;t.hasNext();){t.next().setMarked(e)}},l(Yi,Ui),e(Yi.prototype,{isRemoved:function(){return null===this.parentEdge},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:Ut.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var e=t;return this.compareDirection(e)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[o]},getClass:function(){return Yi}}),Yi.toEdges=function(t){for(var e=new w,n=t.iterator();n.hasNext();)e.add(n.next().parentEdge);return e},l(Xi,Yi),e(Xi.prototype,{getNext:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(f.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return Xi}}),l(Ji,Ui),e(Ji.prototype,{isRemoved:function(){return null===this.dirEdge},setDirectedEdges:function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof Qi){var e=arguments[0];return this.dirEdge[0].getFromNode()===e?this.dirEdge[0]:this.dirEdge[1].getFromNode()===e?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return Ji}}),e(Ki.prototype,{getNextEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e+1))},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(Wo.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e-1))},getIndex:function(){if(arguments[0]instanceof Ji){var t=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++){if(this.outEdges.get(e).getEdge()===t)return e}return-1}if(arguments[0]instanceof Yi){var n=arguments[0];this.sortEdges();for(e=0;e<this.outEdges.size();e++){if(this.outEdges.get(e)===n)return e}return-1}if(Number.isInteger(arguments[0])){var i=arguments[0]%this.outEdges.size();return 0>i&&(i+=this.outEdges.size()),i}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return Ki}}),l(Qi,Ui),e(Qi.prototype,{isRemoved:function(){return null===this.pt},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(0===arguments.length)this.pt=null;else if(1===arguments.length){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return Qi}}),Qi.getEdgesBetween=function(t,e){var n=new Q(Yi.toEdges(t.getOutEdges().getEdges())),i=Yi.toEdges(e.getOutEdges().getEdges());return n.retainAll(i),n},l($i,Ji),e($i.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return $i}}),e(tr.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return tr}}),e(er.prototype,{findNodesOfDegree:function(t){for(var e=new w,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()===t&&e.add(i)}return e},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof Ji){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof Yi){var e=arguments[0];null!==(r=e.getSym())&&r.setSym(null),e.getFromNode().remove(e),e.remove(),this.dirEdges.remove(e)}else if(arguments[0]instanceof Qi){for(var n=arguments[0],i=n.getOutEdges().getEdges().iterator();i.hasNext();){var r,o=i.next();null!==(r=o.getSym())&&this.remove(r),this.dirEdges.remove(o);var s=o.getEdge();null!==s&&this.edges.remove(s)}this.nodeMap.remove(n.getCoordinate()),n.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof Ji){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof Yi){var e=arguments[0];return this.dirEdges.contains(e)}},add:function(){if(arguments[0]instanceof Qi){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof Ji){var e=arguments[0];this.edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof Yi){var n=arguments[0];this.dirEdges.add(n)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return er}}),l(nr,er),e(nr.prototype,{addEdge:function(t){if(t.isEmpty())return null;var e=Z.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new Xi(r,o,e[1],!0),a=new Xi(o,r,e[e.length-2],!1),h=new $i(t);h.setDirectedEdges(s,a),this.add(h)},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new Qi(t),this.add(e)),e},interfaces_:function(){return[]},getClass:function(){return nr}}),e(ir.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(f.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(n))}},merge:function(){if(null!==this.mergedLineStrings)return null;Ui.setMarked(this.graph.nodeIterator(),!1),Ui.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new w,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new w;for(var t=this.edgeStrings.iterator();t.hasNext();){var e=t.next();this.mergedLineStrings.add(e.toLineString())}},buildEdgeStringStartingWith:function(t){var e=new Zi(this.factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e},add:function(){if(arguments[0]instanceof z)arguments[0].apply({interfaces_:function(){return[G]},filter:function(t){t instanceof _t&&this.add(t)}});else if(P(arguments[0],y)){var t=arguments[0];this.mergedLineStrings=null;for(var e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}}else if(arguments[0]instanceof _t){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory()),this.graph.addEdge(i)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return ir}});var os=Object.freeze({LineMerger:ir}),ss=Object.freeze({OverlayOp:zn});l(rr,Yi),e(rr.prototype,{getNext:function(){return this.next},isInRing:function(){return null!==this.edgeRing},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return rr}}),l(or,Ji),e(or.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return or}}),e(sr.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(null===this.ringPts){for(var t=new C,e=this.deList.iterator();e.hasNext();){var n=e.next(),i=n.getEdge();sr.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),this.ring.isValid())},build:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)},isOuterHole:function(){return!!this._isHole&&!this.hasShell()},getPolygon:function(){var t=null;if(null!==this.holes){t=new Array(this.holes.size()).fill(null);for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof It){var t=arguments[0];null===this.holes&&(this.holes=new w),this.holes.add(t)}else if(arguments[0]instanceof sr){var e=arguments[0];e.setShell(this);var n=e.getRing();null===this.holes&&(this.holes=new w),this.holes.add(n)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null},computeHole:function(){var t=this.getRing();this._isHole=Ut.isCCW(t.getCoordinates())},hasShell:function(){return null!==this.shell},isOuterShell:function(){return null!==this.getOuterHole()},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return Ht.toLineString(new Rt(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(null!==this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&D.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof S))throw t;D.out.println(this.ringPts)}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return sr}}),sr.findDirEdgesInRing=function(t){var e=t,n=new w;do{n.add(e),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n},sr.addEdge=function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(i=t.length-1;i>=0;i--)n.add(t[i],!1)},sr.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var h=a.next(),u=h.getRing(),l=u.getEnvelopeInternal();if(!l.equals(i)&&l.contains(i)){r=Z.ptNotInList(n.getCoordinates(),u.getCoordinates());var c=!1;Ut.isPointInRing(r,u.getCoordinates())&&(c=!0),c&&(null===o||s.contains(l))&&(s=(o=h).getRing().getEnvelopeInternal())}}return o},e(ar.prototype,{compare:function(t,e){var n=e;return t.getRing().getEnvelope().compareTo(n.getRing().getEnvelope())},interfaces_:function(){return[a]},getClass:function(){return ar}}),sr.EnvelopeComparator=ar,l(hr,er),e(hr.prototype,{findEdgeRing:function(t){var e=new sr(this.factory);return e.build(t),e},computeDepthParity:function(){if(0===arguments.length)for(;;){return null}else 1===arguments.length&&arguments[0]},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();hr.computeNextCWEdges(e)}},addEdge:function(t){if(t.isEmpty())return null;var e=Z.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),o=this.getNode(i),s=new rr(r,o,e[1],!0),a=new rr(o,r,e[e.length-2],!1),h=new or(t);h.setDirectedEdges(s,a),this.add(h)},deleteCutEdges:function(){this.computeNextCWEdges(),hr.findLabeledEdgeRings(this.dirEdges);for(var t=new w,e=this.dirEdges.iterator();e.hasNext();){var n=e.next();if(!n.isMarked()){var i=n.getSym();if(n.getLabel()===i.getLabel()){n.setMarked(!0),i.setMarked(!0);var r=n.getEdge();t.add(r.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),hr.label(this.dirEdges,-1);var t=hr.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new w,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()&&!i.isInRing()){var r=this.findEdgeRing(i);e.add(r)}}return e},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new Qi(t),this.add(e)),e},convertMaximalToMinimalEdgeRings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel(),r=hr.findIntersectionNodes(n,i);if(null!==r)for(var o=r.iterator();o.hasNext();){var s=o.next();hr.computeNextCCWEdges(s,i)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),e=new Q,n=new Qt,i=t.iterator();i.hasNext();)n.push(i.next());for(;!n.isEmpty();){var r=n.pop();hr.deleteAllEdges(r);for(i=r.getOutEdges().getEdges().iterator();i.hasNext();){var o=i.next();o.setMarked(!0);var s=o.getSym();null!==s&&s.setMarked(!0);var a=o.getEdge();e.add(a.getLine());var h=o.getToNode();1===hr.getDegreeNonDeleted(h)&&n.push(h)}}return e},interfaces_:function(){return[]},getClass:function(){return hr}}),hr.findLabeledEdgeRings=function(t){for(var e=new w,n=1,i=t.iterator();i.hasNext();){var r=i.next();if(!(r.isMarked()||r.getLabel()>=0)){e.add(r);var o=sr.findDirEdgesInRing(r);hr.label(o,n),n++}}return e},hr.getDegreeNonDeleted=function(t){for(var e=0,n=t.getOutEdges().getEdges().iterator();n.hasNext();){n.next().isMarked()||e++}return e},hr.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var n=e.next();n.setMarked(!0);var i=n.getSym();null!==i&&i.setMarked(!0)}},hr.label=function(t,e){for(var n=t.iterator();n.hasNext();){n.next().setLabel(e)}},hr.computeNextCWEdges=function(t){for(var e=null,n=null,i=t.getOutEdges().getEdges().iterator();i.hasNext();){var r=i.next();if(!r.isMarked()){if(null===e&&(e=r),null!==n)n.getSym().setNext(r);n=r}}null!==n&&n.getSym().setNext(e)},hr.computeNextCCWEdges=function(t,e){for(var n=null,i=null,r=t.getOutEdges().getEdges(),o=r.size()-1;o>=0;o--){var s=r.get(o),a=s.getSym(),h=null;s.getLabel()===e&&(h=s);var u=null;a.getLabel()===e&&(u=a),null===h&&null===u||(null!==u&&(i=u),null!==h&&(null!==i&&(i.setNext(h),i=null),null===n&&(n=h)))}null!==i&&(f.isTrue(null!==n),i.setNext(n))},hr.getDegree=function(t,e){for(var n=0,i=t.getOutEdges().getEdges().iterator();i.hasNext();){i.next().getLabel()===e&&n++}return n},hr.findIntersectionNodes=function(t,e){var n=t,i=null;do{var r=n.getFromNode();hr.getDegree(r,e)>1&&(null===i&&(i=new w),i.add(r)),n=n.getNext(),f.isTrue(null!==n,"found null DE in ring"),f.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return i},e(ur.prototype,{getGeometry:function(){return null===this.geomFactory&&(this.geomFactory=new jt),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection(jt.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isValid()?e.add(r):n.add(r.getLineString())}},polygonize:function(){if(null!==this.polyList)return null;if(this.polyList=new w,null===this.graph)return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),e=new w;this.invalidRingLines=new w,this.isCheckingRingsValid?this.findValidRings(t,e,this.invalidRingLines):e=t,this.findShellsAndHoles(e),ur.assignHolesToShells(this.holeList,this.shellList),Wo.sort(this.shellList,new sr.EnvelopeComparator);var n=!0;this.extractOnlyPolygonal&&(ur.findDisjointShells(this.shellList),n=!1),this.polyList=ur.extractPolygons(this.shellList,n)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(P(arguments[0],y))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof _t){var n=arguments[0];this.geomFactory=n.getFactory(),null===this.graph&&(this.graph=new hr(this.geomFactory)),this.graph.addEdge(n)}else if(arguments[0]instanceof z){arguments[0].apply(this.lineStringAdder)}},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new w,this.shellList=new w;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this.holeList.add(n):this.shellList.add(n)}},interfaces_:function(){return[]},getClass:function(){return ur}}),ur.findOuterShells=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getOuterHole();null===i||i.isProcessed()||(n.setIncluded(!0),i.setProcessed(!0))}},ur.extractPolygons=function(t,e){for(var n=new w,i=t.iterator();i.hasNext();){var r=i.next();(e||r.isIncluded())&&n.add(r.getPolygon())}return n},ur.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();ur.assignHoleToShell(i,e)}},ur.assignHoleToShell=function(t,e){var n=sr.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)},ur.findDisjointShells=function(t){ur.findOuterShells(t);var e=null;do{e=!1;for(var n=t.iterator();n.hasNext();){var i=n.next();i.isIncludedSet()||(i.updateIncluded(),i.isIncludedSet()||(e=!0))}}while(e)},e(lr.prototype,{filter:function(t){t instanceof _t&&this.p.add(t)},interfaces_:function(){return[G]},getClass:function(){return lr}}),ur.LineStringAdder=lr;var as=Object.freeze({Polygonizer:ur});e(cr.prototype,{createEdgeEndForNext:function(t,e,n,i){var r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;var o=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(o=i.coord);var s=new en(t,n.coord,o,new Ye(t.getLabel()));e.add(s)},createEdgeEndForPrev:function(t,e,n,i){var r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}var o=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(o=i.coord);var s=new Ye(t.getLabel());s.flip();var a=new en(t,n.coord,o,s);e.add(a)},computeEdgeEnds:function(){if(1===arguments.length){for(var t=arguments[0],e=new w,n=t;n.hasNext();){var i=n.next();this.computeEdgeEnds(i,e)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1],s=r.getEdgeIntersectionList();s.addEndpoints();var a=s.iterator(),h=null,u=null;if(!a.hasNext())return null;var l=a.next();do{h=u,u=l,l=null,a.hasNext()&&(l=a.next()),null!==u&&(this.createEdgeEndForPrev(r,o,u,h),this.createEdgeEndForNext(r,o,u,l))}while(null!==u)}},interfaces_:function(){return[]},getClass:function(){return cr}}),l(fr,en),e(fr.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--\x3e Label: "+this.label);for(var e=this.iterator();e.hasNext();){e.next().print(t),t.println()}},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,e){for(var n=0,i=!1,r=this.iterator();r.hasNext();){(o=r.next().getLabel().getLocation(t))===b.BOUNDARY&&n++,o===b.INTERIOR&&(i=!0)}var o=b.NONE;i&&(o=b.INTERIOR),n>0&&(o=Dn.determineBoundary(e,n)),this.label.setLocation(t,o)},computeLabelSide:function(t,e){for(var n=this.iterator();n.hasNext();){var i=n.next();if(i.getLabel().isArea()){var r=i.getLabel().getLocation(t,e);if(r===b.INTERIOR)return this.label.setLocation(t,e,b.INTERIOR),null;r===b.EXTERIOR&&this.label.setLocation(t,e,b.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,Ze.LEFT),this.computeLabelSide(t,Ze.RIGHT)},updateIM:function(t){An.updateIM(this.label,t)},computeLabel:function(t){for(var e=!1,n=this.iterator();n.hasNext();){n.next().getLabel().isArea()&&(e=!0)}this.label=e?new Ye(b.NONE,b.NONE,b.NONE):new Ye(b.NONE);for(var i=0;2>i;i++)this.computeLabelOn(i,t),e&&this.computeLabelSides(i)},interfaces_:function(){return[]},getClass:function(){return fr}}),l(pr,cn),e(pr.prototype,{updateIM:function(t){for(var e=this.iterator();e.hasNext();){e.next().updateIM(t)}},insert:function(t){var e=this.edgeMap.get(t);null===e?(e=new fr(t),this.insertEdgeEnd(t,e)):e.insert(t)},interfaces_:function(){return[]},getClass:function(){return pr}}),l(dr,$e),e(dr.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return dr}}),l(gr,rn),e(gr.prototype,{createNode:function(t){return new dr(t,new pr)},interfaces_:function(){return[]},getClass:function(){return gr}}),e(yr.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},computeProperIntersectionIM:function(t,e){var n=this.arg[0].getGeometry().getDimension(),i=this.arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&o&&e.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this.arg[e].getGeometry()),this.isolatedEdges.add(i))}},labelIsolatedEdge:function(t,e,n){if(n.getDimension()>0){var i=this.ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,b.EXTERIOR)},computeIM:function(){var t=new Xt;if(t.set(b.EXTERIOR,b.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var e=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new cr,i=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();){t.next().getEdges().computeLabelling(this.arg)}},copyNodesAndLabels:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next(),s=this.nodes.find(o.coord);s.getLabel().isNull(t)&&(i===b.BOUNDARY?s.setLabelBoundary(t):s.setLabel(t,b.INTERIOR))}},labelIsolatedNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)},computeIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var o=r.next(),s=this.nodes.addNode(o.coord);i===b.BOUNDARY?s.setLabelBoundary(t):s.getLabel().isNull(t)&&s.setLabel(t,b.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();f.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}},updateIM:function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();){e.next().updateIM(t)}for(var n=this.nodes.iterator();n.hasNext();){var i=n.next();i.updateIM(t),i.updateIMFromEdges(t)}},computeDisjointIM:function(t){var e=this.arg[0].getGeometry();e.isEmpty()||(t.set(b.INTERIOR,b.EXTERIOR,e.getDimension()),t.set(b.BOUNDARY,b.EXTERIOR,e.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(t.set(b.EXTERIOR,b.INTERIOR,n.getDimension()),t.set(b.EXTERIOR,b.BOUNDARY,n.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return yr}}),e(mr.prototype,{isContainedInBoundary:function(t){if(t instanceof Et)return!1;if(t instanceof wt)return this.isPointContainedInBoundary(t);if(t instanceof _t)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},isLineSegmentContainedInBoundary:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var e=t.getCoordinateSequence(),n=new p,i=new p,r=0;r<e.size()-1;r++)if(e.getCoordinate(r,n),e.getCoordinate(r+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof wt){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof p){var e=arguments[0];return e.x===this.rectEnv.getMinX()||e.x===this.rectEnv.getMaxX()||e.y===this.rectEnv.getMinY()||e.y===this.rectEnv.getMaxY()}},contains:function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},interfaces_:function(){return[]},getClass:function(){return mr}}),mr.contains=function(t,e){return new mr(t).contains(e)},e(vr.prototype,{intersects:function(t,e){var n=new E(t,e);if(!this.rectEnv.intersects(n))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var i=t;t=e,e=i}var r=!1;return e.y>t.y&&(r=!0),r?this.li.computeIntersection(t,e,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,e,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return vr}}),e(_r.prototype,{applyTo:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof ft)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return _r}}),e(xr.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new wr(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new Cr(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var i=new Er(this.rectangle);return i.applyTo(t),!!i.intersects()},interfaces_:function(){return[]},getClass:function(){return xr}}),xr.intersects=function(t,e){return new xr(t).intersects(e)},l(wr,_r),e(wr.prototype,{isDone:function(){return!0===this._intersects},visit:function(t){var e=t.getEnvelopeInternal();return this.rectEnv.intersects(e)?this.rectEnv.contains(e)?(this._intersects=!0,null):e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()?(this._intersects=!0,null):e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return wr}}),l(Cr,_r),e(Cr.prototype,{isDone:function(){return!0===this._containsPoint},visit:function(t){if(!(t instanceof Et))return null;var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;for(var n=new p,i=0;4>i;i++)if(this.rectSeq.getCoordinate(i,n),e.contains(n)&&ln.containsPointInPolygon(n,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return Cr}}),l(Er,_r),e(Er.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return!0===this.hasIntersection},visit:function(t){var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;var n=Sn.getLines(t);this.checkIntersectionWithLineStrings(n)},checkIntersectionWithLineStrings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this.p0),e.getCoordinate(n,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return Er}}),l(Sr,kn),e(Sr.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return Sr}}),Sr.covers=function(t,e){return!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||Sr.relate(t,e).isCovers())},Sr.intersects=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&(t.isRectangle()?xr.intersects(t,e):e.isRectangle()?xr.intersects(e,t):Sr.relate(t,e).isIntersects())},Sr.touches=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Sr.relate(t,e).isTouches(t.getDimension(),e.getDimension())},Sr.within=function(t,e){return e.contains(t)},Sr.coveredBy=function(t,e){return Sr.covers(e,t)},Sr.relate=function(){if(2===arguments.length)return new Sr(arguments[0],arguments[1]).getIntersectionMatrix();if(3===arguments.length){if("string"==typeof arguments[2]&&arguments[0]instanceof z&&arguments[1]instanceof z){var t=arguments[0],e=arguments[1],n=arguments[2];return Sr.relateWithCheck(t,e).matches(n)}if(P(arguments[2],B)&&arguments[0]instanceof z&&arguments[1]instanceof z)return new Sr(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix()}},Sr.overlaps=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Sr.relate(t,e).isOverlaps(t.getDimension(),e.getDimension())},Sr.disjoint=function(t,e){return!t.intersects(e)},Sr.relateWithCheck=function(t,e){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Sr.relate(t,e)},Sr.crosses=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Sr.relate(t,e).isCrosses(t.getDimension(),e.getDimension())},Sr.contains=function(t,e){return!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?mr.contains(t,e):Sr.relate(t,e).isContains())};var hs=Object.freeze({RelateOp:Sr});e(Ir.prototype,{extractElements:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this.skipEmpty&&i.isEmpty()||e.add(i)}},combine:function(){for(var t=new w,e=this.inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return Ir}}),Ir.combine=function(){if(1===arguments.length)return new Ir(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ir(Ir.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return new Ir(Ir.createList(n,i,r)).combine()}},Ir.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Ir.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return(n=new w).add(t),n.add(e),n}if(3===arguments.length){var n,i=arguments[0],r=arguments[1],o=arguments[2];return(n=new w).add(i),n.add(r),n.add(o),n}},e(br.prototype,{union:function(){for(var t=new ce,e=new at,n=0;n<this.pointGeom.getNumGeometries();n++){var i=this.pointGeom.getGeometryN(n).getCoordinate();t.locate(i,this.otherGeom)===b.EXTERIOR&&e.add(i)}if(0===e.size())return this.otherGeom;var r,o=Z.toCoordinateArray(e);return r=1===o.length?this.geomFact.createPoint(o[0]):this.geomFact.createMultiPointFromCoords(o),Ir.combine(r,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return br}}),br.union=function(t,e){return new br(t,e).union()},e(Pr.prototype,{filter:function(t){-1!==this.sortIndex&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[lt]},getClass:function(){return Pr}}),Pr.extract=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Pr.extract(t,e,new w)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return n.getSortIndex()===i?r.add(n):n instanceof ft&&n.apply(new Pr(i,r)),r}},e(Mr.prototype,{reduceToGeometries:function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next(),r=null;P(i,v)?r=this.unionTree(i):i instanceof z&&(r=i),e.add(r)}return e},extractByEnvelope:function(t,e,n){for(var i=new w,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this.geomFactory.buildGeometry(i)},unionOptimized:function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Ir.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},union:function(){if(null===this.inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new Se(Mr.STRTREE_NODE_CAPACITY),e=this.inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this.inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},binaryUnion:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(1>=i-n){var r=Mr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Mr.getGeometry(e,n),Mr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=(r=this.binaryUnion(e,n,o),this.binaryUnion(e,o,i));return this.unionSafe(r,s)}},repeatedUnion:function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},unionSafe:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},unionActual:function(t,e){return Mr.restrictToPolygons(t.union(e))},unionTree:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},unionUsingEnvelopeIntersection:function(t,e,n){var i=new w,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Ir.combine(i)},bufferUnion:function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},interfaces_:function(){return[]},getClass:function(){return Mr}}),Mr.restrictToPolygons=function(t){if(P(t,Ct))return t;var e=Bi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(jt.toPolygonArray(e))},Mr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Mr.union=function(t){return new Mr(t).union()},Mr.STRTREE_NODE_CAPACITY=4,e(Tr.prototype,{unionNoOpt:function(t){var e=this.geomFact.createPoint();return Bn.overlayOp(t,e,zn.UNION)},unionWithNull:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},extract:function(){if(P(arguments[0],y))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.extract(e)}else if(arguments[0]instanceof z){var n=arguments[0];null===this.geomFact&&(this.geomFact=n.getFactory()),Pr.extract(n,z.SORTINDEX_POLYGON,this.polygons),Pr.extract(n,z.SORTINDEX_LINESTRING,this.lines),Pr.extract(n,z.SORTINDEX_POINT,this.points)}},union:function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var e=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(e)}var n=null;if(this.lines.size()>0){var i=this.geomFact.buildGeometry(this.lines);n=this.unionNoOpt(i)}var r=null;this.polygons.size()>0&&(r=Mr.union(this.polygons));var o=this.unionWithNull(n,r),s=null;return s=null===t?o:null===o?t:br.union(t,o),null===s?this.geomFact.createGeometryCollection():s},interfaces_:function(){return[]},getClass:function(){return Tr}}),Tr.union=function(){if(1===arguments.length){if(P(arguments[0],y))return new Tr(arguments[0]).union();if(arguments[0]instanceof z)return new Tr(arguments[0]).union()}else if(2===arguments.length){return new Tr(arguments[0],arguments[1]).union()}};var us=Object.freeze({UnaryUnionOp:Tr});e(Lr.prototype,{visitInteriorRing:function(t,e){var n=t.getCoordinates(),i=n[0],r=Lr.findDifferentPoint(n,i),o=e.findEdgeInSameDirection(i,r),s=e.findEdgeEnd(o),a=null;s.getLabel().getLocation(0,Ze.RIGHT)===b.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,Ze.RIGHT)===b.INTERIOR&&(a=s.getSym()),f.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)},visitShellInteriors:function(t,e){if(t instanceof Et){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof bt)for(var i=t,r=0;r<i.getNumGeometries();r++){n=i.getGeometryN(r);this.visitInteriorRing(n.getExteriorRing(),e)}},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,Ze.RIGHT)===b.INTERIOR&&n.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var e=t,n=t;do{f.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)},buildEdgeRings:function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null===i.getEdgeRing()){var r=new Ke(i,this.geometryFactory);r.linkDirectedEdgesForMinimalEdgeRings();var o=r.buildMinimalRings();e.addAll(o)}}return e},hasUnvisitedShellEdge:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),r=i.get(0);if(r.getLabel().getLocation(0,Ze.RIGHT)===b.INTERIOR)for(var o=0;o<i.size();o++)if(!(r=i.get(o)).isVisited())return this.disconnectedRingcoord=r.getCoordinate(),!0}}return!1},isInteriorsConnected:function(){var t=new w;this.geomGraph.computeSplitEdges(t);var e=new on(new pn);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},interfaces_:function(){return[]},getClass:function(){return Lr}}),Lr.findDifferentPoint=function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null},e(Nr.prototype,{hasChildren:function(){for(var t=0;2>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;2>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},size:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){return null===t||this.isSearchMatch(t)?(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),void(null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))):null},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;2>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||(n=this.items.remove(e))},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;2>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},nodeSize:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return Nr}}),Nr.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},e(Rr.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(1===arguments.length){var t=arguments[0];return this.overlaps(t.min,t.max)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!(this.min>n||this.max<e)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(1===arguments.length){if(arguments[0]instanceof Rr){var t=arguments[0];return this.contains(t.min,t.max)}if("number"==typeof arguments[0]){var e=arguments[0];return e>=this.min&&e<=this.max}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return n>=this.min&&i<=this.max}},init:function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return Rr}}),e(Or.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=Or.computeLevel(t),this.interval=new Rr,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,e){var n=oi.powerOf2(t);this.pt=Math.floor(e.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Or}}),Or.computeLevel=function(t){var e=t.getWidth();return oi.exponent(e)+1},l(Ar,Nr),e(Ar.prototype,{getInterval:function(){return this.interval},find:function(t){var e=Nr.getSubnodeIndex(t,this.centre);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},insert:function(t){f.isTrue(null===this.interval||this.interval.contains(t.interval));var e=Nr.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insert(t),this.subnode[e]=n}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var e=Nr.getSubnodeIndex(t,this.centre);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0;switch(t){case 0:e=this.interval.getMin(),n=this.centre;break;case 1:e=this.centre,n=this.interval.getMax()}return new Ar(new Rr(e,n),this.level-1)},interfaces_:function(){return[]},getClass:function(){return Ar}}),Ar.createNode=function(t){var e=new Or(t);return new Ar(e.getInterval(),e.getLevel())},Ar.createExpanded=function(t,e){var n=new Rr(e);null!==t&&n.expandToInclude(t.interval);var i=Ar.createNode(n);return null!==t&&i.insert(t),i},l(Dr,Nr),e(Dr.prototype,{insert:function(t,e){var n=Nr.getSubnodeIndex(t,Dr.origin);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getInterval().contains(t)){var r=Ar.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getInterval().contains(e));(hi.isZeroWidth(e.getMin(),e.getMax())?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return Dr}}),Dr.origin=0,e(kr.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=kr.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];return this.query(new Rr(t,t))}if(arguments[0]instanceof Rr){var e=arguments[0],n=new w;return this.query(e,n),n}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.root.addAllItemsFromOverlapping(i,r)}},iterator:function(){var t=new w;return this.root.addAllItems(t),t.iterator()},remove:function(t,e){var n=kr.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},depth:function(){return null!==this.root?this.root.depth():0},nodeSize:function(){return null!==this.root?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return kr}}),kr.ensureExtent=function(t,e){var n=t.getMin(),i=t.getMax();return n!==i?t:(n===i&&(i=(n-=e/2)+e/2),new Rr(n,i))},e(Fr.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return Fr}}),e(Gr.prototype,{testLineSegment:function(t,e){var n,i,r,o,s=e.p0,a=e.p1;n=s.x-t.x,i=s.y-t.y,r=a.x-t.x,o=a.y-t.y,(i>0&&0>=o||o>0&&0>=i)&&(Wt.signOfDet2x2(n,i,r,o)/(o-i)>0&&this.crossings++)},buildIndex:function(){this.tree=new kr;for(var t=Z.removeRepeatedPoints(this.ring.getCoordinates()),e=De.getChains(t),n=0;n<e.size();n++){var i=e.get(n),r=i.getEnvelope();this.interval.min=r.getMinY(),this.interval.max=r.getMaxY(),this.tree.insert(this.interval,i)}},testMonotoneChain:function(t,e,n){n.select(t,e)},isInside:function(t){this.crossings=0;var e=new E(r.NEGATIVE_INFINITY,r.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),i=new zr(this,t),o=n.iterator();o.hasNext();){var s=o.next();this.testMonotoneChain(e,i,s)}return this.crossings%2==1},interfaces_:function(){return[Fr]},getClass:function(){return Gr}}),l(zr,Di),e(zr.prototype,{select:function(){if(1!==arguments.length)return Di.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return zr}}),Gr.MCSelecter=zr,e(jr.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next();this.nodes.addNode(i.getCoordinate()).setLabel(e,i.getLabel().getLocation(e))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new cr).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)},computeIntersectionNodes:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(e),o=i.getEdgeIntersectionList().iterator();o.hasNext();){var s=o.next(),a=this.nodes.addNode(s.coord);r===b.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,b.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return jr}}),e(Br.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var n=e.next();if(n.getEdgeEnds().size()>1)return this.invalidPoint=n.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return Br}}),e(Hr.prototype,{buildIndex:function(){this.index=new Se;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),i=this.index.query(e.getEnvelopeInternal()),r=0;r<i.size();r++){var o=i.get(r),s=o.getCoordinates();if(e!==o&&e.getEnvelopeInternal().intersects(o.getEnvelopeInternal())){var a=qr.findPtNotNode(n,o,this.graph);if(null!==a)if(Ut.isPointInRing(a,s))return this.nestedPt=a,!1}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return Hr}}),e(Vr.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return Vr.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return null!==this.pt&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return Vr}}),Vr.ERROR=0,Vr.REPEATED_POINT=1,Vr.HOLE_OUTSIDE_SHELL=2,Vr.NESTED_HOLES=3,Vr.DISCONNECTED_INTERIOR=4,Vr.SELF_INTERSECTION=5,Vr.RING_SELF_INTERSECTION=6,Vr.NESTED_SHELLS=7,Vr.DUPLICATE_RINGS=8,Vr.TOO_FEW_POINTS=9,Vr.INVALID_COORDINATE=10,Vr.RING_NOT_CLOSED=11,Vr.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],e(qr.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],e=0;e<t.length;e++)if(!qr.isValid(t[e]))return this.validErr=new Vr(Vr.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof Et){var n=arguments[0];if(this.checkInvalidCoordinates(n.getExteriorRing().getCoordinates()),null!==this.validErr)return null;for(e=0;e<n.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(n.getInteriorRingN(e).getCoordinates()),null!==this.validErr)return null}},checkHolesNotNested:function(t,e){for(var n=new Hr(e),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i);n.add(r)}n.isNonNested()||(this.validErr=new Vr(Vr.NESTED_HOLES,n.getNestedPoint()))},checkConsistentArea:function(t){var e=new Br(t);return e.isNodeConsistentArea()?void(e.hasDuplicateRings()&&(this.validErr=new Vr(Vr.DUPLICATE_RINGS,e.getInvalidPoint()))):(this.validErr=new Vr(Vr.SELF_INTERSECTION,e.getInvalidPoint()),null)},isValid:function(){return this.checkValid(this.parentGeometry),null===this.validErr},checkShellInsideHole:function(t,e,n){var i=t.getCoordinates(),r=e.getCoordinates(),o=qr.findPtNotNode(i,e,n);if(null!==o&&!Ut.isPointInRing(o,r))return o;var s=qr.findPtNotNode(r,t,n);return null!==s?Ut.isPointInRing(s,i)?s:null:(f.shouldNeverReachHere("points in shell and hole appear to be equal"),null)},checkNoSelfIntersectingRings:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this.validErr)return null}},checkConnectedInteriors:function(t){var e=new Lr(t);e.isInteriorsConnected()||(this.validErr=new Vr(Vr.DISCONNECTED_INTERIOR,e.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var e=new at,n=!0,i=t.iterator();i.hasNext();){var r=i.next();if(n)n=!1;else{if(e.contains(r.coord))return this.validErr=new Vr(Vr.RING_SELF_INTERSECTION,r.coord),null;e.add(r.coord)}}},checkHolesInShell:function(t,e){for(var n=t.getExteriorRing(),i=new Gr(n),r=0;r<t.getNumInteriorRing();r++){var o=t.getInteriorRingN(r),s=qr.findPtNotNode(o.getCoordinates(),n,e);if(null===s)return null;if(!i.isInside(s))return this.validErr=new Vr(Vr.HOLE_OUTSIDE_SHELL,s),null}},checkTooFewPoints:function(t){return t.hasTooFewPoints()?(this.validErr=new Vr(Vr.TOO_FEW_POINTS,t.getInvalidPoint()),null):void 0},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof wt){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof St){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof It){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this.validErr)return null;if(this.checkClosedRing(n),null!==this.validErr)return null;var i=new Dn(0,n);if(this.checkTooFewPoints(i),null!==this.validErr)return null;var r=new qt;i.computeSelfNodes(r,!0,!0),this.checkNoSelfIntersectingRings(i)}else if(arguments[0]instanceof _t){var o=arguments[0];if(this.checkInvalidCoordinates(o.getCoordinates()),null!==this.validErr)return null;i=new Dn(0,o);this.checkTooFewPoints(i)}else if(arguments[0]instanceof Et){var s=arguments[0];if(this.checkInvalidCoordinates(s),null!==this.validErr)return null;if(this.checkClosedRings(s),null!==this.validErr)return null;i=new Dn(0,s);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;if(this.checkHolesInShell(s,i),null!==this.validErr)return null;if(this.checkHolesNotNested(s,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof bt){for(var a=arguments[0],h=0;h<a.getNumGeometries();h++){var u=a.getGeometryN(h);if(this.checkInvalidCoordinates(u),null!==this.validErr)return null;if(this.checkClosedRings(u),null!==this.validErr)return null}i=new Dn(0,a);if(this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;for(h=0;h<a.getNumGeometries();h++){u=a.getGeometryN(h);if(this.checkHolesInShell(u,i),null!==this.validErr)return null}for(h=0;h<a.getNumGeometries();h++){u=a.getGeometryN(h);if(this.checkHolesNotNested(u,i),null!==this.validErr)return null}if(this.checkShellsNotNested(a,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof ft){var l=arguments[0];for(h=0;h<l.getNumGeometries();h++){var c=l.getGeometryN(h);if(this.checkValid(c),null!==this.validErr)return null}}else if(arguments[0]instanceof z){var f=arguments[0];if(this.validErr=null,f.isEmpty())return null;if(f instanceof wt)this.checkValid(f);else if(f instanceof St)this.checkValid(f);else if(f instanceof It)this.checkValid(f);else if(f instanceof _t)this.checkValid(f);else if(f instanceof Et)this.checkValid(f);else if(f instanceof bt)this.checkValid(f);else{if(!(f instanceof ft))throw new UnsupportedOperationException(f.getClass().getName());this.checkValid(f)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,e,n){var i=t.getCoordinates(),r=e.getExteriorRing(),o=r.getCoordinates(),s=qr.findPtNotNode(i,r,n);if(null===s)return null;if(!Ut.isPointInRing(s,o))return null;if(e.getNumInteriorRing()<=0)return this.validErr=new Vr(Vr.NESTED_SHELLS,s),null;for(var a=null,h=0;h<e.getNumInteriorRing();h++){var u=e.getInteriorRingN(h);if(null===(a=this.checkShellInsideHole(t,u,n)))return null}this.validErr=new Vr(Vr.NESTED_SHELLS,a)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this.validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this.validErr)return null},checkClosedRing:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new Vr(Vr.RING_NOT_CLOSED,e)}},checkShellsNotNested:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n).getExteriorRing(),r=0;r<t.getNumGeometries();r++)if(n!==r){var o=t.getGeometryN(r);if(this.checkShellNotNested(i,o,e),null!==this.validErr)return null}},interfaces_:function(){return[]},getClass:function(){return qr}}),qr.findPtNotNode=function(t,e,n){for(var i=n.findEdge(e).getEdgeIntersectionList(),r=0;r<t.length;r++){var o=t[r];if(!i.isIntersection(o))return o}return null},qr.isValid=function(){if(arguments[0]instanceof z)return new qr(arguments[0]).isValid();if(arguments[0]instanceof p){var t=arguments[0];return!r.isNaN(t.x)&&(!r.isInfinite(t.x)&&(!r.isNaN(t.y)&&!r.isInfinite(t.y)))}};var ls=Object.freeze({IsValidOp:qr}),cs=Object.freeze({BoundaryOp:dt,IsSimpleOp:vi,buffer:is,distance:rs,linemerge:os,overlay:ss,polygonize:as,relate:hs,union:us,valid:ls});l(Wr,Pt.CoordinateOperation),e(Wr.prototype,{editCoordinates:function(t,e){if(0===t.length)return null;for(var n=new Array(t.length).fill(null),i=0;i<t.length;i++){var r=new p(t[i]);this.targetPM.makePrecise(r),n[i]=r}var o=new C(n,!1).toCoordinateArray(),s=0;e instanceof _t&&(s=2),e instanceof It&&(s=4);var a=n;return this.removeCollapsed&&(a=null),o.length<s?a:o},interfaces_:function(){return[]},getClass:function(){return Wr}}),e(Zr.prototype,{fixPolygonalTopology:function(t){var e=t;this.changePrecisionModel||(e=this.changePM(t,this.targetPM));var n=e.buffer(0),i=n;return this.changePrecisionModel||(i=t.getFactory().createGeometry(n)),i},reducePointwise:function(t){var e=null;this.changePrecisionModel?e=new Pt(this.createFactory(t.getFactory(),this.targetPM)):e=new Pt;var n=this.removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new Wr(this.targetPM,n))},changePM:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Pt.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,e){return new jt(e,t.getSRID(),t.getCoordinateSequenceFactory())},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var e=this.reducePointwise(t);return this.isPointwise?e:P(e,Ct)?e.isValid()?e:this.fixPolygonalTopology(e):e},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,e){return t.getPrecisionModel()===e?new Pt:new Pt(this.createFactory(t,e))},interfaces_:function(){return[]},getClass:function(){return Zr}}),Zr.reduce=function(t,e){return new Zr(e).reduce(t)},Zr.reducePointwise=function(t,e){var n=new Zr(e);return n.setPointwise(!0),n.reduce(t)};var fs=Object.freeze({GeometryPrecisionReducer:Zr});e(Ur.prototype,{simplifySection:function(t,e){if(t+1===e)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,i=t,r=t+1;e>r;r++){var o=this.seg.distance(this.pts[r]);o>n&&(n=o,i=r)}if(n<=this.distanceTolerance)for(r=t+1;e>r;r++)this.usePt[r]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);var e=new C;for(t=0;t<this.pts.length;t++)this.usePt[t]&&e.add(new p(this.pts[t]));return e.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.simplify=function(t,e){var n=new Ur(t);return n.setDistanceTolerance(e),n.simplify()},e(Yr.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new Xr(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return Yr}}),Yr.simplify=function(t,e){var n=new Yr(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(Xr,ne),e(Xr.prototype,{transformPolygon:function(t,e){if(t.isEmpty())return null;var n=ne.prototype.transformPolygon.call(this,t,e);return e instanceof bt?n:this.createValidArea(n)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,e){var n,i=t.toCoordinateArray();return n=0===i.length?new Array(0).fill(null):Ur.simplify(i,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(n)},transformMultiPolygon:function(t,e){var n=ne.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformLinearRing:function(t,e){var n=e instanceof Et,i=ne.prototype.transformLinearRing.call(this,t,e);return!n||i instanceof It?i:null},interfaces_:function(){return[]},getClass:function(){return Xr}}),Yr.DPTransformer=Xr,l(Jr,Yt),e(Jr.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return Jr}}),e(Kr.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(Kr.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return 0===t?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(Kr.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new Jr(t[e],t[e+1],this.parentLine,e);this.segs[e]=n}},getResultCoordinates:function(){return Kr.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return Kr}}),Kr.extractCoordinates=function(t){for(var e=new Array(t.size()+1).fill(null),n=null,i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e},e(Qr.prototype,{remove:function(t){this.index.remove(new E(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof Kr)for(var t=arguments[0].getSegments(),e=0;e<t.length;e++){var n=t[e];this.add(n)}else if(arguments[0]instanceof Yt){var i=arguments[0];this.index.insert(new E(i.p0,i.p1),i)}},query:function(t){var e=new E(t.p0,t.p1),n=new $r(t);return this.index.query(e,n),n.getItems()},interfaces_:function(){return[]},getClass:function(){return Qr}}),e($r.prototype,{visitItem:function(t){var e=t;E.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[ve]},getClass:function(){return $r}}),e(to.prototype,{flatten:function(t,e){var n=new Yt(this.linePts[t],this.linePts[e]);return this.remove(this.line,t,e),this.outputIndex.add(n),n},hasBadIntersection:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,e,n){n+=1;var i=new Array(2).fill(null);if(t+1===e){var r=this.line.getSegment(t);return this.line.addToResult(r),null}var o=!0;this.line.getResultSize()<this.line.getMinimumSize()&&(n+1<this.line.getMinimumSize()&&(o=!1));var s=new Array(1).fill(null),a=this.findFurthestPoint(this.linePts,t,e,s);s[0]>this.distanceTolerance&&(o=!1);var h=new Yt;if(h.p0=this.linePts[t],h.p1=this.linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this.line,i,h)&&(o=!1),o){r=this.flatten(t,e);return this.line.addToResult(r),null}this.simplifySection(t,a,n),this.simplifySection(a,e,n)},hasBadOutputIntersection:function(t){for(var e=this.outputIndex.query(t).iterator();e.hasNext();){var n=e.next();if(this.hasInteriorIntersection(n,t))return!0}return!1},findFurthestPoint:function(t,e,n,i){var r=new Yt;r.p0=t[e],r.p1=t[n];for(var o=-1,s=e,a=e+1;n>a;a++){var h=t[a],u=r.distance(h);u>o&&(o=u,s=a)}return i[0]=o,s},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,e,n){for(var i=e;n>i;i++){var r=t.getSegment(i);this.inputIndex.remove(r)}},hasInteriorIntersection:function(t,e){return this.li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,e,n){for(var i=this.inputIndex.query(n).iterator();i.hasNext();){var r=i.next();if(this.hasInteriorIntersection(r,n)){if(to.isInLineSection(t,e,r))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return to}}),to.isInLineSection=function(t,e,n){if(n.getParent()!==t.getParent())return!1;var i=n.getIndex();return i>=e[0]&&i<e[1]},e(eo.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var e=t.iterator();e.hasNext();)this.inputIndex.add(e.next());for(e=t.iterator();e.hasNext();){var n=new to(this.inputIndex,this.outputIndex);n.setDistanceTolerance(this.distanceTolerance),n.simplify(e.next())}},interfaces_:function(){return[]},getClass:function(){return eo}}),e(no.prototype,{getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():(this.linestringMap=new Ft,this.inputGeom.apply(new ro(this)),this.lineSimplifier.simplify(this.linestringMap.values()),new io(this.linestringMap).transform(this.inputGeom))},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return no}}),no.simplify=function(t,e){var n=new no(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(io,ne),e(io.prototype,{transformCoordinates:function(t,e){if(0===t.size())return null;if(e instanceof _t){var n=this.linestringMap.get(e);return this.createCoordinateSequence(n.getResultCoordinates())}return ne.prototype.transformCoordinates.call(this,t,e)},interfaces_:function(){return[]},getClass:function(){return io}}),e(ro.prototype,{filter:function(t){if(t instanceof _t){var e=t;if(e.isEmpty())return null;var n=new Kr(e,e.isClosed()?4:2);this.tps.linestringMap.put(e,n)}},interfaces_:function(){return[G]},getClass:function(){return ro}}),no.LineStringTransformer=io,no.LineStringMapBuilderFilter=ro;var ps=Object.freeze({DouglasPeuckerSimplifier:Yr,TopologyPreservingSimplifier:no});e(oo.prototype,{splitAt:function(){if(1===arguments.length){var t=arguments[0],e=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(e),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=oo.pointAlongReverse(this.seg,e),null;this.splitPt=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.getConstrainedLength(n)/this.segLen;i.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(r):this.splitPt=oo.pointAlongReverse(this.seg,r)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return oo}}),oo.pointAlongReverse=function(t,e){var n=new p;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n},e(so.prototype,{findSplitPoint:function(t,e){},interfaces_:function(){return[]},getClass:function(){return so}}),e(ao.prototype,{findSplitPoint:function(t,e){var n=t.getLineSegment(),i=n.getLength()/2,r=new oo(n),o=ao.projectedSplitPoint(t,e),s=2*o.distance(e)*.8;return s>i&&(s=i),r.setMinimumLength(s),r.splitAt(o),r.getSplitPoint()},interfaces_:function(){return[so]},getClass:function(){return ao}}),ao.projectedSplitPoint=function(t,e){return t.getLineSegment().project(e)},e(ho.prototype,{interfaces_:function(){return[]},getClass:function(){return ho}}),ho.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},ho.isInCircleDDNormalized=function(t,e,n,i){var r=R.valueOf(t.x).selfSubtract(i.x),o=R.valueOf(t.y).selfSubtract(i.y),s=R.valueOf(e.x).selfSubtract(i.x),a=R.valueOf(e.y).selfSubtract(i.y),h=R.valueOf(n.x).selfSubtract(i.x),u=R.valueOf(n.y).selfSubtract(i.y),l=r.multiply(a).selfSubtract(s.multiply(o)),c=s.multiply(u).selfSubtract(h.multiply(a)),f=h.multiply(o).selfSubtract(r.multiply(u)),p=r.multiply(r).selfAdd(o.multiply(o)),d=s.multiply(s).selfAdd(a.multiply(a)),g=h.multiply(h).selfAdd(u.multiply(u));return p.selfMultiply(c).selfAdd(d.selfMultiply(f)).selfAdd(g.selfMultiply(l)).doubleValue()>0},ho.checkRobustInCircle=function(t,e,n,i){var r=ho.isInCircleNonRobust(t,e,n,i),o=ho.isInCircleDDSlow(t,e,n,i),s=ho.isInCircleCC(t,e,n,i),a=Un.circumcentre(t,e,n);D.out.println("p radius diff a = "+Math.abs(i.distance(a)-t.distance(a))/t.distance(a)),r===o&&r===s||(D.out.println("inCircle robustness failure (double result = "+r+", DD result = "+o+", CC result = "+s+")"),D.out.println(Ht.toLineString(new Rt([t,e,n,i]))),D.out.println("Circumcentre = "+Ht.toPoint(a)+" radius = "+t.distance(a)),D.out.println("p radius diff a = "+Math.abs(i.distance(a)/t.distance(a)-1)),D.out.println("p radius diff b = "+Math.abs(i.distance(a)/e.distance(a)-1)),D.out.println("p radius diff c = "+Math.abs(i.distance(a)/n.distance(a)-1)),D.out.println())},ho.isInCircleDDFast=function(t,e,n,i){var r=R.sqr(t.x).selfAdd(R.sqr(t.y)).selfMultiply(ho.triAreaDDFast(e,n,i)),o=R.sqr(e.x).selfAdd(R.sqr(e.y)).selfMultiply(ho.triAreaDDFast(t,n,i)),s=R.sqr(n.x).selfAdd(R.sqr(n.y)).selfMultiply(ho.triAreaDDFast(t,e,i)),a=R.sqr(i.x).selfAdd(R.sqr(i.y)).selfMultiply(ho.triAreaDDFast(t,e,n));return r.selfSubtract(o).selfAdd(s).selfSubtract(a).doubleValue()>0},ho.isInCircleCC=function(t,e,n,i){var r=Un.circumcentre(t,e,n),o=t.distance(r);return 0>=i.distance(r)-o},ho.isInCircleNormalized=function(t,e,n,i){var r=t.x-i.x,o=t.y-i.y,s=e.x-i.x,a=e.y-i.y,h=n.x-i.x,u=n.y-i.y;return(r*r+o*o)*(s*u-h*a)+(s*s+a*a)*(h*o-r*u)+(h*h+u*u)*(r*a-s*o)>0},ho.isInCircleDDSlow=function(t,e,n,i){var r=R.valueOf(i.x),o=R.valueOf(i.y),s=R.valueOf(t.x),a=R.valueOf(t.y),h=R.valueOf(e.x),u=R.valueOf(e.y),l=R.valueOf(n.x),c=R.valueOf(n.y),f=s.multiply(s).add(a.multiply(a)).multiply(ho.triAreaDDSlow(h,u,l,c,r,o)),p=h.multiply(h).add(u.multiply(u)).multiply(ho.triAreaDDSlow(s,a,l,c,r,o)),d=l.multiply(l).add(c.multiply(c)).multiply(ho.triAreaDDSlow(s,a,h,u,r,o)),g=r.multiply(r).add(o.multiply(o)).multiply(ho.triAreaDDSlow(s,a,h,u,l,c));return f.subtract(p).add(d).subtract(g).doubleValue()>0},ho.isInCircleNonRobust=function(t,e,n,i){return(t.x*t.x+t.y*t.y)*ho.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*ho.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*ho.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*ho.triArea(t,e,n)>0},ho.isInCircleRobust=function(t,e,n,i){return ho.isInCircleNormalized(t,e,n,i)},ho.triAreaDDSlow=function(t,e,n,i,r,o){return n.subtract(t).multiply(o.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))},ho.triAreaDDFast=function(t,e,n){var i=R.valueOf(e.x).selfSubtract(t.x).selfMultiply(R.valueOf(n.y).selfSubtract(t.y)),r=R.valueOf(e.y).selfSubtract(t.y).selfMultiply(R.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)},e(uo.prototype,{circleCenter:function(t,e){var n,i=new uo(this.getX(),this.getY()),r=new k(this.bisector(i,t),this.bisector(t,e)),o=null;try{o=new uo(r.getX(),r.getY())}catch(n){if(!(n instanceof I))throw n;D.err.println("a: "+i+"  b: "+t+"  c: "+e),D.err.println(n)}return o},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,e){var n=e.getX()-t.getX(),i=e.getY()-t.getY();return new k(new k(t.getX()+n/2,t.getY()+i/2,1),new k(t.getX()-i+n/2,t.getY()+n+i/2,1))},equals:function(){if(1===arguments.length){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.p.distance(e.getCoordinate())<n}},getCoordinate:function(){return this.p},isInCircle:function(t,e,n){return ho.isInCircleRobust(t.p,e.p,n.p,this.p)},interpolateZValue:function(t,e,n){var i=t.getX(),r=t.getY(),o=e.getX()-i,s=n.getX()-i,a=e.getY()-r,h=n.getY()-r,u=o*h-s*a,l=this.getX()-i,c=this.getY()-r,f=(h*l-s*c)/u,p=(-a*l+o*c)/u;return t.getZ()+f*(e.getZ()-t.getZ())+p*(n.getZ()-t.getZ())},midPoint:function(t){return new uo((this.p.x+t.getX())/2,(this.p.y+t.getY())/2,(this.p.z+t.getZ())/2)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new uo(t*this.p.x,t*this.p.y)},cross:function(){return new uo(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new uo(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,e){var n=this,i=e.sub(t),r=n.sub(t),o=i.crossProduct(r);return o>0?uo.LEFT:0>o?uo.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?uo.BEHIND:i.magn()<r.magn()?uo.BEYOND:t.equals(n)?uo.ORIGIN:e.equals(n)?uo.DESTINATION:uo.BETWEEN},sum:function(t){return new uo(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))},circumRadiusRatio:function(t,e){var n=this.circleCenter(t,e),i=this.distance(n,t),r=this.distance(this,t),o=this.distance(t,e);return r>o&&(r=o),r>(o=this.distance(e,this))&&(r=o),i/r},interfaces_:function(){return[]},getClass:function(){return uo}}),uo.interpolateZ=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),o=n.z-e.z;return e.z+o*(r/i)}if(4===arguments.length){var s=arguments[0],a=arguments[1],h=arguments[2],u=arguments[3],l=a.x,c=a.y,f=h.x-l,p=u.x-l,d=h.y-c,g=u.y-c,y=f*g-p*d,m=s.x-l,v=s.y-c,_=(g*m-p*v)/y,x=(-d*m+f*v)/y;return a.z+_*(h.z-a.z)+x*(u.z-a.z)}},uo.LEFT=0,uo.RIGHT=1,uo.BEYOND=2,uo.BEHIND=3,uo.BETWEEN=4,uo.ORIGIN=5,uo.DESTINATION=6,l(lo,uo),e(lo.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return lo}}),e(co.prototype,{equalsNonOriented:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},toLineSegment:function(){return new Yt(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),e=this.dest().getCoordinate();return Ht.toLineString(t,e)},isLive:function(){return null!==this._rot},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return co}}),co.makeEdge=function(t,e){var n=new co,i=new co,r=new co,o=new co;n._rot=i,i._rot=r,r._rot=o,o._rot=n,n.setNext(n),i.setNext(o),r.setNext(r),o.setNext(i);var s=n;return s.setOrig(t),s.setDest(e),s},co.swap=function(t){var e=t.oPrev(),n=t.sym().oPrev();co.splice(t,e),co.splice(t.sym(),n),co.splice(t,e.lNext()),co.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())},co.splice=function(t,e){var n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),o=t.oNext(),s=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(o),n.setNext(s),i.setNext(a)},co.connect=function(t,e){var n=co.makeEdge(t.dest(),e.orig());return co.splice(n,t.lNext()),co.splice(n.sym(),e),n},e(fo.prototype,{insertSite:function(t){var e=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete(e.oNext()));var n=this.subdiv.makeEdge(e.orig(),t);co.splice(n,e);var i=n;do{e=(n=this.subdiv.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);for(;;){var r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))co.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},interfaces_:function(){return[]},getClass:function(){return fo}}),e(po.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return po}}),e(go.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},findEdge:function(){return this.subdiv.getEdges().iterator().next()},interfaces_:function(){return[po]},getClass:function(){return go}}),l(yo,u),e(yo.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return yo}}),yo.msgWithSpatial=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(mo.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return mo}}),e(vo.prototype,{getTriangleVertices:function(t){var e=new wo;return this.visitTriangles(e,t),e.getTriangleVertices()},isFrameVertex:function(t){return!!t.equals(this.frameVertex[0])||(!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2]))},isVertexOfEdge:function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},connect:function(t,e){var n=co.connect(t,e);return this.quadEdges.add(n),n},getVoronoiCellPolygon:function(t,e){var n=new w,i=t;do{var r=t.rot().orig().getCoordinate();n.add(r),t=t.oPrev()}while(t!==i);var o=new C;o.addAll(n,!1),o.closeRing(),o.size()<4&&(D.out.println(o),o.add(o.get(o.size()-1),!0));var s=o.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(s),null),h=i.orig();return a.setUserData(h.getCoordinate()),a},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);co.splice(t.sym(),e);var n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return co.splice(e.sym(),n),co.splice(n.sym(),t),t},isFrameBorderEdge:function(t){var e=new Array(3).fill(null);vo.getTriangleEdges(t,e);var n=new Array(3).fill(null);vo.getTriangleEdges(t.sym(),n);var i=t.lNext().dest();if(this.isFrameVertex(i))return!0;var r=t.sym().lNext().dest();return!!this.isFrameVertex(r)},makeEdge:function(t,e){var n=co.makeEdge(t,e);return this.quadEdges.add(n),n},visitTriangles:function(t,e){this.visitedKey++;var n=new Qt;n.push(this.startingEdge);for(var i=new Q;!n.empty();){var r=n.pop();if(!i.contains(r)){var o=this.fetchTriangleToVisit(r,n,e,i);null!==o&&t.visit(o)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},getEnvelope:function(){return new E(this.frameEnv)},createFrame:function(t){var e,n=t.getWidth(),i=t.getHeight();e=n>i?10*n:10*i,this.frameVertex[0]=new uo((t.getMaxX()+t.getMinX())/2,t.getMaxY()+e),this.frameVertex[1]=new uo(t.getMinX()-e,t.getMinY()-e),this.frameVertex[2]=new uo(t.getMaxX()+e,t.getMinY()-e),this.frameEnv=new E(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var e=new Co;return this.visitTriangles(e,t),e.getTriangles()},getVertices:function(t){for(var e=new Q,n=this.quadEdges.iterator();n.hasNext();){var i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);var o=i.dest();!t&&this.isFrameVertex(o)||e.add(o)}return e},fetchTriangleToVisit:function(t,e,n,i){var r=t,o=0,s=!1;do{this.triEdges[o]=r,this.isFrameEdge(r)&&(s=!0);var a=r.sym();i.contains(a)||e.push(a),i.add(r),o++,r=r.lNext()}while(r!==t);return s&&!n?null:this.triEdges},getEdges:function(){if(0===arguments.length)return this.quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var o=r.next();n[i++]=t.createLineString([o.orig().getCoordinate(),o.dest().getCoordinate()])}return t.createMultiLineString(n)}},getVertexUniqueEdges:function(t){for(var e=new w,n=new Q,i=this.quadEdges.iterator();i.hasNext();){var r=i.next(),o=r.orig();n.contains(o)||(n.add(o),!t&&this.isFrameVertex(o)||e.add(r));var s=r.sym(),a=s.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(s))}return e},getTriangleEdges:function(t){var e=new xo;return this.visitTriangles(e,t),e.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var e=new w,n=new Qt;n.push(this.startingEdge);for(var i=new Q;!n.empty();){var r=n.pop();if(!i.contains(r)){var o=r.getPrimary();!t&&this.isFrameEdge(o)||e.add(o),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e},delete:function(t){co.splice(t,t.oPrev()),co.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),i=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(e),this.quadEdges.remove(n),this.quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()},locateFromEdge:function(t,e){for(var n=0,i=this.quadEdges.size(),r=e;;){if(++n>i)throw new yo(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new _o,!0);for(var e=new w,n=this.getVertexUniqueEdges(!1).iterator();n.hasNext();){var i=n.next();e.add(this.getVoronoiCellPolygon(i,t))}return e},getVoronoiDiagram:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(jt.toGeometryArray(e))},getTriangles:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var o=r.next();n[i++]=t.createPolygon(t.createLinearRing(o),null)}return t.createGeometryCollection(n)},insertSite:function(t){var e=this.locate(t);if(t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;var n=this.makeEdge(e.orig(),t);co.splice(n,e);var i=n;do{e=(n=this.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);return i},locate:function(){if(1===arguments.length){if(arguments[0]instanceof uo){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof p){var e=arguments[0];return this.locator.locate(new uo(e))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.locator.locate(new uo(n));if(null===r)return null;var o=r;r.dest().getCoordinate().equals2D(n)&&(o=r.sym());var s=o;do{if(s.dest().getCoordinate().equals2D(i))return s;s=s.oNext()}while(s!==o);return null}},interfaces_:function(){return[]},getClass:function(){return vo}}),vo.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new i("Edges do not form a triangle")},e(_o.prototype,{visit:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=new uo(Un.circumcentre(e,n,i)),o=0;3>o;o++)t[o].rot().setOrig(r)},interfaces_:function(){return[mo]},getClass:function(){return _o}}),e(xo.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[mo]},getClass:function(){return xo}}),e(wo.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[mo]},getClass:function(){return wo}}),e(Co.prototype,{checkTriangleSize:function(t){t.length>=2?Ht.toLineString(t[0],t[1]):t.length>=1&&Ht.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var e=0;3>e;e++){var n=t[e].orig();this.coordList.add(n.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var i=this.coordList.toCoordinateArray();if(4!==i.length)return null;this.triCoords.add(i)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[mo]},getClass:function(){return Co}}),vo.TriangleCircumcentreVisitor=_o,vo.TriangleEdgesListVisitor=xo,vo.TriangleVertexListVisitor=wo,vo.TriangleCoordinatesVisitor=Co,vo.EDGE_COINCIDENCE_TOL_FACTOR=1e3,e(Eo.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){return this.ls.getCoordinate(1).z},getStartZ:function(){return this.ls.getCoordinate(0).z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){return this.ls.getCoordinate(1).y},getStartX:function(){return this.ls.getCoordinate(0).x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){return this.ls.getCoordinate(0).y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){return this.ls.getCoordinate(1).x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Eo}}),e(So.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return So}}),e(Io.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return Io}}),e(bo.prototype,{insert:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this.root)return this.root=new Io(e,n),this.root;if(this.tolerance>0){var i=this.findBestMatchNode(e);if(null!==i)return i.increment(),i}return this.insertExact(e,n)}},query:function(){var t=arguments,e=this;if(1===arguments.length){var n=arguments[0],i=new w;return this.query(n,i),i}if(2===arguments.length)if(arguments[0]instanceof E&&P(arguments[1],v))!function(){var n=t[0],i=t[1];e.queryNode(e.root,n,!0,{interfaces_:function(){return[So]},visit:function(t){i.add(t)}})}();else if(arguments[0]instanceof E&&P(arguments[1],So)){var r=arguments[0],o=arguments[1];this.queryNode(this.root,r,!0,o)}},queryNode:function(t,e,n,i){if(null===t)return null;var r=null,o=null,s=null;n?(r=e.getMinX(),o=e.getMaxX(),s=t.getX()):(r=e.getMinY(),o=e.getMaxY(),s=t.getY());var a=o>=s;s>r&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),a&&this.queryNode(t.getRight(),e,!n,i)},findBestMatchNode:function(t){var e=new Po(t,this.tolerance);return this.query(e.queryEnvelope(),e),e.getNode()},isEmpty:function(){return null===this.root},insertExact:function(t,e){for(var n=this.root,i=this.root,r=!0,o=!0;null!==n;){if(null!==n)if(t.distance(n.getCoordinate())<=this.tolerance)return n.increment(),n;i=n,n=(o=r?t.x<n.getX():t.y<n.getY())?n.getLeft():n.getRight(),r=!r}this.numberOfNodes=this.numberOfNodes+1;var s=new Io(t,e);return o?i.setLeft(s):i.setRight(s),s},interfaces_:function(){return[]},getClass:function(){return bo}}),bo.toCoordinates=function(){if(1===arguments.length){var t=arguments[0];return bo.toCoordinates(t,!1)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new C,r=e.iterator();r.hasNext();)for(var o=r.next(),s=n?o.getCount():1,a=0;s>a;a++)i.add(o.getCoordinate(),!0);return i.toCoordinateArray()}},e(Po.prototype,{visit:function(t){var e=this.p.distance(t.getCoordinate());if(!(e<=this.tolerance))return null;var n=!1;(null===this.matchNode||e<this.matchDist||null!==this.matchNode&&e===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(n=!0),n&&(this.matchNode=t,this.matchDist=e)},queryEnvelope:function(){var t=new E(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[So]},getClass:function(){return Po}}),bo.BestMatchVisitor=Po,e(Mo.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this.segments),t++}while(e>0&&t<Mo.MAX_SPLIT_ITER)},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),e=0,n=this.initialVertices.iterator();n.hasNext();){var i=n.next();t[e++]=i.getCoordinate()}for(var r=this.segVertices.iterator();r.hasNext();){i=r.next();t[e++]=i.getCoordinate()}return t},setConstraints:function(t,e){this.segments=t,this.segVertices=e},computeConvexHull:function(){var t=new jt,e=new te(this.getPointArray(),t);this.convexHull=e.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var e=t.getStart(),n=t.getEnd(),i=new p((e.x+n.x)/2,(e.y+n.y)/2),o=e.distance(i),s=new E(i);s.expandBy(o);for(var a=this.kdt.query(s),h=null,u=r.MAX_VALUE,l=a.iterator();l.hasNext();){var c=l.next().getCoordinate();if(!c.equals2D(e)&&!c.equals2D(n)){var f=i.distance(c);if(o>f){(null===h||u>f)&&(h=c,u=f)}}}return h},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var e=new w,n=0,i=new w,r=t.iterator();r.hasNext();){var o=r.next(),s=this.findNonGabrielPoint(o);if(null!==s){this.splitPt=this.splitFinder.findSplitPoint(o,s);var a=this.createVertex(this.splitPt,o),h=(this.insertSite(a),new Eo(o.getStartX(),o.getStartY(),o.getStartZ(),a.getX(),a.getY(),a.getZ(),o.getData())),u=new Eo(a.getX(),a.getY(),a.getZ(),o.getEndX(),o.getEndY(),o.getEndZ(),o.getData());e.add(h),e.add(u),i.add(o),n+=1}}return t.removeAll(i),t.addAll(e),n},createVertex:function(){if(1===arguments.length){var t=arguments[0],e=null;return null!==this.vertexFactory?this.vertexFactory.createVertex(t,null):new lo(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];e=null;return(e=null!==this.vertexFactory?this.vertexFactory.createVertex(n,i):new lo(n)).setOnConstraint(!0),e}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=Mo.computeVertexEnvelope(this.initialVertices),e=Mo.computeVertexEnvelope(this.segVertices),n=new E(t);n.expandToInclude(e);var i=.2*n.getWidth(),r=.2*n.getHeight(),o=Math.max(i,r);this.computeAreaEnv=new E(n),this.computeAreaEnv.expandBy(o)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new vo(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new go(this.subdiv)),this.incDel=new fo(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof lo){var t=arguments[0],e=this.kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this.incDel.insertSite(t),t}if(arguments[0]instanceof p){var i=arguments[0];this.insertSite(this.createVertex(i))}},interfaces_:function(){return[]},getClass:function(){return Mo}}),Mo.computeVertexEnvelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i.getCoordinate())}return e},Mo.MAX_SPLIT_ITER=99,e(To.prototype,{create:function(){if(null!==this.subdiv)return null;var t=To.envelope(this.siteCoords),e=To.toVertices(this.siteCoords);this.subdiv=new vo(t,this.tolerance),new fo(this.subdiv).insertSites(e)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof z){var t=arguments[0];this.siteCoords=To.extractUniqueCoordinates(t)}else if(P(arguments[0],y)){var e=arguments[0];this.siteCoords=To.unique(Z.toCoordinateArray(e))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return To}}),To.extractUniqueCoordinates=function(t){if(null===t)return new C;var e=t.getCoordinates();return To.unique(e)},To.envelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i)}return e},To.unique=function(t){var e=Z.copyDeep(t);return ht.sort(e),new C(e,!1)},To.toVertices=function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next();e.add(new uo(i))}return e},e(Lo.prototype,{createSiteVertices:function(t){for(var e=new w,n=t.iterator();n.hasNext();){var i=n.next();this.constraintVertexMap.containsKey(i)||e.add(new lo(i))}return e},create:function(){if(null!==this.subdiv)return null;var t=To.envelope(this.siteCoords),e=new w;null!==this.constraintLines&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),e=Lo.createConstraintSegments(this.constraintLines));var n=new Mo(this.createSiteVertices(this.siteCoords),this.tolerance);n.setConstraints(e,new w(this.constraintVertexMap.values())),n.formInitialDelaunay(),n.enforceConstraints(),this.subdiv=n.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=To.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var i=new lo(e[n]);this.constraintVertexMap.put(e[n],i)}},interfaces_:function(){return[]},getClass:function(){return Lo}}),Lo.createConstraintSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=Sn.getLines(t),n=new w,i=e.iterator();i.hasNext();){var r=i.next();Lo.createConstraintSegments(r,n)}return n}if(2===arguments.length){var o=arguments[0],s=arguments[1],a=o.getCoordinates();for(i=1;i<a.length;i++)s.add(new Eo(a[i-1],a[i]))}},e(No.prototype,{create:function(){if(null!==this.subdiv)return null;var t=To.envelope(this.siteCoords);this.diagramEnv=t;var e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv);var n=To.toVertices(this.siteCoords);this.subdiv=new vo(t,this.tolerance),new fo(this.subdiv).insertSites(n)},getDiagram:function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return No.clipGeometryCollection(e,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof z){var t=arguments[0];this.siteCoords=To.extractUniqueCoordinates(t)}else if(P(arguments[0],y)){var e=arguments[0];this.siteCoords=To.unique(Z.toCoordinateArray(e))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return No}}),No.clipGeometryCollection=function(t,e){for(var n=t.getFactory().toGeometry(e),i=new w,r=0;r<t.getNumGeometries();r++){var o=t.getGeometryN(r),s=null;e.contains(o.getEnvelopeInternal())?s=o:e.intersects(o.getEnvelopeInternal())&&(s=n.intersection(o)).setUserData(o.getUserData()),null===s||s.isEmpty()||i.add(s)}return t.getFactory().createGeometryCollection(jt.toGeometryArray(i))};var ds=Object.freeze({ConformingDelaunayTriangulationBuilder:Lo,DelaunayTriangulationBuilder:To,VoronoiDiagramBuilder:No});e(Ro.prototype,{interfaces_:function(){return[]},getClass:function(){return Ro}}),Ro.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return zn.createEmptyResult(zn.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Bn.overlayOp(t,e,zn.UNION)},e(z.prototype,{equalsTopo:function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&Sr.relate(this,t).isEquals(this.getDimension(),t.getDimension())},union:function(){if(0===arguments.length)return Tr.union(this);if(1===arguments.length){var t=arguments[0];return Ro.union(this,t)}},isValid:function(){return qr.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return zn.createEmptyResult(zn.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var e=t;return We.map(this,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Bn.overlayOp(this,t,zn.INTERSECTION)},covers:function(t){return Sr.covers(this,t)},coveredBy:function(t){return Sr.coveredBy(this,t)},touches:function(t){return Sr.touches(this,t)},intersects:function(t){return Sr.intersects(this,t)},within:function(t){return Sr.within(this,t)},overlaps:function(t){return Sr.overlaps(this,t)},disjoint:function(t){return Sr.disjoint(this,t)},crosses:function(t){return Sr.crosses(this,t)},buffer:function(){if(1===arguments.length){var t=arguments[0];return ji.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return ji.bufferOp(this,e,n)}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return ji.bufferOp(this,i,r,o)}},convexHull:function(){return new te(this).getConvexHull()},relate:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return Sr.relate.apply(Sr,[this].concat(e))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=Jt.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t=null,e=this.getDimension();if(0===e)t=new Wn(this).getInteriorPoint();else if(1===e){t=new qn(this).getInteriorPoint()}else{t=new Hn(this).getInteriorPoint()}return this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return zn.createEmptyResult(zn.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Bn.overlayOp(this,t,zn.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},toText:function(){return(new Ht).write(this)},toString:function(){this.toText()},contains:function(t){return Sr.contains(this,t)},difference:function(t){return this.isEmpty()?zn.createEmptyResult(zn.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Bn.overlayOp(this,t,zn.DIFFERENCE))},isSimple:function(){return new vi(this).isSimple()},isWithinDistance:function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&Wi.isWithinDistance(this,t,e)},distance:function(t){return Wi.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}});t.version="1.1.2 (248dab8)",t.algorithm=Zo,t.densify=Uo,t.dissolve=Yo,t.geom=qo,t.index=Ko,t.io=es,t.noding=ns,t.operation=cs,t.precision=fs,t.simplify=ps,t.triangulate=ds})(e)},t0xs:function(t,e,n){var i=n("OiNl"),r=n("WSCq").featureCollection;t.exports=function(t,e){for(var n=r([]),o=0;o<e.features.length;o++)for(var s=0;s<t.features.length;s++){i(t.features[s],e.features[o])&&n.features.push(t.features[s])}return n}},tYv0:function(t,e,n){"use strict";var i=n("lQk9"),r=n("Y41E"),o=n("rIaE");t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var n=t[0].length;if(0===n)return[];if(1===n)return i(t);if(2===n)return r(t);return o(t,n)}},uJ4D:function(t,e,n){var i=n("WSCq").polygon,r=n("It3W");function o(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),n=r(e.vertices,e.holes,2),o=[],s=[];n.forEach(function(t,i){var r=n[i];s.push([e.vertices[2*r],e.vertices[2*r+1]])});for(var a=0;a<s.length;a+=3){var h=s.slice(a,a+3);h.push(s[a]),o.push(i([h]))}return o}t.exports=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=o(t.geometry.coordinates):t.geometry.coordinates.forEach(function(t){e.features=e.features.concat(o(t))}),e}},"v+Tb":function(t,e,n){"use strict";t.exports=function(t,e,n){var r=t*e,o=i*t,s=o-(o-t),a=t-s,h=i*e,u=h-(h-e),l=e-u,c=a*l-(r-s*u-a*u-s*l);if(n)return n[0]=c,n[1]=r,n;return[c,r]};var i=+(Math.pow(2,27)+1)},yQZG:function(t,e,n){var i=n("j0UB");t.exports=function(t,e){for(var n=t[0],r=t[1],o=t[2],s=(t[3],(o-n)/e),a={type:"FeatureCollection",features:[]},h=0;h<=e;h++)for(var u=0;u<=e;u++)a.features.push(i([h*s+n,u*s+r]));return a}},zXiN:function(t,e,n){var i=n("sijn");t.exports=function(t,e){var n,r;n="Feature"===t.type?t.geometry:t,r="Feature"===e.type?e.geometry:e;var o=new i.io.GeoJSONReader,s=o.read(JSON.stringify(n)),a=o.read(JSON.stringify(r)),h=s.intersection(a);if(!h.isEmpty())return{type:"Feature",properties:{},geometry:(new i.io.GeoJSONWriter).write(h)}}},zjTK:function(t,e,n){for(var i=n("WSCq").point,r=n("WSCq").polygon,o=n("fJ48"),s=n("WSCq").featureCollection,a=[],h=[],u=0;u<6;u++){var l=2*Math.PI/6*u;a.push(Math.cos(l)),h.push(Math.sin(l))}function c(t,e,n){for(var i=[],o=0;o<6;o++){var s=t[0]+e*a[o],u=t[1]+n*h[o];i.push([s,u])}return i.push(i[0]),r([i])}function f(t,e,n){for(var i=[],o=0;o<6;o++){var s=[];s.push(t),s.push([t[0]+e*a[o],t[1]+n*h[o]]),s.push([t[0]+e*a[(o+1)%6],t[1]+n*h[(o+1)%6]]),s.push(t),i.push(r([s]))}return i}t.exports=function(t,e,n,r){var a=e/o(i([t[0],t[1]]),i([t[2],t[1]]),n)*(t[2]-t[0]),h=e/o(i([t[0],t[1]]),i([t[0],t[3]]),n)*(t[3]-t[1]),u=a/2,l=2*u,p=Math.sqrt(3)/2*h,d=t[2]-t[0],g=t[3]-t[1],y=.75*l,m=p,v=d/(l-u/2),_=Math.ceil(v);Math.round(v)===_&&_++;var x=(_*y-u/2-d)/2-u/2,w=Math.ceil(g/p),C=(g-w*p)/2,E=w*p-g>p/2;E&&(C-=p/4);for(var S=s([]),I=0;I<_;I++)for(var b=0;b<=w;b++){var P=I%2==1;if((0!==b||!P)&&(0!==b||!E)){var M=I*y+t[0]-x,T=b*m+t[1]+C;P&&(T-=p/2),r?S.features.push.apply(S.features,f([M,T],a/2,h/2)):S.features.push(c([M,T],a/2,h/2))}}return S}}});
//# sourceMappingURL=0.cc7d06999bf570cc6a46.js.map