webpackJsonp([15],{"65Lh":function(t,e){},pmbF:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("mEuU"),n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}();
/*!
 * maptalks.routeplayer v0.1.0
 * LICENSE : MIT
 * (c) 2016-2018 maptalks.org
 */
/*!
 * requires maptalks@^0.23.0 
 */function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):function(t,e){for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var n=r[i],o=Object.getOwnPropertyDescriptor(e,n);o&&o.configurable&&void 0===t[n]&&Object.defineProperty(t,n,o)}}(t,e))}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(e){a(this,t),this.route=e,this.path=e.path}return t.prototype.getCoordinates=function(t,e){if(t<this.getStart()||t>this.getEnd())return null;for(var r=null,n=0,o=this.path.length;n<o;n++)if(t<this.path[n][2]){r=n;break}null===r&&(r=this.path.length-1);var a=this.path[r-1],s=this.path[r],p=(t-a[2])/(s[2]-a[2]),l=a[0]+(s[0]-a[0])*p,h=a[1]+(s[1]-a[1])*p,u=new i.Coordinate(l,h),y=e.coordinateToViewPoint(u);return{coordinate:u,viewPoint:y,degree:i.Util.computeDegree(e.coordinateToViewPoint(new i.Coordinate(a)),y),index:r}},t.prototype.getStart=function(){return this.path[0][2]},t.prototype.getEnd=function(){return this.path[this.getCount()-1][2]},t.prototype.getCount=function(){return this.path.length},n(t,[{key:"markerSymbol",get:function(){return this.route.markerSymbol},set:function(t){this.route.markerSymbol=t,this._painter&&this._painter.marker&&this._painter.marker.setSymbol(t)}},{key:"lineSymbol",get:function(){return this.route.lineSymbol},set:function(t){this.route.lineSymbol=t,this._painter&&this._painter.marker&&this._painter.line.setSymbol(t)}}]),t}(),p=function(t){function e(r,n,o){a(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,o));return Array.isArray(r)||(r=[r]),s.id=i.Util.UID(),s._map=n,s._setup(r),s}return o(e,t),e.prototype.remove=function(){return this.markerLayer?(this.finish(),this.markerLayer.remove(),this.lineLayer.remove(),delete this.markerLayer,delete this.lineLayer,delete this._map,this):this},e.prototype.play=function(){return"running"===this.player.playState?this:(this.player.play(),this.fire("playstart"),this)},e.prototype.pause=function(){return"paused"===this.player.playState?this:(this.player.pause(),this.fire("playpause"),this)},e.prototype.cancel=function(){return this.player.cancel(),this.played=0,this._createPlayer(),this._step({styles:{t:0}}),this.fire("playcancel"),this},e.prototype.finish=function(){return"finished"===this.player.playState?this:(this.player.finish(),this._step({styles:{t:1}}),this.fire("playfinish"),this)},e.prototype.getStartTime=function(){return this.startTime||0},e.prototype.getEndTime=function(){return this.endTime||0},e.prototype.getCurrentTime=function(){return this.played?this.startTime+this.played:this.startTime},e.prototype.setTime=function(t){return this.played=t-this.startTime,this.played<0&&(this.played=0),this._resetPlayer(),this},e.prototype.getUnitTime=function(){return this.options.unitTime},e.prototype.setUnitTime=function(t){this.options.unitTime=+t,this._resetPlayer()},e.prototype.getCurrentCoordinates=function(t){return t||(t=0),this.routes[t]&&this.routes[t]._painter?this.routes[t]._painter.marker.getCoordinates():null},e.prototype.getMarkerSymbol=function(t){return this.routes&&this.routes[t]?this.routes[t].markerSymbol:null},e.prototype.setMarkerSymbol=function(t,e){return this.routes&&this.routes[t]&&(this.routes[t].markerSymbol=e),this},e.prototype.getLineSymbol=function(t){return this.routes&&this.routes[t]?this.routes[t].lineSymbol:null},e.prototype.setLineSymbol=function(t,e){return this.routes&&this.routes[t]&&(this.routes[t].lineSymbol=e),this},e.prototype._resetPlayer=function(){var t=this.player&&"running"===this.player.playState;t&&this.player.finish(),this._createPlayer(),t&&this.player.play()},e.prototype._step=function(t){if(t.state&&"running"!==t.state.playState)"finished"===t.state.playState&&this.fire("playfinish");else{this.played=this.duration*t.styles.t;for(var e=0,r=this.routes.length;e<r;e++)this._drawRoute(this.routes[e],this.startTime+this.played);this.fire("playing")}},e.prototype._drawRoute=function(t,e){if(this._map){var r=t.getCoordinates(e,this._map);if(r){if(t._painter||(t._painter={}),t._painter.marker)t._painter.marker.setCoordinates(r.coordinate);else{var n=new i.Marker(r.coordinate,{symbol:t.markerSymbol||this.options.markerSymbol}).addTo(this.markerLayer);t._painter.marker=n}if(!t._painter.line){var o=new i.LineString(t.path,{symbol:t.lineSymbol||this.options.lineSymbol}).addTo(this.lineLayer);t._painter.line=o}}else t._painter&&t._painter.marker&&(t._painter.marker.remove(),delete t._painter.marker)}},e.prototype._setup=function(t){for(var e=t.map(function(t){return new s(t)}),r=e[0].getStart(),i=e[0].getEnd(),n=1;n<e.length;n++){var o=e[n];o.getStart()<r&&(r=o.getStart()),o.getEnd()>i&&(i=o.getEnd())}this.routes=e,this.startTime=r,this.endTime=i,this.played=0,this.duration=i-r,this._createLayers(),this._createPlayer()},e.prototype._createPlayer=function(){var t=(this.duration-this.played)/this.options.unitTime,e=void 0,r=this._map._getRenderer();r.callInFrameLoop&&(e=function(t){r.callInFrameLoop(t)}),this.player=i.animation.Animation.animate({t:[this.played/this.duration,1]},{framer:e,speed:t,easing:"linear"},this._step.bind(this))},e.prototype._createLayers=function(){this.lineLayer=new i.VectorLayer(i.INTERNAL_LAYER_PREFIX+"_routeplay_r_"+this.id).addTo(this._map),this.markerLayer=new i.VectorLayer(i.INTERNAL_LAYER_PREFIX+"_routeplay_m_"+this.id).addTo(this._map)},e}(Object(i.Eventable)(i.Class));p.mergeOptions({unitTime:1e3,showRoutes:!0,markerSymbol:null,lineSymbol:{lineWidth:2,lineColor:"#004A8D"}}),"undefined"!=typeof console&&console.log("maptalks.routeplayer v0.1.0, requires maptalks@^0.23.0.");var l={data:function(){return{map:null,player:null,mapconfig:{zoom:12,center:[121.475031060928,31.2611187865471]}}},mounted:function(){this.$nextTick(function(){this.initmap(),this.createRouter()})},methods:{initmap:function(){this.map=new i.Map("map",{center:this.mapconfig.center,zoom:this.mapconfig.zoom,baseLayer:new i.TileLayer("base",{urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>'})})},createRouter:function(){this.player=new p([{path:[[121.475031060928,31.2611187865471,301e3],[121.47940842604,31.263466566376,541e3],[121.47940842604,31.273466566376,851e3]],markerSymbol:null,lineSymbol:{lineColor:"#f00"}}],this.map);var t=this.player.getUnitTime();console.log(t)},play:function(){this.player.play()},pause:function(){this.player.pause()},cancel:function(){this.player.cancel()},speed:function(){},speed1:function(){}}},h={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{attrs:{id:"map"}}),t._v(" "),r("div",{on:{click:t.play}},[t._v("开始")]),t._v(" "),r("button",{on:{click:t.pause}},[t._v("暂停")]),t._v(" "),r("button",{on:{click:t.cancel}},[t._v("重新开始")]),t._v(" "),r("button",{on:{click:t.speed}},[t._v("加速")]),t._v(" "),r("button",{on:{click:t.speed1}},[t._v("减速")])])},staticRenderFns:[]};var u=r("VU/8")(l,h,!1,function(t){r("65Lh")},"data-v-c9baff22",null);e.default=u.exports}});
//# sourceMappingURL=15.71d0b64f9e5ae28c0fcc.js.map